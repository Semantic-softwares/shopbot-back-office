import{a as Fe}from"./chunk-AQOUGCTM.js";import{a as Ve}from"./chunk-DXDY5MGG.js";import{a as b,b as Pe,c as Re}from"./chunk-VCU5WGKM.js";import{a as ke}from"./chunk-G6HLSBRZ.js";import{a as y,b as Ie}from"./chunk-MGTLFUXJ.js";import{a as ge,b as xe,c as he,d as Me,e as ve,f as we,g as ye,h as be,i as Ee,j as Te,k as Le,l as De}from"./chunk-YF6BVSFU.js";import"./chunk-P2VEYFPL.js";import"./chunk-T75DEOG5.js";import{a as ae,b as le}from"./chunk-KR7TMRYR.js";import{b as te,c as ie,d as ne}from"./chunk-IKP7S2Y7.js";import{a as Q,b as j}from"./chunk-7QB7BEGO.js";import{a as Se,c as Ce}from"./chunk-ZD2MQVCP.js";import{c as _e,h as fe}from"./chunk-ZOYXPNSX.js";import"./chunk-A2NM27HC.js";import"./chunk-ZXGSCOR2.js";import{a as me,b as de,c as ue,d as ce}from"./chunk-CXPTKSLY.js";import{a as pe}from"./chunk-EUHZN2UI.js";import"./chunk-M5357V7P.js";import{d as se}from"./chunk-2WBLSBPP.js";import"./chunk-SY26FGZT.js";import"./chunk-XYJ5R6BC.js";import"./chunk-YEWYHM4L.js";import{a as J,c as K,g as X}from"./chunk-PZG5LZPC.js";import{a as Y,d as Z,h as ee}from"./chunk-GY37C2FD.js";import{D as G,b as W,g as q,l as U}from"./chunk-2UT4NYMV.js";import"./chunk-S2P5547C.js";import{a as oe,b as re}from"./chunk-MNFAJ2ZP.js";import"./chunk-AGG277FR.js";import"./chunk-N3VBTGB6.js";import"./chunk-4KLRET2M.js";import{X as N,Y as z,_ as O}from"./chunk-KSQJ4KAT.js";import"./chunk-RDMIWI4X.js";import"./chunk-AGZJ637K.js";import{c as H,i as A}from"./chunk-LTDPQFG4.js";import"./chunk-VYX7HJYX.js";import"./chunk-FORATDN3.js";import{Bc as $,Eb as M,Fb as v,Kb as c,Lb as n,Mb as o,Nb as _,Rb as C,Sb as g,Ub as P,V as I,Yb as f,Za as p,_b as m,ca as S,cc as E,dc as T,ec as L,ha as x,ia as h,ic as R,m as D,mb as k,nc as a,oc as d,pc as w,sb as u,sc as V,tc as F,uc as B}from"./chunk-53XJD7JZ.js";import"./chunk-EQDQRRRY.js";var He=()=>[5,10,25,100];function Ae(e,i){e&1&&(n(0,"div",10),_(1,"mat-spinner",14),o())}function Ne(e,i){e&1&&_(0,"app-no-record",11)}function ze(e,i){e&1&&_(0,"app-no-record",12)}function Oe(e,i){e&1&&(n(0,"th",27),a(1,"Supplier"),o())}function Qe(e,i){if(e&1&&(n(0,"div",35),a(1),o()),e&2){let t=m().$implicit;p(),d(t.description)}}function je(e,i){if(e&1&&(n(0,"td",28)(1,"div",29)(2,"div",30)(3,"div",31)(4,"span",32),a(5),o()()(),n(6,"div",33)(7,"div",34),a(8),o(),M(9,Qe,2,1,"div",35),o()()()),e&2){let t=i.$implicit;p(5),w(" ",t.name.charAt(0).toUpperCase()," "),p(3),d(t.name),p(),v(t.description?9:-1)}}function We(e,i){e&1&&(n(0,"th",36),a(1,"Contact Info"),o())}function qe(e,i){if(e&1&&(n(0,"div",35),a(1),o()),e&2){let t=m().$implicit;p(),d(t.phone)}}function Ue(e,i){if(e&1&&(n(0,"div",35),a(1),o()),e&2){let t=m().$implicit;p(),w("Contact: ",t.contactPerson)}}function Ge(e,i){if(e&1&&(n(0,"td",28)(1,"div",37),a(2),o(),M(3,qe,2,1,"div",35),M(4,Ue,2,1,"div",35),o()),e&2){let t=i.$implicit;p(2),d(t.email),p(),v(t.phone?3:-1),p(),v(t.contactPerson?4:-1)}}function Je(e,i){e&1&&(n(0,"th",27),a(1,"Status"),o())}function Ke(e,i){if(e&1&&(n(0,"td",28)(1,"mat-chip",38),a(2),o()()),e&2){let t=i.$implicit;p(),c("color",t.active?"primary":"warn"),p(),w(" ",t.active?"Active":"Inactive"," ")}}function Xe(e,i){e&1&&(n(0,"th",27),a(1,"Payment Terms"),o())}function Ye(e,i){if(e&1&&(n(0,"td",28),a(1),o()),e&2){let t=i.$implicit;p(),d(t.paymentTerms||"N/A")}}function Ze(e,i){e&1&&(n(0,"th",36),a(1,"Actions"),o())}function et(e,i){if(e&1){let t=P();n(0,"td",28)(1,"button",39)(2,"mat-icon"),a(3,"more_vert"),o()(),n(4,"mat-menu",null,0)(6,"button",40),f("click",function(){let l=x(t).$implicit,s=m(2);return h(s.viewSupplier(l._id))}),n(7,"mat-icon"),a(8,"visibility"),o(),n(9,"span"),a(10,"View Details"),o()(),n(11,"button",40),f("click",function(){let l=x(t).$implicit,s=m(2);return h(s.editSupplier(l._id))}),n(12,"mat-icon"),a(13,"edit"),o(),n(14,"span"),a(15,"Edit"),o()(),n(16,"button",40),f("click",function(){let l=x(t).$implicit,s=m(2);return h(s.toggleSupplierStatus(l))}),n(17,"mat-icon"),a(18),o(),n(19,"span"),a(20),o()(),n(21,"button",40),f("click",function(){let l=x(t).$implicit,s=m(2);return h(s.deleteSupplier(l))}),n(22,"mat-icon"),a(23,"delete"),o(),n(24,"span"),a(25,"Delete"),o()()()()}if(e&2){let t=i.$implicit,r=R(5);p(),c("matMenuTriggerFor",r),p(17),d(t.active?"toggle_off":"toggle_on"),p(2),d(t.active?"Deactivate":"Activate")}}function tt(e,i){e&1&&_(0,"tr",41)}function it(e,i){e&1&&_(0,"tr",42)}function nt(e,i){if(e&1&&(n(0,"div",13)(1,"table",15),C(2,16),u(3,Oe,2,0,"th",17)(4,je,10,3,"td",18),g(),C(5,19),u(6,We,2,0,"th",20)(7,Ge,5,3,"td",18),g(),C(8,21),u(9,Je,2,0,"th",17)(10,Ke,3,2,"td",18),g(),C(11,22),u(12,Xe,2,0,"th",17)(13,Ye,2,1,"td",18),g(),C(14,23),u(15,Ze,2,0,"th",20)(16,et,26,3,"td",18),g(),u(17,tt,1,0,"tr",24)(18,it,1,0,"tr",25),o(),_(19,"mat-paginator",26),o()),e&2){let t=m();p(),c("dataSource",t.dataSource),p(16),c("matHeaderRowDef",t.displayedColumns),p(),c("matRowDefColumns",t.displayedColumns),p(),c("pageSizeOptions",$(4,He))}}var Be=class e{suppliersService=S(Fe);router=S(H);dialog=S(_e);snackBar=S(Q);storeStore=S(pe);displayedColumns=["name","contactInfo","status","paymentTerms","actions"];dataSource;searchText="";paginator;sort;suppliers=se({params:()=>({storeId:this.storeStore.selectedStore()?._id}),stream:({params:i})=>i.storeId?this.suppliersService.getSuppliers(i.storeId,1,1e3).pipe(I(t=>{let r=t.suppliers||[];this.dataSource=new De(r),this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort})):D({suppliers:[],page:1,totalPages:1,total:0})});constructor(){}ngOnInit(){}applyFilter(i){let t=i.target.value;this.dataSource.filter=t.trim().toLowerCase()}openDialog(){this.createSupplier()}editSupplier(i){this.router.navigate(["/menu/erp/inventory/suppliers/edit",i])}viewSupplier(i){this.router.navigate(["/menu/erp/inventory/suppliers/details",i])}toggleSupplierStatus(i){if(!i._id)return;let t=this.storeStore.selectedStore()?._id;t&&this.suppliersService.toggleSupplierStatus(i._id,t).subscribe({next:r=>{let l=this.dataSource.data,s=l.findIndex($e=>$e._id===i._id);s!==-1&&(l[s]=r,this.dataSource.data=[...l]),this.snackBar.open("Supplier status updated successfully","Close",{duration:3e3,horizontalPosition:"end",verticalPosition:"top"})},error:r=>{console.error("Error toggling supplier status:",r),this.snackBar.open("Failed to update supplier status","Close",{duration:3e3,horizontalPosition:"end",verticalPosition:"top"})}})}deleteSupplier(i){if(!i._id)return;this.dialog.open(Ve,{width:"350px",data:{message:`Are you sure you want to delete supplier "${i.name}"?`}}).afterClosed().subscribe(r=>{if(r&&i._id){let l=this.storeStore.selectedStore()?._id;if(!l)return;this.suppliersService.deleteSupplier(i._id,l).subscribe({next:()=>{this.suppliers.reload(),this.snackBar.open("Supplier deleted successfully","Close",{duration:3e3,horizontalPosition:"end",verticalPosition:"top"})},error:s=>{console.error("Error deleting supplier:",s),this.snackBar.open("Failed to delete supplier","Close",{duration:3e3,horizontalPosition:"end",verticalPosition:"top"})}})}})}createSupplier(){this.router.navigate(["/menu/erp/inventory/suppliers/create"])}static \u0275fac=function(t){return new(t||e)};static \u0275cmp=k({type:e,selectors:[["app-list-suppliers"]],viewQuery:function(t,r){if(t&1&&(E(y,5),E(b,5)),t&2){let l;T(l=L())&&(r.paginator=l.first),T(l=L())&&(r.sort=l.first)}},decls:19,vars:2,consts:[["menu","matMenu"],[1,"suppliers-container","!bg-white"],[1,"!bg-white"],[1,"flex","flex-col","md:flex-row","justify-between","gap-4","p-4"],[1,"flex","flex-col","sm:flex-row","gap-4","flex-grow"],["appearance","outline",1,"w-full","sm:w-48","md:w-72","lg:w-96"],["matPrefix",""],["matInput","","placeholder","Search suppliers by name, contact, or email",3,"keyup","ngModelChange","ngModel"],[1,"flex","gap-3","justify-end"],["mat-raised-button","","color","primary",3,"click"],[1,"flex","items-center","justify-center","min-h-[300px]"],["icon","warehouse","title","No Suppliers","message","No suppliers found matching your criteria."],["icon","error","title","Error","message","An error occurred while fetching suppliers. Please try again later."],[1,"table-container","!bg-white"],["diameter","40"],["mat-table","","matSort","",1,"!bg-white",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","contactInfo"],["mat-header-cell","",4,"matHeaderCellDef"],["matColumnDef","status"],["matColumnDef","paymentTerms"],["matColumnDef","actions"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["aria-label","Select page of suppliers",1,"!bg-white",3,"pageSizeOptions"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],[1,"flex","items-center"],[1,"flex-shrink-0","h-10","w-10"],[1,"h-10","w-10","rounded-full","bg-blue-100","flex","items-center","justify-center"],[1,"text-blue-600","font-medium","text-sm"],[1,"ml-4"],[1,"text-sm","font-medium","text-gray-900"],[1,"text-sm","text-gray-500"],["mat-header-cell",""],[1,"text-sm","text-gray-900"],[3,"color"],["mat-icon-button","","aria-label","Supplier actions",3,"matMenuTriggerFor"],["mat-menu-item","",3,"click"],["mat-header-row",""],["mat-row",""]],template:function(t,r){t&1&&(n(0,"mat-card",1)(1,"mat-card-content",2)(2,"div",3)(3,"div",4)(4,"mat-form-field",5)(5,"mat-label"),a(6,"Search"),o(),n(7,"mat-icon",6),a(8,"search"),o(),n(9,"input",7),f("keyup",function(s){return r.applyFilter(s)}),B("ngModelChange",function(s){return F(r.searchText,s)||(r.searchText=s),s}),o()()(),n(10,"div",8)(11,"button",9),f("click",function(){return r.openDialog()}),n(12,"mat-icon"),a(13,"add"),o(),a(14," ADD Supplier "),o()()(),M(15,Ae,2,0,"div",10)(16,Ne,1,0,"app-no-record",11)(17,ze,1,0,"app-no-record",12)(18,nt,20,5,"div",13),o()()),t&2&&(p(9),V("ngModel",r.searchText),p(6),v(r.suppliers.isLoading()?15:r.suppliers.hasValue()&&r.dataSource&&r.dataSource.data.length===0?16:r.suppliers.error()?17:r.suppliers.hasValue()&&r.dataSource?18:-1))},dependencies:[G,W,q,U,A,Le,ge,he,ye,Me,xe,be,ve,we,Ee,Te,Ie,y,Re,b,Pe,X,J,K,te,ee,Y,Z,ne,ie,O,z,N,re,oe,le,ae,ce,de,me,ue,j,fe,Ce,Se,ke],styles:["[_nghost-%COMP%]{display:block}"]})};export{Be as ListSuppliersComponent};
