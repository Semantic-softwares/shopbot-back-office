import{d as lt}from"./chunk-NH3IR7VS.js";import{a as rt}from"./chunk-M66VCATG.js";import{a as at}from"./chunk-AM3RQGM2.js";import{b as it,f as re}from"./chunk-6IVFTPYN.js";import{a as le,b as de,c as ot,e as ce,f as me,g as se,h as pe}from"./chunk-7AEPEFCD.js";import{a as et,b as tt,c as nt}from"./chunk-XRIZFGOF.js";import{b as Ze}from"./chunk-IQCUWJKP.js";import{a as Ve,b as Re,c as qe,d as je}from"./chunk-62CZFSKL.js";import{a as g,b as Be,c as De,d as ke,e as Oe,f as Fe,g as U,h as K,i as G}from"./chunk-I4XKOMFF.js";import{b as Ue,c as Ke,d as Xe}from"./chunk-3JUXLSAM.js";import{d as Je,e as We,h as He}from"./chunk-TKNXELSU.js";import{b as Ye}from"./chunk-4CSV6WDD.js";import{A as Qe,b as $e,g as Ge,l as ze}from"./chunk-APGJ2ZCU.js";import{a as oe}from"./chunk-6XJLFJNL.js";import{a as Le,c as Ne,e as Ae,h as ae}from"./chunk-SV3V3KFF.js";import{b as L,c as N}from"./chunk-A5WKFY2Q.js";import{Y as ie,Z as $,aa as F}from"./chunk-PD333HOR.js";import{m as we,o as Pe,q as ne,s as j}from"./chunk-T7PMTSVA.js";import{$b as b,Hb as p,Ib as u,Kc as C,Lb as W,Mb as H,Mc as te,Nb as M,Ob as a,Oc as S,Pb as o,Qb as Z,U as Q,Ub as ye,Uc as I,Vb as ve,X as J,Xa as Ce,Xb as O,Zc as P,_c as B,ab as l,bc as m,c as z,cd as Ee,ea as x,ja as E,ka as w,lc as he,nc as Se,pb as k,qc as r,rc as f,sc as h,tc as ee,va as V,vc as Te,wc as Me,xc as Ie}from"./chunk-ZCSDIQ3M.js";import{a as q,b as X,g as Y}from"./chunk-GAL4ENT6.js";function bt(e,i){if(e&1){let t=O();a(0,"button",4),b("click",function(d){E(t);let c=m();return w(c.onLeftTap(d))}),a(1,"mat-icon"),r(2),o()()}if(e&2){let t=m();l(2),f(t.leftIcon())}}function xt(e,i){if(e&1){let t=O();a(0,"button",5),b("click",function(d){E(t);let c=m();return c.onRightTap(d),w(c.clearFilter())}),a(1,"mat-icon"),r(2),o()()}if(e&2){let t=m();l(2),f(t.rightIcon())}}var dt=class e{filter=Ee("");searchText=B("Search...");leftIcon=B("search");rightIcon=B("close");showRightIcon=B(!0);showLeftIcon=B(!0);leftTap=P();rightTap=P();onLeftTap(i){this.leftTap.emit(i)}onRightTap(i){this.rightTap.emit(i)}clearFilter(){console.log("Clearing search filter"),this.filter.set("")}static \u0275fac=function(t){return new(t||e)};static \u0275cmp=k({type:e,selectors:[["app-search"]],inputs:{filter:[1,"filter"],searchText:[1,"searchText"],leftIcon:[1,"leftIcon"],rightIcon:[1,"rightIcon"],showRightIcon:[1,"showRightIcon"],showLeftIcon:[1,"showLeftIcon"]},outputs:{filter:"filterChange",leftTap:"leftTap",rightTap:"rightTap"},decls:4,vars:4,consts:[["appearance","outline",1,"w-full"],["mat-icon-button","","matPrefix",""],["matInput","","type","text",3,"ngModelChange","placeholder","ngModel"],["mat-icon-button","","matSuffix",""],["mat-icon-button","","matPrefix","",3,"click"],["mat-icon-button","","matSuffix","",3,"click"]],template:function(t,n){t&1&&(a(0,"mat-form-field",0),p(1,bt,3,1,"button",1),a(2,"input",2),Ie("ngModelChange",function(c){return Me(n.filter,c)||(n.filter=c),c}),o(),p(3,xt,3,1,"button",3),o()),t&2&&(l(),u(n.showLeftIcon()?1:-1),l(),M("placeholder",n.searchText()),Te("ngModel",n.filter),l(),u(n.showRightIcon()&&n.filter().length>0?3:-1))},dependencies:[Qe,$e,Ge,ze,Ue,He,Je,We,Xe,Ke,N,L,F,ie],styles:["[_nghost-%COMP%]{display:block;width:100%}mat-form-field[_ngcontent-%COMP%]     .mat-mdc-form-field-subscript-wrapper{display:none}mat-form-field[_ngcontent-%COMP%]     .mdc-notched-outline__leading, mat-form-field[_ngcontent-%COMP%]     .mdc-notched-outline__notch, mat-form-field[_ngcontent-%COMP%]     .mdc-notched-outline__trailing{border-color:#0000001f}mat-form-field[_ngcontent-%COMP%]     .mat-mdc-form-field-flex{align-items:center}"]})};var yt=(e,i)=>i._id,vt=(e,i)=>i.name;function ht(e,i){if(e&1&&Z(0,"img",3),e&2){let t,n=m();M("src",(t=n.storeStore.selectedStore())==null?null:t.logo,Ce)}}function St(e,i){if(e&1&&(a(0,"p"),r(1),o()),e&2){let t,n=m(2);l(),f((t=n.storeStore.selectedStore())==null||t.contactInfo==null?null:t.contactInfo.address)}}function Tt(e,i){if(e&1&&(a(0,"p"),r(1),o()),e&2){let t,n=m(2);l(),h("Tel: ",(t=n.storeStore.selectedStore())==null||t.contactInfo==null?null:t.contactInfo.phone)}}function Mt(e,i){if(e&1&&(a(0,"p"),r(1),o()),e&2){let t,n=m(2);l(),f((t=n.storeStore.selectedStore())==null||t.contactInfo==null?null:t.contactInfo.email)}}function It(e,i){if(e&1&&(a(0,"div",5),p(1,St,2,1,"p"),p(2,Tt,2,1,"p"),p(3,Mt,2,1,"p"),o()),e&2){let t,n,d,c=m();l(),u(!((t=c.storeStore.selectedStore())==null||t.contactInfo==null)&&t.contactInfo.address?1:-1),l(),u(!((n=c.storeStore.selectedStore())==null||n.contactInfo==null)&&n.contactInfo.phone?2:-1),l(),u(!((d=c.storeStore.selectedStore())==null||d.contactInfo==null)&&d.contactInfo.email?3:-1)}}function Et(e,i){if(e&1&&(a(0,"div",7)(1,"span"),r(2,"Guests:"),o(),a(3,"span"),r(4),o()()),e&2){let t,n=m(2);l(4),f((t=n.order().table)==null?null:t.numberOfGuest)}}function wt(e,i){if(e&1&&(a(0,"div",7)(1,"span"),r(2,"Table:"),o(),a(3,"span"),r(4),o()(),p(5,Et,5,1,"div",7)),e&2){let t,n,d=m();l(4),f((t=d.order().table)==null?null:t.name),l(),u((n=d.order().table)!=null&&n.numberOfGuest?5:-1)}}function Pt(e,i){if(e&1&&(a(0,"div",7)(1,"span"),r(2,"Server:"),o(),a(3,"span"),r(4),o()()),e&2){let t=m();l(4),f(t.order().staff.name||"N/A")}}function Bt(e,i){if(e&1&&(a(0,"span"),r(1),o()),e&2){let t=m().$implicit;l(),h("(x",t.quantity,")")}}function Dt(e,i){if(e&1&&(a(0,"span",30),r(1),C(2,"currency"),o()),e&2){let t=m().$implicit,n=m(3);l(),f(S(2,1,t.price,n.currency(),"symbol","1.2-2"))}}function kt(e,i){if(e&1&&(a(0,"div",16)(1,"span"),r(2),p(3,Bt,2,1,"span"),o(),p(4,Dt,3,6,"span",30),o()),e&2){let t=i.$implicit;l(2),h(" + ",t.name," "),l(),u(t.quantity>1?3:-1),l(),u(t.price>0?4:-1)}}function Ot(e,i){if(e&1&&(a(0,"div",29),W(1,kt,5,3,"div",16,vt),o()),e&2){let t=m().$implicit,n=m();l(),H(n.getOptionsDisplay(t))}}function Ft(e,i){if(e&1&&(a(0,"div",11)(1,"div",25)(2,"div",26)(3,"div",8),r(4),o(),a(5,"div",27),r(6),C(7,"currency"),o()(),a(8,"div",28),r(9),C(10,"currency"),o()(),p(11,Ot,3,0,"div",29),o()),e&2){let t=i.$implicit,n=m();l(4),f(t.name),l(2),ee("",t.quantity," x ",S(7,5,t.price,n.currency(),"symbol","1.2-2")),l(3),f(S(10,10,n.getItemTotal(t),n.currency(),"symbol","1.2-2")),l(2),u(n.getOptionsDisplay(t).length>0?11:-1)}}function Lt(e,i){if(e&1&&(a(0,"div",13)(1,"span"),r(2,"Discount:"),o(),a(3,"span"),r(4),C(5,"currency"),o()()),e&2){let t=m();l(4),h("-",S(5,1,t.order().discount,t.currency(),"symbol","1.2-2"))}}function Nt(e,i){if(e&1&&(a(0,"div",13)(1,"span"),r(2,"Tax:"),o(),a(3,"span"),r(4),C(5,"currency"),o()()),e&2){let t=m();l(4),f(S(5,1,t.order().tax,t.currency(),"symbol","1.2-2"))}}function At(e,i){if(e&1&&(a(0,"div",13)(1,"span"),r(2,"Delivery Fee:"),o(),a(3,"span"),r(4),C(5,"currency"),o()()),e&2){let t=m();l(4),f(S(5,1,t.order().shippingFee,t.currency(),"symbol","1.2-2"))}}function Vt(e,i){if(e&1&&(a(0,"div",13)(1,"span"),r(2,"Service Fee:"),o(),a(3,"span"),r(4),C(5,"currency"),o()()),e&2){let t=m();l(4),f(S(5,1,t.order().serviceFee,t.currency(),"symbol","1.2-2"))}}function Rt(e,i){if(e&1&&(a(0,"div",6)(1,"div",31),r(2,"Note:"),o(),a(3,"div",32),r(4),o()()),e&2){let t=m();l(4),f(t.order().note)}}function qt(e,i){if(e&1&&(a(0,"p",19),r(1),o()),e&2){let t,n=m();l(),h(" ",(t=n.storeStore.selectedStore())==null||t.posSettings==null||t.posSettings.receiptSettings==null?null:t.posSettings.receiptSettings.disclaimer," ")}}function jt(e,i){e&1&&(a(0,"mat-icon",33),r(1,"refresh"),o(),r(2," Printing... "))}function $t(e,i){e&1&&(a(0,"mat-icon"),r(1,"print"),o(),r(2," Print "))}var ue=class e{dialogRef=x(le);storeStore=x(G);printJobService=x(rt);data=x(de);order=V(this.data.orderData);snackBar=x(oe);isPrinting=V(!1);close(){this.dialogRef.close()}print(){return Y(this,null,function*(){this.isPrinting.set(!0);try{(yield this.printJobService.printOrderReceipt(this.order())).isPrinterConnected?this.snackBar.open("\u2705 Order printed successfully","Close",{duration:3e3}):this.snackBar.open("\u{1F4CB} Print job created - Receipt will print at counter","Close",{duration:5e3,panelClass:["info-snackbar"]}),this.close()}catch(i){console.error("Print failed:",i),this.snackBar.open(`Print failed: ${i.message}`,"Close",{duration:5e3,panelClass:["error-snackbar"]})}finally{this.isPrinting.set(!1)}})}currency=I(()=>this.storeStore.selectedStore()?.currency||"\u20A6");getItemTotal(i){let t=i.price*i.quantity;return i.options&&i.options.length>0&&i.options.forEach(n=>{n.options&&n.options.forEach(d=>{d.selected&&(t+=(d.price||0)*(d.quantity||1)*i.quantity)})}),t}getOptionsDisplay(i){if(!i.options||i.options.length===0)return[];let t=[];return i.options.forEach(n=>{n.options&&n.options.forEach(d=>{d.selected&&t.push({name:d.name,quantity:d.quantity||1,price:d.price||0})})}),t}getBasePrice(i){return i.price*i.quantity}getOptionsCost(i){let t=0;return i.options&&i.options.length>0&&i.options.forEach(n=>{n.options&&n.options.forEach(d=>{d.selected&&(t+=(d.price||0)*(d.quantity||1)*i.quantity)})}),t}formatDate(i){return i?new Date(i).toLocaleString():"N/A"}static \u0275fac=function(t){return new(t||e)};static \u0275cmp=k({type:e,selectors:[["app-bill-modal"]],decls:73,vars:39,consts:[["mat-dialog-title",""],[1,"receipt-paper","p-8","font-mono","text-sm","w-full"],[1,"text-center","mb-4","pb-4","border-b","border-dashed","border-gray-400"],["alt","Store Logo",1,"h-12","w-12","object-contain","mx-auto","mb-2",3,"src"],[1,"text-base","font-bold","uppercase","mb-1"],[1,"text-xs","text-gray-700","space-y-0.5"],[1,"text-xs","mb-4","pb-3","border-b","border-dashed","border-gray-400"],[1,"flex","justify-between","mb-1"],[1,"font-semibold"],[1,"mb-4","pb-3","border-b","border-dashed","border-gray-400"],[1,"text-xs","font-bold","uppercase","mb-2"],[1,"mb-3"],[1,"text-xs","mb-4"],[1,"flex","justify-between","mb-1.5"],[1,"border-t-2","border-double","border-gray-800","pt-2","mb-4"],[1,"flex","justify-between","text-base","font-bold"],[1,"flex","justify-between"],[1,"text-center","mt-6","pt-4","border-t","border-dashed","border-gray-400"],[1,"text-xs","font-semibold","mb-2"],[1,"text-xs","text-gray-500","mb-2"],[1,"text-xs","text-gray-400","mt-3"],[1,"text-xs","text-gray-400","mt-1"],["align","end",1,"print:hidden","border-t"],["matButton","",3,"click","disabled"],["matButton","filled","color","primary",3,"click","disabled"],[1,"flex","justify-between","items-start","mb-1"],[1,"flex-1","pr-2"],[1,"text-xs","text-gray-600"],[1,"font-semibold","whitespace-nowrap"],[1,"ml-3","text-xs","text-gray-600","space-y-0.5"],[1,"whitespace-nowrap"],[1,"font-semibold","mb-1"],[1,"text-gray-600"],[1,"animate-spin"]],template:function(t,n){if(t&1&&(a(0,"div",0),r(1,"Receipt"),o(),a(2,"mat-dialog-content")(3,"div",1)(4,"div",2),p(5,ht,1,1,"img",3),a(6,"h3",4),r(7),o(),p(8,It,4,3,"div",5),o(),a(9,"div",6)(10,"div",7)(11,"span"),r(12,"Order #:"),o(),a(13,"span",8),r(14),o()(),a(15,"div",7)(16,"span"),r(17,"Date:"),o(),a(18,"span"),r(19),C(20,"date"),o()(),p(21,wt,6,2),p(22,Pt,5,1,"div",7),o(),a(23,"div",9)(24,"div",10),r(25,"Items"),o(),W(26,Ft,12,15,"div",11,yt),o(),a(28,"div",12)(29,"div",13)(30,"span"),r(31,"Subtotal:"),o(),a(32,"span"),r(33),C(34,"currency"),o()(),p(35,Lt,6,6,"div",13),p(36,Nt,6,6,"div",13),p(37,At,6,6,"div",13),p(38,Vt,6,6,"div",13),o(),a(39,"div",14)(40,"div",15)(41,"span"),r(42,"TOTAL:"),o(),a(43,"span"),r(44),C(45,"currency"),o()()(),a(46,"div",6)(47,"div",7)(48,"span"),r(49,"Payment:"),o(),a(50,"span",8),r(51),o()(),a(52,"div",16)(53,"span"),r(54,"Status:"),o(),a(55,"span",8),r(56),o()()(),p(57,Rt,5,1,"div",6),a(58,"div",17)(59,"p",18),r(60),o(),p(61,qt,2,1,"p",19),a(62,"p",20),r(63),o(),a(64,"p",21),r(65,"***"),o()()()(),a(66,"mat-dialog-actions",22)(67,"button",23),b("click",function(){return n.close()}),r(68," Close "),o(),a(69,"button",24),b("click",function(){return n.print()}),ye(70),p(71,jt,3,0)(72,$t,3,0),ve(),o()()),t&2){let d,c,D,y,v,R;l(5),u((d=n.storeStore.selectedStore())!=null&&d.logo?5:-1),l(2),f(((c=n.storeStore.selectedStore())==null?null:c.name)||"Store Name"),l(),u((D=n.storeStore.selectedStore())!=null&&D.contactInfo?8:-1),l(6),f(n.order().reference||n.order()._id),l(5),f(te(20,26,n.order().createdAt,"short")),l(2),u(n.order().table?21:-1),l(),u(n.order().staff?22:-1),l(4),H((y=n.order().cart)==null?null:y.products),l(7),f(S(34,29,n.order().subTotal||0,n.currency(),"symbol","1.2-2")),l(2),u(n.order().discount&&n.order().discount>0?35:-1),l(),u(n.order().tax&&n.order().tax>0?36:-1),l(),u(n.order().shippingFee&&n.order().shippingFee>0?37:-1),l(),u(n.order().serviceFee&&n.order().serviceFee>0?38:-1),l(6),f(S(45,34,n.order().total||0,n.currency(),"symbol","1.2-2")),l(7),f(n.order().payment||"N/A"),l(4),Se("text-green-600",n.order().paymentStatus==="Paid")("text-orange-600",n.order().paymentStatus==="Unpaid"),l(),h(" ",n.order().paymentStatus," "),l(),u(n.order().note?57:-1),l(3),h(" ",((v=n.storeStore.selectedStore())==null||v.posSettings==null||v.posSettings.receiptSettings==null?null:v.posSettings.receiptSettings.footerMessage)||"Thank you for your patronage!"," "),l(),u(!((R=n.storeStore.selectedStore())==null||R.posSettings==null||R.posSettings.receiptSettings==null)&&R.posSettings.receiptSettings.disclaimer?61:-1),l(2),h(" ",n.formatDate(n.order().createdAt)," "),l(4),M("disabled",n.isPrinting()),l(2),M("disabled",n.isPrinting()),l(2),u(n.isPrinting()?71:72)}},dependencies:[j,pe,ce,se,me,F,$,N,L,Ze,ae,re,ne,we],styles:[".receipt-paper[_ngcontent-%COMP%]{width:100%;max-width:100%}@media print{  mat-dialog-container{box-shadow:none!important;max-width:80mm!important}  h2[mat-dialog-title],   mat-dialog-actions,   .print\\:hidden{display:none!important}  mat-dialog-content{max-height:none!important;padding:0!important;margin:0!important}  .receipt-paper{padding:10mm!important;max-width:80mm!important;width:80mm!important;font-size:11px!important}  .text-gray-600,   .text-gray-700{color:#000!important}}"]})};function Gt(e,i){if(e&1&&(a(0,"span",4),r(1),o()),e&2){let t=m();l(),h(" ",t.table().category.name," ")}}function zt(e,i){e&1&&Z(0,"span")}function Qt(e,i){if(e&1){let t=O();a(0,"button",11),b("click",function(d){return E(t),w(d.stopPropagation())}),a(1,"mat-icon"),r(2,"more_vert"),o()(),a(3,"mat-menu",null,0)(5,"button",12),b("click",function(d){E(t);let c=m();return w(c.onViewBill(d))}),a(6,"mat-icon"),r(7,"receipt_long"),o(),a(8,"span"),r(9,"View Bill"),o()(),a(10,"button",12),b("click",function(d){E(t);let c=m();return w(c.onClearOrder(d))}),a(11,"mat-icon"),r(12,"clear"),o(),a(13,"span"),r(14,"Clear Order"),o()()()}if(e&2){let t=he(4);M("matMenuTriggerFor",t)}}function Jt(e,i){if(e&1&&(a(0,"span",9),r(1),C(2,"currency"),o()),e&2){let t=m();l(),h(" ",S(2,1,t.table().orderId.total,t.currency(),"symbol","1.2-2")," ")}}function Wt(e,i){if(e&1){let t=O();a(0,"button",18),b("click",function(d){E(t);let c=m(3);return w(c.onCompleteOrder(d))}),a(1,"mat-icon",16),r(2,"check_circle"),o(),r(3," Complete "),o()}}function Ht(e,i){if(e&1){let t=O();a(0,"div",13)(1,"button",15),b("click",function(d){E(t);let c=m(2);return w(c.onViewOrder(d))}),a(2,"mat-icon",16),r(3,"visibility"),o(),r(4," View Order "),o(),p(5,Wt,4,0,"button",17),o()}if(e&2){let t=m(2);l(5),u(t.isOrderCompleted?-1:5)}}function Ut(e,i){if(e&1){let t=O();a(0,"button",19),b("click",function(){E(t);let d=m(2);return w(d.onAddNewOrder())}),a(1,"mat-icon"),r(2,"add"),o(),r(3," Add new order "),o()}}function Kt(e,i){if(e&1&&(a(0,"mat-card-actions",10),p(1,Ht,6,1,"div",13)(2,Ut,4,0,"button",14),o()),e&2){let t=m();l(),u(t.table().orderId?1:2)}}var mt=class e{storeStore=x(G);dialog=x(ot);cartService=x(lt);snackBar=x(oe);table=B.required();hideActions=B(!1);tableClick=P();addNewOrder=P();completeOrder=P();clearOrder=P();viewOrder=P();isLoadingBill=V(!1);currency=I(()=>this.storeStore.selectedStore()?.currency||"\u20A6");get isOrderCompleted(){return this.table().orderId?.category==="Complete"}onTableClick(){this.tableClick.emit(this.table())}onAddNewOrder(){this.addNewOrder.emit(this.table())}onCompleteOrder(i){i.stopPropagation(),this.completeOrder.emit(this.table())}onClearOrder(i){i.stopPropagation(),this.clearOrder.emit(this.table())}onViewOrder(i){i.stopPropagation(),this.viewOrder.emit(this.table())}onViewBill(i){i.stopPropagation();let t=this.table().orderId;if(!t?.cart){this.snackBar.open("No cart data available","Close",{duration:3e3});return}this.isLoadingBill.set(!0);let n=this.snackBar.open("Loading bill...","",{duration:0,horizontalPosition:"center",verticalPosition:"bottom"});this.cartService.loadCart(t.cart).subscribe({next:d=>Y(this,null,function*(){try{let c=X(q({},t),{cart:d});n.dismiss(),this.isLoadingBill.set(!1),this.dialog.open(ue,{width:"650px",maxHeight:"90vh",data:{orderData:c}})}catch(c){console.error("Failed to load bill:",c),n.dismiss(),this.isLoadingBill.set(!1),this.snackBar.open("Failed to load bill","Close",{duration:3e3})}}),error:d=>{console.error("Error loading cart:",d),n.dismiss(),this.isLoadingBill.set(!1),this.snackBar.open("Failed to load cart data","Close",{duration:3e3})}})}static \u0275fac=function(t){return new(t||e)};static \u0275cmp=k({type:e,selectors:[["app-table-card"]],inputs:{table:[1,"table"],hideActions:[1,"hideActions"]},outputs:{tableClick:"tableClick",addNewOrder:"addNewOrder",completeOrder:"completeOrder",clearOrder:"clearOrder",viewOrder:"viewOrder"},decls:15,vars:7,consts:[["menu","matMenu"],["appearance","outlined",1,"relative","cursor-pointer","transition-all","duration-300","hover:shadow-xl","hover:-translate-y-1",3,"click"],[1,"p-4"],[1,"flex","items-center","justify-between","mb-4"],[1,"px-2","py-1","bg-gray-100","text-gray-700","text-xs","font-medium","rounded-full"],[1,"flex","flex-col","items-center","justify-center","py-4"],[1,"!text-sm","mb-3"],[1,"text-lg","font-bold","text-gray-900"],[1,"text-xs","text-gray-600","mt-1"],[1,"text-sm","font-semibold","mt-2",2,"color","var(--mat-sys-primary)"],[1,"mt-4","border-t","border-outline-variant"],["matIconButton","",3,"click","matMenuTriggerFor"],["mat-menu-item","",3,"click"],[1,"flex","gap-2","w-full"],["matButton","filled","color","primary",1,"w-full"],["matButton","outlined","color","primary",1,"flex-1","w-full",3,"click"],[1,"mr-2","!text-base"],["mat-flat-button","","color","primary",1,"flex-1","w-full"],["mat-flat-button","","color","primary",1,"flex-1","w-full",3,"click"],["matButton","filled","color","primary",1,"w-full",3,"click"]],template:function(t,n){t&1&&(a(0,"mat-card",1),b("click",function(){return n.onTableClick()}),a(1,"mat-card-content",2)(2,"div",3),p(3,Gt,2,1,"span",4)(4,zt,1,0,"span"),p(5,Qt,15,1),o(),a(6,"div",5)(7,"mat-chip",6),r(8),o(),a(9,"h3",7),r(10),o(),a(11,"span",8),r(12),o(),p(13,Jt,3,6,"span",9),o()(),p(14,Kt,3,1,"mat-card-actions",10),o()),t&2&&(l(3),u(n.table().category?3:4),l(2),u(n.table().orderId?5:-1),l(3),h(" ",n.table().orderId?"Occupied":"Free"," "),l(2),f(n.table().name),l(2),h("",n.table().numberOfGuest," seats"),l(),u(n.table().orderId?13:-1),l(),u(n.hideActions()?-1:14))},dependencies:[j,ae,Le,Ae,Ne,N,L,F,$,ie,je,Re,Ve,qe,re,it,Ye,ne],styles:["[_nghost-%COMP%]{display:block}"]})};var Xt=(e,i)=>i.id;function Yt(e,i){if(e&1&&(a(0,"mat-button-toggle",5)(1,"mat-icon"),r(2),o(),a(3,"span"),r(4),o()()),e&2){let t=i.$implicit;M("value",t.id),l(2),f(t.icon),l(2),f(t.name)}}var st=class e{dialogRef=x(le);data=x(de);selectedPaymentMethod=V("cash");paymentMethods=[{id:"POS",name:"POS Terminal",icon:"credit_card"},{id:"Transfer",name:"Transfer",icon:"swap_horizontal_circle"},{id:"Cash",name:"Cash",icon:"payments"}];onPaymentMethodChange(i){this.selectedPaymentMethod.set(i)}onConfirmPayment(){let i=this.paymentMethods.find(n=>n.id===this.selectedPaymentMethod()),t={action:"confirm",paymentMethod:i?{name:i.name,id:i.id}:void 0};this.dialogRef.close(t)}onSkipPayment(){let i={action:"skip"};this.dialogRef.close(i)}onCancel(){this.dialogRef.close()}static \u0275fac=function(t){return new(t||e)};static \u0275cmp=k({type:e,selectors:[["app-payment-dialog"]],decls:18,vars:6,consts:[["mat-dialog-title",""],[1,"rounded-lg","p-6","mb-6","text-center"],[1,"text-sm","text-gray-600","mb-2"],[1,"text-3xl","font-bold","text-gray-900"],[3,"change","value"],[3,"value"],["align","end",1,"border-2","border-outline-variant"],["matButton","outlined","color","primary",3,"click"],["matButton","filled","color","primary",3,"click"]],template:function(t,n){t&1&&(a(0,"h2",0),r(1,"Payment"),o(),a(2,"mat-dialog-content")(3,"div",1)(4,"p",2),r(5,"Total Amount:"),o(),a(6,"p",3),r(7),C(8,"number"),o()(),a(9,"div")(10,"mat-button-toggle-group",4),b("change",function(c){return n.onPaymentMethodChange(c.value)}),W(11,Yt,5,3,"mat-button-toggle",5,Xt),o()()(),a(13,"mat-dialog-actions",6)(14,"button",7),b("click",function(){return n.onSkipPayment()}),r(15," Skip Payment "),o(),a(16,"button",8),b("click",function(){return n.onConfirmPayment()}),r(17," Confirm Payment "),o()()),t&2&&(l(7),ee(" ",n.data.currency," ",te(8,3,n.data.totalAmount,"1.2-2")," "),l(3),M("value",n.selectedPaymentMethod()),l(),H(n.paymentMethods))},dependencies:[j,pe,ce,se,me,F,$,N,L,nt,et,tt,Pe],encapsulation:2})};var Zt={tables:[],selectedTable:null,isLoading:!1,searchQuery:"",searchFilters:null,statusFilter:"all",error:null},mi=Be({providedIn:"root"},Fe(Zt),De(({tables:e,searchQuery:i,searchFilters:t,statusFilter:n})=>({tablesCount:I(()=>e().length),freeTableCount:I(()=>e().filter(d=>!d.orderId).length),totalSeatCount:I(()=>e().reduce((d,c)=>d+c.numberOfGuest,0)),totalFreeSeats:I(()=>e().filter(d=>d.orderId).reduce((d,c)=>d+c.numberOfGuest,0)),occupiedTableCount:I(()=>e().filter(d=>d.orderId).length),filteredTables:I(()=>{let d=i()?.toLowerCase(),c=t(),D=n(),y=e();return d&&d.length>0&&(y=y.filter(v=>v.name?.toLowerCase().includes(d))),c&&(y=y.filter(v=>v.category?._id===c._id)),console.log(D),D==="free"?y=y.filter(v=>!v.orderId):D==="occupied"&&(y=y.filter(v=>v.orderId)),y})})),Oe((e,i=x(at))=>{function t(s){let _=e.tables().find(T=>T._id===s)||null;g(e,{selectedTable:_})}function n(){g(e,{selectedTable:null})}function d(s,_){let T=e.tables().map(A=>A._id===s?q(q({},A),_):A);g(e,{tables:T})}function c(s,_){let T=e.tables().map(A=>A._id===s?X(q({},A),{order:_}):A);g(e,{tables:T})}function D(s,_){i.updateTable(s,_).subscribe({next:T=>{console.log("Table updated on server:",T)},error:T=>{console.error("Failed to update table on server:",T)}})}function y(s){g(e,{searchFilters:s})}function v(s){g(e,{searchQuery:s})}function R(s){g(e,{statusFilter:s})}function xe(s){g(e,{tables:[...e.tables(),s]})}function pt(s){let _=e.tables().filter(T=>T._id!==s);g(e,{tables:_})}let ut=K(z(J(()=>g(e,{isLoading:!0,error:null,tables:[]})),Q(s=>i.getStoreTables(s).pipe(U({next(_){g(e,{isLoading:!1,error:null,tables:_})},error(_){g(e,{isLoading:!1,error:String(_)})}}))))),ft=K(z(J(()=>g(e,{isLoading:!0,error:null})),Q(s=>i.createTable(s.tableParams).pipe(U({next(_){g(e,{isLoading:!1,error:null}),xe(_),s?.modalParams&&s.modalParams.closeCallback()},error(_){g(e,{isLoading:!1,error:String(_)})}}))))),_t=K(z(J(()=>g(e,{isLoading:!0,error:null})),Q(s=>i.updateTable(s.tableId,s.tableParams).pipe(U({next(_){g(e,{isLoading:!1,error:null}),d(s.tableId,s.tableParams),s?.modalParams&&s.modalParams.closeCallback()},error(_){g(e,{isLoading:!1,error:String(_)})}}))))),gt=K(z(J(()=>g(e,{isLoading:!0,error:null})),Q(s=>i.deleteTable(s).pipe(U({next(_){g(e,{isLoading:!1,error:null})},error(_){g(e,{isLoading:!1,error:String(_)})}})))));return{selectTable:t,clearSelectedTable:n,updateTable:d,updateTableOrder:c,updateSearchFilter:y,updateSearchQuery:v,updateStatusFilter:R,createTable:xe,deleteTable:pt,getTables$:ut,createTable$:ft,updateTable$:_t,deleteTable$:gt,updateTableOrderSync:D}}),ke({onInit(e){let t=x(G).selectedStore();t?._id&&e.getTables$(t._id)}}));export{dt as a,mt as b,st as c,mi as d};
