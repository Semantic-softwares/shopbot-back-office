import{a as qe}from"./chunk-LZRYHEBK.js";import{a as We,b as Ne,c as Ae,h as ze}from"./chunk-NGP3QI5W.js";import{a as $e,b as Ge}from"./chunk-7WNNENZV.js";import{a as Re,b as Te,c as Le,d as De,e as Ie,f as Ve,g as Pe,h as Fe,i as ke,j as Oe,k as Be}from"./chunk-72VJX2YS.js";import{a as He,b as je}from"./chunk-DB3A7P3M.js";import{a as ee}from"./chunk-CZ2S7A5U.js";import"./chunk-KVJZH652.js";import"./chunk-XTLJZNJU.js";import"./chunk-HUTJFBBB.js";import{d as Z}from"./chunk-SWNYNPHN.js";import{b as _e,c as fe,d as ge}from"./chunk-3BP5U2AG.js";import{a as Ee,b as we,c as be}from"./chunk-ZNHPNQ3W.js";import"./chunk-CZME4V75.js";import"./chunk-CQES5GWZ.js";import{a as ve,c as he,d as ye,e as Me}from"./chunk-CMZGRSEW.js";import"./chunk-K6UY4OSY.js";import{d as A}from"./chunk-ZBSG24BC.js";import"./chunk-GXR3VSCN.js";import{a as Se}from"./chunk-7ZRYRFA4.js";import"./chunk-OJWZ6ZD7.js";import{a as me,c as ce,g as se}from"./chunk-L2IRRR6J.js";import{a as de,e as pe,h as ue}from"./chunk-27T6VRU4.js";import{D as le,b as ae,g as oe,l as re}from"./chunk-LM7FYRY4.js";import"./chunk-ZENMOCFL.js";import{a as Ce,b as xe}from"./chunk-EDESGICS.js";import"./chunk-7KAGHLPR.js";import"./chunk-JRF7K3G5.js";import"./chunk-HRGWPEEQ.js";import{X as te,Y as ie,Z as ne}from"./chunk-BVLPFG4Z.js";import"./chunk-LYY57WCE.js";import"./chunk-AGZJ637K.js";import{c as U,d as X,i as Y}from"./chunk-QJAAU2EQ.js";import"./chunk-S3JL7UCS.js";import{n as J,q as K,r as Q}from"./chunk-ETP2OZKZ.js";import{Ac as L,Bc as D,Db as M,Eb as E,Gc as y,Ic as W,Jb as m,Jc as F,Kb as i,Lb as t,Mb as S,Oc as N,Qb as f,Rb as g,Tb as V,Xb as h,Ya as l,Zb as C,ca as O,d as k,fb as j,ha as u,hc as w,ia as _,ic as G,jc as B,lb as $,lc as P,mc as a,nc as x,oc as v,pc as q,rb as p,rc as b,sc as R,tc as T}from"./chunk-KGWH6IHP.js";import"./chunk-EQDQRRRY.js";var Ue=()=>["start"],Je=()=>[],Qe=e=>[e,"details"],Xe=e=>[e,"count"],Ye=e=>[e,"review"],Ze=()=>[10,25,50,100];function et(e,n){e&1&&(i(0,"th",36),a(1,"Name"),t())}function tt(e,n){if(e&1&&(i(0,"td",37)(1,"div",38),a(2),t(),i(3,"div",39),a(4),t()()),e&2){let o=n.$implicit;l(2),x(o.name),l(2),x(o.description)}}function it(e,n){e&1&&(i(0,"th",36),a(1,"Status"),t())}function nt(e,n){if(e&1&&(i(0,"td",37)(1,"mat-chip-set")(2,"mat-chip"),a(3),t()()()),e&2){let o=n.$implicit,r=C();l(2),P(r.getStatusClass(o.status)),l(),v(" ",r.getStatusLabel(o.status)," ")}}function at(e,n){e&1&&(i(0,"th",36),a(1,"Actions"),t())}function ot(e,n){if(e&1&&(i(0,"td",37)(1,"button",40)(2,"mat-icon"),a(3,"more_vert"),t()(),i(4,"mat-menu",null,2)(6,"button",41)(7,"mat-icon"),a(8,"visibility"),t(),i(9,"span"),a(10,"View Details"),t()()()()),e&2){let o=n.$implicit,r=w(5);l(),m("matMenuTriggerFor",r),l(5),m("routerLink",D(2,Qe,o._id))}}function rt(e,n){e&1&&S(0,"tr",42)}function lt(e,n){e&1&&S(0,"tr",43)}function mt(e,n){if(e&1&&(i(0,"div",16)(1,"mat-card",18)(2,"div",44)(3,"div")(4,"p",45),a(5,"Total Reconciliations"),t(),i(6,"p",46),a(7),t()(),i(8,"mat-icon",47),a(9,"inventory"),t()()(),i(10,"mat-card",18)(11,"div",44)(12,"div")(13,"p",45),a(14,"Completed"),t(),i(15,"p",48),a(16),t()(),i(17,"mat-icon",49),a(18,"check_circle"),t()()(),i(19,"mat-card",18)(20,"div",44)(21,"div")(22,"p",45),a(23,"Total Variance"),t(),i(24,"p",50),a(25),y(26,"currency"),t()(),i(27,"mat-icon",51),a(28,"trending_up"),t()()(),i(29,"mat-card",18)(30,"div",44)(31,"div")(32,"p",45),a(33,"Avg Variance"),t(),i(34,"p",46),a(35),y(36,"currency"),t()(),i(37,"mat-icon",52),a(38,"analytics"),t()()()()),e&2){let o=n,r=C();l(7),x(o.overview.totalReconciliations),l(9),x(o.overview.completedReconciliations),l(8),B("text-red-600",o.overview.totalVarianceValue<0)("text-green-600",o.overview.totalVarianceValue>0),l(),v(" ",F(26,8,o.overview.totalVarianceValue,r.currency(),"symbol","1.2-2")," "),l(10),v(" ",F(36,13,o.overview.avgVarianceValue,r.currency(),"symbol","1.2-2")," ")}}function ct(e,n){e&1&&(i(0,"th",36),a(1,"Name"),t())}function st(e,n){if(e&1&&(i(0,"td",37)(1,"div")(2,"div",38),a(3),t(),i(4,"div",39),a(5),t()()()),e&2){let o=n.$implicit;l(3),x(o.name),l(2),x(o.description)}}function dt(e,n){e&1&&(i(0,"th",36),a(1,"Start Date"),t())}function pt(e,n){if(e&1&&(a(0),y(1,"date")),e&2){let o=C().$implicit;v(" Completed: ",W(1,1,o.completedDate,"mediumDate")," ")}}function ut(e,n){if(e&1&&(i(0,"td",37)(1,"div")(2,"div"),a(3),y(4,"date"),t(),i(5,"div",39),M(6,pt,2,4),t()()()),e&2){let o=n.$implicit;l(3),x(W(4,2,o.startDate,"mediumDate")),l(3),E(o.completedDate?6:-1)}}function _t(e,n){e&1&&(i(0,"th",36),a(1,"Type"),t())}function ft(e,n){if(e&1&&(i(0,"td",37)(1,"mat-chip-set")(2,"mat-chip"),a(3),t()()()),e&2){let o=n.$implicit,r=C();l(2),P(r.getTypeClass(o.type)),l(),v(" ",r.getTypeLabel(o.type)," ")}}function gt(e,n){e&1&&(i(0,"th",36),a(1,"Progress"),t())}function Ct(e,n){if(e&1&&(i(0,"td",37)(1,"div")(2,"div",53),a(3),t(),i(4,"div",54),S(5,"div",55),t()()()),e&2){let o=n.$implicit,r=C();l(3),q(" ",o.countedProducts," / ",o.totalProducts," items "),l(2),G("width",r.getProgressPercentage(o),"%")}}function xt(e,n){e&1&&(i(0,"th",36),a(1,"Discrepancies"),t())}function St(e,n){if(e&1&&(i(0,"td",37)(1,"div")(2,"div",38),a(3),t(),i(4,"div",53),a(5),y(6,"currency"),t()()()),e&2){let o=n.$implicit,r=C();l(3),x(o.discrepancyCount),l(),B("text-red-600",o.totalVarianceValue<0)("text-green-600",o.totalVarianceValue>0),l(),v(" ",F(6,6,o.totalVarianceValue,r.currency(),"symbol","1.2-2")," ")}}function vt(e,n){e&1&&(i(0,"th",36),a(1,"Status"),t())}function ht(e,n){if(e&1&&(i(0,"td",37)(1,"mat-chip-set")(2,"mat-chip"),a(3),t()()()),e&2){let o=n.$implicit,r=C();l(2),P(r.getStatusClass(o.status)),l(),v(" ",r.getStatusLabel(o.status)," ")}}function yt(e,n){e&1&&(i(0,"th",36),a(1,"Actions"),t())}function Mt(e,n){if(e&1&&(i(0,"button",41)(1,"mat-icon"),a(2,"edit"),t(),i(3,"span"),a(4,"Continue Counting"),t()(),i(5,"button",41)(6,"mat-icon"),a(7,"preview"),t(),i(8,"span"),a(9,"Review & Approve"),t()()),e&2){let o=C().$implicit;m("routerLink",D(2,Xe,o._id)),l(5),m("routerLink",D(4,Ye,o._id))}}function Et(e,n){if(e&1){let o=V();i(0,"td",37)(1,"button",40)(2,"mat-icon"),a(3,"more_vert"),t()(),i(4,"mat-menu",null,2)(6,"button",41)(7,"mat-icon"),a(8,"visibility"),t(),i(9,"span"),a(10,"View Details"),t()(),M(11,Mt,10,6),i(12,"button",56),h("click",function(){let c=u(o).$implicit,d=C();return _(d.deleteReconciliation(c._id))}),i(13,"mat-icon"),a(14,"delete"),t(),i(15,"span"),a(16,"Delete"),t()()()()}if(e&2){let o=n.$implicit,r=w(5);l(),m("matMenuTriggerFor",r),l(5),m("routerLink",D(3,Qe,o._id)),l(5),E(o.status==="in_progress"?11:-1)}}function wt(e,n){e&1&&S(0,"tr",42)}function bt(e,n){e&1&&S(0,"tr",43)}function Rt(e,n){if(e&1){let o=V();i(0,"mat-paginator",57),h("page",function(c){u(o);let d=C();return _(d.onPageChange(c))}),t()}if(e&2){let o=n;m("length",o.total)("pageSize",o.limit)("pageIndex",o.page-1)("pageSizeOptions",L(4,Ze))}}var Ke=class e{constructor(n){this.reconciliationService=n}storeStore=O(Se);router=O(U);selectedStore=N(()=>this.storeStore.selectedStore());currency=N(()=>this.selectedStore()?.currency||"NGN");displayedColumns=["name","status","actions"];filters={page:1,limit:25,status:"",type:"",dateFrom:null,dateTo:null};reconciliations=A({params:()=>({storeId:this.storeStore.selectedStore()?._id,page:this.filters.page,limit:this.filters.limit,status:this.filters.status,type:this.filters.type,dateFrom:this.filters.dateFrom?this.filters.dateFrom.toISOString().split("T")[0]:void 0,dateTo:this.filters.dateTo?this.filters.dateTo.toISOString().split("T")[0]:void 0}),stream:({params:n})=>{if(!n.storeId)return new k(r=>{r.next({data:[],pagination:{}}),r.complete()});let o=Object.fromEntries(Object.entries(n).filter(([r,c])=>c!==void 0&&c!==""));return this.reconciliationService.findAll(o)}});stats=A({params:()=>({storeId:this.storeStore.selectedStore()?._id}),stream:({params:n})=>n.storeId?this.reconciliationService.getStats():new k(o=>{o.next({}),o.complete()})});ngOnInit(){}onFilterChange(){this.reconciliations.reload()}onPageChange(n){this.filters.page=n.pageIndex+1,this.filters.limit=n.pageSize,this.reconciliations.reload()}getProgressPercentage(n){return n.totalProducts===0?0:n.countedProducts/n.totalProducts*100}getStatusClass(n){switch(n){case"completed":return"bg-green-100 text-green-800";case"in_progress":return"bg-blue-100 text-blue-800";case"cancelled":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}}getStatusLabel(n){switch(n){case"in_progress":return"In Progress";case"completed":return"Completed";case"cancelled":return"Cancelled";default:return n}}getTypeClass(n){switch(n){case"full_inventory":return"bg-purple-100 text-purple-800";case"partial":return"bg-orange-100 text-orange-800";case"cycle_count":return"bg-indigo-100 text-indigo-800";default:return"bg-gray-100 text-gray-800"}}getTypeLabel(n){switch(n){case"full_inventory":return"Full Inventory";case"partial":return"Partial";case"cycle_count":return"Cycle Count";default:return n}}deleteReconciliation(n){confirm("Are you sure you want to delete this reconciliation? This action cannot be undone.")&&this.reconciliationService.delete(n).subscribe(()=>{this.reconciliations.reload()})}static \u0275fac=function(o){return new(o||e)(j(qe))};static \u0275cmp=$({type:e,selectors:[["app-list-reconciliation"]],decls:91,vars:20,consts:[["fromPicker",""],["toPicker",""],["menu","matMenu"],[1,"p-6","max-w-7xl","mx-auto"],[1,"text-3xl","font-bold","text-gray-900","mb-6"],[1,"flex","justify-end","mb-6"],["mat-raised-button","","color","primary",3,"routerLink"],[1,"overflow-x-auto"],["mat-table","",1,"w-full",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","","class","py-3",4,"matCellDef"],["matColumnDef","status"],["matColumnDef","actions"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],[1,"grid","grid-cols-1","md:grid-cols-4","gap-6","mb-6"],[1,"mb-6"],[1,"p-4"],[1,"grid","grid-cols-1","md:grid-cols-4","gap-4"],["appearance","outline"],[3,"valueChange","selectionChange","value"],["value",""],["value","in_progress"],["value","completed"],["value","cancelled"],["value","full_inventory"],["value","partial"],["value","cycle_count"],["matInput","",3,"ngModelChange","dateChange","matDatepicker","ngModel"],["matIconSuffix","",3,"for"],["matColumnDef","date"],["matColumnDef","type"],["matColumnDef","progress"],["matColumnDef","discrepancies"],[3,"length","pageSize","pageIndex","pageSizeOptions"],["mat-header-cell",""],["mat-cell","",1,"py-3"],[1,"font-medium"],[1,"text-sm","text-gray-500"],["mat-icon-button","",3,"matMenuTriggerFor"],["mat-menu-item","",3,"routerLink"],["mat-header-row",""],["mat-row",""],[1,"flex","items-center","justify-between"],[1,"text-sm","text-gray-600"],[1,"text-2xl","font-bold","text-gray-900"],[1,"text-blue-500"],[1,"text-2xl","font-bold","text-green-600"],[1,"text-green-500"],[1,"text-2xl","font-bold"],[1,"text-orange-500"],[1,"text-purple-500"],[1,"text-sm"],[1,"w-full","bg-gray-200","rounded-full","h-2","mt-1"],[1,"bg-blue-500","h-2","rounded-full"],["mat-menu-item","",1,"text-red-600",3,"click"],[3,"page","length","pageSize","pageIndex","pageSizeOptions"]],template:function(o,r){if(o&1){let c=V();i(0,"div",3)(1,"h1",4),a(2,"Inventory Reconciliation"),t(),i(3,"div",5)(4,"button",6)(5,"mat-icon"),a(6,"add_circle"),t(),a(7," Start Reconciliation "),t()(),i(8,"mat-card")(9,"div",7)(10,"table",8),f(11,9),p(12,et,2,0,"th",10)(13,tt,5,2,"td",11),g(),f(14,12),p(15,it,2,0,"th",10)(16,nt,4,3,"td",11),g(),f(17,13),p(18,at,2,0,"th",10)(19,ot,11,4,"td",11),g(),p(20,rt,1,0,"tr",14)(21,lt,1,0,"tr",15),t()()()(),M(22,mt,39,18,"div",16),i(23,"mat-card",17)(24,"mat-card-content",18)(25,"div",19)(26,"mat-form-field",20)(27,"mat-label"),a(28,"Status"),t(),i(29,"mat-select",21),T("valueChange",function(s){return u(c),R(r.filters.status,s)||(r.filters.status=s),_(s)}),h("selectionChange",function(){return u(c),_(r.onFilterChange())}),i(30,"mat-option",22),a(31,"All Statuses"),t(),i(32,"mat-option",23),a(33,"In Progress"),t(),i(34,"mat-option",24),a(35,"Completed"),t(),i(36,"mat-option",25),a(37,"Cancelled"),t()()(),i(38,"mat-form-field",20)(39,"mat-label"),a(40,"Type"),t(),i(41,"mat-select",21),T("valueChange",function(s){return u(c),R(r.filters.type,s)||(r.filters.type=s),_(s)}),h("selectionChange",function(){return u(c),_(r.onFilterChange())}),i(42,"mat-option",22),a(43,"All Types"),t(),i(44,"mat-option",26),a(45,"Full Inventory"),t(),i(46,"mat-option",27),a(47,"Partial"),t(),i(48,"mat-option",28),a(49,"Cycle Count"),t()()(),i(50,"mat-form-field",20)(51,"mat-label"),a(52,"From Date"),t(),i(53,"input",29),T("ngModelChange",function(s){return u(c),R(r.filters.dateFrom,s)||(r.filters.dateFrom=s),_(s)}),h("dateChange",function(){return u(c),_(r.onFilterChange())}),t(),S(54,"mat-datepicker-toggle",30)(55,"mat-datepicker",null,0),t(),i(57,"mat-form-field",20)(58,"mat-label"),a(59,"To Date"),t(),i(60,"input",29),T("ngModelChange",function(s){return u(c),R(r.filters.dateTo,s)||(r.filters.dateTo=s),_(s)}),h("dateChange",function(){return u(c),_(r.onFilterChange())}),t(),S(61,"mat-datepicker-toggle",30)(62,"mat-datepicker",null,1),t()()()(),i(64,"mat-card")(65,"div",7)(66,"table",8),f(67,9),p(68,ct,2,0,"th",10)(69,st,6,2,"td",11),g(),f(70,31),p(71,dt,2,0,"th",10)(72,ut,7,5,"td",11),g(),f(73,32),p(74,_t,2,0,"th",10)(75,ft,4,3,"td",11),g(),f(76,33),p(77,gt,2,0,"th",10)(78,Ct,6,4,"td",11),g(),f(79,34),p(80,xt,2,0,"th",10)(81,St,7,11,"td",11),g(),f(82,12),p(83,vt,2,0,"th",10)(84,ht,4,3,"td",11),g(),f(85,13),p(86,yt,2,0,"th",10)(87,Et,17,5,"td",11),g(),p(88,wt,1,0,"tr",14)(89,bt,1,0,"tr",15),t()(),M(90,Rt,1,5,"mat-paginator",35),t()}if(o&2){let c,d,s,I,z=w(56),H=w(63);l(4),m("routerLink",L(17,Ue)),l(6),m("dataSource",((c=r.reconciliations.value())==null?null:c.data)||L(18,Je)),l(10),m("matHeaderRowDef",r.displayedColumns),l(),m("matRowDefColumns",r.displayedColumns),l(),E((d=r.stats.value())?22:-1,d),l(7),b("value",r.filters.status),l(12),b("value",r.filters.type),l(12),m("matDatepicker",z),b("ngModel",r.filters.dateFrom),l(),m("for",z),l(6),m("matDatepicker",H),b("ngModel",r.filters.dateTo),l(),m("for",H),l(5),m("dataSource",((s=r.reconciliations.value())==null?null:s.data)||L(19,Je)),l(22),m("matHeaderRowDef",r.displayedColumns),l(),m("matRowDefColumns",r.displayedColumns),l(),E((I=(I=r.reconciliations.value())==null?null:I.pagination)?90:-1,I)}},dependencies:[Q,Be,Re,Le,Pe,De,Te,Fe,Ie,Ve,ke,Oe,ne,ie,te,xe,Ce,se,me,ce,Me,he,ve,ye,_e,ue,de,pe,ge,fe,je,He,Z,ze,We,Ne,Ae,ee,Ge,$e,be,Ee,we,Y,X,le,ae,oe,re,K,J],styles:[".mat-mdc-table[_ngcontent-%COMP%]{width:100%}.mat-mdc-chip-set[_ngcontent-%COMP%]{margin:0}.mat-mdc-chip[_ngcontent-%COMP%]{font-size:.75rem;height:auto;padding:4px 8px}"]})};export{Ke as ListReconciliationComponent};
