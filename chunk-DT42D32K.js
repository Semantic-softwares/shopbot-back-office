import{a as Ci}from"./chunk-VWN5Z5VW.js";import{a as bi,b as $e,c as Le}from"./chunk-LGPIYUHR.js";import{a as ue}from"./chunk-MCKQEPBX.js";import{a as hi}from"./chunk-RUZ72OGJ.js";import{a as xi,b as fi}from"./chunk-4OM7C35U.js";import{g as pi}from"./chunk-FOV4ZUKD.js";import{a as ui,b as gi,c as vi,h as _i}from"./chunk-YS6HWZ4Z.js";import"./chunk-MS4AQ6UA.js";import{k as mi}from"./chunk-LGKRDPY2.js";import{a as je,b as ke}from"./chunk-5W5E6AGV.js";import"./chunk-3RK6DDJD.js";import{a as qe,b as De}from"./chunk-57GZGP3R.js";import{a as Qt}from"./chunk-3U7JJIOR.js";import"./chunk-NPTLLH2W.js";import{a as Gt}from"./chunk-JQGESV5S.js";import"./chunk-IX32NZKS.js";import{d as Be,g as Wt}from"./chunk-FNFXBZOZ.js";import{b as $,c as le,d as de}from"./chunk-AQ3KQLE6.js";import{a as _e}from"./chunk-4WFQ5GOX.js";import"./chunk-F5X5MWHG.js";import{c as ci}from"./chunk-KNNK3RCH.js";import{a as me,b as pe,c as di,d as Ee,e as Se,f as Re,g as H}from"./chunk-DGYQUDOC.js";import{a as ye,b as ce}from"./chunk-WVHZJWJP.js";import{a as si,b as li}from"./chunk-KLIJEHXY.js";import{a as ii}from"./chunk-ETOXAU7Y.js";import{a as ni,c as oi,d as ai,e as ri}from"./chunk-OTA24DIU.js";import"./chunk-5LES5XKI.js";import{a as re,b as Ve,c as be,d as Ue,e as Ge,h as se}from"./chunk-QMUPRLKR.js";import{B as oe,C as Jt,D as ae,a as Kt,b as J,d as M,g as X,h as ee,m as te,n as xe,p as ie,q as Yt,s as ne,w as Ne,x as fe}from"./chunk-CXVWFC6J.js";import"./chunk-JTLCVARK.js";import{a as Xt,c as ei,g as he}from"./chunk-UOL4Y3DN.js";import{a as L,b as z}from"./chunk-MCIFQNRK.js";import"./chunk-OHZSVTBE.js";import{a as Ce}from"./chunk-P7SQXTVL.js";import"./chunk-IKGBOHBU.js";import"./chunk-SIHSJGX2.js";import{H as mt,I as Lt,T as zt,U as Ht,W as Zt,X as Y,Y as q,e as jt,n as qt,p as $t,y as ct}from"./chunk-BPRDVRQX.js";import{a as ti}from"./chunk-KP7TGH7C.js";import"./chunk-M2YK6UF7.js";import"./chunk-AGZJ637K.js";import{a as Vt,c as Ut}from"./chunk-WTFDJO4H.js";import"./chunk-TQDHD3WD.js";import{g as Tt,i as Ft,j as At,k as Bt,o as Ae,p as Nt,s as K,t as j}from"./chunk-DWCYWQVU.js";import{$ as _t,$b as Fe,$c as Q,Bb as ot,Cc as f,Db as u,Dc as V,Ea as it,Eb as g,Ec as R,Fb as ve,Fc as A,Hb as U,Ib as G,Jb as v,Kb as o,Lb as n,Mb as k,Mc as I,Qb as w,Qc as Ot,Ub as C,Vb as c,Wb as kt,Xb as Dt,Xc as lt,Yb as Pt,Zb as at,_a as s,_b as Te,a as vt,ad as dt,ba as xt,cb as bt,da as tt,db as Ct,dc as Z,ec as Pe,fa as b,fc as T,hc as W,ic as a,jc as m,kb as B,kc as _,la as y,lb as yt,lc as N,ma as E,mb as Et,na as ft,pa as ht,qb as F,qc as wt,rc as Mt,sb as nt,sc as rt,tb as St,ub as Rt,va as P,vc as It,zc as st}from"./chunk-5AECHVKR.js";import{a as Ie,b as Oe,f as S}from"./chunk-EQDQRRRY.js";function wi(r,t){r&1&&a(0," Should equal the full extension cost ")}function Mi(r,t){r&1&&a(0," Enter the amount paid so far ")}function Ii(r,t){r&1&&a(0," Enter 0 for pending payment ")}function Oi(r,t){r&1&&(o(0,"mat-icon",31),a(1,"refresh"),n())}var ze=class r{dialogRef=b(me);fb=b(oe);data=b(pe);submitting=P(!1);paymentForm=this.fb.group({paymentStatus:["paid",[M.required]],paymentMethod:["",[M.required]],paymentAmount:[0,[M.required,M.min(0)]],transactionReference:[""],notes:[""]});ngOnInit(){this.paymentForm.patchValue({paymentAmount:this.data.extensionCost}),this.paymentForm.get("paymentStatus")?.valueChanges.subscribe(t=>{let e=this.paymentForm.get("paymentAmount");t==="paid"?(e?.setValue(this.data.extensionCost),e?.setValidators([M.required,M.min(this.data.extensionCost)])):t==="pending"?(e?.setValue(0),e?.setValidators([M.required,M.min(0),M.max(0)])):e?.setValidators([M.required,M.min(.01),M.max(this.data.extensionCost-.01)]),e?.updateValueAndValidity()})}onSubmit(){if(this.paymentForm.valid){this.submitting.set(!0);let t={paymentStatus:this.paymentForm.value.paymentStatus,paymentMethod:this.paymentForm.value.paymentMethod,paymentAmount:this.paymentForm.value.paymentAmount,transactionReference:this.paymentForm.value.transactionReference||void 0,notes:this.paymentForm.value.notes||void 0};this.dialogRef.close(t)}}onCancel(){this.dialogRef.close(null)}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=B({type:r,selectors:[["app-extension-payment-dialog"]],decls:81,vars:11,consts:[[1,"max-w-md"],[1,"flex","items-center","gap-3","p-6","border-b","border-gray-200"],[1,"text-green-600"],[1,"text-xl","font-semibold","text-gray-900"],[1,"text-sm","text-gray-600"],[1,"p-6","space-y-4",3,"ngSubmit","formGroup"],[1,"bg-gray-50","rounded-lg","p-4","space-y-2"],[1,"font-medium","text-gray-900"],[1,"grid","grid-cols-2","gap-4","text-sm"],[1,"text-gray-600"],[1,"font-medium","ml-2"],["appearance","outline",1,"w-full"],["formControlName","paymentStatus"],["value","paid"],["value","partial"],["value","pending"],["formControlName","paymentMethod"],["value","cash"],["value","credit_card"],["value","debit_card"],["value","bank_transfer"],["value","mobile_payment"],["value","check"],["value","other"],["matInput","","type","number","step","0.01","min","0","formControlName","paymentAmount","placeholder","0.00",3,"max"],["matSuffix",""],["matInput","","formControlName","transactionReference","placeholder","Optional transaction ID or reference"],["matInput","","rows","3","formControlName","notes","placeholder","Optional notes about the payment..."],[1,"flex","justify-end","gap-3","pt-4","border-t","border-gray-200"],["type","button","mat-button","",1,"px-6",3,"click"],["type","submit","mat-flat-button","","color","primary",1,"px-6",3,"disabled"],[1,"animate-spin","mr-2"]],template:function(e,i){if(e&1&&(o(0,"div",0)(1,"div",1)(2,"mat-icon",2),a(3,"payment"),n(),o(4,"div")(5,"h2",3),a(6,"Extension Payment"),n(),o(7,"p",4),a(8,"Update payment information for extension approval"),n()()(),o(9,"form",5),C("ngSubmit",function(){return i.onSubmit()}),o(10,"div",6)(11,"h3",7),a(12,"Extension Details"),n(),o(13,"div",8)(14,"div")(15,"span",9),a(16,"Additional Nights:"),n(),o(17,"span",10),a(18),n()(),o(19,"div")(20,"span",9),a(21,"Extension Cost:"),n(),o(22,"span",10),a(23),f(24,"currency"),n()()()(),o(25,"mat-form-field",11)(26,"mat-label"),a(27,"Payment Status"),n(),o(28,"mat-select",12)(29,"mat-option",13),a(30,"Paid (Full Amount)"),n(),o(31,"mat-option",14),a(32,"Partial Payment"),n(),o(33,"mat-option",15),a(34,"Pending Payment"),n()(),o(35,"mat-hint"),a(36,"Select the current payment status for this extension"),n()(),o(37,"mat-form-field",11)(38,"mat-label"),a(39,"Payment Method"),n(),o(40,"mat-select",16)(41,"mat-option",17),a(42,"Cash"),n(),o(43,"mat-option",18),a(44,"Credit Card"),n(),o(45,"mat-option",19),a(46,"Debit Card"),n(),o(47,"mat-option",20),a(48,"Bank Transfer"),n(),o(49,"mat-option",21),a(50,"Mobile Payment"),n(),o(51,"mat-option",22),a(52,"Check"),n(),o(53,"mat-option",23),a(54,"Other"),n()()(),o(55,"mat-form-field",11)(56,"mat-label"),a(57,"Payment Amount"),n(),k(58,"input",24),o(59,"span",25),a(60),n(),o(61,"mat-hint"),u(62,wi,1,0)(63,Mi,1,0)(64,Ii,1,0),n()(),o(65,"mat-form-field",11)(66,"mat-label"),a(67,"Transaction Reference"),n(),k(68,"input",26),o(69,"mat-hint"),a(70,"Payment confirmation number, receipt ID, etc."),n()(),o(71,"mat-form-field",11)(72,"mat-label"),a(73,"Payment Notes"),n(),k(74,"textarea",27),n(),o(75,"div",28)(76,"button",29),C("click",function(){return i.onCancel()}),a(77," Cancel "),n(),o(78,"button",30),u(79,Oi,2,0,"mat-icon",31),a(80," Approve Extension "),n()()()()),e&2){let l;s(9),v("formGroup",i.paymentForm),s(9),m(i.data.additionalNights),s(5),m(R(24,8,i.data.extensionCost,i.data.currency)),s(35),v("max",i.data.extensionCost),s(2),m(i.data.currency),s(2),g(((l=i.paymentForm.get("paymentStatus"))==null?null:l.value)==="paid"?62:((l=i.paymentForm.get("paymentStatus"))==null?null:l.value)==="partial"?63:64),s(16),v("disabled",i.paymentForm.invalid||i.submitting()),s(),g(i.submitting()?79:-1)}},dependencies:[j,K,ae,te,J,xe,X,ee,fe,Ne,ie,ne,H,$,se,re,be,Ge,de,le,ke,je,Be,q,Y,z,L],encapsulation:2})};var Ti=["input"],Fi=["formField"],Ai=["*"],Ke=class{source;value;constructor(t,e){this.source=t,this.value=e}},Bi={provide:Kt,useExisting:_t(()=>gt),multi:!0},yi=new tt("MatRadioGroup"),Ni=new tt("mat-radio-default-options",{providedIn:"root",factory:Vi});function Vi(){return{color:"accent",disabledInteractive:!1}}var gt=(()=>{class r{_changeDetector=b(lt);_value=null;_name=b(ct).getId("mat-radio-group-");_selected=null;_isInitialized=!1;_labelPosition="after";_disabled=!1;_required=!1;_buttonChanges;_controlValueAccessorChangeFn=()=>{};onTouched=()=>{};change=new nt;_radios;color;get name(){return this._name}set name(e){this._name=e,this._updateRadioButtonNames()}get labelPosition(){return this._labelPosition}set labelPosition(e){this._labelPosition=e==="before"?"before":"after",this._markRadiosForCheck()}get value(){return this._value}set value(e){this._value!==e&&(this._value=e,this._updateSelectedRadioFromValue(),this._checkSelectedRadioButton())}_checkSelectedRadioButton(){this._selected&&!this._selected.checked&&(this._selected.checked=!0)}get selected(){return this._selected}set selected(e){this._selected=e,this.value=e?e.value:null,this._checkSelectedRadioButton()}get disabled(){return this._disabled}set disabled(e){this._disabled=e,this._markRadiosForCheck()}get required(){return this._required}set required(e){this._required=e,this._markRadiosForCheck()}get disabledInteractive(){return this._disabledInteractive}set disabledInteractive(e){this._disabledInteractive=e,this._markRadiosForCheck()}_disabledInteractive=!1;constructor(){}ngAfterContentInit(){this._isInitialized=!0,this._buttonChanges=this._radios.changes.subscribe(()=>{this.selected&&!this._radios.find(e=>e===this.selected)&&(this._selected=null)})}ngOnDestroy(){this._buttonChanges?.unsubscribe()}_touch(){this.onTouched&&this.onTouched()}_updateRadioButtonNames(){this._radios&&this._radios.forEach(e=>{e.name=this.name,e._markForCheck()})}_updateSelectedRadioFromValue(){let e=this._selected!==null&&this._selected.value===this._value;this._radios&&!e&&(this._selected=null,this._radios.forEach(i=>{i.checked=this.value===i.value,i.checked&&(this._selected=i)}))}_emitChangeEvent(){this._isInitialized&&this.change.emit(new Ke(this._selected,this._value))}_markRadiosForCheck(){this._radios&&this._radios.forEach(e=>e._markForCheck())}writeValue(e){this.value=e,this._changeDetector.markForCheck()}registerOnChange(e){this._controlValueAccessorChangeFn=e}registerOnTouched(e){this.onTouched=e}setDisabledState(e){this.disabled=e,this._changeDetector.markForCheck()}static \u0275fac=function(i){return new(i||r)};static \u0275dir=Et({type:r,selectors:[["mat-radio-group"]],contentQueries:function(i,l,d){if(i&1&&Pt(d,Ye,5),i&2){let p;Te(p=Fe())&&(l._radios=p)}},hostAttrs:["role","radiogroup",1,"mat-mdc-radio-group"],inputs:{color:"color",name:"name",labelPosition:"labelPosition",value:"value",selected:"selected",disabled:[2,"disabled","disabled",Q],required:[2,"required","required",Q],disabledInteractive:[2,"disabledInteractive","disabledInteractive",Q]},outputs:{change:"change"},exportAs:["matRadioGroup"],features:[It([Bi,{provide:yi,useExisting:r}])]})}return r})(),Ye=(()=>{class r{_elementRef=b(it);_changeDetector=b(lt);_focusMonitor=b(qt);_radioDispatcher=b(ii);_defaultOptions=b(Ni,{optional:!0});_ngZone=b(St);_renderer=b(bt);_uniqueId=b(ct).getId("mat-radio-");_cleanupClick;id=this._uniqueId;name;ariaLabel;ariaLabelledby;ariaDescribedby;disableRipple=!1;tabIndex=0;get checked(){return this._checked}set checked(e){this._checked!==e&&(this._checked=e,e&&this.radioGroup&&this.radioGroup.value!==this.value?this.radioGroup.selected=this:!e&&this.radioGroup&&this.radioGroup.value===this.value&&(this.radioGroup.selected=null),e&&this._radioDispatcher.notify(this.id,this.name),this._changeDetector.markForCheck())}get value(){return this._value}set value(e){this._value!==e&&(this._value=e,this.radioGroup!==null&&(this.checked||(this.checked=this.radioGroup.value===e),this.checked&&(this.radioGroup.selected=this)))}get labelPosition(){return this._labelPosition||this.radioGroup&&this.radioGroup.labelPosition||"after"}set labelPosition(e){this._labelPosition=e}_labelPosition;get disabled(){return this._disabled||this.radioGroup!==null&&this.radioGroup.disabled}set disabled(e){this._setDisabled(e)}get required(){return this._required||this.radioGroup&&this.radioGroup.required}set required(e){e!==this._required&&this._changeDetector.markForCheck(),this._required=e}get color(){return this._color||this.radioGroup&&this.radioGroup.color||this._defaultOptions&&this._defaultOptions.color||"accent"}set color(e){this._color=e}_color;get disabledInteractive(){return this._disabledInteractive||this.radioGroup!==null&&this.radioGroup.disabledInteractive}set disabledInteractive(e){this._disabledInteractive=e}_disabledInteractive;change=new nt;radioGroup;get inputId(){return`${this.id||this._uniqueId}-input`}_checked=!1;_disabled;_required;_value=null;_removeUniqueSelectionListener=()=>{};_previousTabIndex;_inputElement;_rippleTrigger;_noopAnimations=jt();_injector=b(ht);constructor(){b($t).load(Lt);let e=b(yi,{optional:!0}),i=b(new Ot("tabindex"),{optional:!0});this.radioGroup=e,this._disabledInteractive=this._defaultOptions?.disabledInteractive??!1,i&&(this.tabIndex=dt(i,0))}focus(e,i){i?this._focusMonitor.focusVia(this._inputElement,i,e):this._inputElement.nativeElement.focus(e)}_markForCheck(){this._changeDetector.markForCheck()}ngOnInit(){this.radioGroup&&(this.checked=this.radioGroup.value===this._value,this.checked&&(this.radioGroup.selected=this),this.name=this.radioGroup.name),this._removeUniqueSelectionListener=this._radioDispatcher.listen((e,i)=>{e!==this.id&&i===this.name&&(this.checked=!1)})}ngDoCheck(){this._updateTabIndex()}ngAfterViewInit(){this._updateTabIndex(),this._focusMonitor.monitor(this._elementRef,!0).subscribe(e=>{!e&&this.radioGroup&&this.radioGroup._touch()}),this._ngZone.runOutsideAngular(()=>{this._cleanupClick=this._renderer.listen(this._inputElement.nativeElement,"click",this._onInputClick)})}ngOnDestroy(){this._cleanupClick?.(),this._focusMonitor.stopMonitoring(this._elementRef),this._removeUniqueSelectionListener()}_emitChangeEvent(){this.change.emit(new Ke(this,this._value))}_isRippleDisabled(){return this.disableRipple||this.disabled}_onInputInteraction(e){if(e.stopPropagation(),!this.checked&&!this.disabled){let i=this.radioGroup&&this.value!==this.radioGroup.value;this.checked=!0,this._emitChangeEvent(),this.radioGroup&&(this.radioGroup._controlValueAccessorChangeFn(this.value),i&&this.radioGroup._emitChangeEvent())}}_onTouchTargetClick(e){this._onInputInteraction(e),(!this.disabled||this.disabledInteractive)&&this._inputElement?.nativeElement.focus()}_setDisabled(e){this._disabled!==e&&(this._disabled=e,this._changeDetector.markForCheck())}_onInputClick=e=>{this.disabled&&this.disabledInteractive&&e.preventDefault()};_updateTabIndex(){let e=this.radioGroup,i;if(!e||!e.selected||this.disabled?i=this.tabIndex:i=e.selected===this?this.tabIndex:-1,i!==this._previousTabIndex){let l=this._inputElement?.nativeElement;l&&(l.setAttribute("tabindex",i+""),this._previousTabIndex=i,Rt(()=>{queueMicrotask(()=>{e&&e.selected&&e.selected!==this&&document.activeElement===l&&(e.selected?._inputElement.nativeElement.focus(),document.activeElement===l&&this._inputElement.nativeElement.blur())})},{injector:this._injector}))}}static \u0275fac=function(i){return new(i||r)};static \u0275cmp=B({type:r,selectors:[["mat-radio-button"]],viewQuery:function(i,l){if(i&1&&(at(Ti,5),at(Fi,7,it)),i&2){let d;Te(d=Fe())&&(l._inputElement=d.first),Te(d=Fe())&&(l._rippleTrigger=d.first)}},hostAttrs:[1,"mat-mdc-radio-button"],hostVars:19,hostBindings:function(i,l){i&1&&C("focus",function(){return l._inputElement.nativeElement.focus()}),i&2&&(ot("id",l.id)("tabindex",null)("aria-label",null)("aria-labelledby",null)("aria-describedby",null),T("mat-primary",l.color==="primary")("mat-accent",l.color==="accent")("mat-warn",l.color==="warn")("mat-mdc-radio-checked",l.checked)("mat-mdc-radio-disabled",l.disabled)("mat-mdc-radio-disabled-interactive",l.disabledInteractive)("_mat-animation-noopable",l._noopAnimations))},inputs:{id:"id",name:"name",ariaLabel:[0,"aria-label","ariaLabel"],ariaLabelledby:[0,"aria-labelledby","ariaLabelledby"],ariaDescribedby:[0,"aria-describedby","ariaDescribedby"],disableRipple:[2,"disableRipple","disableRipple",Q],tabIndex:[2,"tabIndex","tabIndex",e=>e==null?0:dt(e)],checked:[2,"checked","checked",Q],value:"value",labelPosition:"labelPosition",disabled:[2,"disabled","disabled",Q],required:[2,"required","required",Q],color:"color",disabledInteractive:[2,"disabledInteractive","disabledInteractive",Q]},outputs:{change:"change"},exportAs:["matRadioButton"],ngContentSelectors:Ai,decls:13,vars:17,consts:[["formField",""],["input",""],["mat-internal-form-field","",3,"labelPosition"],[1,"mdc-radio"],[1,"mat-mdc-radio-touch-target",3,"click"],["type","radio","aria-invalid","false",1,"mdc-radio__native-control",3,"change","id","checked","disabled","required"],[1,"mdc-radio__background"],[1,"mdc-radio__outer-circle"],[1,"mdc-radio__inner-circle"],["mat-ripple","",1,"mat-radio-ripple","mat-focus-indicator",3,"matRippleTrigger","matRippleDisabled","matRippleCentered"],[1,"mat-ripple-element","mat-radio-persistent-ripple"],[1,"mdc-label",3,"for"]],template:function(i,l){if(i&1){let d=w();kt(),o(0,"div",2,0)(2,"div",3)(3,"div",4),C("click",function(h){return y(d),E(l._onTouchTargetClick(h))}),n(),o(4,"input",5,1),C("change",function(h){return y(d),E(l._onInputInteraction(h))}),n(),o(6,"div",6),k(7,"div",7)(8,"div",8),n(),o(9,"div",9),k(10,"div",10),n()(),o(11,"label",11),Dt(12),n()()}i&2&&(v("labelPosition",l.labelPosition),s(2),T("mdc-radio--disabled",l.disabled),s(2),v("id",l.inputId)("checked",l.checked)("disabled",l.disabled&&!l.disabledInteractive)("required",l.required),ot("name",l.name)("value",l.value)("aria-label",l.ariaLabel)("aria-labelledby",l.ariaLabelledby)("aria-describedby",l.ariaDescribedby)("aria-disabled",l.disabled&&l.disabledInteractive?"true":null),s(5),v("matRippleTrigger",l._rippleTrigger.nativeElement)("matRippleDisabled",l._isRippleDisabled())("matRippleCentered",!0),s(2),v("for",l.inputId))},dependencies:[zt,Gt],styles:[`.mat-mdc-radio-button{-webkit-tap-highlight-color:rgba(0,0,0,0)}.mat-mdc-radio-button .mdc-radio{display:inline-block;position:relative;flex:0 0 auto;box-sizing:content-box;width:20px;height:20px;cursor:pointer;will-change:opacity,transform,border-color,color;padding:calc((var(--mat-radio-state-layer-size, 40px) - 20px)/2)}.mat-mdc-radio-button .mdc-radio:hover>.mdc-radio__native-control:not([disabled]):not(:focus)~.mdc-radio__background::before{opacity:.04;transform:scale(1)}.mat-mdc-radio-button .mdc-radio:hover>.mdc-radio__native-control:not([disabled])~.mdc-radio__background>.mdc-radio__outer-circle{border-color:var(--mat-radio-unselected-hover-icon-color, var(--mat-sys-on-surface))}.mat-mdc-radio-button .mdc-radio:hover>.mdc-radio__native-control:enabled:checked+.mdc-radio__background>.mdc-radio__outer-circle,.mat-mdc-radio-button .mdc-radio:hover>.mdc-radio__native-control:enabled:checked+.mdc-radio__background>.mdc-radio__inner-circle{border-color:var(--mat-radio-selected-hover-icon-color, var(--mat-sys-primary))}.mat-mdc-radio-button .mdc-radio:active>.mdc-radio__native-control:enabled:not(:checked)+.mdc-radio__background>.mdc-radio__outer-circle{border-color:var(--mat-radio-unselected-pressed-icon-color, var(--mat-sys-on-surface))}.mat-mdc-radio-button .mdc-radio:active>.mdc-radio__native-control:enabled:checked+.mdc-radio__background>.mdc-radio__outer-circle,.mat-mdc-radio-button .mdc-radio:active>.mdc-radio__native-control:enabled:checked+.mdc-radio__background>.mdc-radio__inner-circle{border-color:var(--mat-radio-selected-pressed-icon-color, var(--mat-sys-primary))}.mat-mdc-radio-button .mdc-radio__background{display:inline-block;position:relative;box-sizing:border-box;width:20px;height:20px}.mat-mdc-radio-button .mdc-radio__background::before{position:absolute;transform:scale(0, 0);border-radius:50%;opacity:0;pointer-events:none;content:"";transition:opacity 90ms cubic-bezier(0.4, 0, 0.6, 1),transform 90ms cubic-bezier(0.4, 0, 0.6, 1);width:var(--mat-radio-state-layer-size, 40px);height:var(--mat-radio-state-layer-size, 40px);top:calc(-1*(var(--mat-radio-state-layer-size, 40px) - 20px)/2);left:calc(-1*(var(--mat-radio-state-layer-size, 40px) - 20px)/2)}.mat-mdc-radio-button .mdc-radio__outer-circle{position:absolute;top:0;left:0;box-sizing:border-box;width:100%;height:100%;border-width:2px;border-style:solid;border-radius:50%;transition:border-color 90ms cubic-bezier(0.4, 0, 0.6, 1)}.mat-mdc-radio-button .mdc-radio__inner-circle{position:absolute;top:0;left:0;box-sizing:border-box;width:100%;height:100%;transform:scale(0, 0);border-width:10px;border-style:solid;border-radius:50%;transition:transform 90ms cubic-bezier(0.4, 0, 0.6, 1),border-color 90ms cubic-bezier(0.4, 0, 0.6, 1)}.mat-mdc-radio-button .mdc-radio__native-control{position:absolute;margin:0;padding:0;opacity:0;top:0;right:0;left:0;cursor:inherit;z-index:1;width:var(--mat-radio-state-layer-size, 40px);height:var(--mat-radio-state-layer-size, 40px)}.mat-mdc-radio-button .mdc-radio__native-control:checked+.mdc-radio__background,.mat-mdc-radio-button .mdc-radio__native-control:disabled+.mdc-radio__background{transition:opacity 90ms cubic-bezier(0, 0, 0.2, 1),transform 90ms cubic-bezier(0, 0, 0.2, 1)}.mat-mdc-radio-button .mdc-radio__native-control:checked+.mdc-radio__background>.mdc-radio__outer-circle,.mat-mdc-radio-button .mdc-radio__native-control:disabled+.mdc-radio__background>.mdc-radio__outer-circle{transition:border-color 90ms cubic-bezier(0, 0, 0.2, 1)}.mat-mdc-radio-button .mdc-radio__native-control:checked+.mdc-radio__background>.mdc-radio__inner-circle,.mat-mdc-radio-button .mdc-radio__native-control:disabled+.mdc-radio__background>.mdc-radio__inner-circle{transition:transform 90ms cubic-bezier(0, 0, 0.2, 1),border-color 90ms cubic-bezier(0, 0, 0.2, 1)}.mat-mdc-radio-button .mdc-radio__native-control:focus+.mdc-radio__background::before{transform:scale(1);opacity:.12;transition:opacity 90ms cubic-bezier(0, 0, 0.2, 1),transform 90ms cubic-bezier(0, 0, 0.2, 1)}.mat-mdc-radio-button .mdc-radio__native-control:disabled:not(:checked)+.mdc-radio__background>.mdc-radio__outer-circle{border-color:var(--mat-radio-disabled-unselected-icon-color, var(--mat-sys-on-surface));opacity:var(--mat-radio-disabled-unselected-icon-opacity, 0.38)}.mat-mdc-radio-button .mdc-radio__native-control:disabled+.mdc-radio__background{cursor:default}.mat-mdc-radio-button .mdc-radio__native-control:disabled+.mdc-radio__background>.mdc-radio__inner-circle,.mat-mdc-radio-button .mdc-radio__native-control:disabled+.mdc-radio__background>.mdc-radio__outer-circle{border-color:var(--mat-radio-disabled-selected-icon-color, var(--mat-sys-on-surface));opacity:var(--mat-radio-disabled-selected-icon-opacity, 0.38)}.mat-mdc-radio-button .mdc-radio__native-control:enabled:not(:checked)+.mdc-radio__background>.mdc-radio__outer-circle{border-color:var(--mat-radio-unselected-icon-color, var(--mat-sys-on-surface-variant))}.mat-mdc-radio-button .mdc-radio__native-control:enabled:checked+.mdc-radio__background>.mdc-radio__outer-circle,.mat-mdc-radio-button .mdc-radio__native-control:enabled:checked+.mdc-radio__background>.mdc-radio__inner-circle{border-color:var(--mat-radio-selected-icon-color, var(--mat-sys-primary))}.mat-mdc-radio-button .mdc-radio__native-control:enabled:focus:checked+.mdc-radio__background>.mdc-radio__inner-circle,.mat-mdc-radio-button .mdc-radio__native-control:enabled:focus:checked+.mdc-radio__background>.mdc-radio__outer-circle{border-color:var(--mat-radio-selected-focus-icon-color, var(--mat-sys-primary))}.mat-mdc-radio-button .mdc-radio__native-control:checked+.mdc-radio__background>.mdc-radio__inner-circle{transform:scale(0.5);transition:transform 90ms cubic-bezier(0, 0, 0.2, 1),border-color 90ms cubic-bezier(0, 0, 0.2, 1)}.mat-mdc-radio-button.mat-mdc-radio-disabled-interactive .mdc-radio--disabled{pointer-events:auto}.mat-mdc-radio-button.mat-mdc-radio-disabled-interactive .mdc-radio--disabled .mdc-radio__native-control:not(:checked)+.mdc-radio__background>.mdc-radio__outer-circle{border-color:var(--mat-radio-disabled-unselected-icon-color, var(--mat-sys-on-surface));opacity:var(--mat-radio-disabled-unselected-icon-opacity, 0.38)}.mat-mdc-radio-button.mat-mdc-radio-disabled-interactive .mdc-radio--disabled:hover .mdc-radio__native-control:checked+.mdc-radio__background>.mdc-radio__inner-circle,.mat-mdc-radio-button.mat-mdc-radio-disabled-interactive .mdc-radio--disabled:hover .mdc-radio__native-control:checked+.mdc-radio__background>.mdc-radio__outer-circle,.mat-mdc-radio-button.mat-mdc-radio-disabled-interactive .mdc-radio--disabled .mdc-radio__native-control:checked:focus+.mdc-radio__background>.mdc-radio__inner-circle,.mat-mdc-radio-button.mat-mdc-radio-disabled-interactive .mdc-radio--disabled .mdc-radio__native-control:checked:focus+.mdc-radio__background>.mdc-radio__outer-circle,.mat-mdc-radio-button.mat-mdc-radio-disabled-interactive .mdc-radio--disabled .mdc-radio__native-control+.mdc-radio__background>.mdc-radio__inner-circle,.mat-mdc-radio-button.mat-mdc-radio-disabled-interactive .mdc-radio--disabled .mdc-radio__native-control+.mdc-radio__background>.mdc-radio__outer-circle{border-color:var(--mat-radio-disabled-selected-icon-color, var(--mat-sys-on-surface));opacity:var(--mat-radio-disabled-selected-icon-opacity, 0.38)}.mat-mdc-radio-button._mat-animation-noopable .mdc-radio__background::before,.mat-mdc-radio-button._mat-animation-noopable .mdc-radio__outer-circle,.mat-mdc-radio-button._mat-animation-noopable .mdc-radio__inner-circle{transition:none !important}.mat-mdc-radio-button .mdc-radio__background::before{background-color:var(--mat-radio-ripple-color, var(--mat-sys-on-surface))}.mat-mdc-radio-button.mat-mdc-radio-checked .mat-ripple-element,.mat-mdc-radio-button.mat-mdc-radio-checked .mdc-radio__background::before{background-color:var(--mat-radio-checked-ripple-color, var(--mat-sys-primary))}.mat-mdc-radio-button.mat-mdc-radio-disabled-interactive .mdc-radio--disabled .mat-ripple-element,.mat-mdc-radio-button.mat-mdc-radio-disabled-interactive .mdc-radio--disabled .mdc-radio__background::before{background-color:var(--mat-radio-ripple-color, var(--mat-sys-on-surface))}.mat-mdc-radio-button .mat-internal-form-field{color:var(--mat-radio-label-text-color, var(--mat-sys-on-surface));font-family:var(--mat-radio-label-text-font, var(--mat-sys-body-medium-font));line-height:var(--mat-radio-label-text-line-height, var(--mat-sys-body-medium-line-height));font-size:var(--mat-radio-label-text-size, var(--mat-sys-body-medium-size));letter-spacing:var(--mat-radio-label-text-tracking, var(--mat-sys-body-medium-tracking));font-weight:var(--mat-radio-label-text-weight, var(--mat-sys-body-medium-weight))}.mat-mdc-radio-button .mdc-radio--disabled+label{color:var(--mat-radio-disabled-label-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent))}.mat-mdc-radio-button .mat-radio-ripple{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;border-radius:50%}.mat-mdc-radio-button .mat-radio-ripple>.mat-ripple-element{opacity:.14}.mat-mdc-radio-button .mat-radio-ripple::before{border-radius:50%}.mat-mdc-radio-button .mdc-radio>.mdc-radio__native-control:focus:enabled:not(:checked)~.mdc-radio__background>.mdc-radio__outer-circle{border-color:var(--mat-radio-unselected-focus-icon-color, var(--mat-sys-on-surface))}.mat-mdc-radio-button.cdk-focused .mat-focus-indicator::before{content:""}.mat-mdc-radio-disabled{cursor:default;pointer-events:none}.mat-mdc-radio-disabled.mat-mdc-radio-disabled-interactive{pointer-events:auto}.mat-mdc-radio-touch-target{position:absolute;top:50%;left:50%;height:48px;width:48px;transform:translate(-50%, -50%);display:var(--mat-radio-touch-target-display, block)}[dir=rtl] .mat-mdc-radio-touch-target{left:auto;right:50%;transform:translate(50%, -50%)}
`],encapsulation:2,changeDetection:0})}return r})(),Ei=(()=>{class r{static \u0275fac=function(i){return new(i||r)};static \u0275mod=yt({type:r});static \u0275inj=xt({imports:[mt,Ht,Ye,mt]})}return r})();function ji(r,t){r&1&&(o(0,"mat-error"),a(1," New check-out date is required "),n())}function qi(r,t){r&1&&(o(0,"div",30),k(1,"mat-spinner",31),o(2,"span",32),a(3,"Checking availability..."),n()())}function $i(r,t){if(r&1&&(o(0,"div",64)(1,"mat-icon",65),a(2,"savings"),n(),a(3),n()),r&2){let e=c(5);s(3),_(" Save ",e.formatCurrency(e.getDiscountAmount())," per night ")}}function Li(r,t){r&1&&(o(0,"mat-error"),a(1," Discounted rate is required "),n())}function zi(r,t){r&1&&(o(0,"mat-error"),a(1," Rate must be greater than 0 "),n())}function Hi(r,t){r&1&&(o(0,"mat-error"),a(1," Rate cannot be higher than the original rate "),n())}function Wi(r,t){if(r&1&&(o(0,"div",66)(1,"mat-form-field",15)(2,"mat-label"),a(3,"Discounted Rate per Night"),n(),k(4,"input",67),o(5,"span",68),a(6),n(),o(7,"mat-hint"),a(8),n(),F(9,Li,2,0,"mat-error",18)(10,zi,2,0,"mat-error",18)(11,Hi,2,0,"mat-error",18),n()()),r&2){let e,i,l,d,p,h=c(5);s(4),v("max",(e=h.availability())==null||e.pricingBreakdown==null?null:e.pricingBreakdown.originalRate),s(2),_("",((i=h.storeStore.selectedStore())==null?null:i.currency)||"$","\xA0"),s(2),_("Rate must be less than or equal to ",h.formatCurrency(((l=h.availability())==null||l.pricingBreakdown==null?null:l.pricingBreakdown.originalRate)||0)),s(),v("ngIf",(d=h.extensionForm.get("discountedRate"))==null?null:d.hasError("required")),s(),v("ngIf",(p=h.extensionForm.get("discountedRate"))==null?null:p.hasError("min")),s(),v("ngIf",!h.validateDiscountedRate())}}function Qi(r,t){if(r&1&&(o(0,"div",69),a(1),n()),r&2){let e,i=c(5);s(),_(" Total Savings: ",i.formatCurrency(i.getDiscountAmount()*(((e=i.availability())==null?null:e.extensionDays)||0))," ")}}function Zi(r,t){if(r&1&&(o(0,"div",41)(1,"div",42)(2,"label",14),a(3,"Choose Rate Option:"),n(),o(4,"div",43),a(5,"2 options available"),n()(),o(6,"mat-radio-group",44)(7,"div",45)(8,"mat-radio-button",46)(9,"div",47),a(10," ORIGINAL "),n(),o(11,"div",48)(12,"div",49)(13,"div",50),a(14,"Same Rate"),n(),o(15,"div",51),a(16,"Continue with the original room rate"),n()(),o(17,"div",52)(18,"div",53),a(19),n(),o(20,"div",43),a(21,"per night"),n()()()()(),o(22,"div",45)(23,"mat-radio-button",54)(24,"div",48)(25,"div",49)(26,"div",55),a(27,"Discounted Rate"),n(),o(28,"div",56),a(29,"Apply a custom discount to the original rate"),n(),F(30,$i,4,1,"div",57),n(),o(31,"div",52)(32,"div",58),a(33),n(),o(34,"div",43),a(35,"per night"),n()()()()()(),F(36,Wi,12,6,"div",59),o(37,"div",60)(38,"div",61)(39,"div")(40,"div",14),a(41,"Total Extension Cost"),n(),o(42,"div",43),a(43),n(),F(44,Qi,2,1,"div",62),n(),o(45,"div",63),a(46),n()()()()),r&2){let e,i,l,d=c(4);s(19),_(" ",d.formatCurrency(((e=d.availability())==null||e.pricingBreakdown==null?null:e.pricingBreakdown.originalRate)||0)," "),s(11),v("ngIf",d.getDiscountAmount()>0),s(3),_(" ",d.formatCurrency(d.getSelectedRate())," "),s(3),v("ngIf",((i=d.extensionForm.get("selectedPricingStrategy"))==null?null:i.value)==="discounted_rate"),s(7),N(" ",(l=d.availability())==null?null:l.extensionDays," nights \xD7 ",d.formatCurrency(d.getSelectedRate())," "),s(),v("ngIf",d.getDiscountAmount()>0),s(2),_(" ",d.formatCurrency(d.getTotalCost())," ")}}function Ki(r,t){if(r&1&&(o(0,"div",86)(1,"span",75),a(2),n(),o(3,"span",76),a(4),n()()),r&2){let e=t.$implicit,i=c(6);s(2),_("",i.getModifierDisplayName(e),":"),s(),W(i.getModifierValueClass(e)),s(),_(" ",i.getModifierValueDisplay(e)," ")}}function Yi(r,t){if(r&1&&(o(0,"div",9)(1,"div",84),a(2,"ADJUSTMENTS:"),n(),F(3,Ki,5,4,"div",85),n()),r&2){let e,i=c(5);s(3),v("ngForOf",(e=i.availability())==null||e.pricingBreakdown==null?null:e.pricingBreakdown.appliedModifiers)}}function Ji(r,t){if(r&1&&(o(0,"div",70)(1,"h5",71)(2,"mat-icon",72),a(3,"receipt"),n(),a(4," Pricing Breakdown "),n(),o(5,"div",73)(6,"div",74)(7,"span",75),a(8,"Base Rate per Night:"),n(),o(9,"span",76),a(10),n()(),F(11,Yi,4,1,"div",77),o(12,"div",78)(13,"div",79)(14,"span"),a(15,"Final Rate per Night:"),n(),o(16,"span",80),a(17),n()()(),o(18,"div",81)(19,"div",61)(20,"span",82),a(21,"Total Extension Cost:"),n(),o(22,"span",83),a(23),n()()()()()),r&2){let e,i,l,d,p=c(4);s(10),m(p.formatCurrency(((e=p.availability())==null||e.pricingBreakdown==null?null:e.pricingBreakdown.baseRatePerNight)||0)),s(),v("ngIf",(i=p.availability())==null||i.pricingBreakdown==null||i.pricingBreakdown.appliedModifiers==null?null:i.pricingBreakdown.appliedModifiers.length),s(6),m(p.formatCurrency(((l=p.availability())==null||l.pricingBreakdown==null?null:l.pricingBreakdown.finalRatePerNight)||0)),s(6),m(p.formatCurrency(((d=p.availability())==null?null:d.estimatedCost)||0))}}function Xi(r,t){if(r&1&&(o(0,"div",27)(1,"div",37)(2,"div",9)(3,"div",10),a(4,"Additional Nights"),n(),o(5,"div",38),a(6),n()(),o(7,"div",9)(8,"div",10),a(9,"Extension Days"),n(),o(10,"div",38),a(11),n()()(),F(12,Zi,47,8,"div",39)(13,Ji,24,4,"div",40),n()),r&2){let e,i,l,d,p=c(3);s(6),m((e=p.availability())==null?null:e.maxExtensionNights),s(5),m((i=p.availability())==null?null:i.extensionDays),s(),v("ngIf",(l=p.availability())==null||l.pricingBreakdown==null?null:l.pricingBreakdown.originalRate),s(),v("ngIf",(d=p.availability())==null?null:d.pricingBreakdown)}}function en(r,t){r&1&&(o(0,"div",87)(1,"mat-icon",88),a(2,"warning"),n(),o(3,"div",89)(4,"div",76),a(5,"Room conflicts prevent extension beyond this date"),n(),o(6,"div",90),a(7,"Please choose an earlier date or check with front desk for alternative options."),n()()())}function tn(r,t){if(r&1&&(o(0,"div",33)(1,"div",34)(2,"mat-icon"),a(3),n(),o(4,"h4",35),a(5),n()(),F(6,Xi,14,4,"div",19)(7,en,8,0,"div",36),n()),r&2){let e,i,l,d,p,h,D,O=c(2);W((e=O.availability())!=null&&e.isAvailable?"border-green-200 bg-green-50":"border-red-200 bg-red-50"),s(2),W((i=O.availability())!=null&&i.isAvailable?"text-green-600":"text-red-600"),s(),_(" ",(l=O.availability())!=null&&l.isAvailable?"check_circle":"cancel"," "),s(),W((d=O.availability())!=null&&d.isAvailable?"text-green-800":"text-red-800"),s(),_(" ",(p=O.availability())!=null&&p.isAvailable?"Extension Available":"Extension Unavailable"," "),s(),v("ngIf",(h=O.availability())==null?null:h.isAvailable),s(),v("ngIf",!((D=O.availability())!=null&&D.isAvailable)&&((D=O.availability())==null||D.conflictingReservations==null?null:D.conflictingReservations.length))}}function nn(r,t){if(r&1&&(o(0,"div",27),F(1,qi,4,0,"div",28)(2,tn,8,10,"div",29),n()),r&2){let e=c();s(),v("ngIf",e.availabilityChecking()),s(),v("ngIf",e.availability()&&!e.availabilityChecking())}}function on(r,t){if(r&1&&(o(0,"div",91)(1,"mat-icon",92),a(2,"error"),n(),o(3,"div",93)(4,"div",76),a(5,"Extension Request Failed"),n(),o(6,"div"),a(7),n()()()),r&2){let e=c();s(7),m(e.errorMessage())}}function an(r,t){r&1&&k(0,"mat-spinner",94)}function rn(r,t){r&1&&(o(0,"span"),a(1,"Request Extension"),n())}function sn(r,t){r&1&&(o(0,"span"),a(1,"Processing..."),n())}var Je=class r{dialogRef=b(me);data=b(pe);fb=b(oe);reservationService=b(ue);storeStore=b(Ce);extensionForm;isLoading=P(!1);availabilityChecking=P(!1);availability=P(null);errorMessage=P("");constructor(){let t=new Date(this.data.currentCheckOutDate);t.setDate(t.getDate()+1),this.extensionForm=this.fb.group({newCheckOutDate:["",[M.required]],selectedPricingStrategy:["same_rate",M.required],discountedRate:[{value:"",disabled:!0}],notes:[""]}),this.minExtensionDate=t,this.extensionForm.get("selectedPricingStrategy")?.valueChanges.subscribe(e=>{this.onPricingStrategyChange(e)})}minExtensionDate;get reservation(){return this.data.reservation}get currentCheckOutDate(){return this.data.currentCheckOutDate}get selectedStore(){return this.storeStore.selectedStore}formatCurrency(t){let i=this.selectedStore()?.currency||"USD";return`${{USD:"$",EUR:"\u20AC",GBP:"\xA3",NGN:"\u20A6",GHS:"\u20B5",KES:"KSh",ZAR:"R",CAD:"C$",AUD:"A$"}[i]||i+" "}${t.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}`}getPricingStrategyDisplayName(t){return{same_rate:"Original Booking Rate",current_rate:"Current Room Rate",extension_rate:"Extension Rate",dynamic_rate:"Dynamic Pricing",loyalty_rate:"Loyalty Rate"}[t]||t}getModifierDisplayName(t){if(t.type==="percentage"){let e=((t.value-1)*100).toFixed(0);return e>="0"?`+${e}%`:`${e}%`}else return`${t.value>0?"+":""}${this.formatCurrency(t.value)}`}onDateChange(){return S(this,null,function*(){let t=this.extensionForm.get("newCheckOutDate")?.value;yield this.checkAvailability()})}checkAvailability(){return S(this,null,function*(){let t=this.extensionForm.get("newCheckOutDate")?.value;if(t){this.availabilityChecking.set(!0),this.errorMessage.set("");try{let e=yield this.reservationService.checkExtensionAvailability(this.reservation._id,t.toISOString()).toPromise();this.availability.set(e)}catch(e){this.errorMessage.set(e.message||"Failed to check availability"),this.availability.set(null)}finally{this.availabilityChecking.set(!1)}}})}calculateEstimatedCost(t){return this.calculateNights(t)*100}calculateNights(t){let e=t.getTime()-this.currentCheckOutDate.getTime();return Math.ceil(e/(1e3*3600*24))}submitExtension(){return S(this,null,function*(){if(!this.extensionForm.valid){this.markFormGroupTouched();return}if(!this.availability()?.isAvailable){this.errorMessage.set("Extension is not available for the selected dates");return}this.isLoading.set(!0),this.errorMessage.set("");try{let e=this.extensionForm.value,i=this.calculateNights(e.newCheckOutDate),l={newCheckOutDate:e.newCheckOutDate.toISOString(),additionalNights:i,selectedPricingStrategy:e.selectedPricingStrategy,selectedRate:this.getSelectedRate(),discountedRate:e.selectedPricingStrategy==="discounted_rate"?this.getDiscountedRateValue():null,totalCost:this.getTotalCost(),notes:e.notes||""},d=yield this.reservationService.requestExtension(this.reservation._id,l).toPromise();this.dialogRef.close({success:!0,extension:d?.extension})}catch(e){this.errorMessage.set(e.message||"Failed to request extension")}finally{this.isLoading.set(!1)}})}markFormGroupTouched(){Object.keys(this.extensionForm.controls).forEach(t=>{this.extensionForm.get(t)?.markAsTouched()})}getModifierValueDisplay(t){return t.type==="percentage"?`${t.value>0?"+":""}${t.value}%`:`${t.value>0?"+":""}${this.formatCurrency(t.value)}`}getModifierValueClass(t){return t.value>0?"text-red-600 font-medium":"text-green-600 font-medium"}getModifierDescription(t){let e={seasonal:"Applied based on current season",loyalty:"Discount for loyalty program members",length_of_stay:"Discount for extended stays",last_minute:"Discount for booking within 24 hours",occupancy:"Rate adjusted based on current occupancy levels",weekend:"Additional charge for weekend stays",holiday:"Premium rate during holiday periods"};return t.description||e[t.type]||""}get rateOptions(){let t=this.availability()?.pricingBreakdown;return!t||!t.originalRate?[]:[{id:"same_rate",name:"Same Rate",description:"Continue with the original room rate",rate:t.originalRate,isRecommended:!0,badge:"ORIGINAL",savings:0},{id:"discounted_rate",name:"Discounted Rate",description:"Apply a custom discount to the original rate",rate:this.getDiscountedRateValue()||t.originalRate,isRecommended:!1,badge:null,savings:this.getDiscountAmount()}]}getDiscountedRateValue(){let t=this.extensionForm.get("discountedRate")?.value;return t?parseFloat(t):0}getDiscountAmount(){let t=this.availability()?.pricingBreakdown?.originalRate||0,e=this.getDiscountedRateValue();return e>0?Math.max(0,t-e):0}getSelectedRate(){let t=this.extensionForm.get("selectedPricingStrategy")?.value;if(t==="same_rate")return this.availability()?.pricingBreakdown?.originalRate||0;if(t==="discounted_rate"){let e=this.getDiscountedRateValue();return e>0?e:this.availability()?.pricingBreakdown?.originalRate||0}return 0}getTotalCost(){let t=this.availability()?.extensionDays||0,e=this.getSelectedRate();return t*e}getSavings(t){return t.savings||0}hasSavings(t){return(t.savings||0)>0}onPricingStrategyChange(t){let e=this.extensionForm.get("discountedRate");if(t==="discounted_rate"){e?.enable(),e?.setValidators([M.required,M.min(1)]);let i=this.availability()?.pricingBreakdown?.originalRate||0;e?.setValue(i)}else e?.disable(),e?.clearValidators(),e?.setValue("");e?.updateValueAndValidity()}validateDiscountedRate(){if(this.extensionForm.get("selectedPricingStrategy")?.value==="discounted_rate"){let e=this.availability()?.pricingBreakdown?.originalRate||0,i=this.getDiscountedRateValue();return i>0&&i<=e}return!0}onCancel(){this.dialogRef.close({success:!1})}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=B({type:r,selectors:[["app-extension-dialog"]],decls:59,vars:19,consts:[["picker",""],["mat-dialog-title","",1,"flex","items-center","gap-3","border-b","border-gray-200"],[1,"text-xl","font-semibold","text-gray-800","m-0"],[1,"text-sm","text-gray-600","m-0","mt-1"],[1,"py-6"],[1,"bg-gray-50","rounded-lg","p-4","mb-6"],[1,"text-sm","font-medium","text-gray-700","mb-3","flex","items-center","gap-2"],[1,"text-gray-600","!text-base"],[1,"grid","grid-cols-1","md:grid-cols-3","gap-4"],[1,"space-y-1"],[1,"text-xs","font-medium","text-gray-500","uppercase","tracking-wider"],[1,"text-sm","text-gray-900"],[1,"space-y-6",3,"formGroup"],[1,"space-y-2"],[1,"text-sm","font-medium","text-gray-700"],["appearance","outline",1,"w-full"],["matInput","","formControlName","newCheckOutDate","placeholder","Choose date",3,"dateChange","matDatepicker"],["matIconSuffix","",3,"for"],[4,"ngIf"],["class","space-y-4",4,"ngIf"],["matInput","","formControlName","notes","rows","3","placeholder","Add any special requests or notes for the extension"],["class","flex items-start gap-3 p-4 bg-red-50 border border-red-200 rounded-md",4,"ngIf"],[1,"flex","justify-end","gap-3","pt-6","border-t","border-gray-200","mt-6"],["mat-button","","type","button",1,"px-4","py-2",3,"click","disabled"],["mat-raised-button","","color","primary","type","button",1,"px-6","py-2","min-w-[140px]",3,"click","disabled"],[1,"flex","items-center","justify-center","gap-2"],["diameter","16",4,"ngIf"],[1,"space-y-4"],["class","flex items-center justify-center gap-3 py-8",4,"ngIf"],["class","border rounded-lg p-4",3,"class",4,"ngIf"],[1,"flex","items-center","justify-center","gap-3","py-8"],["diameter","24"],[1,"text-sm","text-gray-600"],[1,"border","rounded-lg","p-4"],[1,"flex","items-center","gap-3","mb-4"],[1,"text-base","font-medium"],["class","flex items-start gap-3 p-3 bg-amber-50 border border-amber-200 rounded-md",4,"ngIf"],[1,"grid","grid-cols-2","gap-4","text-sm"],[1,"text-gray-900","font-semibold"],["class","space-y-4 border-t pt-4",4,"ngIf"],["class","bg-white rounded-md p-4 border border-gray-200",4,"ngIf"],[1,"space-y-4","border-t","pt-4"],[1,"flex","items-center","justify-between"],[1,"text-xs","text-gray-500"],["formControlName","selectedPricingStrategy",1,"space-y-3"],[1,"relative"],["value","same_rate",1,"w-full","block","p-4","border","border-blue-200","bg-blue-50","rounded-lg","hover:bg-blue-100","transition-colors"],[1,"absolute","top-2","right-2","px-2","py-1","text-xs","font-bold","rounded-full","bg-blue-100","text-blue-800"],[1,"flex","items-start","justify-between","mt-1"],[1,"flex-1","min-w-0","pr-4"],[1,"text-sm","font-semibold","text-blue-900"],[1,"text-xs","mt-1","text-blue-700"],[1,"text-right"],[1,"text-lg","font-bold","text-blue-600"],["value","discounted_rate",1,"w-full","block","p-4","border","border-green-200","bg-green-50","rounded-lg","hover:bg-green-100","transition-colors"],[1,"text-sm","font-semibold","text-green-900"],[1,"text-xs","mt-1","text-green-700"],["class","inline-flex items-center mt-2 px-2 py-1 bg-green-100 text-green-800 text-xs font-medium rounded-full",4,"ngIf"],[1,"text-lg","font-bold","text-green-600"],["class","mt-4",4,"ngIf"],[1,"bg-gray-100","rounded-lg","p-4","mt-4"],[1,"flex","justify-between","items-center"],["class","text-xs text-green-600 font-medium mt-1",4,"ngIf"],[1,"text-xl","font-bold","text-blue-600"],[1,"inline-flex","items-center","mt-2","px-2","py-1","bg-green-100","text-green-800","text-xs","font-medium","rounded-full"],[1,"!text-xs","mr-1"],[1,"mt-4"],["matInput","","type","number","min","1","step","0.01","formControlName","discountedRate","placeholder","Enter discounted rate",3,"max"],["matTextPrefix",""],[1,"text-xs","text-green-600","font-medium","mt-1"],[1,"bg-white","rounded-md","p-4","border","border-gray-200"],[1,"text-sm","font-medium","text-gray-900","mb-3","flex","items-center","gap-2"],[1,"!text-base","text-blue-600"],[1,"space-y-2","text-sm"],[1,"flex","justify-between"],[1,"text-gray-600"],[1,"font-medium"],["class","space-y-1",4,"ngIf"],[1,"border-t","pt-2","mt-3"],[1,"flex","justify-between","font-semibold"],[1,"text-blue-600"],[1,"bg-blue-50","rounded","p-2","mt-3"],[1,"font-semibold","text-blue-900"],[1,"text-lg","font-bold","text-blue-700"],[1,"text-xs","font-medium","text-gray-500","mt-2","mb-1"],["class","flex justify-between text-xs",4,"ngFor","ngForOf"],[1,"flex","justify-between","text-xs"],[1,"flex","items-start","gap-3","p-3","bg-amber-50","border","border-amber-200","rounded-md"],[1,"text-amber-600","!text-base","mt-0.5"],[1,"text-sm","text-amber-800"],[1,"text-xs","mt-1"],[1,"flex","items-start","gap-3","p-4","bg-red-50","border","border-red-200","rounded-md"],[1,"text-red-600","!text-base","mt-0.5"],[1,"text-sm","text-red-800"],["diameter","16"]],template:function(e,i){if(e&1){let l=w();o(0,"div",1)(1,"div")(2,"span",2),a(3,"Extend Reservation"),n(),o(4,"p",3),a(5),n()()(),o(6,"mat-dialog-content",4)(7,"div",5)(8,"h3",6)(9,"mat-icon",7),a(10,"info"),n(),a(11," Current Reservation Details "),n(),o(12,"div",8)(13,"div",9)(14,"div",10),a(15,"Check-out Date"),n(),o(16,"div",11),a(17),f(18,"date"),n()(),o(19,"div",9)(20,"div",10),a(21,"Room(s)"),n(),o(22,"div",11),a(23),n()(),o(24,"div",9)(25,"div",10),a(26,"Confirmation"),n(),o(27,"div",11),a(28),n()()()(),o(29,"form",12)(30,"div",13)(31,"label",14),a(32,"New Check-out Date"),n(),o(33,"mat-form-field",15)(34,"mat-label"),a(35,"Select new check-out date"),n(),o(36,"input",16),C("dateChange",function(){return y(l),E(i.onDateChange())}),n(),k(37,"mat-datepicker-toggle",17)(38,"mat-datepicker",null,0),F(40,ji,2,0,"mat-error",18),n()(),F(41,nn,3,2,"div",19),o(42,"div",13)(43,"label",14),a(44,"Notes (Optional)"),n(),o(45,"mat-form-field",15)(46,"mat-label"),a(47,"Special requests or notes"),n(),o(48,"textarea",20),a(49,"        "),n()()(),F(50,on,8,1,"div",21),n()(),o(51,"mat-dialog-actions",22)(52,"button",23),C("click",function(){return y(l),E(i.onCancel())}),a(53," Cancel "),n(),o(54,"button",24),C("click",function(){return y(l),E(i.submitExtension())}),o(55,"div",25),F(56,an,1,0,"mat-spinner",26)(57,rn,2,0,"span",18)(58,sn,2,0,"span",18),n()()()}if(e&2){let l,d,p,h=Z(39);s(5),N(" Request extension for ",i.reservation==null||i.reservation.guestDetails==null||i.reservation.guestDetails.primaryGuest==null?null:i.reservation.guestDetails.primaryGuest.firstName," ",i.reservation==null||i.reservation.guestDetails==null||i.reservation.guestDetails.primaryGuest==null?null:i.reservation.guestDetails.primaryGuest.lastName," "),s(12),m(R(18,16,i.currentCheckOutDate,"mediumDate")),s(6),_("",i.reservation==null||i.reservation.rooms==null?null:i.reservation.rooms.length," room(s)"),s(5),m(i.reservation==null?null:i.reservation.confirmationNumber),s(),v("formGroup",i.extensionForm),s(7),v("matDatepicker",h),s(),v("for",h),s(3),v("ngIf",(l=i.extensionForm.get("newCheckOutDate"))==null?null:l.hasError("required")),s(),v("ngIf",(d=i.extensionForm.get("newCheckOutDate"))==null?null:d.value),s(9),v("ngIf",i.errorMessage()),s(2),v("disabled",i.isLoading()),s(2),v("disabled",!i.extensionForm.valid||!((p=i.availability())!=null&&p.isAvailable)||i.isLoading()),s(2),v("ngIf",i.isLoading()),s(),v("ngIf",!i.isLoading()),s(),v("ngIf",i.isLoading())}},dependencies:[j,At,Bt,Nt,Jt,te,J,xe,X,ee,fe,Ne,ae,ie,ne,H,Ee,Re,Se,$,se,re,be,Ve,Ue,Ge,de,le,q,Y,_i,ui,gi,vi,Qt,De,qe,z,L,he,ce,Ei,gt,Ye],styles:[".mat-mdc-dialog-container[_ngcontent-%COMP%]{--mdc-dialog-container-color: white;--mdc-dialog-supporting-text-color: #374151}.mat-mdc-radio-button.mat-mdc-radio-checked[_ngcontent-%COMP%]   .mdc-radio__native-control[_ngcontent-%COMP%]:enabled:checked + .mdc-radio__background[_ngcontent-%COMP%]   .mdc-radio__outer-circle[_ngcontent-%COMP%]{border-color:#2563eb}.mat-mdc-radio-button.mat-mdc-radio-checked[_ngcontent-%COMP%]   .mdc-radio__background[_ngcontent-%COMP%]   .mdc-radio__inner-circle[_ngcontent-%COMP%]{border-color:#2563eb;background-color:#2563eb}.mat-mdc-radio-button[_ngcontent-%COMP%]:hover   .mdc-radio__native-control[_ngcontent-%COMP%]:enabled:not(:checked) + .mdc-radio__background[_ngcontent-%COMP%]   .mdc-radio__outer-circle[_ngcontent-%COMP%]{border-color:#3b82f6}.mat-mdc-form-field.mat-form-field-appearance-outline[_ngcontent-%COMP%]   .mat-mdc-text-field-wrapper[_ngcontent-%COMP%]   .mat-mdc-form-field-flex[_ngcontent-%COMP%]   .mat-mdc-form-field-infix[_ngcontent-%COMP%]{padding:12px 0}@media (max-width: 640px){.mat-mdc-dialog-container[_ngcontent-%COMP%]{margin:16px;width:calc(100vw - 32px);max-width:none}}"]})};function ln(r,t){if(r&1&&(o(0,"mat-form-field",7)(1,"mat-label"),a(2,"Service Fee"),n(),k(3,"input",46),o(4,"span",9),a(5),n()()),r&2){let e=c(2);s(5),_("",e.currency,"\xA0")}}function dn(r,t){if(r&1&&(o(0,"mat-form-field",7)(1,"mat-label"),a(2,"Cleaning Fee"),n(),k(3,"input",47),o(4,"span",9),a(5),n()()),r&2){let e=c(2);s(5),_("",e.currency,"\xA0")}}function cn(r,t){if(r&1&&(o(0,"mat-form-field",7)(1,"mat-label"),a(2,"Resort Fee"),n(),k(3,"input",48),o(4,"span",9),a(5),n()()),r&2){let e=c(2);s(5),_("",e.currency,"\xA0")}}function mn(r,t){if(r&1&&(o(0,"mat-form-field",7)(1,"mat-label"),a(2,"Other Fees"),n(),k(3,"input",49),o(4,"span",9),a(5),n()()),r&2){let e=c(2);s(5),_("",e.currency,"\xA0")}}function pn(r,t){if(r&1&&(o(0,"div",11)(1,"h4",4)(2,"mat-icon",5),a(3,"lock"),n(),a(4," Additional Fees (Read-only) "),n(),o(5,"div",6),u(6,ln,6,1,"mat-form-field",7),u(7,dn,6,1,"mat-form-field",7),u(8,cn,6,1,"mat-form-field",7),u(9,mn,6,1,"mat-form-field",7),n()()),r&2){let e=c();s(6),g(e.data.reservation.pricing.fees.serviceFee?6:-1),s(),g(e.data.reservation.pricing.fees.cleaningFee?7:-1),s(),g(e.data.reservation.pricing.fees.resortFee?8:-1),s(),g(e.data.reservation.pricing.fees.other?9:-1)}}function un(r,t){if(r&1&&(o(0,"div",12)(1,"h4",50)(2,"mat-icon",51),a(3,"lock"),n(),a(4," Extension Charges (Read-only) "),n(),o(5,"div",6)(6,"mat-form-field",7)(7,"mat-label"),a(8,"Extension Cost"),n(),k(9,"input",52),o(10,"span",9),a(11),n(),o(12,"mat-hint"),a(13),n()(),o(14,"div",25)(15,"div",53),a(16,"Extension Status"),n(),o(17,"div",45)(18,"mat-icon",54),a(19,"check_circle"),n(),o(20,"span",55),a(21,"Approved & Included"),n()(),o(22,"div",56),a(23," Cannot be modified in pricing dialog "),n()()(),o(24,"div",57)(25,"div",45)(26,"mat-icon",58),a(27,"info"),n(),o(28,"span")(29,"strong"),a(30),n(),a(31," totaling "),o(32,"strong"),a(33),f(34,"currency"),n(),a(35," have been approved and are automatically included in the total. "),n()()()()),r&2){let e=c();s(9),v("value",e.getApprovedExtensionCost()),s(2),_("",e.currency,"\xA0"),s(2),_("",e.getApprovedExtensionNights()," additional nights"),s(17),_("",e.getApprovedExtensionNights()," extension night(s)"),s(3),m(A(34,5,e.getApprovedExtensionCost(),e.currency,"symbol","1.2-2"))}}function gn(r,t){if(r&1&&(o(0,"div",32)(1,"span",33),a(2),n(),o(3,"span",59),a(4),f(5,"currency"),n()()),r&2){let e=c();s(2),_("Extensions (",e.getApprovedExtensionNights()," nights):"),s(2),_("+",A(5,2,e.getApprovedExtensionCost(),e.currency,"symbol","1.2-2"))}}function vn(r,t){r&1&&(o(0,"span",45),ft(),o(1,"svg",60),k(2,"circle",61)(3,"path",62),n(),a(4," Updating... "),n())}function _n(r,t){r&1&&(o(0,"span",45)(1,"mat-icon"),a(2,"save"),n(),a(3," Update Pricing "),n())}var Xe=class r{constructor(t){this.data=t;if(this.data.reservation.status==="checked_out"){this.pricingForm=this.fb.group({}),setTimeout(()=>{this.dialogRef.close({confirmed:!1,error:"Cannot edit pricing for checked-out reservations"})});return}let e=this.data.reservation.pricing;this.pricingForm=this.fb.group({subtotal:[{value:e.subtotal||0,disabled:!0}],taxes:[{value:e.taxes||0,disabled:!0}],fees:this.fb.group({serviceFee:[{value:e.fees?.serviceFee||0,disabled:!0}],cleaningFee:[{value:e.fees?.cleaningFee||0,disabled:!0}],resortFee:[{value:e.fees?.resortFee||0,disabled:!0}],other:[{value:e.fees?.other||0,disabled:!0}]}),discounts:this.fb.group({amount:[e.discounts?.amount||0,[M.min(0)]],reason:[e.discounts?.reason||""],code:[e.discounts?.code||""]}),paid:[e.paid||0,[M.min(0)]]}),this.pricingForm.valueChanges.subscribe(()=>{this.calculateTotal()})}fb=b(oe);dialogRef=b(me);reservationService=b(ue);storeStore=b(Ce);snackBar=b(_e);pricingForm;loading=P(!1);get currency(){return this.storeStore.selectedStore()?.currency||this.storeStore.selectedStore()?.currencyCode||"USD"}getApprovedExtensionCost(){return this.data.reservation.extensions?this.data.reservation.extensions.filter(e=>e.status==="approved").reduce((e,i)=>e+(i.additionalCost||0),0):0}getApprovedExtensionNights(){return this.data.reservation.extensions?this.data.reservation.extensions.filter(e=>e.status==="approved").reduce((e,i)=>e+(i.additionalNights||0),0):0}hasApprovedExtensions(){return this.getApprovedExtensionCost()>0}get currentTotal(){let t=this.data.reservation.pricing,e=this.pricingForm.value,i=t.subtotal||0,l=t.taxes||0,d=t.fees?.serviceFee||0,p=t.fees?.cleaningFee||0,h=t.fees?.resortFee||0,D=t.fees?.other||0,O=this.getApprovedExtensionCost(),ge=e.discounts?.amount||0,Me=d+p+h+D;return i+l+Me+O-ge}get currentBalance(){let t=this.pricingForm.get("paid")?.value||0;return this.currentTotal-t}calculateTotal(){}onCancel(){this.dialogRef.close({success:!1})}onSave(){if(this.pricingForm.invalid){this.snackBar.open("Please fill in all required fields correctly","Close",{duration:3e3,panelClass:["error-snackbar"]});return}this.loading.set(!0);let t=this.pricingForm.value,e=this.data.reservation.pricing,i={subtotal:e.subtotal,taxes:e.taxes,fees:{serviceFee:e.fees?.serviceFee||0,cleaningFee:e.fees?.cleaningFee||0,resortFee:e.fees?.resortFee||0,other:e.fees?.other||0},discounts:{amount:t.discounts.amount,reason:t.discounts.reason,code:t.discounts.code},total:this.currentTotal,paid:t.paid||0,balance:this.currentBalance};this.reservationService.updateReservation(this.data.reservation._id,{pricing:i}).subscribe({next:l=>{this.loading.set(!1),this.snackBar.open("Pricing updated successfully","Close",{duration:3e3,panelClass:["success-snackbar"]}),this.dialogRef.close({success:!0,updatedReservation:l})},error:l=>{this.loading.set(!1),console.error("Error updating pricing:",l),this.snackBar.open(l.message||"Failed to update pricing","Close",{duration:5e3,panelClass:["error-snackbar"]})}})}static \u0275fac=function(e){return new(e||r)(Ct(pe))};static \u0275cmp=B({type:r,selectors:[["app-pricing-update-dialog"]],decls:149,vars:86,consts:[["mat-dialog-title",""],["mat-dialog-content","",1,"!p-6","!max-h-[70vh]","overflow-y-auto"],[1,"space-y-6",3,"formGroup"],[1,"bg-gray-50","rounded-lg","p-4","border","border-gray-200","mb-6","shadow-sm"],[1,"text-sm","font-semibold","text-gray-700","mb-3","flex","items-center","gap-2","uppercase","tracking-wide"],[1,"text-gray-500","text-lg"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4"],["appearance","outline",1,"w-full"],["matInput","","type","number","formControlName","subtotal","readonly","",1,"!bg-gray-100","!text-gray-600"],["matPrefix",""],["matInput","","type","number","formControlName","taxes","readonly","",1,"!bg-gray-100","!text-gray-600"],["formGroupName","fees",1,"bg-gray-50","rounded-lg","p-4","border","border-gray-200","mb-6","shadow-sm"],[1,"bg-orange-50","rounded-lg","p-4","border","border-orange-200","mb-6","shadow-sm"],[1,"space-y-6"],["formGroupName","discounts",1,"bg-green-50","rounded-lg","p-4","border","border-green-200","shadow-sm","hover:shadow-md","transition-shadow","duration-200"],[1,"text-lg","font-semibold","text-green-900","mb-3","flex","items-center","gap-2","uppercase","tracking-wide"],[1,"text-green-600"],[1,"grid","grid-cols-1","md:grid-cols-3","gap-4"],["matInput","","type","number","formControlName","amount","min","0","step","0.01","placeholder","0.00"],["matInput","","formControlName","reason","placeholder","e.g., Staff discount"],["matInput","","formControlName","code","placeholder","e.g., STAFF10"],[1,"bg-blue-50","rounded-lg","p-4","border","border-blue-200","shadow-sm","hover:shadow-md","transition-shadow","duration-200"],[1,"text-lg","font-semibold","text-blue-900","mb-3","flex","items-center","gap-2","uppercase","tracking-wide"],[1,"text-blue-600"],["matInput","","type","number","formControlName","paid","min","0","step","0.01","placeholder","0.00"],[1,"flex","flex-col","justify-center"],[1,"text-sm","text-gray-600","mb-1"],[1,"text-lg","font-medium"],[1,"bg-gradient-to-br","from-purple-50","to-indigo-50","rounded-lg","p-4","border","border-purple-200","shadow-sm"],[1,"text-lg","font-semibold","text-purple-900","mb-3","flex","items-center","gap-2","uppercase","tracking-wide"],[1,"text-purple-600"],[1,"space-y-2","text-sm"],[1,"flex","justify-between"],[1,"text-gray-600"],[1,"font-medium"],[1,"font-medium","text-green-600"],[1,"my-2"],[1,"flex","justify-between","text-lg","font-semibold"],[1,"text-gray-900"],[1,"bg-gradient-to-br","from-blue-50","to-cyan-50","rounded-lg","p-4","border","border-blue-200","shadow-sm"],[1,"text-sm","font-semibold","text-blue-900","mb-2","uppercase","tracking-wide"],[1,"text-xs","text-blue-800","space-y-1"],["mat-dialog-actions","",1,"flex","items-center","justify-end","gap-3","!p-6","!m-0","border-t","border-gray-200","bg-gray-50"],["mat-button","",1,"!text-gray-600","hover:!bg-gray-100","!px-6","!py-2","!font-medium","!rounded-lg","transition-colors","duration-200",3,"click","disabled"],["mat-raised-button","","color","primary",1,"!bg-gradient-to-r","!from-purple-600","!to-purple-700","hover:!from-purple-700","hover:!to-purple-800","!text-white","!shadow-lg","hover:!shadow-xl","!px-6","!py-2","!font-semibold","!rounded-lg","transition-all","duration-200","transform","hover:!scale-105","disabled:!opacity-50","disabled:!cursor-not-allowed","disabled:hover:!scale-100",3,"click","disabled"],[1,"flex","items-center","gap-2"],["matInput","","type","number","formControlName","serviceFee","readonly","",1,"!bg-gray-100","!text-gray-600"],["matInput","","type","number","formControlName","cleaningFee","readonly","",1,"!bg-gray-100","!text-gray-600"],["matInput","","type","number","formControlName","resortFee","readonly","",1,"!bg-gray-100","!text-gray-600"],["matInput","","type","number","formControlName","other","readonly","",1,"!bg-gray-100","!text-gray-600"],[1,"text-sm","font-semibold","text-orange-700","mb-3","flex","items-center","gap-2","uppercase","tracking-wide"],[1,"text-orange-500","text-lg"],["matInput","","type","number","readonly","",1,"!bg-gray-100","!text-gray-600",3,"value"],[1,"text-sm","text-orange-600","mb-1"],[1,"text-green-600","text-sm"],[1,"text-sm","font-medium","text-green-600"],[1,"text-xs","text-gray-500","mt-1"],[1,"mt-3","p-2","bg-orange-100","border","border-orange-200","rounded","text-xs","text-orange-800"],[1,"text-orange-600","text-sm"],[1,"font-medium","text-orange-600"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24",1,"animate-spin","-ml-1","mr-3","h-4","w-4","text-white"],["cx","12","cy","12","r","10","stroke","currentColor","stroke-width","4",1,"opacity-25"],["fill","currentColor","d","M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z",1,"opacity-75"]],template:function(e,i){if(e&1&&(o(0,"div",0),a(1,` Update Pricing
`),n(),o(2,"div",1)(3,"form",2)(4,"div",3)(5,"h4",4)(6,"mat-icon",5),a(7,"lock"),n(),a(8," Base Pricing (Read-only) "),n(),o(9,"div",6)(10,"mat-form-field",7)(11,"mat-label"),a(12,"Subtotal"),n(),k(13,"input",8),o(14,"span",9),a(15),n(),o(16,"mat-hint"),a(17,"Based on room rates and duration"),n()(),o(18,"mat-form-field",7)(19,"mat-label"),a(20,"Taxes"),n(),k(21,"input",10),o(22,"span",9),a(23),n(),o(24,"mat-hint"),a(25,"Calculated from store tax rate"),n()()()(),u(26,pn,10,4,"div",11),u(27,un,36,10,"div",12),o(28,"div",13)(29,"div",14)(30,"h4",15)(31,"mat-icon",16),a(32,"local_offer"),n(),a(33," Discounts (Editable) "),n(),o(34,"div",17)(35,"mat-form-field",7)(36,"mat-label"),a(37,"Discount Amount"),n(),k(38,"input",18),o(39,"span",9),a(40),n(),o(41,"mat-hint"),a(42,"Reduce total amount"),n()(),o(43,"mat-form-field",7)(44,"mat-label"),a(45,"Discount Reason"),n(),k(46,"input",19),n(),o(47,"mat-form-field",7)(48,"mat-label"),a(49,"Discount Code"),n(),k(50,"input",20),n()()(),o(51,"div",21)(52,"h4",22)(53,"mat-icon",23),a(54,"payment"),n(),a(55," Payment Amount (Editable) "),n(),o(56,"div",6)(57,"mat-form-field",7)(58,"mat-label"),a(59,"Amount Paid"),n(),k(60,"input",24),o(61,"span",9),a(62),n(),o(63,"mat-hint"),a(64,"Total amount received from guest"),n()(),o(65,"div",25)(66,"div",26),a(67,"Current Status"),n(),o(68,"div",27),a(69),f(70,"titlecase"),n()()()()(),o(71,"div",28)(72,"h4",29)(73,"mat-icon",30),a(74,"calculate"),n(),a(75," Updated Summary "),n(),o(76,"div",31)(77,"div",32)(78,"span",33),a(79,"Subtotal:"),n(),o(80,"span",34),a(81),f(82,"currency"),n()(),o(83,"div",32)(84,"span",33),a(85,"Taxes:"),n(),o(86,"span",34),a(87),f(88,"currency"),n()(),o(89,"div",32)(90,"span",33),a(91,"Total Fees:"),n(),o(92,"span",34),a(93),f(94,"currency"),n()(),u(95,gn,6,7,"div",32),o(96,"div",32)(97,"span",33),a(98,"Discount:"),n(),o(99,"span",35),a(100),f(101,"currency"),n()(),k(102,"mat-divider",36),o(103,"div",37)(104,"span",38),a(105,"New Total:"),n(),o(106,"span",38),a(107),f(108,"currency"),n()(),o(109,"div",32)(110,"span",33),a(111,"Amount Paid:"),n(),o(112,"span",35),a(113),f(114,"currency"),n()(),o(115,"div",37)(116,"span"),a(117,"New Balance:"),n(),o(118,"span"),a(119),f(120,"currency"),n()()()(),o(121,"div",39)(122,"h4",40),a(123,"Original Pricing (for reference)"),n(),o(124,"div",41)(125,"div",32)(126,"span"),a(127,"Original Total:"),n(),o(128,"span"),a(129),f(130,"currency"),n()(),o(131,"div",32)(132,"span"),a(133,"Original Balance:"),n(),o(134,"span"),a(135),f(136,"currency"),n()(),o(137,"div",32)(138,"span"),a(139,"Original Amount Paid:"),n(),o(140,"span"),a(141),f(142,"currency"),n()()()()()(),o(143,"div",42)(144,"button",43),C("click",function(){return i.onCancel()}),a(145," Cancel "),n(),o(146,"button",44),C("click",function(){return i.onSave()}),u(147,vn,5,0,"span",45)(148,_n,4,0,"span",45),n()()),e&2){let l,d,p,h,D;s(3),v("formGroup",i.pricingForm),s(12),_("",i.currency,"\xA0"),s(8),_("",i.currency,"\xA0"),s(3),g(i.data.reservation.pricing.fees&&(i.data.reservation.pricing.fees.serviceFee||i.data.reservation.pricing.fees.cleaningFee||i.data.reservation.pricing.fees.resortFee||i.data.reservation.pricing.fees.other)?26:-1),s(),g(i.hasApprovedExtensions()?27:-1),s(13),_("",i.currency,"\xA0"),s(22),_("",i.currency,"\xA0"),s(6),T("text-green-600",(i.data.reservation.paymentInfo==null?null:i.data.reservation.paymentInfo.status)==="paid")("text-orange-600",(i.data.reservation.paymentInfo==null?null:i.data.reservation.paymentInfo.status)==="partial")("text-gray-600",(i.data.reservation.paymentInfo==null?null:i.data.reservation.paymentInfo.status)==="pending"),s(),_(" ",V(70,34,(i.data.reservation.paymentInfo==null?null:i.data.reservation.paymentInfo.status)||"pending")," "),s(12),m(A(82,36,(l=i.pricingForm.get("subtotal"))==null?null:l.value,i.currency,"symbol","1.2-2")),s(6),m(A(88,41,(d=i.pricingForm.get("taxes"))==null?null:d.value,i.currency,"symbol","1.2-2")),s(6),m(A(94,46,(((p=i.pricingForm.get("fees.serviceFee"))==null?null:p.value)||0)+(((p=i.pricingForm.get("fees.cleaningFee"))==null?null:p.value)||0)+(((p=i.pricingForm.get("fees.resortFee"))==null?null:p.value)||0)+(((p=i.pricingForm.get("fees.other"))==null?null:p.value)||0),i.currency,"symbol","1.2-2")),s(2),g(i.hasApprovedExtensions()?95:-1),s(5),_("-",A(101,51,(h=i.pricingForm.get("discounts.amount"))==null?null:h.value,i.currency,"symbol","1.2-2")),s(7),m(A(108,56,i.currentTotal,i.currency,"symbol","1.2-2")),s(6),m(A(114,61,(D=i.pricingForm.get("paid"))==null?null:D.value,i.currency,"symbol","1.2-2")),s(2),T("text-red-600",i.currentBalance>0)("text-green-600",i.currentBalance<0)("text-gray-900",i.currentBalance===0),s(4),m(A(120,66,i.currentBalance,i.currency,"symbol","1.2-2")),s(10),m(A(130,71,i.data.reservation.pricing.total,i.currency,"symbol","1.2-2")),s(6),m(A(136,76,i.data.reservation.pricing.balance,i.currency,"symbol","1.2-2")),s(6),m(A(142,81,i.data.reservation.pricing.paid,i.currency,"symbol","1.2-2")),s(3),v("disabled",i.loading()),s(2),v("disabled",i.loading()||i.pricingForm.invalid),s(),g(i.loading()?147:148)}},dependencies:[j,Ae,K,ae,te,J,xe,X,ee,fe,ie,ne,Yt,H,Ee,Re,Se,q,Y,de,le,se,re,be,Ue,$,z,L,ce,ye],styles:["[_nghost-%COMP%]{display:block}.mat-mdc-dialog-container[_ngcontent-%COMP%]{max-width:90vw;max-height:90vh;overflow:visible}.mat-mdc-dialog-title[_ngcontent-%COMP%]{border-bottom:1px solid #e5e7eb;background-color:#f9fafb}.mat-mdc-dialog-content[_ngcontent-%COMP%]{background-color:#fff}.mat-mdc-dialog-actions[_ngcontent-%COMP%]{border-top:1px solid #e5e7eb;background-color:#f9fafb}.mat-mdc-form-field[_ngcontent-%COMP%]{width:100%}.mat-mdc-form-field[_ngcontent-%COMP%]   .mat-mdc-form-field-wrapper[_ngcontent-%COMP%]{padding-bottom:0}.pricing-summary[_ngcontent-%COMP%]{background-color:#f8fafc;border:1px solid #e2e8f0;border-radius:.5rem;padding:1rem}.pricing-summary[_ngcontent-%COMP%]   .summary-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:.5rem}.pricing-summary[_ngcontent-%COMP%]   .summary-row[_ngcontent-%COMP%]:last-child{margin-bottom:0}.pricing-summary[_ngcontent-%COMP%]   .summary-row.total-row[_ngcontent-%COMP%]{font-weight:600;font-size:1.125rem;border-top:2px solid #cbd5e1;padding-top:.75rem;margin-top:.75rem}.reference-pricing[_ngcontent-%COMP%]{background-color:#f0f9ff;border:1px solid #bae6fd;border-radius:.5rem;padding:1rem;font-size:.875rem}.loading-spinner[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:.5rem}.loading-spinner[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:1rem;height:1rem}.mat-mdc-raised-button.mat-primary[_ngcontent-%COMP%]{background-color:#7c3aed!important}.mat-mdc-raised-button.mat-primary[_ngcontent-%COMP%]:hover{background-color:#6d28d9!important}.mat-mdc-raised-button.mat-primary[_ngcontent-%COMP%]:disabled{background-color:#9ca3af!important;color:#6b7280!important}.mat-mdc-form-field.mat-form-field-invalid[_ngcontent-%COMP%]   .mat-mdc-text-field-wrapper[_ngcontent-%COMP%]{border-color:#ef4444}@media (max-width: 768px){.grid-cols-2[_ngcontent-%COMP%], .grid-cols-3[_ngcontent-%COMP%]{grid-template-columns:1fr}.mat-mdc-dialog-container[_ngcontent-%COMP%]{margin:1rem;max-width:calc(100vw - 2rem)}}"]})};var xn=(r,t)=>t.room._id,fn=(r,t)=>t._id;function hn(r,t){if(r&1){let e=w();o(0,"mat-card",20),C("click",function(){let l=y(e).$implicit,d=c();return E(d.toggleCurrentRoomForSwap(l.room,!d.isCurrentRoomSelected(l.room._id)))}),o(1,"mat-card-content",21)(2,"div",22)(3,"div",23)(4,"div",24)(5,"mat-checkbox",25),C("change",function(l){let d=y(e).$implicit,p=c();return E(p.toggleCurrentRoomForSwap(d.room,l.checked))})("click",function(l){return y(e),E(l.stopPropagation())}),n(),o(6,"div")(7,"div",26),a(8),n(),o(9,"div",27),a(10),n()()(),o(11,"div",28)(12,"div"),a(13),n(),o(14,"div",29),a(15),f(16,"currency"),n(),o(17,"div",30),a(18),f(19,"currency"),n()()()()()()}if(r&2){let e=t.$implicit,i=c();T("!border-2",i.isCurrentRoomSelected(e.room._id))("!border-blue-500",i.isCurrentRoomSelected(e.room._id))("!bg-blue-50",i.isCurrentRoomSelected(e.room._id)),s(5),v("checked",i.isCurrentRoomSelected(e.room._id)),s(3),_("Room ",e.room.roomNumber),s(2),m(e.room.name),s(3),m((e.room.roomType==null?null:e.room.roomType.name)||"Standard"),s(2),_(" ",R(16,12,i.getRoomRate(e),i.data.currency),"/night "),s(3),_(" Total: ",R(19,15,i.getRoomTotalCost(e),i.data.currency)," ")}}function bn(r,t){r&1&&(o(0,"div",11)(1,"mat-icon",31),a(2,"info"),n(),o(3,"span"),a(4,"Select rooms you want to swap out"),n()())}function Cn(r,t){if(r&1&&(o(0,"mat-option",65)(1,"div",68)(2,"div",69)(3,"span",70),a(4),n(),o(5,"span",71),a(6,"\u2022"),n(),o(7,"span",72),a(8),n()(),o(9,"div",73)(10,"span",74),a(11),n(),o(12,"span",75),a(13),f(14,"currency"),n()()()()),r&2){let e=t.$implicit,i=c(3);v("value",e),s(4),_("Room ",e.roomNumber),s(4),m(e.name),s(3),_(" ",e.roomType==null?null:e.roomType.name," "),s(2),_(" ",R(14,5,i.getRoomRate(e),i.data.currency),"/night ")}}function yn(r,t){r&1&&(o(0,"mat-icon",85),a(1,"arrow_downward"),n())}function En(r,t){r&1&&(o(0,"mat-icon",85),a(1,"arrow_upward"),n())}function Sn(r,t){r&1&&(o(0,"mat-icon",85),a(1,"drag_handle"),n())}function Rn(r,t){if(r&1&&(o(0,"div",66)(1,"div",76)(2,"div",23)(3,"div",24)(4,"mat-icon",77),a(5,"check_circle"),n(),o(6,"span",78),a(7,"New Room"),n()(),o(8,"div",79)(9,"div",51)(10,"span",80),a(11),n(),o(12,"span",27),a(13),n()(),o(14,"div",81),a(15),n(),o(16,"div",82),a(17),f(18,"currency"),n()()(),o(19,"div",83)(20,"div",55),a(21,"Price Difference"),n(),o(22,"div",84),u(23,yn,2,0,"mat-icon",85)(24,En,2,0,"mat-icon",85)(25,Sn,2,0,"mat-icon",85),o(26,"span"),a(27),f(28,"currency"),n()()()()()),r&2){let e=c().$implicit,i=c(2);s(11),m(e.replacementRoom.roomNumber),s(2),m(e.replacementRoom.name),s(2),_(" ",e.replacementRoom.roomType==null?null:e.replacementRoom.roomType.name," "),s(2),_(" ",R(18,19,i.getRoomRate(e.replacementRoom),i.data.currency),"/night "),s(5),T("bg-green-100",e.priceDifference<0)("text-green-700",e.priceDifference<0)("bg-red-100",e.priceDifference>0)("text-red-700",e.priceDifference>0)("bg-gray-100",e.priceDifference===0)("text-gray-700",e.priceDifference===0),s(),g(e.priceDifference<0?23:e.priceDifference>0?24:25),s(4),N("",e.priceDifference>=0?"+":"","",R(28,22,e.priceDifference,i.data.currency))}}function kn(r,t){r&1&&(o(0,"div",67)(1,"mat-icon",86),a(2,"room_preferences"),n(),o(3,"p",87),a(4,"Select a replacement room from the dropdown above"),n()())}function Dn(r,t){if(r&1){let e=w();wt(0),o(1,"div",38)(2,"div",39)(3,"div",40)(4,"div",41)(5,"div",42),a(6),n()(),o(7,"button",43),C("click",function(){y(e);let l=rt(0),d=c(2);return E(d.removeSwapPair(l))}),o(8,"mat-icon",34),a(9,"close"),n()()(),o(10,"div",44)(11,"div",45)(12,"div",46)(13,"div",47)(14,"mat-icon",48),a(15,"meeting_room"),n(),o(16,"span",49),a(17,"Current Room"),n()(),o(18,"div",50)(19,"div",51)(20,"span",52),a(21),n(),o(22,"span",27),a(23),n()(),o(24,"div",41)(25,"div",53),a(26),n()(),o(27,"div",54)(28,"div",55),a(29,"Rate per Night"),n(),o(30,"div",56),a(31),f(32,"currency"),n()()()()(),o(33,"div",57)(34,"div",58)(35,"mat-icon",59),a(36,"arrow_forward"),n()()(),o(37,"div",60)(38,"div",61)(39,"div")(40,"label",62)(41,"mat-icon",63),a(42,"add_business"),n(),a(43," Select Replacement Room "),n(),o(44,"mat-form-field",13)(45,"mat-label"),a(46,"Choose a room"),n(),o(47,"mat-select",64),C("selectionChange",function(l){y(e);let d=rt(0),p=c(2);return E(p.assignReplacementRoom(d,l.value))}),U(48,Cn,15,8,"mat-option",65,fn),n()()(),u(50,Rn,29,25,"div",66)(51,kn,5,0,"div",67),n()()()()()}if(r&2){let e=t.$implicit,i=t.$index,l=c(2),d=e.currentRoom.room||e.currentRoom,p=Mt(d._id);s(6),_(" Swap #",i+1," "),s(15),m(d.roomNumber),s(2),m(d.name),s(3),_(" ",(d.roomType==null?null:d.roomType.name)||"Standard"," "),s(5),_(" ",R(32,9,l.getRoomRate(e.currentRoom),l.data.currency)," "),s(16),v("value",e.replacementRoom)("compareWith",l.compareRooms),s(),G(l.getAvailableRoomsForSpecificSwap(p)),s(2),g(e.replacementRoom?50:51)}}function Pn(r,t){if(r&1&&(o(0,"div",12)(1,"div",32)(2,"div",33)(3,"mat-icon",34),a(4,"swap_horiz"),n()(),o(5,"div")(6,"h3",35),a(7,"Step 2: Assign Replacement Rooms"),n(),o(8,"p",36),a(9,"Choose new rooms for the selected reservations"),n()()(),o(10,"div",37),U(11,Dn,52,12,"div",38,ve),n()()),r&2){let e=c();s(11),G(e.swapPairs())}}function wn(r,t){r&1&&(o(0,"mat-error"),a(1,"Reason is required"),n())}function Mn(r,t){r&1&&(o(0,"mat-error"),a(1,"Reason must be at least 10 characters"),n())}function In(r,t){r&1&&(o(0,"div",95)(1,"mat-icon",97),a(2,"info"),n(),a(3," Additional payment required "),n())}function On(r,t){if(r&1&&(o(0,"div",96)(1,"mat-icon",98),a(2,"info"),n(),a(3),f(4,"currency"),n()),r&2){let e=c(2);s(3),_(" Refund of ",R(4,1,e.Math.abs(e.priceDifference()),e.data.currency)," will be processed ")}}function Tn(r,t){if(r&1&&(o(0,"div",15)(1,"h4",88)(2,"mat-icon",89),a(3,"receipt"),n(),a(4," Pricing Summary "),n(),o(5,"div",50)(6,"div",90)(7,"span",89),a(8,"Current Total:"),n(),o(9,"span",91),a(10),f(11,"currency"),n()(),o(12,"div",90)(13,"span",89),a(14,"New Total:"),n(),o(15,"span",91),a(16),f(17,"currency"),n()(),k(18,"mat-divider",92),o(19,"div",93)(20,"span",94),a(21,"Difference:"),n(),o(22,"span"),a(23),f(24,"currency"),n()(),u(25,In,4,0,"div",95),u(26,On,5,4,"div",96),n()()),r&2){let e=c();s(10),m(R(11,12,e.currentTotal(),e.data.currency)),s(6),m(R(17,15,e.newTotal(),e.data.currency)),s(6),T("text-green-600",e.priceDifference()<0)("text-red-600",e.priceDifference()>0)("text-gray-600",e.priceDifference()===0),s(),N(" ",e.priceDifference()>=0?"+":"","",R(24,18,e.priceDifference(),e.data.currency)," "),s(2),g(e.priceDifference()>0?25:-1),s(),g(e.priceDifference()<0?26:-1)}}function Fn(r,t){r&1&&(o(0,"mat-icon",19),a(1,"refresh"),n())}var et=class r{dialogRef=b(me);fb=b(oe);roomsService=b(hi);reservationService=b(ue);storeService=b(ti);snackBar=b(_e);data=b(pe);subscriptions=new vt;roomChangeForm=this.fb.group({reason:["",[M.required,M.minLength(10)]]});availableRooms=P([]);loadingRooms=P(!0);submitting=P(!1);formValid=P(!1);swapPairs=P([]);selectedCurrentRooms=P([]);currentTotal=I(()=>{let t=this.data.currentRooms.reduce((e,i)=>{let l=this.getRoomTotalCost(i);return console.log("Current room cost calculation:",{room:i,roomRate:this.getRoomRate(i),nights:this.data.numberOfNights,totalCost:l}),e+l},0);return console.log("Current total calculated:",t),t});newTotal=I(()=>{let t=this.currentTotal(),e=this.swapPairs().reduce((i,l)=>i+l.priceDifference,0);return t+e});priceDifference=I(()=>this.swapPairs().reduce((t,e)=>t+e.priceDifference,0));hasValidSelections=I(()=>this.swapPairs().some(t=>t.replacementRoom!==null));canSubmit=I(()=>{let t=this.formValid(),e=this.submitting(),i=this.swapPairs();return console.log("canSubmit check:",{formValid:t,isSubmitting:e,swapPairsCount:i.length,swapPairs:i,allHaveReplacements:i.every(d=>d.replacementRoom!==null)}),!t||e||i.length===0?!1:i.every(d=>d.replacementRoom!==null)});Math=Math;compareRooms(t,e){return t&&e&&t._id===e._id}findOriginalReservationRoom(t){return this.data.currentRooms.find(e=>e.room._id===t)}ngOnInit(){console.log("Current rooms data structure:",this.data.currentRooms),this.loadAvailableRooms(),this.subscriptions.add(this.roomChangeForm.valueChanges.subscribe(()=>{this.formValid.set(this.roomChangeForm.valid),console.log("Form value changed:",{valid:this.roomChangeForm.valid,value:this.roomChangeForm.value})})),this.subscriptions.add(this.roomChangeForm.statusChanges.subscribe(()=>{this.formValid.set(this.roomChangeForm.valid),console.log("Form status changed:",{valid:this.roomChangeForm.valid,status:this.roomChangeForm.status})})),this.formValid.set(this.roomChangeForm.valid)}ngOnDestroy(){this.subscriptions.unsubscribe()}loadAvailableRooms(){return S(this,null,function*(){try{this.loadingRooms.set(!0);let t=this.storeService.getStoreLocally;if(!t)throw new Error("No store selected");let e=yield this.roomsService.getAvailableRooms({storeId:t._id,checkInDate:this.data.checkInDate,checkOutDate:this.data.checkOutDate,excludeReservationId:this.data.reservationId}).toPromise(),i=this.data.currentRooms.map(p=>p.room),d=[...e||[],...i].filter((p,h,D)=>h===D.findIndex(O=>O._id===p._id));this.availableRooms.set(d)}catch(t){console.error("Error loading available rooms:",t),this.snackBar.open("Failed to load available rooms","Close",{duration:3e3})}finally{this.loadingRooms.set(!1)}})}getRoomTotalCost(t){return this.getRoomRate(t)*this.data.numberOfNights}getRoomRate(t){let e=0,i="";return t.priceOverride!==null&&t.priceOverride!==void 0&&typeof t.priceOverride=="number"?(e=t.priceOverride,i="room.priceOverride"):t.rate&&typeof t.rate=="number"?(e=t.rate,i="room.rate"):t.room&&typeof t.room=="object"?t.room.priceOverride!==null&&t.room.priceOverride!==void 0&&typeof t.room.priceOverride=="number"?(e=t.room.priceOverride,i="room.room.priceOverride"):t.room.roomType?.basePrice?(e=t.room.roomType.basePrice,i="room.room.roomType.basePrice"):t.room.roomType?.baseRate&&(e=t.room.roomType.baseRate,i="room.room.roomType.baseRate"):t.roomType?.basePrice?(e=t.roomType.basePrice,i="room.roomType.basePrice"):t.roomType?.baseRate&&(e=t.roomType.baseRate,i="room.roomType.baseRate"),console.log("Room rate lookup:",{roomNumber:t.roomNumber||t.room?.roomNumber,roomId:t._id||t.room?._id,rate:e,source:i,roomStructure:{hasRate:!!t.rate,priceOverride:t.priceOverride,priceOverrideType:typeof t.priceOverride,priceOverrideIsNull:t.priceOverride===null,hasNestedRoom:!!t.room,nestedPriceOverride:t.room?.priceOverride,nestedPriceOverrideType:typeof t.room?.priceOverride,roomTypeBasePrice:t.roomType?.basePrice||t.room?.roomType?.basePrice}}),e===0&&console.warn("No room rate found for room:",t),e}isRoomSelected(t){return this.swapPairs().some(e=>(e.currentRoom.room?._id||e.currentRoom._id)===t)}isCurrentRoomSelected(t){return this.selectedCurrentRooms().some(e=>e._id===t)}toggleCurrentRoomForSwap(t,e){console.log("Toggle room swap - Room:",t._id,"Selected:",e);let i=this.selectedCurrentRooms();if(e){if(!i.some(l=>l._id===t._id)&&(this.selectedCurrentRooms.set([...i,t]),!this.swapPairs().find(d=>(d.currentRoom.room?._id||d.currentRoom._id)===t._id))){let p={currentRoom:this.data.currentRooms.find(h=>h.room._id===t._id)||{room:t},replacementRoom:null,priceDifference:0};this.swapPairs.set([...this.swapPairs(),p]),console.log("Created new swap pair for room:",t._id)}}else{this.selectedCurrentRooms.set(i.filter(d=>d._id!==t._id));let l=this.swapPairs().filter(d=>(d.currentRoom.room?._id||d.currentRoom._id)!==t._id);this.swapPairs.set(l),console.log("Removed swap pair for room:",t._id)}this.roomChangeForm.updateValueAndValidity()}assignReplacementRoom(t,e){console.log("=== ASSIGNING REPLACEMENT ROOM ==="),console.log("Current Room ID:",t),console.log("Replacement Room Object:",e);let i=this.swapPairs().map(l=>{let d=l.currentRoom.room?._id||l.currentRoom._id;if(d===t){let p=this.getRoomRate(l.currentRoom),h=this.getRoomRate(e),D=p*this.data.numberOfNights,ge=h*this.data.numberOfNights-D;return console.log("\u2705 Swap calculation:",{currentRoomId:d,oldRate:p,newRate:h,difference:ge,nights:this.data.numberOfNights}),Oe(Ie({},l),{replacementRoom:e,priceDifference:ge})}return l});this.swapPairs.set(i),this.roomChangeForm.updateValueAndValidity()}removeSwapPair(t){this.swapPairs.set(this.swapPairs().filter(e=>(e.currentRoom.room?._id||e.currentRoom._id)!==t)),this.selectedCurrentRooms.set(this.selectedCurrentRooms().filter(e=>e._id!==t))}getSwapPairForCurrentRoom(t){return this.swapPairs().find(e=>e.currentRoom._id===t)}isReplacementRoomUsed(t){return this.swapPairs().some(e=>e.replacementRoom?._id===t)}getAvailableRoomsForSwap(){let t=this.swapPairs().map(e=>e.replacementRoom?._id).filter(Boolean);return this.availableRooms().filter(e=>!t.includes(e._id))}getAvailableRoomsForSpecificSwap(t){let e=this.selectedCurrentRooms().find(l=>l._id===t),i=this.swapPairs().filter(l=>(l.currentRoom.room?._id||l.currentRoom._id)!==t).map(l=>l.replacementRoom?._id).filter(Boolean);return this.availableRooms().filter(l=>!i.includes(l._id)&&l._id!==t)}onSubmit(){return S(this,null,function*(){if(this.canSubmit())try{if(this.submitting.set(!0),this.swapPairs().filter(p=>{let h=p.currentRoom.room?._id||p.currentRoom._id,D=p.replacementRoom?._id;return h===D}).length>0){this.snackBar.open("Cannot swap a room with itself. Please select different rooms.","Close",{duration:5e3});return}console.log("=== SWAP PAIRS DEBUG ==="),console.log("Original swap pairs:",this.swapPairs());let e=this.swapPairs().map(p=>{let h=p.currentRoom.room||p.currentRoom,D=p.replacementRoom;return{currentRoomId:p.currentRoom._id||h._id,room:D._id,guests:p.currentRoom.guests||{adults:1,children:0},currentRoomDetails:{roomNumber:h.roomNumber,name:h.name,rate:this.getRoomRate(p.currentRoom)},newRoomDetails:{roomNumber:D.roomNumber,name:D.name,rate:this.getRoomRate(D),priceOverride:D.priceOverride},priceDifference:p.priceDifference}});console.log("New rooms array for swap mode:",e);let i=this.swapPairs().map(p=>{let h=p.currentRoom.room||p.currentRoom,D=p.replacementRoom,O=this.data.currency;return`Room ${h.roomNumber} (${h.name}) \u2192 Room ${D.roomNumber} (${D.name}). Price difference: ${O}${p.priceDifference.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}`}).join("; "),l=`Room swap completed. ${i}. Reason: ${this.roomChangeForm.get("reason")?.value}`;console.log("Generated internal note:",l),console.log("Swap summary details:",i);let d={mode:"swap",newRooms:e,swapPairs:this.swapPairs(),pricingAdjustment:{oldTotal:this.currentTotal(),newTotal:this.newTotal(),difference:this.priceDifference(),requiresPayment:this.priceDifference()>0,refundAmount:this.priceDifference()<0?Math.abs(this.priceDifference()):void 0},reason:this.roomChangeForm.get("reason")?.value,suggestedInternalNote:l,roomMapping:this.swapPairs().map(p=>{let h=p.currentRoom.room||p.currentRoom,D=p.replacementRoom;return{fromRoomId:p.currentRoom._id||h._id,fromRoomNumber:h.roomNumber,fromRoomName:h.name,toRoomId:D._id,toRoomNumber:D.roomNumber,toRoomName:D.name,priceDifference:p.priceDifference}})};console.log("Final swap mode payload:",d),this.dialogRef.close(d)}catch(t){console.error("Error submitting room change:",t),this.snackBar.open("Failed to process room change","Close",{duration:3e3})}finally{this.submitting.set(!1)}})}onCancel(){this.dialogRef.close()}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=B({type:r,selectors:[["app-room-change-dialog"]],decls:31,vars:10,consts:[[1,"room-change-dialog"],["mat-dialog-title","",1,"text-2xl","font-bold","text-gray-900","mb-2"],[1,"text-sm","text-gray-600","mb-6"],[1,"!max-h-[70vh]","!overflow-y-auto"],[1,"space-y-6",3,"formGroup"],[1,"space-y-6"],[1,"bg-blue-50","border","border-blue-200","rounded-lg","p-4"],[1,"text-lg","font-semibold","text-blue-900","mb-3","flex","items-center","gap-2"],[1,"text-blue-600"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-3"],[1,"cursor-pointer","transition-all","duration-200","hover:shadow-md",3,"!border-2","!border-blue-500","!bg-blue-50"],[1,"mt-3","text-sm","text-blue-600","flex","items-center","gap-2"],[1,"bg-gradient-to-br","from-green-50","to-emerald-50","border-2","border-green-300","rounded-xl","p-6","shadow-sm"],["appearance","outline",1,"w-full"],["matInput","","formControlName","reason","rows","3","placeholder","Enter the reason for changing rooms (minimum 10 characters)"],[1,"bg-gray-50","border","border-gray-200","rounded-lg","p-4"],["align","end",1,"!p-6","!border-t","!border-gray-200"],["type","button","mat-stroked-button","",3,"click","disabled"],["type","button","mat-raised-button","","color","primary",3,"click","disabled"],[1,"animate-spin","mr-2"],[1,"cursor-pointer","transition-all","duration-200","hover:shadow-md",3,"click"],[1,"!p-4"],[1,"flex","items-start","justify-between"],[1,"flex-1"],[1,"flex","items-center","gap-2","mb-2"],["color","primary",3,"change","click","checked"],[1,"font-semibold","text-gray-900"],[1,"text-sm","text-gray-600"],[1,"text-sm","text-gray-600","ml-8"],[1,"font-medium","text-gray-900","mt-1"],[1,"text-xs","text-gray-500"],[1,"text-sm"],[1,"flex","items-center","gap-3","mb-5"],[1,"bg-green-500","text-white","rounded-full","p-2"],[1,"!text-xl"],[1,"text-xl","font-bold","text-green-900"],[1,"text-sm","text-green-700"],[1,"space-y-4"],[1,"bg-white","rounded-lg","shadow-md","border","border-gray-200","overflow-hidden","transition-all","duration-200","hover:shadow-lg"],[1,"p-5"],[1,"flex","items-center","justify-between","mb-4","pb-3","border-b","border-gray-200"],[1,"flex","items-center","gap-2"],[1,"bg-blue-100","text-blue-700","rounded-full","px-3","py-1","text-xs","font-semibold"],["type","button","title","Remove this swap",1,"text-red-500","hover:text-red-700","hover:bg-red-50","rounded-full","p-2","transition-colors","duration-200",3,"click"],[1,"grid","grid-cols-1","lg:grid-cols-12","gap-4","items-center"],[1,"lg:col-span-4"],[1,"bg-gradient-to-br","from-gray-50","to-gray-100","rounded-lg","p-4","border-2","border-gray-300"],[1,"flex","items-center","gap-2","mb-3"],[1,"text-gray-500","!text-lg"],[1,"text-xs","font-semibold","text-gray-500","uppercase","tracking-wide"],[1,"space-y-2"],[1,"flex","items-baseline","gap-2"],[1,"text-2xl","font-bold","text-gray-900"],[1,"bg-white","px-2","py-1","rounded","text-xs","font-medium","text-gray-700","border","border-gray-300"],[1,"pt-2","border-t","border-gray-300"],[1,"text-xs","text-gray-500","mb-1"],[1,"text-lg","font-bold","text-gray-900"],[1,"lg:col-span-1","flex","justify-center","items-center"],[1,"bg-green-500","text-white","rounded-full","p-3","shadow-md"],[1,"!text-2xl"],[1,"lg:col-span-7"],[1,"space-y-3"],[1,"block","text-sm","font-semibold","text-gray-700","mb-2","flex","items-center","gap-2"],[1,"!text-lg","text-green-600"],[1,"!text-base",3,"selectionChange","value","compareWith"],[3,"value"],[1,"bg-gradient-to-br","from-green-50","to-emerald-50","rounded-lg","p-4","border-2","border-green-300"],[1,"bg-gray-50","border-2","border-dashed","border-gray-300","rounded-lg","p-4","text-center"],[1,"flex","flex-col","py-2"],[1,"flex","items-center","gap-2","mb-1"],[1,"font-bold","text-gray-900"],[1,"text-gray-500"],[1,"text-gray-700"],[1,"flex","items-center","gap-3"],[1,"text-xs","bg-blue-100","text-blue-700","px-2","py-0.5","rounded","font-medium"],[1,"text-sm","font-bold","text-green-600"],[1,"flex","items-start","justify-between","gap-4"],[1,"text-green-600","!text-lg"],[1,"text-xs","font-semibold","text-green-700","uppercase","tracking-wide"],[1,"space-y-1"],[1,"text-xl","font-bold","text-gray-900"],[1,"text-sm","text-gray-700"],[1,"text-base","font-bold","text-gray-900"],[1,"text-right"],[1,"inline-flex","items-center","gap-1","px-3","py-2","rounded-lg","font-bold","text-lg"],[1,"!text-lg"],[1,"text-gray-400","!text-3xl","mb-2"],[1,"text-sm","text-gray-500","font-medium"],[1,"font-semibold","text-gray-900","mb-3","flex","items-center","gap-2"],[1,"text-gray-600"],[1,"flex","justify-between","text-sm"],[1,"font-medium","text-gray-900"],[1,"!my-2"],[1,"flex","justify-between","text-base","font-semibold"],[1,"text-gray-900"],[1,"mt-3","p-3","bg-red-50","border","border-red-200","rounded","text-sm","text-red-700"],[1,"mt-3","p-3","bg-green-50","border","border-green-200","rounded","text-sm","text-green-700"],[1,"text-red-600","text-sm","mr-1","align-middle"],[1,"text-green-600","text-sm","mr-1","align-middle"]],template:function(e,i){if(e&1&&(o(0,"div",0)(1,"h2",1),a(2,"Swap Rooms"),n(),o(3,"p",2),a(4,"Select rooms to swap and assign their replacements"),n(),o(5,"mat-dialog-content",3)(6,"form",4)(7,"div",5)(8,"div",6)(9,"h3",7)(10,"mat-icon",8),a(11,"check_circle"),n(),a(12," Step 1: Select Rooms to Swap "),n(),o(13,"div",9),U(14,hn,20,18,"mat-card",10,xn),n(),u(16,bn,5,0,"div",11),n(),u(17,Pn,13,0,"div",12),o(18,"mat-form-field",13)(19,"mat-label"),a(20,"Reason for Room Change"),n(),k(21,"textarea",14),u(22,wn,2,0,"mat-error"),u(23,Mn,2,0,"mat-error"),n(),u(24,Tn,27,21,"div",15),n()()(),o(25,"mat-dialog-actions",16)(26,"button",17),C("click",function(){return i.onCancel()}),a(27," Cancel "),n(),o(28,"button",18),C("click",function(){return i.onSubmit()}),u(29,Fn,2,0,"mat-icon",19),a(30),n()()()),e&2){let l,d;s(6),v("formGroup",i.roomChangeForm),s(8),G(i.data.currentRooms),s(2),g(i.selectedCurrentRooms().length===0?16:-1),s(),g(i.swapPairs().length>0?17:-1),s(5),g((l=i.roomChangeForm.get("reason"))!=null&&l.hasError("required")?22:-1),s(),g((d=i.roomChangeForm.get("reason"))!=null&&d.hasError("minlength")?23:-1),s(),g(i.swapPairs().length>0?24:-1),s(2),v("disabled",i.submitting()),s(2),v("disabled",!i.canSubmit()),s(),g(i.submitting()?29:-1),s(),_(" ",i.submitting()?"Processing...":"Change Rooms"," ")}},dependencies:[j,K,ae,te,J,X,ee,ie,ne,H,Ee,Re,Se,$,se,re,Ve,ke,je,Be,de,le,q,Y,z,L,he,Xt,ei,fi,xi,ce,ye,De,Wt],encapsulation:2})};var An=(r,t,e)=>({"bg-yellow-100 text-yellow-700 border-yellow-200":r,"bg-green-100 text-green-700 border-green-200":t,"bg-red-100 text-red-700 border-red-200":e}),Bn=(r,t,e)=>({"bg-green-100 text-green-800":r,"bg-yellow-100 text-yellow-800":t,"bg-red-100 text-red-800":e}),Di=(r,t)=>t.value,Nn=(r,t)=>t._id||r;function Vn(r,t){if(r&1&&(o(0,"h1",40),a(1," Reservation Details "),n(),o(2,"p",41),a(3),n()),r&2){let e=c();s(3),_("Confirmation: ",e.reservation().confirmationNumber)}}function Un(r,t){r&1&&(o(0,"h1",40),a(1,"Reservation Details"),n(),o(2,"p",41),a(3,"Loading reservation information..."),n())}function Gn(r,t){r&1&&(o(0,"mat-icon",44),a(1,"refresh"),n())}function jn(r,t){if(r&1&&(o(0,"mat-icon",53),a(1),n()),r&2){let e=c(2);Pe("color",e.getStatusColor(e.reservation().status)),s(),m(e.getStatusIcon(e.reservation().status))}}function qn(r,t){r&1&&(o(0,"div",24),a(1," No status changes available "),n())}function $n(r,t){if(r&1){let e=w();o(0,"button",54),C("click",function(){let l=y(e).$implicit,d=c(2);return E(d.updateReservationStatus(l.value))}),o(1,"mat-icon",55),a(2),n(),o(3,"span"),a(4),n()()}if(r&2){let e=t.$implicit;s(),Pe("color",e.color),s(),m(e.icon),s(2),m(e.label)}}function Ln(r,t){r&1&&(o(0,"div",48),a(1," \u{1F4A1} Confirm reservation before check-in "),n())}function zn(r,t){r&1&&(o(0,"div",49),a(1," \u{1F4A1} Ready for check-in "),n())}function Hn(r,t){if(r&1){let e=w();o(0,"button",56),C("click",function(){y(e);let l=c(2);return E(l.editReservation())}),o(1,"mat-icon",57),a(2,"edit"),n(),a(3," Edit Reservation "),n()}}function Wn(r,t){if(r&1){let e=w();o(0,"button",58),C("click",function(){y(e);let l=c(2);return E(l.requestExtension())}),o(1,"mat-icon",57),a(2,"schedule"),n(),a(3," Extend Stay "),n()}if(r&2){let e=c(2);v("disabled",e.statusUpdating())}}function Qn(r,t){if(r&1&&(o(0,"div",10)(1,"div",42)(2,"button",43),u(3,Gn,2,0,"mat-icon",44)(4,jn,2,3,"mat-icon",45),a(5),f(6,"titlecase"),o(7,"mat-icon",46),a(8,"expand_more"),n()(),o(9,"mat-menu",13,4)(11,"div",22),a(12," Change Status "),n(),u(13,qn,2,0,"div",24),U(14,$n,5,4,"button",47,Di),u(16,Ln,2,0,"div",48),u(17,zn,2,0,"div",49),n()(),u(18,Hn,4,0,"button",50),u(19,Wn,4,1,"button",51),o(20,"button",52)(21,"mat-icon"),a(22,"more_vert"),n()()()),r&2){let e=Z(10),i=c(),l=Z(15);s(2),Pe("background-color",i.getStatusColor(i.reservation().status)+"20")("color",i.getStatusColor(i.reservation().status))("border-color",i.getStatusColor(i.reservation().status)+"40"),v("matMenuTriggerFor",e)("disabled",i.statusUpdating()),s(),g(i.statusUpdating()?3:4),s(2),_(" ",V(6,16,i.reservation().status)," "),s(8),g(i.getAvailableStatusOptions().length===0?13:-1),s(),G(i.getAvailableStatusOptions()),s(2),g(i.reservation()&&i.reservation().status==="pending"?16:-1),s(),g(i.reservation()&&i.reservation().status==="confirmed"?17:-1),s(),g(i.canEdit()?18:-1),s(),g(i.canRequestExtension()?19:-1),s(),v("matMenuTriggerFor",l)}}function Zn(r,t){r&1&&(o(0,"div",11),k(1,"mat-spinner",59),o(2,"span",60),a(3,"Loading reservation details..."),n()())}function Kn(r,t){if(r&1){let e=w();o(0,"div",12)(1,"div",61)(2,"div",62)(3,"mat-icon",63),a(4,"error_outline"),n()(),o(5,"h3",64),a(6,"Failed to Load Reservation"),n(),o(7,"p",65),a(8),n(),o(9,"button",66),C("click",function(){y(e);let l=c();return E(l.goBack())}),a(10," Back to Reservations "),n()()()}if(r&2){let e=c();s(8),m(e.error())}}function Yn(r,t){if(r&1&&(o(0,"div",41),a(1),n()),r&2){let e=c(2);s(),_("Expected: ",e.reservation().expectedCheckInTime)}}function Jn(r,t){if(r&1&&(o(0,"div",41),a(1),n()),r&2){let e=c(2);s(),_("Expected: ",e.reservation().expectedCheckOutTime)}}function Xn(r,t){if(r&1&&(o(0,"div",117)(1,"label",75),a(2,"Notes"),n(),o(3,"div",120),a(4),n()()),r&2){let e=c().$implicit;s(4),m(e.notes)}}function eo(r,t){r&1&&(o(0,"mat-icon",44),a(1,"refresh"),n())}function to(r,t){r&1&&(o(0,"mat-icon",53),a(1,"check_circle"),n())}function io(r,t){r&1&&(o(0,"mat-icon",44),a(1,"refresh"),n())}function no(r,t){r&1&&(o(0,"mat-icon",53),a(1,"cancel"),n())}function oo(r,t){if(r&1){let e=w();o(0,"div",118)(1,"button",121),C("click",function(){y(e);let l=c().$implicit,d=c(3);return E(d.approveExtension(l._id))}),u(2,eo,2,0,"mat-icon",44)(3,to,2,0,"mat-icon",53),a(4," Approve Extension "),n(),o(5,"button",122),C("click",function(){y(e);let l=c().$implicit,d=c(3);return E(d.rejectExtension(l._id))}),u(6,io,2,0,"mat-icon",44)(7,no,2,0,"mat-icon",53),a(8," Reject Extension "),n()()}if(r&2){let e=c().$implicit,i=c(3);s(),v("disabled",i.processingExtension()===e._id),s(),g(i.processingExtension()===e._id&&i.processingAction()==="approve"?2:3),s(3),v("disabled",i.processingExtension()===e._id),s(),g(i.processingExtension()===e._id&&i.processingAction()==="reject"?6:7)}}function ao(r,t){if(r&1&&(o(0,"div")(1,"span",93),a(2,"Reference:"),n(),o(3,"span",130),a(4),n()()),r&2){let e=c(3).$implicit;s(4),m(e.paymentInfo.transactionReference)}}function ro(r,t){if(r&1&&(o(0,"div",129)(1,"span",131),a(2,"Payment Notes:"),n(),o(3,"div",132),a(4),n()()),r&2){let e=c(3).$implicit;s(4),m(e.paymentInfo.notes)}}function so(r,t){if(r&1&&(o(0,"div",124)(1,"div",125)(2,"mat-icon",53),a(3,"payment"),n(),o(4,"span",99),a(5,"Payment Information"),n()(),o(6,"div",126)(7,"div")(8,"span",93),a(9,"Status:"),n(),o(10,"span",127),a(11),f(12,"titlecase"),n()(),o(13,"div")(14,"span",93),a(15,"Method:"),n(),o(16,"span",128),a(17),f(18,"titlecase"),n()(),o(19,"div")(20,"span",93),a(21,"Amount:"),n(),o(22,"span",128),a(23),f(24,"currency"),n()(),u(25,ao,5,1,"div"),n(),u(26,ro,5,1,"div",129),n()),r&2){let e,i=c(2).$implicit,l=c(3);s(10),v("ngClass",st(13,Bn,i.paymentInfo.status==="paid",i.paymentInfo.status==="partial",i.paymentInfo.status==="pending")),s(),_(" ",V(12,6,i.paymentInfo.status)," "),s(6),m(V(18,8,i.paymentInfo.method)),s(6),m(R(24,10,i.paymentInfo.amount,(e=l.storeStore.selectedStore())==null?null:e.currency)),s(2),g(i.paymentInfo.transactionReference?25:-1),s(),g(i.paymentInfo.notes?26:-1)}}function lo(r,t){if(r&1&&(o(0,"div",123)(1,"mat-icon",53),a(2,"check_circle"),n(),a(3),n(),u(4,so,27,17,"div",124)),r&2){let e=c().$implicit,i=c(3);s(3),_(" Approved on ",i.formatExtensionDate(e.approvedAt)," "),s(),g(e.paymentInfo?4:-1)}}function co(r,t){if(r&1&&(o(0,"div",135),a(1),n()),r&2){let e=c(2).$implicit,i=c(3);s(),_("Rejected on ",i.formatExtensionDate(e.rejectedAt))}}function mo(r,t){if(r&1&&(o(0,"div",119)(1,"div",133)(2,"mat-icon",53),a(3,"cancel"),n(),a(4," Rejection Reason "),n(),o(5,"div",134),a(6),n(),u(7,co,2,1,"div",135),n()),r&2){let e=c().$implicit;s(6),m(e.rejectionReason),s(),g(e.rejectedAt?7:-1)}}function po(r,t){if(r&1&&(o(0,"div",107)(1,"div",109)(2,"div",10)(3,"div",110)(4,"mat-icon",111),a(5,"hotel_class"),n()(),o(6,"div")(7,"h4",94),a(8,"Extension Request"),n(),o(9,"p",41),a(10),n()()(),o(11,"span",112),a(12),f(13,"titlecase"),n()(),o(14,"div",113)(15,"div")(16,"label",75),a(17,"Original Check-out"),n(),o(18,"div",114),a(19),n()(),o(20,"div")(21,"label",75),a(22,"Extended Check-out"),n(),o(23,"div",115),a(24),n()(),o(25,"div")(26,"label",75),a(27,"Additional Nights"),n(),o(28,"div",114),a(29),n()(),o(30,"div")(31,"label",75),a(32,"Extension Cost"),n(),o(33,"div",116),a(34),f(35,"currency"),n()()(),u(36,Xn,5,1,"div",117),u(37,oo,9,4,"div",118),u(38,lo,5,2),u(39,mo,8,2,"div",119),n()),r&2){let e,i=t.$implicit,l=c(3);s(10),m(l.formatExtensionDate(i.requestedAt)),s(),v("ngClass",st(17,An,i.status==="pending",i.status==="approved",i.status==="rejected")),s(),_(" ",V(13,12,i.status)," "),s(7),m(l.formatExtensionDate(i.originalCheckOutDate)),s(5),m(l.formatExtensionDate(i.newCheckOutDate)),s(5),N("",i.additionalNights," night",i.additionalNights>1?"s":""),s(5),m(R(35,14,i.additionalCost,(e=l.storeStore.selectedStore())==null?null:e.currency)),s(2),g(i.notes?36:-1),s(),g(i.status==="pending"?37:-1),s(),g(i.status==="approved"&&i.approvedAt?38:-1),s(),g(i.status==="rejected"&&i.rejectionReason?39:-1)}}function uo(r,t){if(r&1&&(o(0,"div",108)(1,"div",136)(2,"mat-icon",77),a(3,"check_circle"),n(),o(4,"span",137),a(5,"Active Extension"),n()(),o(6,"div",138)(7,"p"),a(8,"Total extension cost: "),o(9,"strong"),a(10),f(11,"currency"),n()(),o(12,"p"),a(13,"Total additional nights: "),o(14,"strong"),a(15),n()()()()),r&2){let e,i=c(3);s(10),m(R(11,2,i.getTotalExtensionCost(),(e=i.storeStore.selectedStore())==null?null:e.currency)),s(5),m(i.getTotalExtensionNights())}}function go(r,t){if(r&1&&(o(0,"div",69)(1,"div",103)(2,"h3",71)(3,"mat-icon",104),a(4,"schedule"),n(),a(5," Stay Extensions "),o(6,"span",105),a(7),n()()(),o(8,"div",73)(9,"div",106),U(10,po,40,21,"div",107,Nn),n(),u(12,uo,16,5,"div",108),n()()),r&2){let e=c(2);s(7),N(" ",e.getExtensions().length," Extension",e.getExtensions().length>1?"s":""," "),s(3),G(e.getExtensions()),s(2),g(e.hasActiveExtension()?12:-1)}}function vo(r,t){if(r&1){let e=w();o(0,"button",139),C("click",function(){y(e);let l=c(2);return E(l.openRoomChangeDialog())}),o(1,"mat-icon"),a(2,"swap_horiz"),n()()}}function _o(r,t){if(r&1&&(o(0,"tr",85)(1,"td",140),a(2),n(),o(3,"td",141),a(4),n(),o(5,"td",141),a(6),n(),o(7,"td",141),a(8),n(),o(9,"td",140),a(10),f(11,"currency"),n()()),r&2){let e,i=t.$implicit,l=c(2);s(2),m(i.roomNumber+" ("+i.name+")"),s(2),m(i.roomType),s(2),m(i.adults),s(2),m(i.children),s(2),m(R(11,5,i.rate,(e=l.storeStore.selectedStore())==null?null:e.currency))}}function xo(r,t){r&1&&(o(0,"span",89),a(1,"(Locked)"),n())}function fo(r,t){if(r&1&&(o(0,"div",92)(1,"span",93),a(2,"Service Fee"),n(),o(3,"span",94),a(4),f(5,"currency"),n()()),r&2){let e,i=c(2);s(4),m(R(5,1,(e=i.reservation().pricing.fees)==null?null:e.serviceFee,(e=i.storeStore.selectedStore())==null?null:e.currency))}}function ho(r,t){if(r&1&&(o(0,"div",92)(1,"span",93),a(2,"Cleaning Fee"),n(),o(3,"span",94),a(4),f(5,"currency"),n()()),r&2){let e,i=c(2);s(4),m(R(5,1,(e=i.reservation().pricing.fees)==null?null:e.cleaningFee,(e=i.storeStore.selectedStore())==null?null:e.currency))}}function bo(r,t){if(r&1&&(o(0,"div",92)(1,"span",93),a(2,"Resort Fee"),n(),o(3,"span",94),a(4),f(5,"currency"),n()()),r&2){let e,i=c(2);s(4),m(R(5,1,(e=i.reservation().pricing.fees)==null?null:e.resortFee,(e=i.storeStore.selectedStore())==null?null:e.currency))}}function Co(r,t){if(r&1&&(o(0,"div",92)(1,"span",93),a(2,"Discount"),n(),o(3,"span",98),a(4),f(5,"currency"),n()()),r&2){let e,i=c(2);s(4),_("-",R(5,1,(e=i.reservation().pricing.discounts)==null?null:e.amount,(e=i.storeStore.selectedStore())==null?null:e.currency))}}function yo(r,t){if(r&1&&(o(0,"div",92)(1,"span",93),a(2),n(),o(3,"span",142),a(4),f(5,"currency"),n()()),r&2){let e,i=c(2);s(2),_("Extensions (",i.getTotalExtensionNights()," nights)"),s(2),_("+",R(5,2,i.getTotalExtensionCost(),(e=i.storeStore.selectedStore())==null?null:e.currency))}}function Eo(r,t){r&1&&(o(0,"span",89),a(1,"(Locked)"),n())}function So(r,t){if(r&1&&(o(0,"button",143)(1,"mat-icon"),a(2,"more_vert"),n()()),r&2){c(3);let e=Z(39);v("matMenuTriggerFor",e)}}function Ro(r,t){r&1&&(o(0,"div",144)(1,"mat-icon"),a(2,"lock"),n()())}function ko(r,t){r&1&&(o(0,"mat-icon",146),a(1,"refresh"),n())}function Do(r,t){if(r&1&&(o(0,"div")(1,"label",75),a(2,"Last Transaction"),n(),o(3,"div",114),a(4),f(5,"currency"),n()()),r&2){let e,i=c(3);s(4),N(" ",R(5,2,i.transactionHistory()[i.transactionHistory().length-1].amount,(e=i.storeStore.selectedStore())==null?null:e.currency)," on ",i.formatDateTime(i.transactionHistory()[i.transactionHistory().length-1].date)," ")}}function Po(r,t){if(r&1&&(o(0,"div",69)(1,"div",70)(2,"div",88)(3,"h3",71)(4,"mat-icon"),a(5),n(),a(6," Payment Information "),u(7,Eo,2,0,"span",89),n(),u(8,So,3,1,"button",143)(9,Ro,3,0,"div",144),n()(),o(10,"div",73)(11,"div",91)(12,"div")(13,"label",75),a(14,"Payment Method"),n(),o(15,"div",114),a(16),f(17,"titlecase"),n()(),o(18,"div")(19,"label",75),a(20,"Payment Status"),n(),o(21,"div",145),u(22,ko,2,0,"mat-icon",146),o(23,"span",147),a(24),f(25,"titlecase"),n()()(),u(26,Do,6,5,"div"),n()()()),r&2){let e,i,l,d=c(2);s(4),T("text-indigo-600",!d.isCheckedOut())("text-gray-400",d.isCheckedOut()),s(),_(" ",d.isCheckedOut()?"lock":"credit_card"," "),s(2),g(d.isCheckedOut()?7:-1),s(),g(d.canEditPaymentInfo()?8:d.isCheckedOut()?9:-1),s(8),m(V(17,13,(e=d.reservation().paymentInfo)==null?null:e.method)),s(6),g(d.statusUpdating()?22:-1),s(),W(((i=d.reservation().paymentInfo)==null?null:i.status)==="paid"?"bg-green-100 text-green-800":((i=d.reservation().paymentInfo)==null?null:i.status)==="refunded"?"bg-gray-100 text-gray-800":"bg-yellow-100 text-yellow-800"),s(),_(" ",V(25,15,(l=d.reservation().paymentInfo)==null?null:l.status)," "),s(2),g(d.transactionHistory().length>0?26:-1)}}function wo(r,t){if(r&1&&(o(0,"tr",85)(1,"td",141),a(2),n(),o(3,"td",140),a(4),f(5,"currency"),n(),o(6,"td",141),a(7),f(8,"titlecase"),n(),o(9,"td",141),a(10),n(),o(11,"td",148)(12,"span",147),a(13),f(14,"titlecase"),n()()()),r&2){let e,i=t.$implicit,l=c(3);s(2),m(l.formatDateTime(i.date)),s(2),m(R(5,7,i.amount,(e=l.storeStore.selectedStore())==null?null:e.currency)),s(3),m(V(8,10,i.method)),s(3),m(i.reference),s(2),W(i.status==="completed"?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"),s(),_(" ",V(14,12,i.status)," ")}}function Mo(r,t){if(r&1&&(o(0,"div",69)(1,"div",70)(2,"h3",71)(3,"mat-icon",77),a(4,"receipt"),n(),a(5," Transaction History "),n()(),o(6,"div",73)(7,"div",81)(8,"table",82)(9,"thead")(10,"tr",83)(11,"th",84),a(12,"Date"),n(),o(13,"th",84),a(14,"Amount"),n(),o(15,"th",84),a(16,"Method"),n(),o(17,"th",84),a(18,"Reference"),n(),o(19,"th",84),a(20,"Status"),n()()(),o(21,"tbody"),U(22,wo,15,14,"tr",85,ve),n()()()()()),r&2){let e=c(2);s(22),G(e.transactionHistory())}}function Io(r,t){if(r&1&&(o(0,"div",69)(1,"div",70)(2,"h3",71)(3,"mat-icon",72),a(4,"message"),n(),a(5," Special Requests "),n()(),o(6,"div",73)(7,"p",149),a(8),n()()()),r&2){let e=c(3);s(8),m(e.reservation().specialRequests)}}function Oo(r,t){if(r&1&&(o(0,"div",69)(1,"div",70)(2,"h3",71)(3,"mat-icon",104),a(4,"note"),n(),a(5," Internal Notes "),n()(),o(6,"div",73)(7,"p",149),a(8),n()()()),r&2){let e=c(3);s(8),m(e.reservation().internalNotes)}}function To(r,t){if(r&1&&(o(0,"div",101),u(1,Io,9,1,"div",69),u(2,Oo,9,1,"div",69),n()),r&2){let e=c(2);s(),g(e.reservation().specialRequests?1:-1),s(),g(e.reservation().internalNotes?2:-1)}}function Fo(r,t){if(r&1&&(o(0,"div",41),a(1),n()),r&2){let e=c().$implicit;s(),_("Age: ",e.age)}}function Ao(r,t){if(r&1&&(o(0,"div",41),a(1),n()),r&2){let e=c().$implicit;s(),m(e.relationship)}}function Bo(r,t){if(r&1&&(o(0,"div",151)(1,"div",94),a(2),n(),u(3,Fo,2,1,"div",41),u(4,Ao,2,1,"div",41),n()),r&2){let e=t.$implicit;s(2),N("",e.firstName," ",e.lastName),s(),g(e.age?3:-1),s(),g(e.relationship?4:-1)}}function No(r,t){if(r&1&&(o(0,"div",69)(1,"div",70)(2,"h3",71)(3,"mat-icon",77),a(4,"group"),n(),a(5," Additional Guests "),n()(),o(6,"div",73)(7,"div",150),U(8,Bo,5,4,"div",151,ve),n()()()),r&2){let e=c(2);s(8),G(e.reservation().guestDetails.additionalGuests)}}function Vo(r,t){if(r&1&&(o(0,"div")(1,"label",75),a(2,"Last Updated"),n(),o(3,"div",41),a(4),n()()),r&2){let e=c(2);s(4),m(e.formatDateTime(e.reservation().updatedAt))}}function Uo(r,t){if(r&1&&(o(0,"div")(1,"label",75),a(2,"Actual Check-in"),n(),o(3,"div",41),a(4),n()()),r&2){let e=c(2);s(4),m(e.formatDateTime(e.reservation().actualCheckInDate))}}function Go(r,t){if(r&1&&(o(0,"div")(1,"label",75),a(2,"Actual Check-out"),n(),o(3,"div",41),a(4),n()()),r&2){let e=c(2);s(4),m(e.formatDateTime(e.reservation().actualCheckOutDate))}}function jo(r,t){if(r&1&&(o(0,"div")(1,"label",155),a(2,"Refund Amount"),n(),o(3,"div",156),a(4),f(5,"currency"),n()()),r&2){let e,i=c(3);s(4),m(R(5,1,i.getRefundAmount(),(e=i.storeStore.selectedStore())==null?null:e.currency))}}function qo(r,t){if(r&1&&(o(0,"div")(1,"label",155),a(2,"Cancellation Fee"),n(),o(3,"div",156),a(4),f(5,"currency"),n()()),r&2){let e,i=c(3);s(4),m(R(5,1,i.getCancellationFee(),(e=i.storeStore.selectedStore())==null?null:e.currency))}}function $o(r,t){if(r&1&&(o(0,"div",102)(1,"div",152)(2,"h3",153)(3,"mat-icon",154),a(4,"cancel"),n(),a(5," Cancellation Information "),n()(),o(6,"div",73)(7,"div",74)(8,"div")(9,"label",155),a(10,"Cancelled"),n(),o(11,"div",156),a(12),n()(),o(13,"div")(14,"label",155),a(15,"Reason"),n(),o(16,"div",156),a(17),n()(),u(18,jo,6,4,"div"),u(19,qo,6,4,"div"),n()()()),r&2){let e=c(2);s(12),m(e.formatDateTime(e.reservation().cancellation.cancelledAt)),s(5),m(e.reservation().cancellation.reason),s(),g(e.hasRefundAmount()?18:-1),s(),g(e.hasCancellationFee()?19:-1)}}function Lo(r,t){if(r&1){let e=w();o(0,"div",12)(1,"div",67)(2,"div",68)(3,"div",69)(4,"div",70)(5,"h3",71)(6,"mat-icon",72),a(7,"person"),n(),a(8," Guest Information "),n()(),o(9,"div",73)(10,"div",74)(11,"div")(12,"label",75),a(13,"Guest Name"),n(),o(14,"div",76),a(15),n()(),o(16,"div")(17,"label",75),a(18,"Email"),n(),o(19,"div",41),a(20),n()(),o(21,"div")(22,"label",75),a(23,"Phone"),n(),o(24,"div",41),a(25),n()(),o(26,"div")(27,"label",75),a(28,"Occupancy"),n(),o(29,"div",41),a(30),n()()()()(),o(31,"div",69)(32,"div",70)(33,"h3",71)(34,"mat-icon",77),a(35,"calendar_today"),n(),a(36," Stay Information "),n()(),o(37,"div",73)(38,"div",74)(39,"div")(40,"label",75),a(41,"Check-in Date"),n(),o(42,"div",76),a(43),n(),u(44,Yn,2,1,"div",41),n(),o(45,"div")(46,"label",75),a(47,"Check-out Date"),n(),o(48,"div",76),a(49),n(),u(50,Jn,2,1,"div",41),n(),o(51,"div")(52,"label",75),a(53,"Number of Nights"),n(),o(54,"div",76),a(55),n()(),o(56,"div")(57,"label",75),a(58,"Booking Source"),n(),o(59,"div",41),a(60),f(61,"titlecase"),n()()()()(),u(62,go,13,3,"div",69),o(63,"div",69)(64,"div",70)(65,"div",78)(66,"h3",71)(67,"mat-icon",79),a(68,"hotel"),n(),a(69," Room Details "),n(),u(70,vo,3,0,"button",80),n()(),o(71,"div",73)(72,"div",81)(73,"table",82)(74,"thead")(75,"tr",83)(76,"th",84),a(77,"Room Number"),n(),o(78,"th",84),a(79,"Room Type"),n(),o(80,"th",84),a(81,"Adults"),n(),o(82,"th",84),a(83,"Children"),n(),o(84,"th",84),a(85,"Rate per Night"),n()()(),o(86,"tbody"),U(87,_o,12,8,"tr",85,ve),n()()()()()(),o(89,"div",86)(90,"div",69)(91,"div",87)(92,"div",88)(93,"h3",71)(94,"mat-icon"),a(95),n(),a(96," Pricing Summary "),u(97,xo,2,0,"span",89),n(),o(98,"button",90),C("click",function(){y(e);let l=c();return E(l.openPricingUpdateDialog())}),o(99,"mat-icon"),a(100),n()()()(),o(101,"div",73)(102,"div",91)(103,"div",92)(104,"span",93),a(105,"Subtotal"),n(),o(106,"span",94),a(107),f(108,"currency"),n()(),o(109,"div",92)(110,"span",93),a(111,"Taxes"),n(),o(112,"span",94),a(113),f(114,"currency"),n()(),u(115,fo,6,4,"div",92),u(116,ho,6,4,"div",92),u(117,bo,6,4,"div",92),u(118,Co,6,4,"div",92),u(119,yo,6,5,"div",92),k(120,"hr",95),o(121,"div",96)(122,"span",97),a(123,"Total"),n(),o(124,"span",97),a(125),f(126,"currency"),n()(),o(127,"div",92)(128,"span",93),a(129,"Paid"),n(),o(130,"span",98),a(131),f(132,"currency"),n()(),o(133,"div",92)(134,"span",93),a(135,"Balance"),n(),o(136,"span",99),a(137),f(138,"currency"),n()()()()(),u(139,Po,27,17,"div",69),n()(),o(140,"div",100),u(141,Mo,24,0,"div",69),u(142,To,3,2,"div",101),u(143,No,10,0,"div",69),o(144,"div",69)(145,"div",70)(146,"h3",71)(147,"mat-icon",79),a(148,"info"),n(),a(149," Booking Information "),n()(),o(150,"div",73)(151,"div",74)(152,"div")(153,"label",75),a(154,"Created"),n(),o(155,"div",41),a(156),n()(),u(157,Vo,5,1,"div"),u(158,Uo,5,1,"div"),u(159,Go,5,1,"div"),n()()(),u(160,$o,20,4,"div",102),n()()}if(r&2){let e,i,l,d,p,h,D,O,ge,Me,x=c();s(15),m(x.guestName()),s(5),m(x.guestEmail()),s(5),m(x.guestPhone()),s(5),N("",x.reservation().guestDetails.totalAdults," Adults, ",x.reservation().guestDetails.totalChildren," Children"),s(13),m(x.formatDate(x.reservation().checkInDate)),s(),g(x.reservation().expectedCheckInTime?44:-1),s(5),m(x.formatDate(x.reservation().checkOutDate)),s(),g(x.reservation().expectedCheckOutTime?50:-1),s(5),m(x.reservation().numberOfNights),s(5),m(V(61,53,x.reservation().bookingSource)),s(2),g(x.hasExtensions()?62:-1),s(8),g(!x.isCheckedOut()&&((e=x.reservation())==null?null:e.status)!=="cancelled"?70:-1),s(17),G(x.roomDetails()),s(4),T("from-gray-50",x.isCheckedOut())("to-gray-100",x.isCheckedOut())("border-gray-200",x.isCheckedOut()),s(3),T("text-purple-600",!x.isCheckedOut())("text-gray-400",x.isCheckedOut()),s(),_(" ",x.isCheckedOut()?"lock":"account_balance_wallet"," "),s(2),g(x.isCheckedOut()?97:-1),s(),T("text-gray-400",!x.canEditPricing())("cursor-not-allowed",!x.canEditPricing()),v("matTooltip",x.canEditPricing()?"Update Pricing (Owner Authorization Required)":"Cannot edit pricing for checked-out reservations")("disabled",!x.canEditPricing()),s(2),m(x.canEditPricing()?"edit":"lock"),s(7),m(R(108,55,x.reservation().pricing.subtotal,(i=x.storeStore.selectedStore())==null?null:i.currency)),s(6),m(R(114,58,x.reservation().pricing.taxes,(l=x.storeStore.selectedStore())==null?null:l.currency)),s(2),g((d=x.reservation().pricing.fees)!=null&&d.serviceFee?115:-1),s(),g((p=x.reservation().pricing.fees)!=null&&p.cleaningFee?116:-1),s(),g((h=x.reservation().pricing.fees)!=null&&h.resortFee?117:-1),s(),g((D=x.reservation().pricing.discounts)!=null&&D.amount?118:-1),s(),g(x.getTotalExtensionCost()>0?119:-1),s(6),m(R(126,61,x.getFinalTotal(),(O=x.storeStore.selectedStore())==null?null:O.currency)),s(6),m(R(132,64,x.reservation().pricing.paid,(ge=x.storeStore.selectedStore())==null?null:ge.currency)),s(5),W(x.reservation().pricing.balance>0?"text-red-600":"text-green-600"),s(),_(" ",R(138,67,x.reservation().pricing.balance,(Me=x.storeStore.selectedStore())==null?null:Me.currency)," "),s(2),g(x.reservation().paymentInfo?139:-1),s(2),g(x.transactionHistory().length>0?141:-1),s(),g(x.reservation().specialRequests||x.reservation().internalNotes?142:-1),s(),g(x.hasAdditionalGuests()?143:-1),s(13),m(x.formatDateTime(x.reservation().createdAt)),s(),g(x.reservation().updatedAt!==x.reservation().createdAt?157:-1),s(),g(x.reservation().actualCheckInDate?158:-1),s(),g(x.reservation().actualCheckOutDate?159:-1),s(),g(x.hasCancellation()?160:-1)}}function zo(r,t){if(r&1){let e=w();o(0,"button",25),C("click",function(){y(e);let l=c();return E(l.editReservation())}),o(1,"mat-icon",26),a(2,"edit"),n(),o(3,"span"),a(4,"Edit Reservation"),n()()}}function Ho(r,t){if(r&1){let e=w();o(0,"button",35),C("click",function(){y(e);let l=c();return E(l.requestExtension())}),o(1,"mat-icon",36),a(2,"schedule"),n(),o(3,"span"),a(4,"Request Stay Extension"),n()()}if(r&2){let e=c();v("disabled",e.statusUpdating())}}function Wo(r,t){r&1&&(o(0,"mat-icon",20),a(1,"download"),n())}function Qo(r,t){r&1&&(o(0,"mat-icon",21),a(1,"picture_as_pdf"),n())}function Zo(r,t){if(r&1){let e=w();k(0,"mat-divider",157),o(1,"button",158),C("click",function(){y(e);let l=c();return E(l.deleteReservation())}),o(2,"mat-icon",21),a(3,"delete"),n(),o(4,"span"),a(5,"Delete Reservation"),n()()}}function Ko(r,t){r&1&&(o(0,"div",23)(1,"mat-icon",159),a(2,"lock"),n(),o(3,"span"),a(4,"Payment information is locked for checked-out reservations"),n()())}function Yo(r,t){r&1&&(o(0,"div",24),a(1," No status changes available "),n())}function Jo(r,t){if(r&1){let e=w();o(0,"button",54),C("click",function(){let l=y(e).$implicit,d=c(2);return E(d.updatePaymentStatus(l.value))}),o(1,"mat-icon",55),a(2),n(),o(3,"span"),a(4),n()()}if(r&2){let e=t.$implicit;s(),Pe("color",e.color),s(),m(e.icon),s(2),m(e.label)}}function Xo(r,t){if(r&1){let e=w();U(0,Jo,5,4,"button",47,Di),o(2,"button",25),C("click",function(){y(e);let l=c();return E(l.showPaymentDialog(l.reservation()))}),o(3,"mat-icon",160),a(4,"edit"),n(),o(5,"span"),a(6,"Edit Payment Information"),n()(),o(7,"div",49),a(8,' \u{1F4A1} Use "Edit Payment Information" to update method and status details '),n()}if(r&2){let e=c();G(e.getAvailablePaymentStatusOptions())}}function ea(r,t){if(r&1){let e=w();o(0,"button",161),C("click",function(){y(e);let l=c();return E(l.sendReservationEmail("confirmation"))}),o(1,"mat-icon",36),a(2,"check_circle"),n(),o(3,"span"),a(4,"Send Confirmation Email"),n()()}}function ta(r,t){if(r&1){let e=w();o(0,"button",162),C("click",function(){y(e);let l=c();return E(l.sendReservationEmail("checkin"))}),o(1,"mat-icon",163),a(2,"login"),n(),o(3,"span"),a(4,"Send Check-in Notification"),n()()}}function ia(r,t){r&1&&(o(0,"div",31)(1,"mat-icon",53),a(2,"bluetooth_connected"),n(),o(3,"span"),a(4,"Printer Connected"),n()())}function na(r,t){r&1&&(o(0,"div",32)(1,"mat-icon",53),a(2,"bluetooth_disabled"),n(),o(3,"span"),a(4,"Printer Not Connected"),n()())}function oa(r,t){r&1&&(o(0,"mat-icon",34),a(1,"print"),n())}function aa(r,t){r&1&&(o(0,"mat-icon",26),a(1,"print"),n())}function ra(r,t){if(r&1){let e=w();o(0,"button",164),C("click",function(){y(e);let l=c();return E(l.disconnectFromPrinter())}),o(1,"mat-icon",21),a(2,"bluetooth_disabled"),n(),o(3,"span"),a(4,"Disconnect Printer"),n()()}if(r&2){let e=c();v("disabled",e.printing()||e.statusUpdating())}}function sa(r,t){if(r&1){let e=w();o(0,"button",165),C("click",function(){y(e);let l=c();return E(l.connectToPrinter())}),o(1,"mat-icon",26),a(2,"bluetooth"),n(),o(3,"span"),a(4,"Connect to Printer"),n()()}if(r&2){let e=c();v("disabled",e.printing()||e.statusUpdating())}}var ki=class r{router=b(Ut);route=b(Vt);location=b(Tt);reservationService=b(ue);bluetoothPrinterService=b(Ci);storeStore=b(Ce);snackBar=b(_e);dialog=b(di);reservation=P(null);loading=P(!1);error=P(null);statusUpdating=P(!1);printerConnected=P(!1);printing=P(!1);exportingPDF=P(!1);statusOptions=[{value:"pending",label:"Pending",icon:"schedule",color:"#f59e0b"},{value:"confirmed",label:"Confirmed",icon:"check_circle",color:"#10b981"},{value:"checked_in",label:"Checked In",icon:"login",color:"#3b82f6"},{value:"checked_out",label:"Checked Out",icon:"logout",color:"#6b7280"},{value:"cancelled",label:"Cancelled",icon:"cancel",color:"#ef4444"},{value:"no_show",label:"No Show",icon:"person_off",color:"#f97316"}];roomDetails=I(()=>{let t=this.reservation();return!t||!t.rooms?[]:t.rooms.map(e=>{let i=typeof e.room=="string"?{roomNumber:e.room,roomType:"Unknown"}:e.room;return{name:i.name||"N/A",roomNumber:i.roomNumber||"Unknown",roomType:typeof i.roomType=="object"&&i.roomType?.name||"Unknown",adults:e.guests?.adults||0,children:e.guests?.children||0,rate:i.priceOverride||0}})});transactionHistory=I(()=>{let t=this.reservation();return!t||!t.paymentInfo?.transactions?[]:t.paymentInfo.transactions});guestName=I(()=>{let t=this.reservation();if(!t||!t.guestDetails?.primaryGuest)return"Unknown Guest";let e=t.guestDetails.primaryGuest;return`${e.firstName||""} ${e.lastName||""}`.trim()||"Unknown Guest"});guestEmail=I(()=>this.reservation()?.guestDetails?.primaryGuest?.email||"No email provided");guestPhone=I(()=>this.reservation()?.guestDetails?.primaryGuest?.phone||"No phone provided");hasAdditionalGuests=I(()=>{let t=this.reservation();return t?.guestDetails?.additionalGuests&&t.guestDetails.additionalGuests.length>0});hasCancellation=I(()=>this.reservation()?.cancellation?.isCancelled);hasRefundAmount=I(()=>{let t=this.reservation();return t?.cancellation?.refundAmount&&t.cancellation.refundAmount>0});hasCancellationFee=I(()=>{let t=this.reservation();return t?.cancellation?.cancellationFee&&t.cancellation.cancellationFee>0});getRefundAmount=I(()=>this.reservation()?.cancellation?.refundAmount||0);getCancellationFee=I(()=>this.reservation()?.cancellation?.cancellationFee||0);paymentStatusOptions=[{value:"pending",label:"Pending",icon:"schedule",color:"#f59e0b"},{value:"paid",label:"Paid",icon:"check_circle",color:"#10b981"},{value:"partial",label:"Partial",icon:"donut_small",color:"#3b82f6"},{value:"refunded",label:"Refunded",icon:"undo",color:"#6b7280"}];getAvailablePaymentStatusOptions=I(()=>{let t=this.reservation();if(!t)return[];let e=t.paymentInfo?.status||"pending";return this.paymentStatusOptions.filter(i=>i.value!==e)});ngOnInit(){let t=this.route.snapshot.paramMap.get("id");t?this.loadReservation(t):this.error.set("No reservation ID provided"),this.printerConnected.set(this.bluetoothPrinterService.isConnected())}loadReservation(t){return S(this,null,function*(){this.loading.set(!0),this.error.set(null);try{if(!this.storeStore.selectedStore()?._id)throw new Error("No store selected");this.reservationService.getReservationById(t).subscribe({next:i=>{this.reservation.set(i),this.loading.set(!1)},error:i=>{console.error("Error loading reservation:",i),this.error.set("Failed to load reservation details"),this.loading.set(!1)}})}catch(e){console.error("Error loading reservation:",e),this.error.set("Failed to load reservation details"),this.loading.set(!1)}})}goBack(){this.location.back()}editReservation(){this.reservation()&&this.router.navigate(["/menu/hms/front-desk/reservations/edit",this.reservation()._id])}canEdit(){let t=this.reservation();return t?.status!=="cancelled"&&t?.status!=="checked_out"&&t?.status!=="no_show"&&t?.status!=="checked_in"&&!t?.actualCheckInDate}canDelete(){let t=this.reservation();return t?["pending","cancelled","no_show"].includes(t.status):!1}deleteReservation(){let t=this.reservation();if(!t)return;let e=this.storeStore.selectedStore();if(!e?._id){this.snackBar.open("No store selected","Close",{duration:3e3});return}let i={storeId:e._id,actionDescription:`delete reservation ${t.confirmationNumber}`,reservationId:t._id};this.dialog.open(Le,{data:i,width:"500px",maxWidth:"90vw",disableClose:!0}).afterClosed().subscribe(d=>{d?.authorized&&d.pin&&this.performReservationDeletion(t,d.pin)})}performReservationDeletion(t,e){this.statusUpdating.set(!0),this.reservationService.deleteReservationWithPin(t._id,e).subscribe({next:i=>{this.snackBar.open(`Reservation ${t.confirmationNumber} deleted successfully`,"Close",{duration:5e3}),this.router.navigate(["/dashboard/hms/front-desk/reservations"])},error:i=>{console.error("Error deleting reservation:",i),this.snackBar.open(i.message||"Failed to delete reservation","Close",{duration:5e3,panelClass:["error-snackbar"]})},complete:()=>{this.statusUpdating.set(!1)}})}canCheckIn(){return this.reservation()?.status==="confirmed"}canCheckOut(){return this.reservation()?.status==="checked_in"}canCancel(){let t=this.reservation();return t?.status!=="cancelled"&&t?.status!=="checked_out"&&t?.status!=="no_show"}canRequestExtension(){return this.reservation()?.status==="checked_in"}isCheckedOut(){return this.reservation()?.status==="checked_out"}canEditPricing(){return!this.isCheckedOut()&&!this.loading()}canEditPaymentInfo(){return!this.isCheckedOut()&&!this.statusUpdating()}checkInReservation(){return S(this,null,function*(){if(this.reservation()){if(!this.canCheckIn()){this.snackBar.open('Guests can only be checked in when reservation status is "Confirmed"',"Close",{duration:5e3,panelClass:["error-snackbar"]});return}try{yield this.updateReservationStatus("checked_in")}catch(e){console.error("Error checking in reservation:",e),this.snackBar.open("Failed to check in reservation","Close",{duration:3e3})}}})}checkOutReservation(){return S(this,null,function*(){if(this.reservation()){if(!this.canCheckOut()){this.snackBar.open('Guests can only be checked out when reservation status is "Checked In"',"Close",{duration:5e3,panelClass:["error-snackbar"]});return}try{yield this.updateReservationStatus("checked_out")}catch(e){console.error("Error checking out reservation:",e),this.snackBar.open("Failed to check out reservation","Close",{duration:3e3})}}})}cancelReservation(){return S(this,null,function*(){if(!(!this.reservation()||!this.canCancel()))try{this.snackBar.open("Cancellation functionality coming soon","Close",{duration:3e3})}catch(e){console.error("Error cancelling reservation:",e),this.snackBar.open("Failed to cancel reservation","Close",{duration:3e3})}})}requestExtension(){return S(this,null,function*(){let t=this.reservation();if(!t||!this.canRequestExtension()){this.snackBar.open("Extensions can only be requested for checked-in guests","Close",{duration:5e3,panelClass:["error-snackbar"]});return}let e={reservation:t,currentCheckOutDate:new Date(t.checkOutDate)};this.dialog.open(Je,{width:"600px",maxWidth:"90vw",data:e,disableClose:!0}).afterClosed().subscribe(l=>S(this,null,function*(){if(l?.success&&l.extension)try{yield this.loadReservation(t._id),this.snackBar.open("Extension request submitted successfully. Awaiting approval.","Close",{duration:5e3})}catch(d){console.error("Error reloading reservation after extension request:",d),this.snackBar.open("Extension request submitted, but failed to refresh data. Please refresh the page.","Close",{duration:5e3})}}))})}updateReservationStatus(t){return S(this,null,function*(){let e=this.reservation();if(!(!e||e.status===t)){if(t==="reopen"){this.reopenReservation();return}if(t==="checked_in"){this.showCheckInDialog(e);return}if(t==="checked_out"){this.performCheckOut();return}if(!this.isValidStatusTransition(e.status,t)){this.snackBar.open(this.getStatusTransitionError(e.status,t),"Close",{duration:5e3,panelClass:["error-snackbar"]});return}(t==="cancelled"||t==="no_show")&&!confirm(`Are you sure you want to change the status to ${t}?`)||(yield this.performStatusUpdate(t))}})}updatePaymentStatus(t){let e=this.reservation();if(e){if(this.isCheckedOut()){this.snackBar.open("Cannot update payment status for checked-out reservations","Close",{duration:3e3,panelClass:["error-snackbar"]});return}t==="paid"?this.showPaymentDialog(e):this.performPaymentStatusUpdate(t)}}showPaymentDialog(t){if(this.isCheckedOut()){this.snackBar.open("Cannot edit payment information for checked-out reservations","Close",{duration:3e3,panelClass:["error-snackbar"]});return}let e={reservation:t,isCheckoutFlow:!1};this.dialog.open($e,{data:e,width:"600px",maxWidth:"90vw",disableClose:!0}).afterClosed().subscribe(l=>{l?.confirmed&&l.paymentData&&(l.paymentData.amount!==void 0?console.error("Amount-based payment not supported in regular update flow"):l.paymentData.status&&this.processPayment(l.paymentData))})}processPayment(t){return S(this,null,function*(){let e=this.reservation();if(e){this.statusUpdating.set(!0);try{yield this.reservationService.updatePaymentInfo(e._id,t).toPromise();let i=yield this.reservationService.getReservationById(e._id).toPromise();i&&this.reservation.set(i),this.snackBar.open("Payment information updated successfully","Close",{duration:5e3})}catch(i){console.error("Error updating payment info:",i);let l="Failed to update payment information";i?.error?.error?l=i.error.error:i instanceof Error&&(l=i.message),this.snackBar.open(l,"Close",{duration:5e3,panelClass:["error-snackbar"]})}finally{this.statusUpdating.set(!1)}}})}performPaymentStatusUpdate(t){return S(this,null,function*(){let e=this.reservation();if(e){this.statusUpdating.set(!0);try{let i=yield this.reservationService.updateReservation(e._id,{paymentInfo:Oe(Ie({},e.paymentInfo),{status:t})}).toPromise();i&&(this.reservation.set(i),this.snackBar.open(`Payment status updated to ${t}`,"Close",{duration:3e3}))}catch(i){console.error("Error updating payment status:",i);let l=i instanceof Error?i.message:"Failed to update payment status";this.snackBar.open(l,"Close",{duration:5e3,panelClass:["error-snackbar"]})}finally{this.statusUpdating.set(!1)}}})}showCheckInDialog(t){let e={reservation:t};this.dialog.open(bi,{data:e,width:"600px",maxWidth:"90vw",disableClose:!0}).afterClosed().subscribe(l=>{l?.confirmed&&this.performCheckIn(l)})}performCheckIn(t){return S(this,null,function*(){let e=this.reservation();if(e){this.statusUpdating.set(!0);try{let i=yield this.reservationService.checkInReservationWithRooms(e._id).toPromise();i&&(this.reservation.set(i),this.snackBar.open("Guest checked in successfully! Room status updated to occupied.","Close",{duration:5e3}))}catch(i){console.error("Error during check-in:",i);let l=i instanceof Error?i.message:"Failed to check in guest";this.snackBar.open(l,"Close",{duration:5e3,panelClass:["error-snackbar"]})}finally{this.statusUpdating.set(!1)}}})}performCheckOut(){return S(this,null,function*(){let t=this.reservation();if(t){if(this.requiresPaymentBeforeCheckout(t)){this.showPaymentRequiredDialog(t);return}this.statusUpdating.set(!0);try{let e=yield this.reservationService.checkOutReservationWithRooms(t._id).toPromise();e&&(this.reservation.set(e),this.snackBar.open("Guest checked out successfully! Room status updated to cleaning.","Close",{duration:5e3}))}catch(e){console.error("Error during check-out:",e);let i=e instanceof Error?e.message:"Failed to check out guest";this.snackBar.open(i,"Close",{duration:5e3,panelClass:["error-snackbar"]})}finally{this.statusUpdating.set(!1)}}})}requiresPaymentBeforeCheckout(t){let e=t.pricing.balance>0,i=t.paymentInfo?.status!=="paid";return e&&i}showPaymentRequiredDialog(t){let e={reservation:t,isCheckoutFlow:!0};this.dialog.open($e,{data:e,width:"600px",maxWidth:"90vw",disableClose:!0}).afterClosed().subscribe(l=>{l?.confirmed&&l.paymentData&&(l.paymentData.amount!==void 0?this.processPaymentAndCheckout(l.paymentData):console.error("Expected amount-based payment data for checkout flow"))})}processPaymentAndCheckout(t){return S(this,null,function*(){let e=this.reservation();if(e){this.statusUpdating.set(!0);try{yield this.reservationService.processPayment(e._id,{amount:t.amount,method:t.method,reference:t.reference||`PAY-${Date.now()}`}).toPromise();let i=yield this.reservationService.getReservationById(e._id).toPromise();i&&(this.reservation.set(i),this.snackBar.open(`Payment of ${this.formatCurrency(t.amount)} recorded successfully`,"Close",{duration:3e3}),i.pricing.balance<=0||i.paymentInfo?.status==="paid"?setTimeout(()=>{this.proceedWithCheckout()},1500):this.snackBar.open("Payment recorded, but outstanding balance remains. Please complete payment before checkout.","Close",{duration:5e3,panelClass:["warning-snackbar"]}))}catch(i){console.error("Error processing payment for checkout:",i);let l=i instanceof Error?i.message:"Failed to process payment";this.snackBar.open(l,"Close",{duration:5e3,panelClass:["error-snackbar"]})}finally{this.statusUpdating.set(!1)}}})}proceedWithCheckout(){return S(this,null,function*(){let t=this.reservation();if(t){this.statusUpdating.set(!0);try{let e=yield this.reservationService.checkOutReservationWithRooms(t._id).toPromise();e&&(this.reservation.set(e),this.snackBar.open("Guest checked out successfully! Room status updated to cleaning.","Close",{duration:5e3}))}catch(e){console.error("Error during checkout after payment:",e);let i=e instanceof Error?e.message:"Failed to complete checkout";this.snackBar.open(i,"Close",{duration:5e3,panelClass:["error-snackbar"]})}finally{this.statusUpdating.set(!1)}}})}performStatusUpdate(t){return S(this,null,function*(){let e=this.reservation();if(e){this.statusUpdating.set(!0);try{let i=yield this.reservationService.updateReservationStatus(e._id,t).toPromise();i&&(this.reservation.set(i),this.snackBar.open(`Status updated to ${t}`,"Close",{duration:3e3}))}catch(i){console.error("Error updating reservation status:",i);let l=i instanceof Error?i.message:"Failed to update status";this.snackBar.open(l,"Close",{duration:5e3,panelClass:["error-snackbar"]})}finally{this.statusUpdating.set(!1)}}})}reopenReservation(){return S(this,null,function*(){let t=this.reservation();if(!t)return;if(t.status!=="cancelled"){this.snackBar.open("Only cancelled reservations can be reopened","Close",{duration:5e3,panelClass:["error-snackbar"]});return}let e=this.storeStore.selectedStore()?._id;if(!e){this.snackBar.open("Store information not available","Close",{duration:5e3,panelClass:["error-snackbar"]});return}this.dialog.open(Le,{width:"400px",disableClose:!0,data:{storeId:e,actionDescription:"reopen this cancelled reservation",reservationId:t._id}}).afterClosed().subscribe(l=>S(this,null,function*(){if(l&&l.authorized&&l.pin){this.statusUpdating.set(!0);try{let d=yield this.reservationService.reopenReservation(t._id,l.pin).toPromise();d&&(this.reservation.set(d),this.snackBar.open("Reservation reopened successfully","Close",{duration:3e3,panelClass:["success-snackbar"]}))}catch(d){console.error("Error reopening reservation:",d);let p="Failed to reopen reservation";(d instanceof Error&&d.message||d&&typeof d=="object"&&d.message)&&(p=d.message),this.snackBar.open(p,"Close",{duration:5e3,panelClass:["error-snackbar"]})}finally{this.statusUpdating.set(!1)}}}))})}getAvailableStatusOptions(){let t=this.reservation()?.status,e=this.statusOptions.filter(i=>i.value!==t&&this.isValidStatusTransition(t||"",i.value));return t==="cancelled"&&e.push({value:"reopen",label:"Reopen Reservation",color:"#10b981",icon:"refresh"}),e}isValidStatusTransition(t,e){return{pending:["confirmed","cancelled","no_show"],confirmed:["checked_in","cancelled","no_show"],checked_in:["checked_out"],checked_out:[],cancelled:[],no_show:[]}[t]?.includes(e)||!1}getStatusTransitionError(t,e){switch(e){case"checked_in":return'Guests can only be checked in when reservation status is "Confirmed"';case"checked_out":return'Guests can only be checked out when reservation status is "Checked In"';case"confirmed":return t==="checked_in"?"Cannot change back to confirmed after check-in":t==="checked_out"?"Cannot change back to confirmed after check-out":"Invalid status transition";default:return`Cannot change status from "${t}" to "${e}"`}}getStatusColor(t){return{pending:"#f59e0b",confirmed:"#10b981",checked_in:"#3b82f6",checked_out:"#6b7280",cancelled:"#ef4444",no_show:"#f97316"}[t]||"#6b7280"}getStatusIcon(t){return{pending:"schedule",confirmed:"check_circle",checked_in:"login",checked_out:"logout",cancelled:"cancel",no_show:"person_off"}[t]||"help"}formatDate(t){return t?new Date(t).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"}):"N/A"}formatDateTime(t){return t?new Date(t).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"N/A"}sendReservationEmail(t="details"){return S(this,null,function*(){let e=this.reservation();if(!e)return;let i=this.guestEmail();if(!i||i==="No email provided"){this.snackBar.open("No email address available for this guest","Close",{duration:5e3,panelClass:["error-snackbar"]});return}this.statusUpdating.set(!0);try{let l=yield this.reservationService.sendReservationEmail(e._id,{emailType:t}).toPromise();if(l?.success)this.snackBar.open(l.message||`${t.charAt(0).toUpperCase()+t.slice(1)} email sent successfully to ${i}`,"Close",{duration:5e3});else throw new Error("Email sending failed")}catch(l){console.error("Error sending reservation email:",l);let d=l instanceof Error?l.message:"Failed to send reservation email";this.snackBar.open(d,"Close",{duration:5e3,panelClass:["error-snackbar"]})}finally{this.statusUpdating.set(!1)}})}connectToPrinter(){return S(this,null,function*(){if(!this.bluetoothPrinterService.isBluetoothSupported()){this.snackBar.open("Web Bluetooth is not supported in this browser","Close",{duration:5e3,panelClass:["error-snackbar"]});return}try{this.statusUpdating.set(!0),yield this.bluetoothPrinterService.connectToPrinter(),this.printerConnected.set(!0);let t=this.bluetoothPrinterService.getConnectedDeviceInfo();this.snackBar.open(`Connected to printer: ${t?.name||"Unknown Printer"}`,"Close",{duration:3e3})}catch(t){console.error("Error connecting to printer:",t),this.printerConnected.set(!1);let e=t instanceof Error?t.message:"Failed to connect to printer";this.snackBar.open(e,"Close",{duration:5e3,panelClass:["error-snackbar"]})}finally{this.statusUpdating.set(!1)}})}disconnectFromPrinter(){return S(this,null,function*(){try{yield this.bluetoothPrinterService.disconnectPrinter(),this.printerConnected.set(!1),this.snackBar.open("Disconnected from printer","Close",{duration:3e3})}catch(t){console.error("Error disconnecting from printer:",t),this.snackBar.open("Failed to disconnect from printer","Close",{duration:3e3,panelClass:["error-snackbar"]})}})}printReservation(){return S(this,null,function*(){let t=this.reservation();if(t){if(!this.bluetoothPrinterService.isConnected())if(confirm("Printer not connected. Would you like to connect to a printer first?"))try{if(yield this.connectToPrinter(),!this.bluetoothPrinterService.isConnected())return}catch{return}else return;this.printing.set(!0);try{let e=this.storeStore.selectedStore();yield this.bluetoothPrinterService.printReservation(t,e),this.snackBar.open("Reservation printed successfully","Close",{duration:3e3})}catch(e){console.error("Error printing reservation:",e);let i=e instanceof Error?e.message:"Failed to print reservation";this.snackBar.open(i,"Close",{duration:5e3,panelClass:["error-snackbar"]}),i.includes("not connected")&&this.printerConnected.set(!1)}finally{this.printing.set(!1)}}})}testPrint(){return S(this,null,function*(){if(!this.bluetoothPrinterService.isConnected()){this.snackBar.open("Please connect to a printer first","Close",{duration:3e3,panelClass:["error-snackbar"]});return}this.printing.set(!0);try{yield this.bluetoothPrinterService.testPrint(),this.snackBar.open("Test print completed successfully","Close",{duration:3e3})}catch(t){console.error("Error during test print:",t);let e=t instanceof Error?t.message:"Test print failed";this.snackBar.open(e,"Close",{duration:5e3,panelClass:["error-snackbar"]})}finally{this.printing.set(!1)}})}exportReservationToPDF(){return S(this,null,function*(){let t=this.reservation();if(t){this.exportingPDF.set(!0);try{let e=yield this.reservationService.exportReservationToPDF(t._id).toPromise();if(e){let i=window.URL.createObjectURL(e),l=document.createElement("a");l.href=i,l.download=`reservation-${t.confirmationNumber}.pdf`,document.body.appendChild(l),l.click(),document.body.removeChild(l),window.URL.revokeObjectURL(i),this.snackBar.open("Reservation details exported to PDF successfully!","Close",{duration:3e3})}}catch(e){console.error("Error exporting reservation to PDF:",e);let i=e instanceof Error?e.message:"Failed to export reservation to PDF";this.snackBar.open(i,"Close",{duration:5e3,panelClass:["error-snackbar"]})}finally{this.exportingPDF.set(!1)}}})}openPricingUpdateDialog(){let t=this.reservation();if(!t)return;if(this.isCheckedOut()){this.snackBar.open("Cannot edit pricing for checked-out reservations","Close",{duration:3e3,panelClass:["error-snackbar"]});return}let e=this.storeStore.selectedStore();if(!e?._id){this.snackBar.open("No store selected","Close",{duration:3e3});return}let i={storeId:e._id,actionDescription:`update pricing for reservation ${t.confirmationNumber}`,reservationId:t._id};this.dialog.open(Le,{data:i,width:"500px",maxWidth:"90vw",disableClose:!0}).afterClosed().subscribe(d=>{d?.authorized&&d.pin&&this.proceedWithPricingUpdate(t)})}proceedWithPricingUpdate(t){let e={reservation:t};this.dialog.open(Xe,{data:e,width:"800px",maxWidth:"90vw",maxHeight:"90vh",disableClose:!1,autoFocus:!1,panelClass:"pricing-update-dialog"}).afterClosed().subscribe(l=>{l?.success&&l.updatedReservation&&(this.reservation.set(l.updatedReservation),this.snackBar.open("Pricing updated successfully!","Close",{duration:3e3,panelClass:["success-snackbar"]}))})}formatCurrency(t){if(!t&&t!==0)return"N/A";let e=this.storeStore.selectedStore(),i=e?.currencyCode||e?.currency||"USD";try{return new Intl.NumberFormat("en-US",{style:"currency",currency:i}).format(t)}catch{return console.warn(`Invalid currency code: ${i}, falling back to USD`),new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(t)}}hasExtensions(){let t=this.reservation();return!!(t?.extensions&&t.extensions.length>0)}getExtensions(){return this.reservation()?.extensions||[]}hasActiveExtension(){return!!this.reservation()?.currentExtension?.isActive}getTotalExtensionCost(){let t=this.reservation();return t?.currentExtension?.isActive&&t.currentExtension?.totalExtensionCost?t.currentExtension.totalExtensionCost:this.getExtensions().filter(i=>i.status==="approved").reduce((i,l)=>i+(l.additionalCost||0),0)}getTotalExtensionNights(){let t=this.reservation();return t?.currentExtension?.isActive&&t.currentExtension?.totalExtensionNights?t.currentExtension.totalExtensionNights:this.getExtensions().filter(i=>i.status==="approved").reduce((i,l)=>i+(l.additionalNights||0),0)}getFinalTotal(){return this.reservation()?.pricing?.total||0}formatExtensionDate(t){if(!t)return"N/A";try{return(typeof t=="string"?new Date(t):t).toLocaleDateString("en-US",{weekday:"short",year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}catch{return console.warn("Invalid date format:",t),"Invalid Date"}}processingExtension=P(null);processingAction=P(null);approveExtension(t){return S(this,null,function*(){let e=this.reservation();if(!e)return;let i=e.extensions?.find(h=>h._id===t);if(!i){this.snackBar.open("Extension not found","Close",{duration:3e3});return}let l={extensionId:t,reservationId:e._id,extensionCost:i.additionalCost,currency:this.storeStore.selectedStore()?.currency||"USD",additionalNights:i.additionalNights},p=yield this.dialog.open(ze,{data:l,width:"500px",disableClose:!0}).afterClosed().toPromise();if(p){this.processingExtension.set(t),this.processingAction.set("approve");try{let h=yield this.reservationService.approveExtension(e._id,t,"Extension approved from reservation details",p).toPromise();h?.reservation&&(this.reservation.set(h.reservation),this.snackBar.open("Extension approved successfully with payment information!","Close",{duration:3e3,panelClass:["success-snackbar"]}))}catch(h){console.error("Error approving extension:",h),this.snackBar.open(h.message||"Failed to approve extension","Close",{duration:5e3,panelClass:["error-snackbar"]})}finally{this.processingExtension.set(null),this.processingAction.set(null)}}})}rejectExtension(t){return S(this,null,function*(){let e=this.reservation();if(!e)return;let i=prompt("Please provide a reason for rejection:");if(i){this.processingExtension.set(t),this.processingAction.set("reject");try{let l=yield this.reservationService.rejectExtension(e._id,t,i,"Extension rejected from reservation details").toPromise();l?.reservation&&(this.reservation.set(l.reservation),this.snackBar.open("Extension rejected successfully!","Close",{duration:3e3,panelClass:["success-snackbar"]}))}catch(l){console.error("Error rejecting extension:",l),this.snackBar.open(l.message||"Failed to reject extension","Close",{duration:5e3,panelClass:["error-snackbar"]})}finally{this.processingExtension.set(null),this.processingAction.set(null)}}})}openRoomChangeDialog(){return S(this,null,function*(){let t=this.reservation();if(!t||this.isCheckedOut()){this.snackBar.open("Cannot change rooms for checked-out reservations","Close",{duration:3e3});return}this.dialog.open(et,{width:"1000px",maxWidth:"95vw",maxHeight:"90vh",disableClose:!0,data:{reservationId:t._id,currentRooms:t.rooms,checkInDate:new Date(t.checkInDate).toISOString(),checkOutDate:new Date(t.checkOutDate).toISOString(),numberOfNights:t.numberOfNights,currency:this.storeStore.selectedStore()?.currency||"USD"}}).afterClosed().subscribe(i=>S(this,null,function*(){i&&(yield this.processRoomChange(i))}))})}processRoomChange(t){return S(this,null,function*(){let e=this.reservation();if(e)try{if(this.loading.set(!0),t.pricingAdjustment.requiresPayment){let l=this.storeStore.selectedStore()?.currency||"USD";if(!(yield this.dialog.open($e,{width:"500px",disableClose:!0,data:{reservation:e,amount:t.pricingAdjustment.difference,title:"Room Change - Additional Payment Required",description:`Additional payment of ${l}${t.pricingAdjustment.difference.toLocaleString()} required for room upgrade`,isCheckoutFlow:!1}}).afterClosed().toPromise())){this.snackBar.open("Room change cancelled - payment not processed","Close",{duration:3e3});return}}let i=yield this.reservationService.changeRooms(e._id,t).toPromise();i.success&&(this.reservation.set(i.data),this.snackBar.open("Rooms changed successfully","Close",{duration:3e3}),yield this.loadReservation(e._id))}catch(i){console.error("Error processing room change:",i),this.snackBar.open("Failed to change rooms","Close",{duration:3e3})}finally{this.loading.set(!1)}})}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=B({type:r,selectors:[["app-reservation-details"]],decls:80,vars:23,consts:[["actionsMenu","matMenu"],["paymentMenu","matMenu"],["emailMenu","matMenu"],["printMenu","matMenu"],["statusMenu","matMenu"],[1,"bg-gradient-to-r","from-blue-50","to-indigo-50","border-b","border-blue-100"],[1,"max-w-7xl","mx-auto","px-4","sm:px-6","lg:px-8"],[1,"flex","justify-between","items-center","py-6"],[1,"flex","items-center","gap-4"],["type","button",1,"p-2","text-gray-600","hover:text-gray-900","hover:bg-white/60","rounded-lg","transition-all","duration-200",3,"click"],[1,"flex","items-center","gap-3"],[1,"flex","justify-center","items-center","py-12","bg-white"],[1,"max-w-7xl","mx-auto","px-4","sm:px-6","lg:px-8","py-8"],[1,"!shadow-xl","!border","!border-gray-200","!rounded-lg"],["mat-menu-item","",1,"!text-gray-700","hover:!bg-blue-50","hover:!text-blue-700","!transition-colors"],["mat-menu-item","",1,"!text-gray-700","hover:!bg-gray-50","!transition-colors",3,"matMenuTriggerFor"],[1,"mr-3","!text-gray-600"],[1,"ml-auto","!text-gray-400"],["mat-menu-item","",1,"!text-gray-700","hover:!bg-green-50","hover:!text-green-700","!transition-colors",3,"disabled"],["mat-menu-item","",1,"!text-gray-700","hover:!bg-red-50","hover:!text-red-700","!transition-colors",3,"click","disabled"],[1,"mr-3","!text-red-600","animate-spin"],[1,"mr-3","!text-red-600"],[1,"px-3","py-2","text-xs","font-medium","text-gray-500","border-b","border-gray-100"],[1,"px-3","py-2","text-xs","text-gray-400","italic","flex","items-center","gap-2"],[1,"px-3","py-2","text-xs","text-gray-400","italic"],["mat-menu-item","",1,"!text-gray-700","hover:!bg-blue-50","hover:!text-blue-700","!transition-colors",3,"click"],[1,"mr-3","!text-blue-600"],["mat-menu-item","",1,"!text-gray-700","hover:!bg-green-50","hover:!text-green-700","!transition-colors"],["mat-menu-item","",1,"!text-gray-700","hover:!bg-purple-50","hover:!text-purple-700","!transition-colors"],[1,"px-3","py-2","text-xs","text-gray-600","bg-gray-50","border-t","border-gray-100","mt-1"],[1,"px-3","py-2","text-xs","border-b","border-gray-100"],[1,"flex","items-center","gap-2","text-green-600"],[1,"flex","items-center","gap-2","text-gray-500"],["mat-menu-item","",1,"!text-gray-700","hover:!bg-blue-50","hover:!text-blue-700","!transition-colors",3,"click","disabled"],[1,"mr-3","!text-blue-600","animate-spin"],["mat-menu-item","",1,"!text-gray-700","hover:!bg-green-50","hover:!text-green-700","!transition-colors",3,"click","disabled"],[1,"mr-3","!text-green-600"],[1,"px-3","py-2","border-t","border-gray-100","mt-1"],["mat-menu-item","",1,"!text-gray-700","hover:!bg-red-50","hover:!text-red-700","!transition-colors","w-full",3,"disabled"],["mat-menu-item","",1,"!text-gray-700","hover:!bg-blue-50","hover:!text-blue-700","!transition-colors","w-full",3,"disabled"],[1,"text-3xl","font-bold","text-gray-900","mb-1"],[1,"text-sm","text-gray-600"],[1,"relative"],[1,"px-3","py-1","rounded-full","text-sm","font-medium","border-2","flex","items-center","gap-2","hover:opacity-80","transition-all","duration-200","disabled:opacity-50",3,"matMenuTriggerFor","disabled"],[1,"text-sm","animate-spin"],[1,"text-sm",3,"color"],[1,"text-xs","opacity-60"],["mat-menu-item","",1,"!text-gray-700","hover:!bg-gray-50","!transition-colors"],[1,"px-3","py-2","text-xs","text-amber-600","bg-amber-50","border-t","border-amber-100","mt-1"],[1,"px-3","py-2","text-xs","text-blue-600","bg-blue-50","border-t","border-blue-100","mt-1"],["type","button",1,"px-4","py-2","text-sm","font-medium","text-blue-700","bg-blue-50","border","border-blue-200","rounded-lg","hover:bg-blue-100","hover:border-blue-300","transition-all","duration-200","flex","items-center","gap-2"],["type","button",1,"px-4","py-2","text-sm","font-medium","text-green-700","bg-green-50","border","border-green-200","rounded-lg","hover:bg-green-100","hover:border-green-300","transition-all","duration-200","flex","items-center","gap-2","disabled:opacity-50","disabled:cursor-not-allowed",3,"disabled"],[1,"p-2","text-gray-600","hover:text-gray-900","hover:bg-white/60","rounded-lg","transition-all","duration-200",3,"matMenuTriggerFor"],[1,"text-sm"],["mat-menu-item","",1,"!text-gray-700","hover:!bg-gray-50","!transition-colors",3,"click"],[1,"mr-3","!text-base"],["type","button",1,"px-4","py-2","text-sm","font-medium","text-blue-700","bg-blue-50","border","border-blue-200","rounded-lg","hover:bg-blue-100","hover:border-blue-300","transition-all","duration-200","flex","items-center","gap-2",3,"click"],[1,"text-lg"],["type","button",1,"px-4","py-2","text-sm","font-medium","text-green-700","bg-green-50","border","border-green-200","rounded-lg","hover:bg-green-100","hover:border-green-300","transition-all","duration-200","flex","items-center","gap-2","disabled:opacity-50","disabled:cursor-not-allowed",3,"click","disabled"],["diameter","40",1,"!text-blue-600"],[1,"ml-3","text-gray-600"],[1,"bg-red-50","border","border-red-200","rounded-lg","p-6","text-center"],[1,"w-16","h-16","bg-red-200","rounded-full","flex","items-center","justify-center","mx-auto","mb-4"],[1,"text-4xl","text-red-500"],[1,"text-lg","font-semibold","text-red-900","mb-2"],[1,"text-red-700","mb-4"],["type","button",1,"bg-red-600","hover:bg-red-700","text-white","px-4","py-2","rounded-lg","font-medium","transition-colors","duration-200",3,"click"],[1,"grid","grid-cols-1","lg:grid-cols-3","gap-8"],[1,"lg:col-span-2","space-y-6"],[1,"bg-white","rounded-lg","shadow-sm","border","border-gray-200","overflow-hidden"],[1,"bg-gradient-to-r","from-gray-50","to-gray-100","px-6","py-4","border-b","border-gray-200"],[1,"text-lg","font-semibold","text-gray-900","flex","items-center","gap-2"],[1,"text-blue-600"],[1,"p-6"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-6"],[1,"block","text-sm","font-medium","text-gray-700","mb-1"],[1,"text-lg","font-semibold","text-gray-900"],[1,"text-green-600"],[1,"flex","items-center","justify-between"],[1,"text-purple-600"],["mat-icon-button","","matTooltip","Change Rooms",1,"text-blue-600","hover:bg-blue-50","transition-colors","duration-200"],[1,"overflow-x-auto"],[1,"min-w-full"],[1,"border-b","border-gray-200"],[1,"text-left","py-3","px-4","font-semibold","text-gray-700"],[1,"border-b","border-gray-100","hover:bg-gray-50"],[1,"space-y-6"],[1,"bg-gradient-to-r","from-purple-50","to-purple-100","px-6","py-4","border-b","border-purple-200"],[1,"flex","justify-between","items-center"],[1,"text-xs","text-gray-500","font-normal"],["mat-icon-button","",1,"text-gray-600","hover:text-purple-600","hover:bg-purple-50","transition-colors","duration-200",3,"click","matTooltip","disabled"],[1,"space-y-3"],[1,"flex","justify-between"],[1,"text-gray-600"],[1,"font-medium","text-gray-900"],[1,"border-gray-200"],[1,"flex","justify-between","text-lg","font-semibold"],[1,"text-gray-900"],[1,"font-medium","text-green-600"],[1,"font-medium"],[1,"mt-8","space-y-6"],[1,"grid","grid-cols-1","lg:grid-cols-2","gap-6"],[1,"bg-red-50","border","border-red-200","rounded-lg","overflow-hidden"],[1,"bg-gradient-to-r","from-orange-50","to-amber-50","px-6","py-4","border-b","border-orange-200"],[1,"text-orange-600"],[1,"ml-2","px-2","py-1","bg-orange-100","text-orange-700","text-xs","font-medium","rounded-full"],[1,"space-y-4"],[1,"bg-gray-50","rounded-lg","p-4","border","border-gray-200"],[1,"mt-6","p-4","bg-green-50","border","border-green-200","rounded-lg"],[1,"flex","items-start","justify-between","mb-3"],[1,"w-10","h-10","bg-orange-100","rounded-full","flex","items-center","justify-center"],[1,"text-orange-600","text-sm"],[1,"px-3","py-1","rounded-full","text-xs","font-medium","border",3,"ngClass"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4","mb-4"],[1,"text-sm","text-gray-900"],[1,"text-sm","text-gray-900","font-medium"],[1,"text-sm","font-medium","text-orange-600"],[1,"mb-3"],[1,"mt-3","flex","gap-2"],[1,"mt-3","p-3","bg-red-50","border","border-red-200","rounded"],[1,"text-sm","text-gray-600","bg-white","p-3","rounded","border"],["type","button",1,"px-4","py-2","text-sm","font-medium","text-white","bg-green-600","border","border-green-600","rounded-lg","hover:bg-green-700","transition-all","duration-200","flex","items-center","gap-2","disabled:opacity-50","disabled:cursor-not-allowed",3,"click","disabled"],["type","button",1,"px-4","py-2","text-sm","font-medium","text-red-600","bg-white","border","border-red-300","rounded-lg","hover:bg-red-50","hover:border-red-400","transition-all","duration-200","flex","items-center","gap-2","disabled:opacity-50","disabled:cursor-not-allowed",3,"click","disabled"],[1,"flex","items-center","gap-2","text-sm","text-green-600"],[1,"mt-3","p-3","bg-blue-50","border","border-blue-200","rounded"],[1,"flex","items-center","gap-2","text-sm","text-blue-600","mb-2"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-3","text-sm"],[1,"ml-2","px-2","py-1","rounded-full","text-xs","font-medium",3,"ngClass"],[1,"ml-2","font-medium","text-gray-900"],[1,"mt-2","pt-2","border-t","border-blue-200"],[1,"ml-2","font-mono","text-sm","text-gray-900"],[1,"text-gray-600","text-sm"],[1,"mt-1","text-sm","text-gray-700"],[1,"flex","items-center","gap-2","text-sm","text-red-600","mb-1"],[1,"text-sm","text-red-700"],[1,"text-xs","text-red-500","mt-1"],[1,"flex","items-center","gap-2","mb-2"],[1,"font-medium","text-green-800"],[1,"text-sm","text-green-700"],["mat-icon-button","","matTooltip","Change Rooms",1,"text-blue-600","hover:bg-blue-50","transition-colors","duration-200",3,"click"],[1,"py-3","px-4","font-medium","text-gray-900"],[1,"py-3","px-4","text-gray-600"],[1,"font-medium","text-orange-600"],["matTooltip","Payment options",1,"p-2","text-gray-600","hover:text-gray-900","hover:bg-white/60","rounded-lg","transition-all","duration-200",3,"matMenuTriggerFor"],["matTooltip","Cannot edit payment info for checked-out reservations",1,"p-2","text-gray-400"],[1,"flex","items-center","gap-2"],[1,"text-sm","animate-spin","text-blue-600"],[1,"inline-flex","px-2","py-1","text-xs","font-medium","rounded-full"],[1,"py-3","px-4"],[1,"text-gray-700"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4"],[1,"bg-gray-50","border","border-gray-200","rounded-lg","p-4"],[1,"bg-red-100","px-6","py-4","border-b","border-red-200"],[1,"text-lg","font-semibold","text-red-900","flex","items-center","gap-2"],[1,"text-red-600"],[1,"block","text-sm","font-medium","text-red-700","mb-1"],[1,"text-sm","text-red-600"],[1,"!border-gray-200","my-1"],["mat-menu-item","",1,"!text-gray-700","hover:!bg-red-50","hover:!text-red-700","!transition-colors",3,"click"],[1,"!text-sm"],[1,"mr-3","!text-base","!text-blue-600"],["mat-menu-item","",1,"!text-gray-700","hover:!bg-green-50","hover:!text-green-700","!transition-colors",3,"click"],["mat-menu-item","",1,"!text-gray-700","hover:!bg-purple-50","hover:!text-purple-700","!transition-colors",3,"click"],[1,"mr-3","!text-purple-600"],["mat-menu-item","",1,"!text-gray-700","hover:!bg-red-50","hover:!text-red-700","!transition-colors","w-full",3,"click","disabled"],["mat-menu-item","",1,"!text-gray-700","hover:!bg-blue-50","hover:!text-blue-700","!transition-colors","w-full",3,"click","disabled"]],template:function(e,i){if(e&1){let l=w();o(0,"div",5)(1,"div",6)(2,"div",7)(3,"div",8)(4,"button",9),C("click",function(){return y(l),E(i.goBack())}),o(5,"mat-icon"),a(6,"arrow_back"),n()(),o(7,"div"),u(8,Vn,4,1)(9,Un,4,0),n()(),u(10,Qn,23,18,"div",10),n()()(),u(11,Zn,4,0,"div",11),u(12,Kn,11,1,"div",12),u(13,Lo,161,70,"div",12),o(14,"mat-menu",13,0),u(16,zo,5,0,"button",14),o(17,"button",15)(18,"mat-icon",16),a(19,"print"),n(),o(20,"span"),a(21,"Print Details"),n(),o(22,"mat-icon",17),a(23,"chevron_right"),n()(),o(24,"button",15)(25,"mat-icon",16),a(26,"email"),n(),o(27,"span"),a(28,"Send Email"),n(),o(29,"mat-icon",17),a(30,"chevron_right"),n()(),u(31,Ho,5,1,"button",18),o(32,"button",19),C("click",function(){return y(l),E(i.exportReservationToPDF())}),u(33,Wo,2,0,"mat-icon",20)(34,Qo,2,0,"mat-icon",21),o(35,"span"),a(36),n()(),u(37,Zo,6,0),n(),o(38,"mat-menu",13,1)(40,"div",22),a(41," Update Payment Information "),n(),u(42,Ko,5,0,"div",23)(43,Yo,2,0,"div",24)(44,Xo,9,0),n(),o(45,"mat-menu",13,2)(47,"div",22),a(48," Email Options "),n(),o(49,"button",25),C("click",function(){return y(l),E(i.sendReservationEmail("details"))}),o(50,"mat-icon",26),a(51,"description"),n(),o(52,"span"),a(53,"Send Reservation Details"),n()(),u(54,ea,5,0,"button",27),u(55,ta,5,0,"button",28),o(56,"div",29),a(57),n()(),o(58,"mat-menu",13,3)(60,"div",22),a(61," Print Options "),n(),o(62,"div",30),u(63,ia,5,0,"div",31)(64,na,5,0,"div",32),n(),o(65,"button",33),C("click",function(){return y(l),E(i.printReservation())}),u(66,oa,2,0,"mat-icon",34)(67,aa,2,0,"mat-icon",26),o(68,"span"),a(69),n()(),o(70,"button",35),C("click",function(){return y(l),E(i.testPrint())}),o(71,"mat-icon",36),a(72,"check_circle"),n(),o(73,"span"),a(74,"Test Print"),n()(),o(75,"div",37),u(76,ra,5,1,"button",38)(77,sa,5,1,"button",39),n(),o(78,"div",29),a(79," \u{1F5A8}\uFE0F Uses Bluetooth thermal printers with ESC/POS commands "),n()()}if(e&2){let l=Z(46),d=Z(59);s(8),g(i.reservation()?8:9),s(2),g(i.reservation()&&!i.loading()?10:-1),s(),g(i.loading()?11:-1),s(),g(i.error()&&!i.loading()?12:-1),s(),g(i.reservation()&&!i.loading()&&!i.error()?13:-1),s(3),g(i.canEdit()?16:-1),s(),v("matMenuTriggerFor",d),s(7),v("matMenuTriggerFor",l),s(7),g(i.canRequestExtension()?31:-1),s(),v("disabled",i.exportingPDF()||i.statusUpdating()),s(),g(i.exportingPDF()?33:34),s(3),m(i.exportingPDF()?"Exporting...":"Export to PDF"),s(),g(i.canDelete()?37:-1),s(5),g(i.isCheckedOut()?42:i.getAvailablePaymentStatusOptions().length===0?43:44),s(12),g(i.reservation()&&(i.reservation().status==="confirmed"||i.reservation().status==="checked_in"||i.reservation().status==="checked_out")?54:-1),s(),g(i.reservation()&&(i.reservation().status==="checked_in"||i.reservation().status==="checked_out")?55:-1),s(2),_(" \u{1F4E7} Email will be sent to: ",i.guestEmail()," "),s(6),g(i.printerConnected()?63:64),s(2),v("disabled",i.printing()||i.statusUpdating()),s(),g(i.printing()?66:67),s(3),m(i.printing()?"Printing...":"Print Reservation"),s(),v("disabled",i.printing()||i.statusUpdating()||!i.printerConnected()),s(6),g(i.printerConnected()?76:77)}},dependencies:[j,Ft,Ae,K,he,q,Zt,z,L,ci,pi,mi,ri,oi,ni,ai,De,qe,ke,$,H,ce,ye,li,si],styles:[".reservation-details-container[_ngcontent-%COMP%]{padding:24px;max-width:1200px;margin:0 auto}.reservation-details-container[_ngcontent-%COMP%]   .error-card[_ngcontent-%COMP%]{margin:24px auto;max-width:400px}.reservation-details-container[_ngcontent-%COMP%]   .error-card[_ngcontent-%COMP%]   .error-icon[_ngcontent-%COMP%]{font-size:48px;width:48px;height:48px;color:#f44336}.reservation-details-container[_ngcontent-%COMP%]   .header-card[_ngcontent-%COMP%]{box-shadow:0 2px 8px #0000001a;border-radius:12px}.reservation-details-container[_ngcontent-%COMP%]   .header-card[_ngcontent-%COMP%]   mat-card-header[_ngcontent-%COMP%]{padding:24px 24px 0}.reservation-details-container[_ngcontent-%COMP%]   .header-card[_ngcontent-%COMP%]   mat-card-content[_ngcontent-%COMP%]{padding:16px 24px}.reservation-details-container[_ngcontent-%COMP%]   .header-card[_ngcontent-%COMP%]   mat-card-actions[_ngcontent-%COMP%]{background-color:#f8f9fa;border-top:1px solid #e9ecef;margin:0}.reservation-details-container[_ngcontent-%COMP%]   .header-card[_ngcontent-%COMP%]   .status-chip[_ngcontent-%COMP%]{font-weight:500;border-radius:20px;padding:8px 16px;font-size:12px;text-transform:uppercase;letter-spacing:.5px}.reservation-details-container[_ngcontent-%COMP%]   mat-card[_ngcontent-%COMP%]{border-radius:12px;box-shadow:0 2px 8px #00000014;border:1px solid #e5e7eb}.reservation-details-container[_ngcontent-%COMP%]   mat-card[_ngcontent-%COMP%]   mat-card-title[_ngcontent-%COMP%]{font-size:20px;font-weight:600;color:#1f2937}.reservation-details-container[_ngcontent-%COMP%]   mat-card[_ngcontent-%COMP%]   mat-card-subtitle[_ngcontent-%COMP%]{font-size:14px;color:#6b7280;margin-top:4px}.reservation-details-container[_ngcontent-%COMP%]     .mat-mdc-tab-group .mat-mdc-tab-header{border-bottom:1px solid #e5e7eb}.reservation-details-container[_ngcontent-%COMP%]     .mat-mdc-tab-group .mat-mdc-tab.mdc-tab--active .mdc-tab__text-label{color:#3b82f6;font-weight:600}.reservation-details-container[_ngcontent-%COMP%]     .mat-mdc-tab-group .mat-mdc-tab-body-content{padding:0}.reservation-details-container[_ngcontent-%COMP%]     .mat-mdc-table{box-shadow:none;border:1px solid #e5e7eb;border-radius:8px;overflow:hidden}.reservation-details-container[_ngcontent-%COMP%]     .mat-mdc-table .mat-mdc-header-row{background-color:#f8f9fa}.reservation-details-container[_ngcontent-%COMP%]     .mat-mdc-table .mat-mdc-header-cell{font-weight:600;color:#374151;border-bottom:1px solid #e5e7eb;font-size:14px}.reservation-details-container[_ngcontent-%COMP%]     .mat-mdc-table .mat-mdc-cell{color:#1f2937;border-bottom:1px solid #f3f4f6;font-size:14px}.reservation-details-container[_ngcontent-%COMP%]     .mat-mdc-table .mat-mdc-row:hover{background-color:#f9fafb}.reservation-details-container[_ngcontent-%COMP%]     .mat-mdc-table .mat-mdc-row:last-child .mat-mdc-cell{border-bottom:none}.reservation-details-container[_ngcontent-%COMP%]     .mat-mdc-chip{font-size:11px;font-weight:500;height:24px;border-radius:12px}.reservation-details-container[_ngcontent-%COMP%]     .mat-mdc-chip.status-chip{border:none}.reservation-details-container[_ngcontent-%COMP%]     .mat-mdc-raised-button{border-radius:8px;font-weight:500;text-transform:none}.reservation-details-container[_ngcontent-%COMP%]     .mat-mdc-raised-button.mat-primary{background-color:#3b82f6;color:#fff}.reservation-details-container[_ngcontent-%COMP%]     .mat-mdc-raised-button.mat-primary:hover{background-color:#2563eb}.reservation-details-container[_ngcontent-%COMP%]     .mat-mdc-button{border-radius:8px;font-weight:500;text-transform:none}.reservation-details-container[_ngcontent-%COMP%]     .mat-mdc-menu-panel{border-radius:8px;box-shadow:0 4px 16px #0000001f}.reservation-details-container[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]{display:grid}.reservation-details-container[_ngcontent-%COMP%]   .grid-cols-1[_ngcontent-%COMP%]{grid-template-columns:repeat(1,minmax(0,1fr))}.reservation-details-container[_ngcontent-%COMP%]   .grid-cols-2[_ngcontent-%COMP%]{grid-template-columns:repeat(2,minmax(0,1fr))}.reservation-details-container[_ngcontent-%COMP%]   .grid-cols-3[_ngcontent-%COMP%]{grid-template-columns:repeat(3,minmax(0,1fr))}.reservation-details-container[_ngcontent-%COMP%]   .gap-2[_ngcontent-%COMP%]{gap:.5rem}.reservation-details-container[_ngcontent-%COMP%]   .gap-4[_ngcontent-%COMP%]{gap:1rem}.reservation-details-container[_ngcontent-%COMP%]   .gap-6[_ngcontent-%COMP%]{gap:1.5rem}.reservation-details-container[_ngcontent-%COMP%]   .space-y-1[_ngcontent-%COMP%] > *[_ngcontent-%COMP%] + *[_ngcontent-%COMP%]{margin-top:.25rem}.reservation-details-container[_ngcontent-%COMP%]   .space-y-2[_ngcontent-%COMP%] > *[_ngcontent-%COMP%] + *[_ngcontent-%COMP%]{margin-top:.5rem}.reservation-details-container[_ngcontent-%COMP%]   .space-y-6[_ngcontent-%COMP%] > *[_ngcontent-%COMP%] + *[_ngcontent-%COMP%]{margin-top:1.5rem}@media (min-width: 768px){.reservation-details-container[_ngcontent-%COMP%]   .md\\\\[_ngcontent-%COMP%]:grid-cols-2{grid-template-columns:repeat(2,minmax(0,1fr))}.reservation-details-container[_ngcontent-%COMP%]   .md\\\\[_ngcontent-%COMP%]:grid-cols-3{grid-template-columns:repeat(3,minmax(0,1fr))}}.reservation-details-container[_ngcontent-%COMP%]   .flex[_ngcontent-%COMP%]{display:flex}.reservation-details-container[_ngcontent-%COMP%]   .items-center[_ngcontent-%COMP%]{align-items:center}.reservation-details-container[_ngcontent-%COMP%]   .items-start[_ngcontent-%COMP%]{align-items:flex-start}.reservation-details-container[_ngcontent-%COMP%]   .justify-center[_ngcontent-%COMP%]{justify-content:center}.reservation-details-container[_ngcontent-%COMP%]   .justify-between[_ngcontent-%COMP%]{justify-content:space-between}.reservation-details-container[_ngcontent-%COMP%]   .w-full[_ngcontent-%COMP%]{width:100%}.reservation-details-container[_ngcontent-%COMP%]   .mb-2[_ngcontent-%COMP%]{margin-bottom:.5rem}.reservation-details-container[_ngcontent-%COMP%]   .mb-4[_ngcontent-%COMP%]{margin-bottom:1rem}.reservation-details-container[_ngcontent-%COMP%]   .mb-6[_ngcontent-%COMP%]{margin-bottom:1.5rem}.reservation-details-container[_ngcontent-%COMP%]   .ml-2[_ngcontent-%COMP%]{margin-left:.5rem}.reservation-details-container[_ngcontent-%COMP%]   .p-3[_ngcontent-%COMP%]{padding:.75rem}.reservation-details-container[_ngcontent-%COMP%]   .p-4[_ngcontent-%COMP%]{padding:1rem}.reservation-details-container[_ngcontent-%COMP%]   .py-8[_ngcontent-%COMP%]{padding-top:2rem;padding-bottom:2rem}.reservation-details-container[_ngcontent-%COMP%]   .pb-4[_ngcontent-%COMP%]{padding-bottom:1rem}.reservation-details-container[_ngcontent-%COMP%]   .text-center[_ngcontent-%COMP%]{text-align:center}.reservation-details-container[_ngcontent-%COMP%]   .text-sm[_ngcontent-%COMP%]{font-size:.875rem;line-height:1.25rem}.reservation-details-container[_ngcontent-%COMP%]   .text-lg[_ngcontent-%COMP%]{font-size:1.125rem;line-height:1.75rem}.reservation-details-container[_ngcontent-%COMP%]   .text-4xl[_ngcontent-%COMP%]{font-size:2.25rem;line-height:2.5rem}.reservation-details-container[_ngcontent-%COMP%]   .font-medium[_ngcontent-%COMP%]{font-weight:500}.reservation-details-container[_ngcontent-%COMP%]   .font-semibold[_ngcontent-%COMP%]{font-weight:600}.reservation-details-container[_ngcontent-%COMP%]   .rounded-lg[_ngcontent-%COMP%]{border-radius:.5rem}.reservation-details-container[_ngcontent-%COMP%]   .border[_ngcontent-%COMP%]{border-width:1px}.reservation-details-container[_ngcontent-%COMP%]   .border-t[_ngcontent-%COMP%]{border-top-width:1px}.reservation-details-container[_ngcontent-%COMP%]   .overflow-x-auto[_ngcontent-%COMP%]{overflow-x:auto}.reservation-details-container[_ngcontent-%COMP%]   .text-gray-500[_ngcontent-%COMP%]{color:#6b7280}.reservation-details-container[_ngcontent-%COMP%]   .text-gray-900[_ngcontent-%COMP%]{color:#111827}.reservation-details-container[_ngcontent-%COMP%]   .text-blue-600[_ngcontent-%COMP%]{color:#2563eb}.reservation-details-container[_ngcontent-%COMP%]   .text-green-600[_ngcontent-%COMP%]{color:#059669}.reservation-details-container[_ngcontent-%COMP%]   .text-purple-600[_ngcontent-%COMP%]{color:#9333ea}.reservation-details-container[_ngcontent-%COMP%]   .text-orange-600[_ngcontent-%COMP%]{color:#ea580c}.reservation-details-container[_ngcontent-%COMP%]   .text-red-600[_ngcontent-%COMP%]{color:#dc2626}.reservation-details-container[_ngcontent-%COMP%]   .bg-gray-50[_ngcontent-%COMP%]{background-color:#f9fafb}.reservation-details-container[_ngcontent-%COMP%]   .bg-red-50[_ngcontent-%COMP%]{background-color:#fef2f2}.reservation-details-container[_ngcontent-%COMP%]   .border-red-200[_ngcontent-%COMP%]{border-color:#fecaca}.reservation-details-container[_ngcontent-%COMP%]   .loading-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;min-height:200px}.reservation-details-container[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]{text-align:center;padding:2rem;color:#6b7280}.reservation-details-container[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{opacity:.5}.reservation-details-container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:focus{outline:2px solid #3b82f6;outline-offset:2px}@media print{.reservation-details-container[_ngcontent-%COMP%]   .header-card[_ngcontent-%COMP%]   mat-card-actions[_ngcontent-%COMP%], .reservation-details-container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%], .reservation-details-container[_ngcontent-%COMP%]   .mat-mdc-menu-trigger[_ngcontent-%COMP%]{display:none!important}.reservation-details-container[_ngcontent-%COMP%]   mat-card[_ngcontent-%COMP%]{box-shadow:none;border:1px solid #ccc}}@media (prefers-color-scheme: dark){.reservation-details-container[_ngcontent-%COMP%]   mat-card[_ngcontent-%COMP%]{background-color:#374151;color:#f9fafb}.reservation-details-container[_ngcontent-%COMP%]   .text-gray-900[_ngcontent-%COMP%]{color:#f9fafb}.reservation-details-container[_ngcontent-%COMP%]   .text-gray-500[_ngcontent-%COMP%]{color:#9ca3af}.reservation-details-container[_ngcontent-%COMP%]   .bg-gray-50[_ngcontent-%COMP%]{background-color:#4b5563}}"]})};export{ki as ReservationDetailsComponent};
