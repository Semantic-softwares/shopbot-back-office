  <h2 class="text-sm font-semibold text-blue-600 mb-6">Invoices</h2>

<mat-card class="mb-12 py-2" appearance="outlined">


  <!-- Loading State -->
  @if (invoicesResource.isLoading()) {
    <div class="flex justify-center py-8">
      <mat-spinner [diameter]="40"></mat-spinner>
    </div>
  }

  <!-- Error State -->
  @if (invoicesResource.error()) {
    <div class="bg-red-50 border border-red-200 rounded-lg p-4 mb-4">
      <p class="text-red-800 text-sm">Failed to load invoices. Please try again later.</p>
    </div>
  }

  <!-- Invoices Table -->
  @if (!invoicesResource.isLoading() && invoices().length > 0) {
      <table mat-table [dataSource]="invoices()" class="w-full text-sm">
        <!-- Billing Date Column -->
        <ng-container matColumnDef="billingDate">
          <th mat-header-cell *matHeaderCellDef class="bg-gray-50 px-6 py-3 text-left font-semibold text-gray-700">
            Invoice Date
          </th>
          <td mat-cell *matCellDef="let element" class="px-6 py-4">
            <span class="text-gray-900 font-medium">{{ element.billingDate | date: 'MMM d, y' }}</span>
          </td>
        </ng-container>

        <!-- Description Column -->
        <ng-container matColumnDef="description">
          <th mat-header-cell *matHeaderCellDef class="bg-gray-50 px-6 py-3 text-left font-semibold text-gray-700">
            Description
          </th>
          <td mat-cell *matCellDef="let element" class="px-6 py-4">
            <span class="text-gray-600">{{ element.description }}</span>
          </td>
        </ng-container>

        <!-- Amount Column -->
        <ng-container matColumnDef="amount">
          <th mat-header-cell *matHeaderCellDef class="bg-gray-50 px-6 py-3 text-right font-semibold text-gray-700">
            Amount
          </th>
          <td mat-cell *matCellDef="let element" class="px-6 py-4 text-right">
            <span class="text-gray-900 font-semibold">
              {{ element.currency }} {{ element.amount | number: '1.2-2' }}
            </span>
          </td>
        </ng-container>

        <!-- Status Column -->
        <ng-container matColumnDef="status">
          <th mat-header-cell *matHeaderCellDef class="bg-gray-50 px-6 py-3 text-center font-semibold text-gray-700">
            Status
          </th>
          <td mat-cell *matCellDef="let element" class="px-6 py-4 text-center">
            <span
              class="inline-flex items-center px-3 py-1 rounded-full text-xs font-semibold"
              [ngClass]="getStatusClass(element.status)"
            >
              {{ formatStatus(element.status) }}
            </span>
          </td>
        </ng-container>

        <!-- Actions Column -->
        <ng-container matColumnDef="actions">
          <th mat-header-cell *matHeaderCellDef class="bg-gray-50 px-6 py-3 text-right font-semibold text-gray-700">
            Actions
          </th>
          <td mat-cell *matCellDef="let element" class="px-6 py-4 text-right">
            <button
              mat-icon-button
              matTooltip="Download PDF"
              (click)="downloadInvoice(element)"
              [disabled]="isDownloading()"
              class="hover:bg-blue-50"
            >
              @if (isDownloading()) {
                <mat-spinner [diameter]="20"></mat-spinner>
              } @else {
                <mat-icon class="text-blue-600">download</mat-icon>
              }
            </button>
          </td>
        </ng-container>

        <!-- Table Header and Body -->
        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
      </table>
       <!-- Paginator -->
    <mat-paginator
      [length]="totalInvoices()"
      [pageSize]="12"
      [pageSizeOptions]="[6, 12, 24]"
      (page)="onPageChange($event)"
      showFirstLastButtons
      aria-label="Select page of invoices"
    ></mat-paginator>

   
  } @else if (!invoicesResource.isLoading()) {
    <app-no-record icon="receipt_long" title="No Invoices" message="You don't have any invoices yet." />
  }
</mat-card>
