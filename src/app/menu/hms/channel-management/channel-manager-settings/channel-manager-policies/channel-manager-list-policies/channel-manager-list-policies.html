  <!-- Page Header -->
  <app-page-header
    title="Hotel Policies"
    subtitle="Manage your hotel policies">
  
    <ng-container actions>
      <button
        matButton="filled"
        color="primary"
        (click)="createPolicy()"
        [disabled]="policies.isLoading()"
        class="px-4"
      >
        <mat-icon>add</mat-icon>
        Create Policy
      </button>
    </ng-container>
  </app-page-header>

  <!-- Loading State -->
  @if (policies.isLoading()) {
    <div class="flex justify-center items-center py-20">
      <mat-spinner diameter="50"></mat-spinner>
    </div>
  }

  <!-- Error State -->
  @if (policies.error()) {
    <app-no-record
      icon="error_outline"
      title="Failed to Load Policies"
      [message]="policies.error()?.message || 'Unable to load hotel policies. Please try again.'"
    ></app-no-record>
  }

  <!-- Policies Table -->
  @if (!policies.isLoading() && dataSource && dataSource.data.length > 0) {
    <mat-card appearance="outlined" class="mt-6">
      <mat-card-content class="p-0">
        <!-- Search Field -->
        <div class="p-4 border-b border-gray-200">
          <mat-form-field appearance="outline" class="w-full md:w-80">
            <mat-label>Search policies</mat-label>
            <input
              matInput
              [(ngModel)]="searchText"
              (input)="applyFilter()"
              placeholder="Search by title..."
            />
            <mat-icon matSuffix>search</mat-icon>
          </mat-form-field>
        </div>

        <!-- Table -->
        <table mat-table [dataSource]="dataSource" matSort #table>
          <!-- Title Column -->
          <ng-container matColumnDef="title">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>Policy Title</th>
            <td mat-cell *matCellDef="let element">
              <span class="font-semibold text-gray-900">{{ element.attributes?.title }}</span>
            </td>
          </ng-container>

          <!-- Currency Column -->
          <ng-container matColumnDef="currency">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>Currency</th>
            <td mat-cell *matCellDef="let element">
              {{ element.attributes?.currency }}
            </td>
          </ng-container>

          <!-- Check-in Time Column -->
          <ng-container matColumnDef="checkin_time">
            <th mat-header-cell *matHeaderCellDef>Check-in</th>
            <td mat-cell *matCellDef="let element">
              {{ element.attributes?.checkin_from_time }} - {{ element.attributes?.checkin_to_time }}
            </td>
          </ng-container>

          <!-- Check-out Time Column -->
          <ng-container matColumnDef="checkout_time">
            <th mat-header-cell *matHeaderCellDef>Check-out</th>
            <td mat-cell *matCellDef="let element">
              {{ element.attributes?.checkout_from_time }} - {{ element.attributes?.checkout_to_time }}
            </td>
          </ng-container>

          <!-- Max Guests Column -->
          <ng-container matColumnDef="max_guests">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>Max Guests</th>
            <td mat-cell *matCellDef="let element">
              {{ element.attributes?.max_count_of_guests }}
            </td>
          </ng-container>

          <!-- Actions Column -->
          <ng-container matColumnDef="actions">
            <th mat-header-cell *matHeaderCellDef>Actions</th>
            <td mat-cell *matCellDef="let element" class="text-right">
              <button
                mat-icon-button
                [matMenuTriggerFor]="menu"
                matTooltip="More options"
              >
                <mat-icon>more_vert</mat-icon>
              </button>
              <mat-menu #menu="matMenu">
                <button mat-menu-item (click)="editPolicy(element)">
                  <mat-icon>edit</mat-icon>
                  <span>Edit</span>
                </button>
                <button mat-menu-item (click)="deletePolicy(element)" class="text-red-600">
                  <mat-icon>delete</mat-icon>
                  <span>Delete</span>
                </button>
              </mat-menu>
            </td>
          </ng-container>

          <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
          <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
        </table>

        <!-- Paginator -->
        <mat-paginator
          [pageSizeOptions]="[5, 10, 20, 50]"
          showFirstLastButtons
          aria-label="Select page"
        ></mat-paginator>
      </mat-card-content>
    </mat-card>
  }

  <!-- Empty State -->
  @if (!policies.isLoading() && (!dataSource || dataSource.data.length === 0) && !policies.error()) {
    <app-no-record
      icon="policy"
      title="No Policies Found"
      message="No hotel policies have been created yet. Create your first policy to get started."
    ></app-no-record>
  }
