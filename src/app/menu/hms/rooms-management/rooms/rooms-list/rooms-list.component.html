<!-- Header Section -->
<div class="bg-gradient-to-r from-blue-50 to-indigo-50 border-b border-blue-100">
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
    <div class="flex justify-between items-center py-6">
      <div>
        <h1 class="text-3xl font-bold text-gray-900 mb-1">Rooms Management</h1>
        <p class="text-sm text-gray-600">Manage hotel rooms, room types, and availability</p>
      </div>
      <div class="flex items-center gap-3">
        <button 
          class="p-2 text-gray-600 hover:text-gray-900 hover:bg-white/60 rounded-lg transition-all duration-200"
          (click)="toggleViewMode()" 
          [title]="viewMode() === 'table' ? 'Switch to Grid View' : 'Switch to Table View'">
          <mat-icon>{{ viewMode() === 'table' ? 'grid_view' : 'table_view' }}</mat-icon>
        </button>
        <button 
          class="!bg-gradient-to-r !from-blue-600 !to-blue-700 hover:!from-blue-700 hover:!to-blue-800 !text-white px-6 py-3 rounded-lg font-medium transition-all duration-200 shadow-lg hover:shadow-xl transform hover:scale-105 flex items-center gap-2"
          routerLink="./create">
          <mat-icon class="text-lg">add</mat-icon>
          Add Room
        </button>
      </div>
    </div>
  </div>
</div>

<!-- Stats Cards -->
<div class="bg-white shadow-sm border-b border-gray-100">
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6">
    <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4">
      <div class="bg-gradient-to-br from-blue-50 to-blue-100 rounded-xl border border-blue-200 p-4 shadow-sm hover:shadow-md transition-all duration-200">
        <div class="flex items-center gap-3">
          <div class="w-12 h-12 bg-gradient-to-r from-blue-500 to-blue-600 rounded-full flex items-center justify-center shadow-lg">
            <mat-icon class="text-white text-xl">hotel</mat-icon>
          </div>
          <div>
            <div class="text-2xl font-bold text-gray-900">{{ roomStats().total }}</div>
            <div class="text-sm font-medium text-gray-600">Total Rooms</div>
          </div>
        </div>
      </div>

      <div class="bg-gradient-to-br from-green-50 to-green-100 rounded-xl border border-green-200 p-4 shadow-sm hover:shadow-md transition-all duration-200">
        <div class="flex items-center gap-3">
          <div class="w-12 h-12 bg-gradient-to-r from-green-500 to-green-600 rounded-full flex items-center justify-center shadow-lg">
            <mat-icon class="text-white text-xl">check_circle</mat-icon>
          </div>
          <div>
            <div class="text-2xl font-bold text-gray-900">{{ roomStats().available }}</div>
            <div class="text-sm font-medium text-gray-600">Available</div>
          </div>
        </div>
      </div>

      <div class="bg-gradient-to-br from-purple-50 to-purple-100 rounded-xl border border-purple-200 p-4 shadow-sm hover:shadow-md transition-all duration-200">
        <div class="flex items-center gap-3">
          <div class="w-12 h-12 bg-gradient-to-r from-purple-500 to-purple-600 rounded-full flex items-center justify-center shadow-lg">
            <mat-icon class="text-white text-xl">person</mat-icon>
          </div>
          <div>
            <div class="text-2xl font-bold text-gray-900">{{ roomStats().occupied }}</div>
            <div class="text-sm font-medium text-gray-600">Occupied</div>
          </div>
        </div>
      </div>

      <div class="bg-gradient-to-br from-orange-50 to-orange-100 rounded-xl border border-orange-200 p-4 shadow-sm hover:shadow-md transition-all duration-200">
        <div class="flex items-center gap-3">
          <div class="w-12 h-12 bg-gradient-to-r from-orange-500 to-orange-600 rounded-full flex items-center justify-center shadow-lg">
            <mat-icon class="text-white text-xl">build</mat-icon>
          </div>
          <div>
            <div class="text-2xl font-bold text-gray-900">{{ roomStats().maintenance }}</div>
            <div class="text-sm font-medium text-gray-600">Maintenance</div>
          </div>
        </div>
      </div>

      <div class="bg-gradient-to-br from-cyan-50 to-cyan-100 rounded-xl border border-cyan-200 p-4 shadow-sm hover:shadow-md transition-all duration-200">
        <div class="flex items-center gap-3">
          <div class="w-12 h-12 bg-gradient-to-r from-cyan-500 to-cyan-600 rounded-full flex items-center justify-center shadow-lg">
            <mat-icon class="text-white text-xl">cleaning_services</mat-icon>
          </div>
          <div>
            <div class="text-2xl font-bold text-gray-900">{{ roomStats().cleaning }}</div>
            <div class="text-sm font-medium text-gray-600">Cleaning</div>
          </div>
        </div>
      </div>

      <div class="bg-gradient-to-br from-red-50 to-red-100 rounded-xl border border-red-200 p-4 shadow-sm hover:shadow-md transition-all duration-200">
        <div class="flex items-center gap-3">
          <div class="w-12 h-12 bg-gradient-to-r from-red-500 to-red-600 rounded-full flex items-center justify-center shadow-lg">
            <mat-icon class="text-white text-xl">error</mat-icon>
          </div>
          <div>
            <div class="text-2xl font-bold text-gray-900">{{ roomStats().outOfOrder }}</div>
            <div class="text-sm font-medium text-gray-600">Out of Order</div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Filters Section -->
<div class="bg-white shadow-sm border-b border-gray-100">
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6">
    <form [formGroup]="filterForm">
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 xl:grid-cols-6 gap-4 mb-4">
        <div class="lg:col-span-2">
          <mat-form-field appearance="outline" class="w-full [&_.mdc-text-field--outlined]:!bg-gray-50 [&_.mdc-text-field--outlined]:!border-gray-200 hover:[&_.mdc-text-field--outlined]:!border-blue-300 [&_.mdc-text-field--focused_.mdc-text-field--outlined]:!border-blue-500">
            <mat-label>Search rooms...</mat-label>
            <mat-icon matPrefix class="text-gray-400">search</mat-icon>
            <input matInput formControlName="search" placeholder="Room number, type..." class="!bg-gray-50">
          </mat-form-field>
        </div>

        <div>
          <mat-form-field appearance="outline" class="w-full [&_.mdc-text-field--outlined]:!bg-gray-50 [&_.mdc-text-field--outlined]:!border-gray-200 hover:[&_.mdc-text-field--outlined]:!border-blue-300 [&_.mdc-text-field--focused_.mdc-text-field--outlined]:!border-blue-500">
            <mat-label>Status</mat-label>
            <mat-select formControlName="status" multiple>
              @for (status of statusOptions; track status) {
                <mat-option [value]="status">
                  <span class="flex items-center">
                    <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium mr-2"
                          [ngClass]="{
                            'bg-green-100 text-green-800': status === 'available',
                            'bg-purple-100 text-purple-800': status === 'occupied',
                            'bg-orange-100 text-orange-800': status === 'maintenance',
                            'bg-cyan-100 text-cyan-800': status === 'cleaning',
                            'bg-red-100 text-red-800': status === 'out_of_order'
                          }">
                      {{ status | titlecase }}
                    </span>
                  </span>
                </mat-option>
              }
            </mat-select>
          </mat-form-field>
        </div>

        <div>
          <mat-form-field appearance="outline" class="w-full [&_.mdc-text-field--outlined]:!bg-gray-50 [&_.mdc-text-field--outlined]:!border-gray-200 hover:[&_.mdc-text-field--outlined]:!border-blue-300 [&_.mdc-text-field--focused_.mdc-text-field--outlined]:!border-blue-500">
            <mat-label>Housekeeping</mat-label>
            <mat-select formControlName="housekeepingStatus" multiple>
              @for (status of housekeepingOptions; track status) {
                <mat-option [value]="status">
                  <span class="flex items-center">
                    <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium mr-2"
                          [ngClass]="{
                            'bg-green-100 text-green-800': status === 'clean',
                            'bg-orange-100 text-orange-800': status === 'dirty',
                            'bg-cyan-100 text-cyan-800': status === 'inspected',
                            'bg-red-100 text-red-800': status === 'out_of_order'
                          }">
                      {{ status | titlecase }}
                    </span>
                  </span>
                </mat-option>
              }
            </mat-select>
          </mat-form-field>
        </div>

        <div>
          <mat-form-field appearance="outline" class="w-full [&_.mdc-text-field--outlined]:!bg-gray-50 [&_.mdc-text-field--outlined]:!border-gray-200 hover:[&_.mdc-text-field--outlined]:!border-blue-300 [&_.mdc-text-field--focused_.mdc-text-field--outlined]:!border-blue-500">
            <mat-label>Room Type</mat-label>
            <mat-select formControlName="roomType" multiple>
              @for (roomType of roomTypes(); track roomType.id || roomType._id) {
                <mat-option [value]="roomType.id || roomType._id">{{ roomType.name }}</mat-option>
              }
            </mat-select>
          </mat-form-field>
        </div>

        <div>
          <mat-form-field appearance="outline" class="w-full [&_.mdc-text-field--outlined]:!bg-gray-50 [&_.mdc-text-field--outlined]:!border-gray-200 hover:[&_.mdc-text-field--outlined]:!border-blue-300 [&_.mdc-text-field--focused_.mdc-text-field--outlined]:!border-blue-500">
            <mat-label>Floor</mat-label>
            <mat-select formControlName="floor" multiple>
              @for (floor of getFloorOptions(); track floor) {
                <mat-option [value]="floor">Floor {{ floor }}</mat-option>
              }
            </mat-select>
          </mat-form-field>
        </div>
      </div>

      <!-- Quick Filters -->
      <div class="flex items-center gap-3 flex-wrap">
        <span class="text-sm font-medium text-gray-600 mr-2">Quick filters:</span>
        <button type="button" class="px-3 py-1.5 text-sm font-medium bg-green-50 text-green-700 border border-green-200 rounded-lg hover:bg-green-100 transition-all duration-200" (click)="applyQuickFilter({status: ['available']})">Available</button>
        <button type="button" class="px-3 py-1.5 text-sm font-medium bg-purple-50 text-purple-700 border border-purple-200 rounded-lg hover:bg-purple-100 transition-all duration-200" (click)="applyQuickFilter({status: ['occupied']})">Occupied</button>
        <button type="button" class="px-3 py-1.5 text-sm font-medium bg-orange-50 text-orange-700 border border-orange-200 rounded-lg hover:bg-orange-100 transition-all duration-200" (click)="applyQuickFilter({status: ['maintenance']})">Maintenance</button>
        <button type="button" class="px-3 py-1.5 text-sm font-medium bg-cyan-50 text-cyan-700 border border-cyan-200 rounded-lg hover:bg-cyan-100 transition-all duration-200" (click)="applyQuickFilter({housekeepingStatus: ['dirty']})">Needs Cleaning</button>
        <button type="button" class="px-3 py-1.5 text-sm font-medium text-gray-600 hover:text-gray-800 bg-gray-50 border border-gray-200 rounded-lg hover:bg-gray-100 transition-all duration-200 flex items-center gap-1" (click)="clearFilters()">
          <mat-icon class="text-sm">clear</mat-icon>
          Clear
        </button>
      </div>
    </form>
  </div>
</div>

<!-- Main Content -->
<div class="bg-gray-50 min-h-screen">
  <div >

    <!-- Bulk Actions -->
    @if (selectedRooms().length > 0) {
      <div class="bg-gradient-to-r from-blue-50 to-blue-100 border border-blue-200 rounded-lg p-4 mb-6 shadow-sm">
        <div class="flex justify-between items-center flex-wrap gap-4">
          <span class="text-blue-800 font-semibold">{{ selectedRooms().length }} room(s) selected</span>
          <div class="flex gap-2 flex-wrap">
            <button class="px-4 py-2 text-sm font-medium bg-green-600 text-white rounded-lg hover:bg-green-700 transition-all duration-200 shadow-sm hover:shadow-md flex items-center gap-2" (click)="bulkUpdateStatus('available')">
              <mat-icon class="text-sm">check_circle</mat-icon>
              Mark Available
            </button>
            <button class="px-4 py-2 text-sm font-medium bg-orange-600 text-white rounded-lg hover:bg-orange-700 transition-all duration-200 shadow-sm hover:shadow-md flex items-center gap-2" (click)="bulkUpdateStatus('maintenance')">
              <mat-icon class="text-sm">build</mat-icon>
              Mark Maintenance
            </button>
            <button class="px-4 py-2 text-sm font-medium bg-cyan-600 text-white rounded-lg hover:bg-cyan-700 transition-all duration-200 shadow-sm hover:shadow-md flex items-center gap-2" (click)="bulkUpdateStatus('cleaning')">
              <mat-icon class="text-sm">cleaning_services</mat-icon>
              Mark Cleaning
            </button>
            <button class="px-3 py-2 text-sm font-medium text-gray-600 hover:text-gray-800 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-all duration-200 flex items-center gap-2" (click)="clearSelection()">
              <mat-icon class="text-sm">clear</mat-icon>
              Clear Selection
            </button>
          </div>
        </div>
      </div>
    }

    <!-- Loading Spinner -->
    @if (loading()) {
      <div class="flex justify-center items-center py-12 bg-white rounded-lg shadow-sm">
        <div class="animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"></div>
        <span class="ml-3 text-gray-600">Loading rooms...</span>
      </div>
    }

    <!-- Table View -->
    @if (viewMode() === 'table' && !loading()) {
      <div class="bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden my-6">
        <div class="overflow-x-auto">
          <table class="min-w-full divide-y divide-gray-200">
            <thead class="bg-gradient-to-r from-gray-50 to-gray-100">
              <tr>
                <th class="px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider border-b-2 border-gray-200">
                  <mat-checkbox 
                    [checked]="selectedRooms().length === filteredRooms().length && filteredRooms().length > 0"
                    [indeterminate]="selectedRooms().length > 0 && selectedRooms().length < filteredRooms().length"
                    (change)="selectedRooms().length === filteredRooms().length ? clearSelection() : selectAllRooms()">
                  </mat-checkbox>
                </th>
                <th class="px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider border-b-2 border-gray-200">Room</th>
                <th class="px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider border-b-2 border-gray-200">Type & Capacity</th>
                <th class="px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider border-b-2 border-gray-200">Size & View</th>
                <th class="px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider border-b-2 border-gray-200">Quality</th>
                <th class="px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider border-b-2 border-gray-200">Status</th>
                <th class="px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider border-b-2 border-gray-200">Housekeeping</th>
                <th class="px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider border-b-2 border-gray-200">Features</th>
                <th class="px-6 py-4 text-right text-xs font-semibold text-gray-700 uppercase tracking-wider border-b-2 border-gray-200">Actions</th>
              </tr>
            </thead>
            <tbody class="bg-white divide-y divide-gray-100">
              @for (room of filteredRooms(); track room._id || room.id) {
                <tr class="hover:bg-gray-50 transition-colors duration-200">
                  <td class="px-6 py-4 whitespace-nowrap border-b border-gray-100">
                    <mat-checkbox 
                      [checked]="isRoomSelected(room)"
                      (change)="toggleRoomSelection(room)">
                    </mat-checkbox>
                  </td>
                  <td class="px-6 py-4 whitespace-nowrap border-b border-gray-100">
                    <div class="flex items-center space-x-3">
                      <div class="w-10 h-10 bg-gradient-to-r from-blue-500 to-blue-600 rounded-lg flex items-center justify-center shadow-sm">
                        <mat-icon class="text-white text-lg">hotel</mat-icon>
                      </div>
                      <div>
                        <div class="text-sm font-semibold text-gray-900">
                          @if (room.name) {
                            {{ room.name }}
                            <span class="text-xs text-gray-500 ml-1">({{ room.roomNumber }})</span>
                          } @else {
                            {{ room.roomNumber }}
                          }
                        </div>
                        @if (room.floor !== undefined && room.floor !== null) {
                          <div class="text-sm text-gray-500">Floor {{ room.floor }}</div>
                        }
                        @if (room.bedConfiguration) {
                          <div class="text-xs text-blue-600 font-medium">{{ room.bedConfiguration }}</div>
                        }
                      </div>
                    </div>
                  </td>
                  <td class="px-6 py-4 whitespace-nowrap border-b border-gray-100">
                    <div>
                      <div class="text-sm font-semibold text-gray-900">{{ getRoomTypeName(room) }}</div>
                      <div class="text-sm text-gray-500">
                        @if (room.capacity) {
                          {{ room.capacity.adults }}A/{{ room.capacity.children }}C
                        } @else if (room.roomType && typeof room.roomType === 'object') {
                          {{ room.roomType.capacity.adults }}A/{{ room.roomType.capacity.children }}C
                        }
                        @if (room.maxOccupancy) {
                          • Max {{ room.maxOccupancy }}
                        }
                      </div>
                      <div class="text-sm text-green-600 font-medium">
                        @if (room.priceOverride) {
                          ${{ room.priceOverride }}/night
                        } @else if (room.roomType && typeof room.roomType === 'object') {
                          ${{ room.roomType.basePrice }}/night
                        }
                      </div>
                    </div>
                  </td>
                  <td class="px-6 py-4 whitespace-nowrap border-b border-gray-100">
                    <div>
                      @if (room.size) {
                        <div class="text-sm font-medium text-gray-900">{{ getSizeDisplay(room.size) }}</div>
                      }
                      @if (room.viewType) {
                        <div class="text-sm text-gray-600 flex items-center gap-1">
                          <mat-icon class="text-xs">{{ getViewIcon(room.viewType) }}</mat-icon>
                          {{ room.viewType | titlecase }} View
                        </div>
                      }
                    </div>
                  </td>
                  <td class="px-6 py-4 whitespace-nowrap border-b border-gray-100">
                    @if (room.qualityRating) {
                      <div class="flex items-center gap-1">
                        @for (star of [].constructor(room.qualityRating); track $index) {
                          <mat-icon class="text-yellow-400 text-sm">star</mat-icon>
                        }
                        @for (star of [].constructor(5 - room.qualityRating); track $index) {
                          <mat-icon class="text-gray-300 text-sm">star_border</mat-icon>
                        }
                        <span class="text-sm text-gray-600 ml-1">{{ room.qualityRating }}/5</span>
                      </div>
                    } @else {
                      <span class="text-sm text-gray-400">Not rated</span>
                    }
                  </td>
                  <td class="px-6 py-4 whitespace-nowrap border-b border-gray-100">
                    <span class="inline-flex items-center px-3 py-2 text-xs font-bold rounded-full shadow-sm ring-2"
                          [ngClass]="{
                            'bg-green-100 text-green-800 ring-green-200': room.status === 'available',
                            'bg-purple-100 text-purple-800 ring-purple-200': room.status === 'occupied',
                            'bg-orange-100 text-orange-800 ring-orange-200': room.status === 'maintenance',
                            'bg-cyan-100 text-cyan-800 ring-cyan-200': room.status === 'cleaning',
                            'bg-red-100 text-red-800 ring-red-200': room.status === 'out_of_order'
                          }">
                      <span class="w-2 h-2 rounded-full mr-2"
                            [ngClass]="{
                              'bg-green-600': room.status === 'available',
                              'bg-purple-600': room.status === 'occupied',
                              'bg-orange-600': room.status === 'maintenance',
                              'bg-cyan-600': room.status === 'cleaning',
                              'bg-red-600': room.status === 'out_of_order'
                            }"></span>
                      {{ room.status | titlecase }}
                    </span>
                  </td>
                  <td class="px-6 py-4 whitespace-nowrap border-b border-gray-100">
                    <span class="inline-flex items-center px-3 py-2 text-xs font-bold rounded-full shadow-sm ring-2"
                          [ngClass]="{
                            'bg-green-100 text-green-800 ring-green-200': room.housekeepingStatus === 'clean',
                            'bg-orange-100 text-orange-800 ring-orange-200': room.housekeepingStatus === 'dirty',
                            'bg-cyan-100 text-cyan-800 ring-cyan-200': room.housekeepingStatus === 'inspected',
                            'bg-red-100 text-red-800 ring-red-200': room.housekeepingStatus === 'out_of_order'
                          }">
                      <span class="w-2 h-2 rounded-full mr-2"
                            [ngClass]="{
                              'bg-green-600': room.housekeepingStatus === 'clean',
                              'bg-orange-600': room.housekeepingStatus === 'dirty',
                              'bg-cyan-600': room.housekeepingStatus === 'inspected',
                              'bg-red-600': room.housekeepingStatus === 'out_of_order'
                            }"></span>
                      {{ room.housekeepingStatus | titlecase }}
                    </span>
                  </td>
                  <td class="px-6 py-4 whitespace-nowrap border-b border-gray-100">
                    <div class="flex flex-wrap gap-1">
                      @for (feature of getFeaturesList(room).slice(0, 3); track feature) {
                        <span class="inline-flex items-center px-2 py-1 rounded-md text-xs font-medium bg-gray-100 text-gray-700 border border-gray-200">{{ feature }}</span>
                      }
                      @if (getFeaturesList(room).length > 3) {
                        <span class="inline-flex items-center px-2 py-1 rounded-md text-xs font-medium bg-gray-200 text-gray-600 border border-gray-300">+{{ getFeaturesList(room).length - 3 }}</span>
                      }
                    </div>
                  </td>
                  <td class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium border-b border-gray-100">
                    <div class="flex items-center justify-end gap-2">
                      <button class="text-blue-600 hover:text-blue-900 p-2 rounded-lg hover:bg-blue-50 transition-all duration-200" [routerLink]="['./', room._id || room.id]" title="View Details">
                        <mat-icon class="text-lg">visibility</mat-icon>
                      </button>
                      <button class="text-green-600 hover:text-green-900 p-2 rounded-lg hover:bg-green-50 transition-all duration-200" [routerLink]="['./', room._id || room.id, 'edit']" title="Edit Room">
                        <mat-icon class="text-lg">edit</mat-icon>
                      </button>
                      <div class="relative inline-block text-left">
                        <button class="text-gray-600 hover:text-gray-900 p-2 rounded-lg hover:bg-gray-100 transition-all duration-200" title="More Actions">
                          <mat-icon class="text-lg">more_vert</mat-icon>
                        </button>
                      </div>
                    </div>
                  </td>
                </tr>
              }
            </tbody>
          </table>
        </div>

        @if (filteredRooms().length === 0 && !loading()) {
          <div class="py-20 bg-gradient-to-br from-gray-50 to-white text-center">
            <div class="w-16 h-16 bg-gray-200 rounded-full flex items-center justify-center mx-auto mb-4">
              <mat-icon class="text-4xl text-gray-400">hotel</mat-icon>
            </div>
            <h3 class="text-lg font-semibold text-gray-900 mb-2">No rooms found</h3>
            <p class="text-gray-500 mb-6">Try adjusting your filters or create a new room.</p>
            <button class="!bg-gradient-to-r !from-blue-600 !to-blue-700 hover:!from-blue-700 hover:!to-blue-800 !text-white px-6 py-3 rounded-lg font-medium transition-all duration-200 shadow-lg hover:shadow-xl transform hover:scale-105 inline-flex items-center gap-2" routerLink="/hms/rooms-management/rooms/create">
              <mat-icon class="text-lg">add</mat-icon>
              Add Room
            </button>
          </div>
        }
      </div>
    }

    <!-- Grid View -->
    @if (viewMode() === 'grid' && !loading()) {
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6">
        @for (room of filteredRooms(); track room._id || room.id) {
          <div class="bg-white rounded-xl border border-gray-200 shadow-sm hover:shadow-lg transition-all duration-300 overflow-hidden" 
               [class.ring-2]="isRoomSelected(room)" 
               [class.ring-blue-500]="isRoomSelected(room)"
               [class.bg-blue-50]="isRoomSelected(room)">
            <div class="p-6">
              <div class="flex items-start justify-between mb-4">
                <div class="flex items-start gap-3">
                  <mat-checkbox 
                    [checked]="isRoomSelected(room)"
                    (change)="toggleRoomSelection(room)">
                  </mat-checkbox>
                  <div class="flex items-center gap-3">
                    <div class="w-10 h-10 bg-gradient-to-r from-blue-500 to-blue-600 rounded-lg flex items-center justify-center shadow-sm">
                      <mat-icon class="text-white text-lg">hotel</mat-icon>
                    </div>
                    <div>
                      <h3 class="text-lg font-bold text-gray-900">
                        @if (room.name) {
                          {{ room.name }}
                          <span class="text-sm text-gray-500 font-normal ml-1">({{ room.roomNumber }})</span>
                        } @else {
                          Room {{ room.roomNumber }}
                        }
                      </h3>
                      <p class="text-sm font-medium text-gray-600">{{ getRoomTypeName(room) }}</p>
                    </div>
                  </div>
                </div>
              </div>

              <div class="space-y-3 mb-4">
                <!-- Floor & Basic Info -->
                <div class="grid grid-cols-2 gap-4">
                  @if (room.floor !== undefined && room.floor !== null) {
                    <div class="flex items-center gap-2 text-sm text-gray-600">
                      <mat-icon class="text-base text-gray-400">layers</mat-icon>
                      <span>Floor {{ room.floor }}</span>
                    </div>
                  }
                  
                  @if (room.size) {
                    <div class="flex items-center gap-2 text-sm text-gray-600">
                      <mat-icon class="text-base text-gray-400">fullscreen</mat-icon>
                      <span>{{ getSizeDisplay(room.size) }}</span>
                    </div>
                  }
                  
                  @if (room.viewType) {
                    <div class="flex items-center gap-2 text-sm text-gray-600">
                      <mat-icon class="text-base text-gray-400">{{ getViewIcon(room.viewType) }}</mat-icon>
                      <span>{{ room.viewType | titlecase }} View</span>
                    </div>
                  }
                  
                  @if (room.bedConfiguration) {
                    <div class="flex items-center gap-2 text-sm text-gray-600">
                      <mat-icon class="text-base text-gray-400">bed</mat-icon>
                      <span>{{ room.bedConfiguration }}</span>
                    </div>
                  }
                </div>

                <!-- Capacity Info -->
                <div class="flex items-center gap-2 text-sm text-gray-600">
                  <mat-icon class="text-base text-gray-400">people</mat-icon>
                  <span>
                    @if (room.capacity) {
                      {{ room.capacity.adults }}A/{{ room.capacity.children }}C
                    } @else if (room.roomType && typeof room.roomType === 'object') {
                      {{ room.roomType.capacity.adults }}A/{{ room.roomType.capacity.children }}C
                    }
                    @if (room.maxOccupancy) {
                      (Max {{ room.maxOccupancy }})
                    }
                  </span>
                </div>

                <!-- Price Info -->
                <div class="flex items-center gap-2 text-sm">
                  <mat-icon class="text-base text-gray-400">attach_money</mat-icon>
                  <span class="font-medium text-green-600">
                    @if (room.priceOverride) {
                      ${{ room.priceOverride }}/night (Custom)
                    } @else if (room.roomType && typeof room.roomType === 'object') {
                      ${{ room.roomType.basePrice }}/night
                    }
                  </span>
                </div>

                <!-- Quality Rating -->
                @if (room.qualityRating) {
                  <div class="flex items-center gap-2 text-sm text-gray-600">
                    <div class="flex items-center gap-1">
                      @for (star of [].constructor(room.qualityRating); track $index) {
                        <mat-icon class="text-yellow-400 text-sm">star</mat-icon>
                      }
                      @for (star of [].constructor(5 - room.qualityRating); track $index) {
                        <mat-icon class="text-gray-300 text-sm">star_border</mat-icon>
                      }
                      <span class="ml-1">{{ room.qualityRating }}/5</span>
                    </div>
                  </div>
                }

                <!-- Status Info -->
                <div class="flex items-center justify-between text-sm">
                  <div class="flex items-center gap-2 text-gray-600">
                    <mat-icon class="text-base text-gray-400">hotel_class</mat-icon>
                    <span>Status</span>
                  </div>
                  <span class="inline-flex items-center px-3 py-1.5 text-xs font-bold rounded-full shadow-sm ring-1"
                        [ngClass]="{
                          'bg-green-100 text-green-800 ring-green-200': room.status === 'available',
                          'bg-purple-100 text-purple-800 ring-purple-200': room.status === 'occupied',
                          'bg-orange-100 text-orange-800 ring-orange-200': room.status === 'maintenance',
                          'bg-cyan-100 text-cyan-800 ring-cyan-200': room.status === 'cleaning',
                          'bg-red-100 text-red-800 ring-red-200': room.status === 'out_of_order'
                        }">
                    <span class="w-2 h-2 rounded-full mr-2"
                          [ngClass]="{
                            'bg-green-600': room.status === 'available',
                            'bg-purple-600': room.status === 'occupied',
                            'bg-orange-600': room.status === 'maintenance',
                            'bg-cyan-600': room.status === 'cleaning',
                            'bg-red-600': room.status === 'out_of_order'
                          }"></span>
                    {{ room.status | titlecase }}
                  </span>
                </div>

                <div class="flex items-center justify-between text-sm">
                  <div class="flex items-center gap-2 text-gray-600">
                    <mat-icon class="text-base text-gray-400">cleaning_services</mat-icon>
                    <span>Housekeeping</span>
                  </div>
                  <span class="inline-flex items-center px-3 py-1.5 text-xs font-bold rounded-full shadow-sm ring-1"
                        [ngClass]="{
                          'bg-green-100 text-green-800 ring-green-200': room.housekeepingStatus === 'clean',
                          'bg-orange-100 text-orange-800 ring-orange-200': room.housekeepingStatus === 'dirty',
                          'bg-cyan-100 text-cyan-800 ring-cyan-200': room.housekeepingStatus === 'inspected',
                          'bg-red-100 text-red-800 ring-red-200': room.housekeepingStatus === 'out_of_order'
                        }">
                    <span class="w-2 h-2 rounded-full mr-2"
                          [ngClass]="{
                            'bg-green-600': room.housekeepingStatus === 'clean',
                            'bg-orange-600': room.housekeepingStatus === 'dirty',
                            'bg-cyan-600': room.housekeepingStatus === 'inspected',
                            'bg-red-600': room.housekeepingStatus === 'out_of_order'
                          }"></span>
                    {{ room.housekeepingStatus | titlecase }}
                  </span>
                </div>

                @if (getFeaturesList(room).length > 0) {
                  <div class="pt-3 border-t border-gray-100">
                    <div class="text-sm font-medium text-gray-600 mb-2">Features:</div>
                    <div class="flex flex-wrap gap-1">
                      @for (feature of getFeaturesList(room); track feature) {
                        <span class="inline-flex items-center px-2 py-1 rounded-md text-xs font-medium bg-gray-100 text-gray-700 border border-gray-200">{{ feature }}</span>
                      }
                    </div>
                  </div>
                }
              </div>

              <div class="flex gap-2 pt-4 border-t border-gray-100">
                <button class="flex-1 !bg-gradient-to-r !from-blue-600 !to-blue-700 hover:!from-blue-700 hover:!to-blue-800 !text-white px-4 py-2.5 rounded-lg text-sm font-medium flex items-center justify-center gap-2 transition-all duration-200 shadow-sm hover:shadow-md" [routerLink]="['./', room._id || room.id]">
                  <mat-icon class="text-sm">visibility</mat-icon>
                  View
                </button>
                <button class="flex-1 border border-gray-300 hover:bg-gray-50 text-gray-700 px-4 py-2.5 rounded-lg text-sm font-medium flex items-center justify-center gap-2 transition-all duration-200" [routerLink]="['./', room._id || room.id, 'edit']">
                  <mat-icon class="text-sm">edit</mat-icon>
                  Edit
                </button>
              </div>
            </div>
          </div>
        }

        @if (filteredRooms().length === 0 && !loading()) {
          <div class="col-span-full py-20 bg-gradient-to-br from-gray-50 to-white text-center rounded-lg border border-gray-200">
            <div class="w-16 h-16 bg-gray-200 rounded-full flex items-center justify-center mx-auto mb-4">
              <mat-icon class="text-4xl text-gray-400">hotel</mat-icon>
            </div>
            <h3 class="text-lg font-semibold text-gray-900 mb-2">No rooms found</h3>
            <p class="text-gray-500 mb-6">Try adjusting your filters or create a new room.</p>
            <button class="!bg-gradient-to-r !from-blue-600 !to-blue-700 hover:!from-blue-700 hover:!to-blue-800 !text-white px-6 py-3 rounded-lg font-medium transition-all duration-200 shadow-lg hover:shadow-xl transform hover:scale-105 inline-flex items-center gap-2" routerLink="./create">
              <mat-icon class="text-lg">add</mat-icon>
              Add Room
            </button>
          </div>
        }
      </div>
    }

    <!-- Error State -->
    @if (error()) {
      <div class="bg-red-50 border border-red-200 rounded-lg p-6 text-center">
        <div class="w-16 h-16 bg-red-200 rounded-full flex items-center justify-center mx-auto mb-4">
          <mat-icon class="text-4xl text-red-500">error</mat-icon>
        </div>
        <h3 class="text-lg font-semibold text-gray-900 mb-2">Error Loading Rooms</h3>
        <p class="text-gray-500 mb-6">{{ error() }}</p>
        <button class="!bg-gradient-to-r !from-blue-600 !to-blue-700 hover:!from-blue-700 hover:!to-blue-800 !text-white px-6 py-3 rounded-lg font-medium transition-all duration-200 shadow-lg hover:shadow-xl transform hover:scale-105 inline-flex items-center gap-2" (click)="loadData()">
          <mat-icon class="text-lg">refresh</mat-icon>
          Retry
        </button>
      </div>
    }

  </div>
</div>