<div class=" min-h-full">
  <!-- Header Section -->
  <div class="p-4 border-b border-outline-variant">
    <div class="flex items-center gap-3">
      <div class="flex-1">
        <app-search #searchComponent [filter]="searchFilter" (filterChange)="onSearchChange($any($event))"
          [showRightIcon]="true" (rightTap)="clearSearch()" searchText="Search by table name...">
        </app-search>
      </div>
      <div class="hidden md:flex items-center gap-2 shrink-0">
        <mat-button-toggle-group [value]="tableStore.statusFilter()" (change)="onStatusFilterChange($any($event.value))"
          class="w-full sm:w-auto">
          <mat-button-toggle value="all" class="flex-1 sm:flex-initial">
            <span class="hidden sm:inline">All ({{tableStore.tablesCount()}})</span>
            <span class="sm:hidden">All</span>
          </mat-button-toggle>
          <mat-button-toggle value="free" class="flex-1 sm:flex-initial">
            <span class="hidden sm:inline">Free ({{tableStore.freeTableCount()}})</span>
            <span class="sm:hidden">Free</span>
          </mat-button-toggle>
          <mat-button-toggle value="occupied" class="flex-1 sm:flex-initial">
            <span class="hidden sm:inline">Occupied ({{tableStore.occupiedTableCount()}})</span>
            <span class="sm:hidden">Occ.</span>
          </mat-button-toggle>
        </mat-button-toggle-group>
      </div>
    </div>
  </div>

  <!-- Category Chips -->
  <div class="px-4 py-3 border-b border-outline-variant mb-4">
    <div class="flex items-center gap-3 overflow-x-auto scrollbar-hide">
      <mat-chip-listbox aria-label="Select a table category" class="flex-nowrap">
        <mat-chip-option [selected]="!tableCategoryStore.selectedTableCategory()" (click)="clearCategoryFilter()"
          class="cursor-pointer">
          All Categories
        </mat-chip-option>
        @for (category of tableCategoryStore.tableCategories(); track category._id) {
        <mat-chip-option [selected]="tableCategoryStore.selectedTableCategory()?._id === category._id"
          (click)="onCategorySelect(category)" class="cursor-pointer">
          {{category.name}}
        </mat-chip-option>
        }
      </mat-chip-listbox>
    </div>
  </div>

  <!-- Loading State -->
  @if (tableStore.isLoading()) {
    <div class="flex justify-center items-center py-16">
      <mat-spinner diameter="40"></mat-spinner>
    </div>
  }

  <!-- Tables Grid -->
  @if (!tableStore.isLoading()) {
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 px-4 gap-4">
      @for (table of tableStore.filteredTables(); track table._id) {
      <app-table-card (addNewOrder)="onAddNewOrder($event)" [table]="table" (viewOrder)="viewOrder($event)"
        (completeOrder)="completeOrder($event)" (clearOrder)="onClearOrder($event)" (tableClick)="onTableClick($event)">
      </app-table-card>
      }
    </div>

    @if (tableStore.filteredTables().length === 0) {
      <div class="px-4 py-8">
        <app-no-record icon="table_restaurant" title="No Tables Found" message="There are no tables to display at this time."></app-no-record>
      </div>
    }
  }
</div>