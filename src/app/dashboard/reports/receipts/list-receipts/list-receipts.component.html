<div class="p-4 bg-gray-50 min-h-screen">
  <!-- Header Section -->
  <div class="flex justify-between items-center mb-6 bg-white p-4 rounded-lg shadow-sm">
    <date-range-selector />

    <app-employee-selector />
  </div>

  <div class="bg-white rounded-lg shadow-sm">
    <!-- Tabs Section -->
    @if (dataSource.hasValue()) {
    <nav mat-tab-nav-bar class="grid grid-cols-3" [tabPanel]="tabPanel">
      @for (tab of tabStats ; track tab.value) {
      <a mat-tab-link (click)="onTabChange(tab.value)" [active]="activeTab === tab.value"
        class="!h-auto !min-h-[100px] !px-4 !py-4 border-b">
        <div class="text-center">
          <h3 class="text-gray-600 font-medium mb-1">{{tab.label}}</h3>
          <p class="text-2xl font-semibold">{{tab.count}}</p>
        </div>
      </a>
      }
    </nav>
    <mat-tab-nav-panel #tabPanel>

      <!-- Search and Export Section -->
      <div class="p-6 flex justify-between items-center border-b">
        <!-- <mat-form-field appearance="outline" class="w-80">
              <mat-label>Search receipts</mat-label>
              <input matInput [formControl]="searchText" placeholder="Search by receipt number, customer...">
              <mat-icon matSuffix>search</mat-icon>
            </mat-form-field> -->

        <button mat-flat-button color="primary" [matMenuTriggerFor]="exportMenu">
          <mat-icon class="mr-2">file_download</mat-icon>
          Export Data
        </button>
        <mat-menu #exportMenu="matMenu">
          <button mat-menu-item (click)="exportData('pdf')">
            <mat-icon>picture_as_pdf</mat-icon>
            <span>Export as PDF</span>
          </button>
          <button mat-menu-item (click)="exportData('csv')">
            <mat-icon>description</mat-icon>
            <span>Export as CSV</span>
          </button>
          <button mat-menu-item (click)="exportData('excel')">
            <mat-icon>table_chart</mat-icon>
            <span>Export as Excel</span>
          </button>
        </mat-menu>
      </div>



      <div class="p-6">
        <div class="table-container">
          <table mat-table [dataSource]="dataSource.value().orders" matSort class="!bg-white w-full">
            <ng-container matColumnDef="receiptNo">
              <th mat-header-cell *matHeaderCellDef>Receipt no.</th>
              <td mat-cell *matCellDef="let element">{{element.receiptNo}}</td>
            </ng-container>

            <ng-container matColumnDef="date">
              <th mat-header-cell *matHeaderCellDef>Date</th>
              <td mat-cell *matCellDef="let element">{{element.date}}</td>
            </ng-container>

            <ng-container matColumnDef="orderedBy">
              <th mat-header-cell *matHeaderCellDef>Ordered by</th>
              <td mat-cell *matCellDef="let element">{{element?.orderedBy?.name ?? 'Admin'}}</td>
            </ng-container>

            <ng-container matColumnDef="category">
              <th mat-header-cell *matHeaderCellDef>Status</th>
              <td mat-cell *matCellDef="let element">
                <span
                  class="inline-block px-2 py-1 rounded-full text-xs font-semibold"
                  [ngClass]="{
                    'bg-green-100 text-green-800': element.category === 'Complete',
                    'bg-yellow-100 text-yellow-800': element.category === 'Processing',
                    'bg-red-100 text-red-800': element.category === 'Cancel',
                    'bg-gray-100 text-gray-800': element.category !== 'Complete' && element.category !== 'Processing' && element.category !== 'Cancel'
                  }"
                >
                  {{element.category}}
                </span>
              </td>
            </ng-container>

            <ng-container matColumnDef="type">
              <th mat-header-cell *matHeaderCellDef>Payment Type</th>
              <td mat-cell *matCellDef="let element">{{element.type}}</td>
            </ng-container>

            <ng-container matColumnDef="ordertype">
              <th mat-header-cell *matHeaderCellDef>Order Type</th>
              <td mat-cell *matCellDef="let element">{{element.ordertype | titlecase}}</td>
            </ng-container>

            <ng-container matColumnDef="total">
              <th mat-header-cell *matHeaderCellDef>Total</th>
              <td mat-cell *matCellDef="let element">{{element.total | currency: storeStore.selectedStore()?.currency}}</td>
            </ng-container>

            <ng-container matColumnDef="actions">
              <th mat-header-cell *matHeaderCellDef>Actions</th>
              <td mat-cell *matCellDef="let element">
                <button mat-icon-button [matMenuTriggerFor]="menu">
                  <mat-icon>more_vert</mat-icon>
                </button>
                <mat-menu #menu="matMenu">
                  <button mat-menu-item (click)="viewRecipesDetails(element._id)">
                    <mat-icon>visibility</mat-icon>
                    <span>View Receipt Details</span>
                  </button>
                  <button mat-menu-item (click)="deleteReceipt(element)">
                    <mat-icon>delete</mat-icon>
                    <span>Delete</span>
                  </button>
                </mat-menu>
              </td>
            </ng-container>

            <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
            <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
          </table>

        <mat-paginator class="!bg-white" [pageSize]="pageSize" [pageSizeOptions]="pageSizeOptions" showFirstLastButtons
          aria-label="Select page">
        </mat-paginator>
        </div>
      </div>

    </mat-tab-nav-panel>
    } @else {
    <div class="flex items-center justify-center min-h-[300px]">
      <mat-spinner diameter="40"></mat-spinner>
    </div>
    }

  </div>


</div>