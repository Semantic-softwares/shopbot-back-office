import{c as X,d as Y}from"./chunk-3BP5U2AG.js";import{a as I}from"./chunk-BF5Y3WJN.js";import{a as te}from"./chunk-RBYYFQHC.js";import{a as ee}from"./chunk-UPBHOZRL.js";import{a as z,b as A,c as H,f as J,g as K}from"./chunk-L2IRRR6J.js";import{a as O,b as Q,e as U,h as W}from"./chunk-27T6VRU4.js";import{C as V,E as j,b as B,d as c,g as D,h as T,m as q,s as G,t as R}from"./chunk-LM7FYRY4.js";import"./chunk-ZENMOCFL.js";import{a as Z,b as $}from"./chunk-EDESGICS.js";import{a as P}from"./chunk-6UI2KQ7N.js";import"./chunk-7KAGHLPR.js";import"./chunk-JRF7K3G5.js";import"./chunk-HRGWPEEQ.js";import{X as k,Y as L,Z as N}from"./chunk-BVLPFG4Z.js";import"./chunk-LYY57WCE.js";import"./chunk-5CST2L2O.js";import{c as F,d as y}from"./chunk-QJAAU2EQ.js";import"./chunk-S3JL7UCS.js";import"./chunk-ETP2OZKZ.js";import{Bb as _,D as f,Db as S,Eb as v,Jb as u,Kb as t,Lb as i,Mb as b,S as g,Xb as C,Ya as n,ca as l,lb as E,m as p,mc as r,n as M,nc as x,oc as w,ta as h}from"./chunk-KGWH6IHP.js";import"./chunk-EQDQRRRY.js";function oe(m,a){m&1&&(t(0,"mat-error"),r(1,"Please enter a valid email"),i())}function re(m,a){m&1&&(t(0,"mat-error"),r(1,"Password is required"),i())}var ie=class m{fb=l(V);authService=l(P);snackBar=l(I);router=l(F);hide=h(!0);loading=h(!1);storeService=l(ee);storeStore=l(te);clickEvent(a){this.hide.set(!this.hide()),a.stopPropagation()}loginForm=this.fb.group({email:["",[c.required,c.email]],password:["",c.required]});onSubmit(){if(this.loginForm.valid){this.loading.set(!0);let{email:a,password:s}=this.loginForm.value;this.authService.login(a,s).pipe(g(e=>{let d=e._id;return this.storeService.getMerchantStores(d).pipe(g(o=>!o||o.length===0?M(()=>new Error("No stores found for this merchant.")):(this.storeStore.setSelectedStores(o),this.storeStore.setSelectedStore(o[0]),setTimeout(()=>{this.router.navigate(["/menu/menu"])},2e3),this.loading.set(!1),p(null))),f(o=>(this.snackBar.open(o.message||"Failed to load stores.","Close",{duration:5e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["error-snackbar"]}),this.loading.set(!1),p(null))))}),f(e=>(this.snackBar.open(e.error?.message||e.message||"Login failed. Please try again.","Close",{duration:5e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["error-snackbar"]}),this.loading.set(!1),p(null)))).subscribe()}}static \u0275fac=function(s){return new(s||m)};static \u0275cmp=E({type:m,selectors:[["login"]],decls:27,vars:9,consts:[[1,"min-h-screen","w-full","flex","items-center","justify-center"],["appearance","outlined",1,"w-full","max-w-sm"],[1,"mb-6"],[1,"text-xl","font-bold"],[1,"flex","flex-col","gap-4",3,"ngSubmit","formGroup"],["appearance","outline",1,"w-full"],["matInput","","formControlName","email","placeholder","Enter your email"],["matSuffix","","fontSet","material-icons-outlined"],["matInput","","formControlName","password","placeholder","Enter your password",3,"type"],["mat-icon-button","","matSuffix","",3,"click"],["fontSet","material-icons-outlined"],[1,"text-right"],["routerLink","/auth/forgot-password",1,"text-xs","text-blue-600","hover:text-blue-800"],["matButton","filled","color","primary",3,"disabled"]],template:function(s,e){if(s&1&&(t(0,"div",0)(1,"mat-card",1)(2,"mat-card-header",2)(3,"mat-card-title",3),r(4,"Sign in"),i()(),t(5,"mat-card-content")(6,"form",4),C("ngSubmit",function(){return e.onSubmit()}),t(7,"mat-form-field",5)(8,"mat-label"),r(9,"Email"),i(),b(10,"input",6),t(11,"mat-icon",7),r(12,"email"),i(),S(13,oe,2,0,"mat-error"),i(),t(14,"mat-form-field",5)(15,"mat-label"),r(16,"Password"),i(),b(17,"input",8),t(18,"a",9),C("click",function(o){return e.clickEvent(o)}),t(19,"mat-icon",10),r(20),i()(),S(21,re,2,0,"mat-error"),i(),t(22,"div",11)(23,"a",12),r(24," Forgot password? "),i()(),t(25,"button",13),r(26),i()()()()()),s&2){let d,o;n(6),u("formGroup",e.loginForm),n(7),v((d=e.loginForm.get("email"))!=null&&d.hasError("required")?13:-1),n(4),u("type",e.hide()?"password":"text"),n(),_("aria-label","Hide password")("aria-pressed",e.hide()),n(2),x(e.hide()?"visibility_off":"visibility"),n(),v((o=e.loginForm.get("email"))!=null&&o.hasError("required")?21:-1),n(4),u("disabled",!e.loginForm.valid||e.loading()),n(),w("",e.loading()?"Logging in...":"Login"," ")}},dependencies:[K,z,H,J,A,N,L,k,Y,X,W,O,Q,U,j,q,B,D,T,R,G,$,Z,y],encapsulation:2})};export{ie as LoginComponent};
