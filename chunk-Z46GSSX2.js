import{a as p}from"./chunk-AIJP532J.js";import{e as b}from"./chunk-QAO3BBZ5.js";import{Rc as s,Z as o,ca as a,ta as c}from"./chunk-HCNG3XRF.js";import{a as u}from"./chunk-EQDQRRRY.js";var d=class r{subscriptionService=a(p);activatedRoute=a(b);currentSubscription=c(null);isTrialActive=s(()=>this.currentSubscription()?.status==="TRIAL");isSubscriptionActive=s(()=>this.currentSubscription()?.status==="ACTIVE");isPaymentRequired=s(()=>this.currentSubscription()?.status==="PAST_DUE");isAccessBlocked=s(()=>{let t=this.currentSubscription();return t?.status==="EXPIRED"||t?.status==="CANCELLED"});hasValidSubscription=s(()=>{let t=this.currentSubscription();return t?.status==="TRIAL"||t?.status==="ACTIVE"});trialDaysRemaining=s(()=>{let t=this.currentSubscription();if(!t||t.status!=="TRIAL")return 0;let e=new Date(t.trialEndDate),i=new Date,n=Math.ceil((e.getTime()-i.getTime())/(1e3*60*60*24));return Math.max(0,n)});constructor(){this.initializeSubscription()}initializeSubscription(){this.activatedRoute.data.subscribe(t=>{t.subscription?this.currentSubscription.set(t.subscription):this.loadSubscription()})}loadSubscription(){this.subscriptionService.getSubscriptionStatus().subscribe({next:t=>{this.currentSubscription.set(t)},error:t=>{console.error("Failed to load subscription:",t),this.currentSubscription.set(null)}})}isFeatureAvailable(t){let e=this.currentSubscription();return e?({viewDashboard:["TRIAL","ACTIVE"],viewReservations:["TRIAL","ACTIVE"],viewReports:["TRIAL","ACTIVE"],createReservation:["ACTIVE"],editReservation:["ACTIVE"],managePayments:["ACTIVE"],manageRooms:["ACTIVE"],exportData:["ACTIVE"],advancedReports:["ACTIVE"],automatedEmails:["ACTIVE"],apiAccess:["ACTIVE"]}[t]||[]).includes(e.status):!1}getBlockedFeatureMessage(t){let e=this.currentSubscription();return e?e.status==="TRIAL"?`This feature is available after your trial ends. You have ${this.trialDaysRemaining()} days remaining.`:e.status==="PAST_DUE"?"Your subscription payment is overdue. Please update your payment method to access this feature.":e.status==="EXPIRED"?"Your subscription has expired. Please renew to access this feature.":e.status==="CANCELLED"?"Your subscription has been cancelled. Please contact support for more information.":"This feature is not available for your subscription.":"Please set up a subscription to continue."}trackFeatureUsage(t,e){let i=this.currentSubscription();i&&console.log(`Feature used: ${t}`,u({subscriptionStatus:i.status},e))}refreshSubscription(){this.subscriptionService.refreshSubscription().subscribe({next:t=>this.currentSubscription.set(t)})}getSubscription(){return this.currentSubscription()}static \u0275fac=function(e){return new(e||r)};static \u0275prov=o({token:r,factory:r.\u0275fac,providedIn:"root"})};export{d as a};
