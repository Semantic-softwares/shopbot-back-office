import{a as A}from"./chunk-OCOPYLE5.js";import{a as Ct}from"./chunk-D2XD2MPO.js";import{f as pt}from"./chunk-CU623SSI.js";import{c as ut,h as xt}from"./chunk-XNNKKASY.js";import{a as _t}from"./chunk-5HSGNHP2.js";import{a as ft}from"./chunk-JZKRHT5H.js";import{a as st}from"./chunk-O4OM35BU.js";import{a as tt,b as et,c as it,d as nt,e as ot,f as at,g as rt,h as lt,i as mt,j as ct,k as dt}from"./chunk-GTRRE3DU.js";import{a as Y,b as Z}from"./chunk-4XV2UKEU.js";import{a as j,b as O,c as U,d as q}from"./chunk-Q4U6FYZ3.js";import{i as F}from"./chunk-QC7H4KPM.js";import{a as W}from"./chunk-Y4YMG23Q.js";import{b as Q}from"./chunk-P4SPQCUJ.js";import"./chunk-R6JGHN2R.js";import{d as X}from"./chunk-BXJEGH2V.js";import"./chunk-64WHNS37.js";import"./chunk-TIVXUJ22.js";import"./chunk-W7B5PSOS.js";import"./chunk-XLZTIYSF.js";import{b as G}from"./chunk-UMV4DCPT.js";import"./chunk-G3VZM262.js";import"./chunk-BCE7WRWQ.js";import{a as J,b as K}from"./chunk-6I3AJKA7.js";import{A as z}from"./chunk-W7NMJLMQ.js";import"./chunk-F5SZ3AU3.js";import{a as B}from"./chunk-4UBDYPTG.js";import"./chunk-UVV7QZRX.js";import"./chunk-TILT22SG.js";import"./chunk-BFT2MTJY.js";import{a as L,h as P}from"./chunk-3E3PJ7Q7.js";import"./chunk-FO4KTVQ3.js";import"./chunk-TRZH7NMW.js";import"./chunk-GXTELBJV.js";import{b as H,c as N}from"./chunk-JPRPNQOM.js";import{Z as I,_ as V,ba as $}from"./chunk-3LDCGXHW.js";import{h as k,l as R}from"./chunk-ZLVQTB5B.js";import{s as T}from"./chunk-6PFJHDFS.js";import{Ib as M,Jb as b,Ob as C,Pb as n,Qb as o,Rb as h,Vb as p,Wb as u,Yb as y,ac as x,bb as l,cc as c,fa as S,ka as f,la as _,mc as D,qb as w,qc as E,rc as a,sc as v,tc as g,wb as d}from"./chunk-J2AK4FW5.js";import"./chunk-GAL4ENT6.js";function St(e,i){e&1&&(n(0,"div",2),h(1,"mat-spinner",3),n(2,"span",4),a(3,"Loading staff..."),o()())}function ht(e,i){e&1&&(n(0,"th",27),a(1,"Name"),o())}function Mt(e,i){if(e&1&&(n(0,"td",28)(1,"div",29)(2,"div",30)(3,"span",31),a(4),o()(),n(5,"span",32),a(6),o()()()),e&2){let t=i.$implicit;l(4),g(" ",t.name.charAt(0).toUpperCase()," "),l(2),v(t.name)}}function bt(e,i){e&1&&(n(0,"th",27),a(1,"Email"),o())}function yt(e,i){if(e&1&&(n(0,"td",33),a(1),o()),e&2){let t=i.$implicit;l(),g(" ",t.email," ")}}function vt(e,i){e&1&&(n(0,"th",27),a(1,"Phone"),o())}function Et(e,i){if(e&1&&(n(0,"td",33),a(1),o()),e&2){let t=i.$implicit;l(),g(" ",t.phoneNumber," ")}}function At(e,i){e&1&&(n(0,"th",27),a(1,"Role"),o())}function wt(e,i){if(e&1&&(n(0,"span",36),a(1),o()),e&2){let t=c().$implicit,r=c(3);E(r.getRoleColor(t.role)),l(),g(" ",t.role.name," ")}}function Dt(e,i){e&1&&(n(0,"span",35),a(1," No Role "),o())}function Tt(e,i){if(e&1&&(n(0,"td",28),M(1,wt,2,3,"span",34)(2,Dt,2,0,"span",35),o()),e&2){let t=i.$implicit;l(),b(t.role?1:2)}}function kt(e,i){e&1&&(n(0,"th",27),a(1,"Status"),o())}function Rt(e,i){if(e&1&&(n(0,"td",28)(1,"span",36),a(2),o()()),e&2){let t=i.$implicit,r=c(3);l(),E(r.getStatusColor(t)),l(),g(" ",r.getStatusText(t)," ")}}function It(e,i){e&1&&(n(0,"th",37),a(1,"Actions"),o())}function Vt(e,i){if(e&1){let t=y();n(0,"td",38)(1,"button",39)(2,"mat-icon"),a(3,"more_vert"),o()(),n(4,"mat-menu",null,0)(6,"button",40),x("click",function(){let m=f(t).$implicit,s=c(3);return _(s.openEditMerchantDialog(m))}),n(7,"mat-icon"),a(8,"edit"),o(),n(9,"span"),a(10,"Edit Details"),o()(),n(11,"button",40),x("click",function(){let m=f(t).$implicit,s=c(3);return _(s.openAssignRoleDialog(m))}),n(12,"mat-icon"),a(13,"admin_panel_settings"),o(),n(14,"span"),a(15,"Assign Role"),o()(),n(16,"button",40),x("click",function(){let m=f(t).$implicit,s=c(3);return _(s.toggleMerchantStatus(m))}),n(17,"mat-icon"),a(18),o(),n(19,"span"),a(20),o()(),h(21,"mat-divider"),n(22,"button",41),x("click",function(){let m=f(t).$implicit,s=c(3);return _(s.deleteMerchant(m))}),n(23,"mat-icon",42),a(24,"delete"),o(),n(25,"span"),a(26,"Delete"),o()()()()}if(e&2){let t=i.$implicit,r=D(5);l(),C("matMenuTriggerFor",r),l(17),v(t.deactivate?"toggle_on":"toggle_off"),l(2),v(t.deactivate?"Activate":"Deactivate")}}function $t(e,i){e&1&&h(0,"tr",43)}function Bt(e,i){e&1&&h(0,"tr",44)}function Ft(e,i){if(e&1){let t=y();n(0,"mat-card",5)(1,"div",7)(2,"div")(3,"h2",8),a(4,"Staff & Merchants"),o(),n(5,"p",9),a(6,"Manage your hotel staff accounts and their role permissions"),o()(),n(7,"div",10)(8,"button",11)(9,"mat-icon"),a(10,"admin_panel_settings"),o(),a(11," Manage Roles "),o(),n(12,"button",12),x("click",function(){f(t);let m=c(2);return _(m.openAddMerchantDialog())}),n(13,"mat-icon"),a(14,"person_add"),o(),a(15," Add Staff "),o()()(),n(16,"table",13),p(17,14),d(18,ht,2,0,"th",15)(19,Mt,7,2,"td",16),u(),p(20,17),d(21,bt,2,0,"th",15)(22,yt,2,1,"td",18),u(),p(23,19),d(24,vt,2,0,"th",15)(25,Et,2,1,"td",18),u(),p(26,20),d(27,At,2,0,"th",15)(28,Tt,3,1,"td",16),u(),p(29,21),d(30,kt,2,0,"th",15)(31,Rt,3,3,"td",16),u(),p(32,22),d(33,It,2,0,"th",23)(34,Vt,27,3,"td",24),u(),d(35,$t,1,0,"tr",25)(36,Bt,1,0,"tr",26),o()()}if(e&2){let t=c(2);l(8),C("routerLink","../roles"),l(8),C("dataSource",t.merchants.value()),l(19),C("matHeaderRowDef",t.displayedColumns),l(),C("matRowDefColumns",t.displayedColumns)}}function Ht(e,i){if(e&1){let t=y();n(0,"app-no-record",6)(1,"button",12),x("click",function(){f(t);let m=c(2);return _(m.openAddMerchantDialog())}),n(2,"mat-icon"),a(3,"person_add"),o(),a(4," Add Staff Member "),o()()}}function Nt(e,i){if(e&1&&M(0,Ft,37,4,"mat-card",5)(1,Ht,5,0,"app-no-record",6),e&2){let t=c();b(t.merchants.value().length>0?0:1)}}var gt=class e{snackBar=S(B);dialog=S(ut);storeStore=S(F);userService=S(W);merchants=X({params:()=>({storeId:this.storeStore.selectedStore()?._id}),stream:({params:i})=>this.userService.getStoreMerchants(i.storeId)});displayedColumns=["name","email","phone","role","status","actions"];getRoleColor(i){if(!i)return"bg-gray-100 text-gray-700";let t=i.name.toLowerCase();return t.includes("admin")||t.includes("owner")?"bg-purple-100 text-purple-700":t.includes("manager")?"bg-blue-100 text-blue-700":t.includes("front desk")||t.includes("receptionist")?"bg-green-100 text-green-700":t.includes("housekeeper")||t.includes("housekeeping")?"bg-yellow-100 text-yellow-700":"bg-gray-100 text-gray-700"}getStatusColor(i){return i.deactivate?"bg-red-100 text-red-700":"bg-green-100 text-green-700"}getStatusText(i){return i.deactivate?"Inactive":"Active"}openAddMerchantDialog(){let i=this.storeStore.selectedStore()?._id;if(!i)return;this.dialog.open(A,{width:"500px",data:{storeId:i}}).afterClosed().subscribe(r=>{r&&this.merchants.reload()})}openEditMerchantDialog(i){let t=this.storeStore.selectedStore()?._id;if(!t)return;this.dialog.open(A,{width:"500px",data:{storeId:t,staff:i}}).afterClosed().subscribe(m=>{m&&this.merchants.reload()})}openAssignRoleDialog(i){this.openEditMerchantDialog(i)}toggleMerchantStatus(i){let t=!i.deactivate;this.userService.updateMerchant(i._id,{deactivate:t}).subscribe({next:()=>{this.snackBar.open(`${i.name} ${t?"deactivated":"activated"}`,"Close",{duration:3e3}),this.merchants.reload()},error:r=>{this.snackBar.open(r.error?.message||"Failed to update status","Close",{duration:5e3})}})}deleteMerchant(i){this.dialog.open(Ct,{width:"400px",data:{title:"Delete Staff Member",message:`Are you sure you want to delete ${i.name}? This action cannot be undone.`}}).afterClosed().subscribe(r=>{r&&this.userService.deleteMerchant(i._id).subscribe({next:()=>{this.snackBar.open(`${i.name} deleted`,"Close",{duration:3e3}),this.merchants.reload()},error:m=>{this.snackBar.open(m.error?.message||"Failed to delete staff member","Close",{duration:5e3})}})})}static \u0275fac=function(t){return new(t||e)};static \u0275cmp=w({type:e,selectors:[["app-staff-account"]],decls:3,vars:1,consts:[["menu","matMenu"],[1,"py-6"],[1,"flex","justify-center","items-center","py-12"],["diameter","40"],[1,"ml-3","text-gray-600"],["appearance","outlined",1,"py-3"],["icon","people_outline","title","No Staff Members","message","Add your first staff member to get started"],[1,"flex","p-3","flex-col","sm:flex-row","justify-between","items-start","sm:items-center","gap-4","mb-6"],[1,"text-xl","font-semibold","text-gray-900"],[1,"text-sm","text-gray-600"],[1,"flex","gap-3"],["mat-stroked-button","","color","primary",3,"routerLink"],["mat-flat-button","","color","primary",3,"click"],["mat-table","",1,"w-full",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","","class","!py-4 !px-6 !font-semibold",4,"matHeaderCellDef"],["mat-cell","","class","!py-4 !px-6",4,"matCellDef"],["matColumnDef","email"],["mat-cell","","class","!py-4 !px-6 text-gray-600",4,"matCellDef"],["matColumnDef","phone"],["matColumnDef","role"],["matColumnDef","status"],["matColumnDef","actions"],["mat-header-cell","","class","!py-4 !px-6 !font-semibold text-right",4,"matHeaderCellDef"],["mat-cell","","class","!py-4 !px-6 text-right",4,"matCellDef"],["mat-header-row","","class","bg-gray-50",4,"matHeaderRowDef"],["mat-row","","class","hover:bg-gray-50",4,"matRowDef","matRowDefColumns"],["mat-header-cell","",1,"!py-4","!px-6","!font-semibold"],["mat-cell","",1,"!py-4","!px-6"],[1,"flex","items-center","gap-3"],[1,"w-10","h-10","bg-blue-100","rounded-full","flex","items-center","justify-center"],[1,"text-blue-600","font-medium"],[1,"font-medium","text-gray-900"],["mat-cell","",1,"!py-4","!px-6","text-gray-600"],[1,"px-3","py-1","rounded-full","text-sm","font-medium",3,"class"],[1,"px-3","py-1","rounded-full","text-sm","font-medium","bg-gray-100","text-gray-500"],[1,"px-3","py-1","rounded-full","text-sm","font-medium"],["mat-header-cell","",1,"!py-4","!px-6","!font-semibold","text-right"],["mat-cell","",1,"!py-4","!px-6","text-right"],["mat-icon-button","","matTooltip","More actions",3,"matMenuTriggerFor"],["mat-menu-item","",3,"click"],["mat-menu-item","",1,"!text-red-600",3,"click"],[1,"!text-red-600"],["mat-header-row","",1,"bg-gray-50"],["mat-row","",1,"hover:bg-gray-50"]],template:function(t,r){t&1&&(n(0,"div",1),M(1,St,4,0,"div",2)(2,Nt,2,1),o()),t&2&&(l(),b(r.merchants.isLoading()?1:r.merchants.hasValue()?2:-1))},dependencies:[T,z,P,L,$,V,I,N,H,dt,tt,it,rt,nt,et,lt,ot,at,mt,ct,pt,q,O,j,U,xt,K,J,ft,st,Q,G,Z,Y,_t,R,k],styles:["[_nghost-%COMP%]{display:block}"]})};export{gt as StaffAccount};
