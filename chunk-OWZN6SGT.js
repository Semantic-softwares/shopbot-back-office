import{a as z,b as R}from"./chunk-4FCLVNHT.js";import"./chunk-YCI4GSMN.js";import{b as V}from"./chunk-W6FIBOPD.js";import{b as G,c as U,d as H}from"./chunk-7JNU3RG5.js";import{a as x}from"./chunk-GGWIF4RR.js";import{a as j}from"./chunk-PQXLVIGM.js";import{a as A}from"./chunk-5WBVJVYM.js";import{g as k}from"./chunk-X7SU23UW.js";import{a as P,e as B,h as D}from"./chunk-3SKQMCZR.js";import{C as w,E as I,b as y,g as M,h as C,m as F,n as N,s as _,t as T}from"./chunk-EQD33MW2.js";import"./chunk-UJ5WOJLI.js";import"./chunk-3R2L4BJM.js";import"./chunk-Y4VWLT32.js";import"./chunk-CDKFCYZ5.js";import{b as L,c as O}from"./chunk-2HLT5ZQQ.js";import{Y as h,_ as E}from"./chunk-UUZHPQZB.js";import"./chunk-CQ6SLR32.js";import"./chunk-C3MGKPDK.js";import"./chunk-KTA4MFBX.js";import"./chunk-HUSU2JWO.js";import{Eb as v,Fb as b,Kb as c,Lb as i,Mb as e,Nb as o,Yb as u,Za as d,ca as s,mb as f,nc as t,ta as p}from"./chunk-HCNG3XRF.js";import{a as g,b as S}from"./chunk-EQDQRRRY.js";function J(l,n){l&1&&(i(0,"mat-icon",31),t(1,"refresh"),e(),t(2," Saving... "))}function K(l,n){l&1&&(i(0,"mat-icon",20),t(1,"save"),e(),t(2," Save Email Settings "))}var q=class l{fb=s(w);snackBar=s(x);storeService=s(A);storeStore=s(j);loading=p(!1);saving=p(!1);emailSettingsForm;ngOnInit(){this.initializeForm(),this.loadSettings()}initializeForm(){this.emailSettingsForm=this.fb.group({smtpHost:[""],smtpPort:[587],smtpUsername:[""],smtpPassword:[""],smtpSecure:[!0],senderName:[""],senderEmail:[""],replyToEmail:[""]})}loadSettings(){this.loading.set(!0);let n=this.storeStore.selectedStore();n?.hotelSettings?.emailSettings&&this.emailSettingsForm.patchValue(n.hotelSettings.emailSettings),this.loading.set(!1)}testEmailConnection(){this.emailSettingsForm.valid&&(this.snackBar.open("Testing email connection...","Close",{duration:2e3}),setTimeout(()=>{this.snackBar.open("Email connection test successful!","Close",{duration:3e3})},2e3))}saveEmailSettings(){if(this.emailSettingsForm.valid&&this.storeStore.selectedStore()){this.saving.set(!0);let n=this.storeStore.selectedStore(),m=this.emailSettingsForm.value,a={hotelSettings:S(g({},n.hotelSettings),{emailSettings:m})};this.storeService.updateStore(n._id,a).subscribe({next:()=>{this.storeService.getStore(n._id).subscribe({next:r=>{this.storeStore.updateStore(r),this.storeService.saveStoreLocally(r),this.saving.set(!1),this.snackBar.open("Email settings saved successfully!","Close",{duration:3e3})},error:r=>{console.error("Error fetching updated store:",r),this.saving.set(!1),this.snackBar.open("Settings saved but failed to update local data.","Close",{duration:5e3})}})},error:r=>{console.error("Error saving email settings:",r),this.saving.set(!1),this.snackBar.open("Failed to save email settings.","Close",{duration:5e3})}})}}static \u0275fac=function(m){return new(m||l)};static \u0275cmp=f({type:l,selectors:[["app-email-settings"]],decls:82,vars:3,consts:[[1,"py-6"],[3,"ngSubmit","formGroup"],[1,"grid","grid-cols-1","lg:grid-cols-2","gap-8"],[1,"bg-white","rounded-lg","shadow-sm","border","border-gray-200","overflow-hidden"],[1,"bg-gradient-to-r","from-gray-50","to-gray-100","px-6","py-4","border-b","border-gray-200"],[1,"text-lg","font-semibold","text-gray-900","flex","items-center","gap-2"],[1,"text-orange-600"],[1,"p-6","space-y-6"],["appearance","outline",1,"w-full"],["matInput","","formControlName","smtpHost","placeholder","smtp.gmail.com"],["matSuffix",""],[1,"grid","grid-cols-2","gap-4"],["appearance","outline"],["matInput","","type","number","formControlName","smtpPort","placeholder","587"],[1,"flex","items-center"],["formControlName","smtpSecure","color","primary"],[1,"ml-2","text-sm","text-gray-700"],["matInput","","formControlName","smtpUsername","placeholder","your-email@domain.com"],["matInput","","type","password","formControlName","smtpPassword","placeholder","\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022"],["type","button","mat-stroked-button","","color","accent",1,"w-full",3,"click"],[1,"mr-2"],[1,"text-blue-600"],["matInput","","formControlName","senderName","placeholder","Hotel Name"],["matInput","","type","email","formControlName","senderEmail","placeholder","noreply@hotel.com"],["matInput","","type","email","formControlName","replyToEmail","placeholder","reservations@hotel.com"],[1,"p-4","bg-yellow-50","border","border-yellow-200","rounded-lg"],[1,"font-semibold","text-yellow-900","mb-2","flex","items-center","gap-2"],[1,"text-yellow-600"],[1,"text-sm","text-yellow-800","space-y-1"],[1,"flex","justify-end","mt-8"],["type","submit","mat-raised-button","","color","primary",1,"px-8","py-2",3,"disabled"],[1,"animate-spin","mr-2"]],template:function(m,a){m&1&&(i(0,"div",0)(1,"form",1),u("ngSubmit",function(){return a.saveEmailSettings()}),i(2,"div",2)(3,"div",3)(4,"div",4)(5,"h3",5)(6,"mat-icon",6),t(7,"settings"),e(),t(8," SMTP Configuration "),e()(),i(9,"div",7)(10,"mat-form-field",8)(11,"mat-label"),t(12,"SMTP Host"),e(),o(13,"input",9),i(14,"mat-icon",10),t(15,"dns"),e()(),i(16,"div",11)(17,"mat-form-field",12)(18,"mat-label"),t(19,"Port"),e(),o(20,"input",13),e(),i(21,"div",14),o(22,"mat-slide-toggle",15),i(23,"span",16),t(24,"Use SSL/TLS"),e()()(),i(25,"mat-form-field",8)(26,"mat-label"),t(27,"Username"),e(),o(28,"input",17),i(29,"mat-icon",10),t(30,"person"),e()(),i(31,"mat-form-field",8)(32,"mat-label"),t(33,"Password"),e(),o(34,"input",18),i(35,"mat-icon",10),t(36,"lock"),e()(),i(37,"button",19),u("click",function(){return a.testEmailConnection()}),i(38,"mat-icon",20),t(39,"send"),e(),t(40," Test Connection "),e()()(),i(41,"div",3)(42,"div",4)(43,"h3",5)(44,"mat-icon",21),t(45,"branding_watermark"),e(),t(46," Email Branding "),e()(),i(47,"div",7)(48,"mat-form-field",8)(49,"mat-label"),t(50,"Sender Name"),e(),o(51,"input",22),i(52,"mat-icon",10),t(53,"badge"),e()(),i(54,"mat-form-field",8)(55,"mat-label"),t(56,"Sender Email"),e(),o(57,"input",23),i(58,"mat-icon",10),t(59,"email"),e()(),i(60,"mat-form-field",8)(61,"mat-label"),t(62,"Reply-To Email"),e(),o(63,"input",24),i(64,"mat-icon",10),t(65,"reply"),e()(),i(66,"div",25)(67,"h5",26)(68,"mat-icon",27),t(69,"lightbulb"),e(),t(70," Email Tips "),e(),i(71,"ul",28)(72,"li"),t(73,"\u2022 Use a dedicated email for hotel communications"),e(),i(74,"li"),t(75,"\u2022 Enable 2FA for better security"),e(),i(76,"li"),t(77,"\u2022 Test emails before going live"),e()()()()()(),i(78,"div",29)(79,"button",30),v(80,J,3,0)(81,K,3,0),e()()()()),m&2&&(d(),c("formGroup",a.emailSettingsForm),d(78),c("disabled",a.emailSettingsForm.invalid||a.saving()),d(),b(a.saving()?80:81))},dependencies:[I,F,y,N,M,C,T,_,k,E,h,O,L,G,D,P,B,H,U,R,z,V],styles:["[_nghost-%COMP%]{display:block}"]})};export{q as EmailSettings};
