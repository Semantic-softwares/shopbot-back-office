import{a as J,b as Q,h as W}from"./chunk-XNNKKASY.js";import{a as z}from"./chunk-XLZTIYSF.js";import{b as K,c as U,d as Y}from"./chunk-UMV4DCPT.js";import{a as L,b as q,e as B,h as j}from"./chunk-G3VZM262.js";import{b as H}from"./chunk-6I3AJKA7.js";import{B as G,b as A,d as P,g as E,h as F,m as N,s as k,t as T,y as R,z as V}from"./chunk-W7NMJLMQ.js";import{b as S,c as I}from"./chunk-JPRPNQOM.js";import{Z as O,_ as w,ba as D}from"./chunk-3LDCGXHW.js";import{Gb as y,Ib as s,Jb as p,Ob as g,Pb as e,Qb as i,ac as c,bb as o,cc as M,fa as u,qb as C,rc as n,sc as b,tc as x,wa as _}from"./chunk-J2AK4FW5.js";import{g as v}from"./chunk-GAL4ENT6.js";function Z(r,a){r&1&&(e(0,"mat-error"),n(1,"PIN is required"),i())}function $(r,a){r&1&&(e(0,"mat-error"),n(1,"PIN must be at least 4 digits"),i())}function tt(r,a){r&1&&(e(0,"mat-error"),n(1,"PIN cannot exceed 6 digits"),i())}function et(r,a){r&1&&(e(0,"mat-error"),n(1,"Invalid PIN entered"),i())}function it(r,a){if(r&1&&(e(0,"div",12)(1,"mat-icon",20),n(2,"error"),i(),e(3,"div")(4,"h4",21),n(5,"Authorization Failed"),i(),e(6,"p",22),n(7),i()()()),r&2){let d=M();o(7),b(d.error())}}var X=class r{fb=u(V);dialogRef=u(J);data=u(Q);storeService=u(z);verifying=_(!1);error=_(null);showPin=_(!1);pinForm;constructor(){this.pinForm=this.fb.group({pin:["",[P.required,P.minLength(4),P.maxLength(6)]]})}get actionDescription(){return this.data.actionDescription||"perform this action"}get storeId(){return this.data.storeId}togglePinVisibility(){this.showPin.set(!this.showPin())}verifyPin(){return v(this,null,function*(){if(this.pinForm.invalid){this.pinForm.markAllAsTouched();return}let a=this.pinForm.get("pin")?.value;if(a){this.verifying.set(!0),this.error.set(null);try{(yield this.storeService.validateStoreOwnerPin(this.storeId,a).toPromise())?this.dialogRef.close({authorized:!0,pin:a}):(this.error.set("Invalid PIN. Please check with the store owner for the correct PIN."),this.pinForm.get("pin")?.setErrors({invalid:!0}))}catch(d){console.error("Error validating PIN:",d),this.error.set("Unable to verify PIN. Please check your connection and try again.")}finally{this.verifying.set(!1)}}})}cancel(){this.dialogRef.close({authorized:!1})}onPinKeyPress(a){a.key==="Enter"&&this.pinForm.valid&&!this.verifying()&&this.verifyPin()}onPinInput(){this.error()&&(this.error.set(null),this.pinForm.get("pin")?.setErrors(null))}static \u0275fac=function(d){return new(d||r)};static \u0275cmp=C({type:r,selectors:[["app-pin-authorization-dialog"]],decls:37,vars:13,consts:[[1,"pin-authorization-dialog"],[1,"dialog-header"],[1,"text-xl","font-semibold","text-gray-900","mb-2","flex","items-center","gap-3"],[1,"w-10","h-10","bg-gradient-to-r","from-red-500","to-red-600","rounded-full","flex","items-center","justify-center","shadow-lg"],[1,"text-white","text-lg"],[1,"text-gray-600","text-sm"],[1,"dialog-content","mt-6"],[3,"ngSubmit","formGroup"],[1,"space-y-4"],["appearance","outline",1,"w-full"],["matInput","","formControlName","pin","placeholder","Enter 4-6 digit PIN","maxlength","6","autocomplete","off",1,"text-center","text-lg","tracking-wider","font-mono",3,"keypress","input","type"],["type","button","matSuffix","","mat-icon-button","",1,"text-gray-500","hover:text-gray-700",3,"click"],[1,"bg-red-50","border","border-red-200","rounded-lg","p-4","flex","items-start","gap-3"],[1,"bg-blue-50","border","border-blue-200","rounded-lg","p-4","flex","items-start","gap-3"],[1,"text-blue-500","mt-0.5","flex-shrink-0"],[1,"text-blue-800","font-medium","text-sm"],[1,"text-blue-700","text-sm","mt-1"],[1,"dialog-actions","mt-8","flex","items-center","justify-end","gap-3","pt-4","border-t","border-gray-200"],["type","button","mat-button","",1,"!text-gray-600","hover:!text-gray-800","hover:!bg-gray-50","!transition-colors","!px-6","!py-2",3,"click","disabled"],["type","button","mat-raised-button","","color","primary",1,"!bg-gradient-to-r","!from-blue-600","!to-blue-700","hover:!from-blue-700","hover:!to-blue-800","!text-white","!px-8","!py-2","!rounded-lg","!font-medium","!transition-all","!duration-200","!shadow-lg","hover:!shadow-xl","disabled:!opacity-50","disabled:!cursor-not-allowed",3,"click","disabled"],[1,"text-red-500","mt-0.5","flex-shrink-0"],[1,"text-red-800","font-medium","text-sm"],[1,"text-red-700","text-sm","mt-1"]],template:function(d,t){if(d&1&&(e(0,"div",0)(1,"div",1)(2,"h2",2)(3,"div",3)(4,"mat-icon",4),n(5,"security"),i()(),n(6," Store Owner Authorization Required "),i(),e(7,"p",5),n(8),i()(),e(9,"div",6)(10,"form",7),c("ngSubmit",function(){return t.verifyPin()}),e(11,"div",8)(12,"mat-form-field",9)(13,"mat-label"),n(14,"Store Owner PIN"),i(),e(15,"input",10),c("keypress",function(m){return t.onPinKeyPress(m)})("input",function(){return t.onPinInput()}),i(),e(16,"button",11),c("click",function(){return t.togglePinVisibility()}),e(17,"mat-icon"),n(18),i()(),s(19,Z,2,0,"mat-error"),s(20,$,2,0,"mat-error"),s(21,tt,2,0,"mat-error"),s(22,et,2,0,"mat-error"),i(),s(23,it,8,1,"div",12),e(24,"div",13)(25,"mat-icon",14),n(26,"info"),i(),e(27,"div")(28,"h4",15),n(29,"Security Notice"),i(),e(30,"p",16),n(31," Only the store owner should have access to this PIN. This authorization ensures that important actions are performed with proper approval. "),i()()()()()(),e(32,"div",17)(33,"button",18),c("click",function(){return t.cancel()}),n(34," Cancel "),i(),e(35,"button",19),c("click",function(){return t.verifyPin()}),n(36),i()()()),d&2){let l,m,f,h;o(8),x(" Enter the store owner PIN to authorize and ",t.actionDescription,". "),o(2),g("formGroup",t.pinForm),o(5),g("type",t.showPin()?"text":"password"),o(),y("aria-label","Toggle PIN visibility"),o(2),b(t.showPin()?"visibility_off":"visibility"),o(),p((l=t.pinForm.get("pin"))!=null&&l.hasError("required")&&((l=t.pinForm.get("pin"))!=null&&l.touched)?19:-1),o(),p((m=t.pinForm.get("pin"))!=null&&m.hasError("minlength")&&((m=t.pinForm.get("pin"))!=null&&m.touched)?20:-1),o(),p((f=t.pinForm.get("pin"))!=null&&f.hasError("maxlength")&&((f=t.pinForm.get("pin"))!=null&&f.touched)?21:-1),o(),p((h=t.pinForm.get("pin"))!=null&&h.hasError("invalid")&&((h=t.pinForm.get("pin"))!=null&&h.touched)?22:-1),o(),p(t.error()?23:-1),o(10),g("disabled",t.verifying()),o(2),g("disabled",t.pinForm.invalid||t.verifying()),o(),x(" ",t.verifying()?"Verifying...":"Authorize Action"," ")}},dependencies:[G,N,A,E,F,R,T,k,W,D,w,O,K,j,L,q,B,Y,U,I,S,H],styles:[".pin-authorization-dialog[_ngcontent-%COMP%]{padding:24px;max-width:450px;min-width:400px}.dialog-header[_ngcontent-%COMP%]{text-align:center}.dialog-content[_ngcontent-%COMP%]   .mat-mdc-form-field[_ngcontent-%COMP%]   .mdc-text-field--outlined[_ngcontent-%COMP%]{background-color:#f9fafb;border-color:#e5e7eb}.dialog-content[_ngcontent-%COMP%]   .mat-mdc-form-field[_ngcontent-%COMP%]   .mdc-text-field--outlined[_ngcontent-%COMP%]:hover{border-color:#3b82f6}.dialog-content[_ngcontent-%COMP%]   .mat-mdc-form-field[_ngcontent-%COMP%]   .mdc-text-field--outlined.mdc-text-field--focused[_ngcontent-%COMP%]{border-color:#2563eb;box-shadow:0 0 0 3px #3b82f61a}.dialog-actions[_ngcontent-%COMP%]   .mat-mdc-raised-button[_ngcontent-%COMP%]:disabled{box-shadow:none}.dialog-actions[_ngcontent-%COMP%]   .mat-mdc-raised-button[_ngcontent-%COMP%]:disabled:hover{transform:none}.dialog-actions[_ngcontent-%COMP%]   .mat-mdc-raised-button[_ngcontent-%COMP%]:not(:disabled):hover{transform:translateY(-1px);box-shadow:0 10px 15px -3px #0000001a,0 4px 6px -2px #0000000d}@keyframes _ngcontent-%COMP%_pulse-security{0%,to{transform:scale(1)}50%{transform:scale(1.05)}}.dialog-header[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_pulse-security 2s infinite}.mat-mdc-form-field[_ngcontent-%COMP%]   input[type=password][_ngcontent-%COMP%], .mat-mdc-form-field[_ngcontent-%COMP%]   input[type=text][_ngcontent-%COMP%]{font-size:18px;letter-spacing:.2em}.mat-mdc-form-field[_ngcontent-%COMP%]   input[type=password][_ngcontent-%COMP%]::placeholder, .mat-mdc-form-field[_ngcontent-%COMP%]   input[type=text][_ngcontent-%COMP%]::placeholder{font-size:14px;letter-spacing:normal}.bg-red-50[_ngcontent-%COMP%], .bg-blue-50[_ngcontent-%COMP%]{transition:all .2s ease-in-out}.bg-red-50[_ngcontent-%COMP%]:hover, .bg-blue-50[_ngcontent-%COMP%]:hover{box-shadow:0 2px 4px #0000001a}.animate-spin[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_spin 1s linear infinite}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}@media(max-width:480px){.pin-authorization-dialog[_ngcontent-%COMP%]{padding:16px;min-width:320px;max-width:95vw}.dialog-actions[_ngcontent-%COMP%]{flex-direction:column-reverse}.dialog-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:100%;margin:4px 0}}"]})};export{X as a};
