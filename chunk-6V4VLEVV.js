import{a as G}from"./chunk-5QHSQXKO.js";import{a as He}from"./chunk-HJQVQ5OX.js";import{a as A,b as Oe,c as ke}from"./chunk-ETPNRL7S.js";import{a as z,b as H}from"./chunk-U7ARI6ZS.js";import{a as Re,b as Ie,c as Ne,e as Be,f as Ve,g as Ae,h as ze}from"./chunk-DCD2EY64.js";import{a as Fe}from"./chunk-2MXILDTK.js";import{a as V,b as Le}from"./chunk-SYBKQTIU.js";import"./chunk-H3VCUIUM.js";import"./chunk-FB5OTQCF.js";import{a as B,b as he,c as Me,d as Te,e as Se,f as ve,g as xe,h as we,i as Ee,j as Pe,k as De}from"./chunk-OALZQOYE.js";import"./chunk-EIZRJIIE.js";import{a as ie,b as oe,c as re,d as ne}from"./chunk-U2JZUY6D.js";import{i as F}from"./chunk-U4YSNMIZ.js";import"./chunk-3IQG3KHZ.js";import"./chunk-YK4A772F.js";import"./chunk-HXICWX3M.js";import"./chunk-4YIJHWNC.js";import{d as ye}from"./chunk-EPNSEEH4.js";import"./chunk-MMNFDWV7.js";import"./chunk-CGDRKYIW.js";import{b as R,c as I,d as N}from"./chunk-IS37LNAK.js";import{a as O,b as Ce,d as fe,h as k}from"./chunk-QJ2P7YZL.js";import"./chunk-LXD47U2C.js";import{a as be,b as _e}from"./chunk-ZG44B3L4.js";import{B as ue,b as le,d as j,g as me,h as se,m as ce,s as de,t as pe,z as ge}from"./chunk-SZWYIW32.js";import"./chunk-CTT4BYCX.js";import{a as L}from"./chunk-V7ZBVJLR.js";import"./chunk-NQRUH5DO.js";import{a as ee,c as te,h as ae}from"./chunk-MESJBQC5.js";import"./chunk-QEF3JOQ3.js";import"./chunk-LSROOOYO.js";import"./chunk-7NDZPDVA.js";import{b as X,c as Z}from"./chunk-OWLRGWNJ.js";import{$ as D,Y as W,Z as P}from"./chunk-OS2CYUJN.js";import"./chunk-U2P6GFP5.js";import{$a as m,Dc as J,Gb as f,Hb as b,Mb as c,Nb as i,Ob as o,Pb as p,Tb as _,Tc as K,Ub as y,Wb as Q,_b as g,ac as h,ea as s,ec as x,fc as w,gc as E,ja as T,ka as S,kc as U,ob as v,pc as n,qc as Y,rc as C,ub as u,va as q}from"./chunk-IQSYHSID.js";import"./chunk-EQDQRRRY.js";function Ye(a,e){a&1&&(i(0,"mat-error"),n(1," Category name is required "),o())}function Je(a,e){a&1&&(i(0,"mat-error"),n(1," Category name must be at least 2 characters "),o())}var M=class a{fb=s(ge);tableCategoryService=s(G);storeStore=s(F);snackBar=s(L);dialogRef=s(Re);data=s(Ie);categoryForm;isEdit=!1;isLoading=!1;ngOnInit(){this.isEdit=this.data?.mode==="edit",this.initForm(),this.isEdit&&this.data.category&&this.populateForm(this.data.category)}initForm(){this.categoryForm=this.fb.group({name:["",[j.required,j.minLength(2)]],active:[!0],store:[this.storeStore.selectedStore()?._id]})}populateForm(e){this.categoryForm.patchValue({name:e.name,active:e.active,store:typeof e.store=="object"?e.store._id:e.store})}onSubmit(){if(this.categoryForm.valid){this.isLoading=!0;let e=this.categoryForm.value;this.isEdit?this.tableCategoryService.updateTableCategory(this.data.category._id,e).subscribe({next:()=>{this.snackBar.open("Table category updated successfully","Close",{duration:3e3,horizontalPosition:"end",verticalPosition:"top"}),this.dialogRef.close(!0)},error:t=>{console.error("Error updating table category:",t),this.snackBar.open("Error updating table category","Close",{duration:3e3,horizontalPosition:"end",verticalPosition:"top"}),this.isLoading=!1}}):this.tableCategoryService.createTableCategory(e).subscribe({next:()=>{this.snackBar.open("Table category created successfully","Close",{duration:3e3,horizontalPosition:"end",verticalPosition:"top"}),this.dialogRef.close(!0)},error:t=>{console.error("Error creating table category:",t),this.snackBar.open("Error creating table category","Close",{duration:3e3,horizontalPosition:"end",verticalPosition:"top"}),this.isLoading=!1}})}}onCancel(){this.dialogRef.close(!1)}static \u0275fac=function(t){return new(t||a)};static \u0275cmp=v({type:a,selectors:[["app-create-table-category"]],decls:21,vars:8,consts:[[1,"dialog-container"],["mat-dialog-title","",1,"text-xl","font-semibold","text-gray-900","mb-4"],[1,"space-y-4",3,"ngSubmit","formGroup"],[1,"space-y-4"],["appearance","outline",1,"w-full"],["matInput","","formControlName","name","placeholder","Enter category name"],[1,"flex","items-center","gap-3"],["formControlName","active","color","primary"],[1,"text-sm","text-gray-600"],[1,"flex","justify-end","gap-3","pt-4"],["mat-button","","type","button",3,"click","disabled"],["mat-raised-button","","color","primary","type","submit",3,"disabled"]],template:function(t,r){if(t&1&&(i(0,"div",0)(1,"h2",1),n(2),o(),i(3,"form",2),g("ngSubmit",function(){return r.onSubmit()}),i(4,"mat-dialog-content",3)(5,"mat-form-field",4)(6,"mat-label"),n(7,"Category Name"),o(),p(8,"input",5),f(9,Ye,2,0,"mat-error"),f(10,Je,2,0,"mat-error"),o(),i(11,"div",6)(12,"mat-slide-toggle",7),n(13," Active "),o(),i(14,"span",8),n(15),o()()(),i(16,"mat-dialog-actions",9)(17,"button",10),g("click",function(){return r.onCancel()}),n(18," Cancel "),o(),i(19,"button",11),n(20),o()()()()),t&2){let l,d,$;m(2),C(" ",r.isEdit?"Edit Table Category":"Create New Table Category"," "),m(),c("formGroup",r.categoryForm),m(6),b((l=r.categoryForm.get("name"))!=null&&l.hasError("required")?9:-1),m(),b((d=r.categoryForm.get("name"))!=null&&d.hasError("minlength")?10:-1),m(5),C(" ",($=r.categoryForm.get("active"))!=null&&$.value?"Category is active":"Category is inactive"," "),m(2),c("disabled",r.isLoading),m(2),c("disabled",r.categoryForm.invalid||r.isLoading),m(),C(" ",r.isLoading?"Saving...":r.isEdit?"Update Category":"Create Category"," ")}},dependencies:[ue,ce,le,me,se,pe,de,ze,Be,Ae,Ve,R,k,O,Ce,N,I,D,P,H,z],styles:[".dialog-container[_ngcontent-%COMP%]{min-width:400px}.dialog-container[_ngcontent-%COMP%]   .mat-mdc-form-field[_ngcontent-%COMP%]   .mat-mdc-form-field-subscript-wrapper[_ngcontent-%COMP%]{display:none}.dialog-container[_ngcontent-%COMP%]   .mat-mdc-dialog-content[_ngcontent-%COMP%]{max-height:60vh;overflow-y:auto}.dialog-container[_ngcontent-%COMP%]   .mat-mdc-slide-toggle[_ngcontent-%COMP%]{--mdc-switch-selected-track-color: #1976d2;--mdc-switch-selected-handle-color: #1976d2}"]})};var Ke=()=>[5,10,25,100];function We(a,e){a&1&&(i(0,"div",10),p(1,"mat-spinner",14),o())}function Xe(a,e){a&1&&p(0,"app-no-record",11)}function Ze(a,e){a&1&&(i(0,"th",27),n(1,"Category Name"),o())}function et(a,e){if(a&1&&(i(0,"td",28),n(1),o()),a&2){let t=e.$implicit;m(),Y(t.name)}}function tt(a,e){a&1&&(i(0,"th",29),n(1,"Tables Count"),o())}function at(a,e){if(a&1&&(i(0,"td",30)(1,"span",31),n(2),o()()),a&2){let t=e.$implicit;m(2),C(" ",(t.tables==null?null:t.tables.length)||0," tables ")}}function it(a,e){a&1&&(i(0,"th",29),n(1,"Status"),o())}function ot(a,e){if(a&1){let t=Q();i(0,"td",30)(1,"mat-slide-toggle",32),g("change",function(){let l=T(t).$implicit,d=h(2);return S(d.toggleCategoryStatus(l))}),o()()}if(a&2){let t=e.$implicit;m(),c("checked",t.active)}}function rt(a,e){a&1&&(i(0,"th",29),n(1,"Actions"),o())}function nt(a,e){if(a&1){let t=Q();i(0,"td",30)(1,"button",33)(2,"mat-icon"),n(3,"more_vert"),o()(),i(4,"mat-menu",null,0)(6,"button",34),g("click",function(){let l=T(t).$implicit,d=h(2);return S(d.editCategory(l))}),i(7,"mat-icon"),n(8,"edit"),o(),i(9,"span"),n(10,"Edit"),o()(),i(11,"button",34),g("click",function(){let l=T(t).$implicit,d=h(2);return S(d.deleteCategory(l))}),i(12,"mat-icon"),n(13,"delete"),o(),i(14,"span"),n(15,"Delete"),o()()()()}if(a&2){let t=U(5);m(),c("matMenuTriggerFor",t)}}function lt(a,e){a&1&&p(0,"tr",35)}function mt(a,e){a&1&&p(0,"tr",36)}function st(a,e){if(a&1&&(i(0,"div",12)(1,"table",15),_(2,16),u(3,Ze,2,0,"th",17)(4,et,2,1,"td",18),y(),_(5,19),u(6,tt,2,0,"th",20)(7,at,3,1,"td",21),y(),_(8,22),u(9,it,2,0,"th",20)(10,ot,2,1,"td",21),y(),_(11,23),u(12,rt,2,0,"th",20)(13,nt,16,1,"td",21),y(),u(14,lt,1,0,"tr",24)(15,mt,1,0,"tr",25),o(),p(16,"mat-paginator",26),o()),a&2){let t=h();m(),c("dataSource",t.filteredCategories()),m(13),c("matHeaderRowDef",t.displayedColumns),m(),c("matRowDefColumns",t.displayedColumns),m(),c("pageSizeOptions",J(4,Ke))}}function ct(a,e){a&1&&p(0,"app-no-record",13)}var Ge=class a{tableCategoryService=s(G);storeStore=s(F);dialog=s(Ne);snackBar=s(L);searchTerm=q("");displayedColumns=["name","tables","active","actions"];dataSource=ye({params:()=>({storeId:this.storeStore.selectedStore()?._id}),stream:({params:e})=>this.tableCategoryService.getStoreTableCategories(e.storeId)});filteredCategories=K(()=>{let e=this.searchTerm().toLowerCase();return this.dataSource.value()?.filter(t=>t.name.toLowerCase().includes(e))??[]});paginator;sort;table;onSearch(e){let t=e.target;this.searchTerm.set(t.value)}addCategory(){this.dialog.open(M,{width:"500px",data:{mode:"create"}}).afterClosed().subscribe(t=>{t&&this.dataSource.reload()})}editCategory(e){this.dialog.open(M,{width:"500px",data:{mode:"edit",category:e}}).afterClosed().subscribe(r=>{r&&this.dataSource.reload()})}deleteCategory(e){this.dialog.open(He,{width:"400px",data:{message:`Are you sure you want to delete ${e.name}?`}}).afterClosed().subscribe(r=>{r&&this.tableCategoryService.deleteTableCategory(e._id).subscribe({next:()=>{this.snackBar.open("Table category deleted successfully","Close",{duration:3e3,horizontalPosition:"end",verticalPosition:"top"}),this.dataSource.reload()},error:l=>{console.error("Error deleting table category:",l),this.snackBar.open("Error deleting table category","Close",{duration:3e3,horizontalPosition:"end",verticalPosition:"top"})}})})}toggleCategoryStatus(e){let t={active:!e.active};this.tableCategoryService.updateTableCategory(e._id,t).subscribe({next:()=>{this.snackBar.open("Table category status updated successfully","Close",{duration:3e3,horizontalPosition:"end",verticalPosition:"top"}),this.dataSource.reload()},error:()=>{this.snackBar.open("Error updating table category status","Close",{duration:3e3,horizontalPosition:"end",verticalPosition:"top"})}})}static \u0275fac=function(t){return new(t||a)};static \u0275cmp=v({type:a,selectors:[["app-list-table-categories"]],viewQuery:function(t,r){if(t&1&&(x(V,5),x(A,5),x(B,5)),t&2){let l;w(l=E())&&(r.paginator=l.first),w(l=E())&&(r.sort=l.first),w(l=E())&&(r.table=l.first)}},decls:19,vars:1,consts:[["menu","matMenu"],[1,"table-categories-container","!bg-white","!rounded-xl","!shadow-lg","border","border-gray-100"],[1,"!bg-white"],[1,"flex","flex-col","md:flex-row","justify-between","gap-4","p-4","border-b"],[1,"flex","flex-col","sm:flex-row","gap-4","flex-grow"],["appearance","outline",1,"w-full","sm:w-48","md:w-72","lg:w-96"],["matPrefix",""],["matInput","","placeholder","Search table categories",3,"input"],[1,"flex","gap-3","justify-end"],["mat-raised-button","","color","primary",3,"click"],[1,"flex","items-center","justify-center","min-h-[300px]"],["icon","category","title","No Table Categories","message","No table categories found matching your criteria."],[1,"table-container","rounded-lg","overflow-x-auto","mt-4"],["icon","error","title","Error","message","An error occurred while fetching the data. Please try again later."],["diameter","40"],["mat-table","","matSort","",1,"!bg-white","min-w-full","rounded-lg",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","","mat-sort-header","","class","bg-gray-50",4,"matHeaderCellDef"],["mat-cell","","class","font-semibold",4,"matCellDef"],["matColumnDef","tables"],["mat-header-cell","","class","bg-gray-50",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","active"],["matColumnDef","actions"],["mat-header-row","","class","bg-gray-50",4,"matHeaderRowDef"],["mat-row","","class","hover:bg-gray-50 transition",4,"matRowDef","matRowDefColumns"],["aria-label","Select page of categories",1,"!bg-white",3,"pageSizeOptions"],["mat-header-cell","","mat-sort-header","",1,"bg-gray-50"],["mat-cell","",1,"font-semibold"],["mat-header-cell","",1,"bg-gray-50"],["mat-cell",""],[1,"px-2","py-1","bg-blue-100","text-blue-800","rounded-full","text-xs"],["color","primary",3,"change","checked"],["mat-icon-button","","aria-label","Category actions",3,"matMenuTriggerFor"],["mat-menu-item","",3,"click"],["mat-header-row","",1,"bg-gray-50"],["mat-row","",1,"hover:bg-gray-50","transition"]],template:function(t,r){t&1&&(i(0,"mat-card",1)(1,"mat-card-content",2)(2,"div",3)(3,"div",4)(4,"mat-form-field",5)(5,"mat-label"),n(6,"Search"),o(),i(7,"mat-icon",6),n(8,"search"),o(),i(9,"input",7),g("input",function(d){return r.onSearch(d)}),o()()(),i(10,"div",8)(11,"button",9),g("click",function(){return r.addCategory()}),i(12,"mat-icon"),n(13,"add"),o(),n(14," ADD CATEGORY "),o()()(),f(15,We,2,0,"div",10)(16,Xe,1,0,"app-no-record",11)(17,st,17,5,"div",12)(18,ct,1,0,"app-no-record",13),o()()),t&2&&(m(15),b(r.dataSource.isLoading()?15:r.dataSource.hasValue()&&r.filteredCategories().length===0?16:r.dataSource.hasValue()?17:r.dataSource.error()?18:-1))},dependencies:[De,B,Me,xe,Te,he,we,Se,ve,Ee,Pe,Le,V,ke,A,Oe,ae,ee,te,R,k,O,fe,N,I,D,P,W,Z,X,ne,oe,ie,re,_e,be,H,z,Fe],styles:[".table-categories-container[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   .mat-mdc-table[_ngcontent-%COMP%]{border-radius:8px}.table-categories-container[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   .mat-mdc-table[_ngcontent-%COMP%]   .mat-mdc-header-cell[_ngcontent-%COMP%]{font-weight:600;color:#374151;background-color:#f9fafb}.table-categories-container[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   .mat-mdc-table[_ngcontent-%COMP%]   .mat-mdc-row[_ngcontent-%COMP%]:hover{background-color:#f9fafb}.mat-mdc-form-field[_ngcontent-%COMP%]   .mat-mdc-form-field-subscript-wrapper[_ngcontent-%COMP%]{display:none}.mat-mdc-card[_ngcontent-%COMP%]{box-shadow:0 1px 3px #0000001a,0 1px 2px #0000000f}"]})};export{Ge as ListTableCategoriesComponent};
