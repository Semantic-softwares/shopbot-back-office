import{a as E}from"./chunk-EXZT4M77.js";import"./chunk-ZAOMQAJO.js";import"./chunk-4L4VWXIM.js";import{a as Pt}from"./chunk-2YWNEDPY.js";import{a as V,b as Dt,c as Rt}from"./chunk-V6Q2J3ZF.js";import{a as kt}from"./chunk-LO5LXT4F.js";import{a as wt}from"./chunk-YZQZHEMG.js";import{a as It,b as Ft}from"./chunk-NYCP7ATN.js";import{f as Et}from"./chunk-XSZYAESL.js";import"./chunk-LCNY3JPX.js";import{a as Tt}from"./chunk-4QMHOUIB.js";import{a as v,b as yt}from"./chunk-5NCGVO7F.js";import{a as xt}from"./chunk-HOFFRLAS.js";import{a as bt}from"./chunk-OFQMF3WN.js";import{a as pt,b as ct,c as ut,d as _t,e as ft,f as Ct,g as gt,h as ht,i as Mt,j as St,k as vt,l as Vt}from"./chunk-BAU4EBFS.js";import"./chunk-OKEXGVJ3.js";import{a as K,b as U,c as X,d as Y}from"./chunk-4P4GBQE7.js";import{i as z}from"./chunk-ZKQYDJ5W.js";import"./chunk-LCF3SYDV.js";import"./chunk-ZLVLWRZH.js";import{d as dt}from"./chunk-HJGFVW6K.js";import"./chunk-TVH27JLT.js";import"./chunk-G4CZ6LK2.js";import"./chunk-I564X6SI.js";import"./chunk-VTDH2LYT.js";import{b as ot,c as rt,d as lt}from"./chunk-63HT37SK.js";import{a as at,h as nt}from"./chunk-YJCGHVXK.js";import"./chunk-UHBDKNKX.js";import{a as mt,b as st}from"./chunk-3ZLH5HUN.js";import{A as it,b as Z,g as tt,l as et}from"./chunk-O5GCTPYR.js";import"./chunk-EGLRIU4H.js";import{a as Q}from"./chunk-5TL46KBL.js";import"./chunk-53AK2UWQ.js";import"./chunk-BFT2MTJY.js";import{a as q,c as G,h as J}from"./chunk-JONI64R4.js";import"./chunk-H7INH462.js";import"./chunk-OOL2KACG.js";import"./chunk-KZJMNFJ3.js";import{b as W,c as j}from"./chunk-G6I3OKXX.js";import{Z as N,_ as $,ba as O}from"./chunk-4Z2XUZY2.js";import"./chunk-F436VINI.js";import"./chunk-H22US2IH.js";import{Gc as L,Ib as P,Jb as I,Ob as u,Pb as a,Qb as n,Rb as _,Vb as p,Wb as c,Y as R,Yb as b,ac as f,bb as m,cc as g,fa as C,gc as x,hc as y,ic as T,ka as M,la as S,mc as F,qb as k,rc as r,sc as h,wb as d,xc as H,yc as B,zc as A}from"./chunk-P5WOETP4.js";import{a as w,b as D}from"./chunk-GAL4ENT6.js";var Bt=()=>[5,10,25,100];function At(t,e){t&1&&(a(0,"div",10),_(1,"mat-spinner",14),n())}function Lt(t,e){t&1&&_(0,"app-no-record",11)}function Nt(t,e){t&1&&_(0,"app-no-record",12)}function $t(t,e){t&1&&(a(0,"th",28),r(1,"Name"),n())}function Ot(t,e){if(t&1&&(a(0,"td",29),r(1),n()),t&2){let i=e.$implicit;m(),h(i.name)}}function Qt(t,e){t&1&&(a(0,"th",28),r(1,"At Least"),n())}function zt(t,e){if(t&1&&(a(0,"td",29),r(1),n()),t&2){let i=e.$implicit;m(),h(i.atLeast)}}function Wt(t,e){t&1&&(a(0,"th",28),r(1,"At Most"),n())}function jt(t,e){if(t&1&&(a(0,"td",29),r(1),n()),t&2){let i=e.$implicit;m(),h(i.atMost)}}function qt(t,e){t&1&&(a(0,"th",28),r(1,"Options"),n())}function Gt(t,e){if(t&1&&(a(0,"td",29),r(1),n()),t&2){let i=e.$implicit;m(),h(i.options.length)}}function Jt(t,e){t&1&&(a(0,"th",30),r(1,"Published"),n())}function Kt(t,e){if(t&1){let i=b();a(0,"td",29)(1,"mat-slide-toggle",31),f("change",function(){let l=M(i).$implicit,s=g(2);return S(s.togglePublished(l))}),n()()}if(t&2){let i=e.$implicit;m(),u("checked",i.enabled)}}function Ut(t,e){t&1&&(a(0,"th",30),r(1,"Actions"),n())}function Xt(t,e){if(t&1){let i=b();a(0,"td",29)(1,"button",32)(2,"mat-icon"),r(3,"more_vert"),n()(),a(4,"mat-menu",null,0)(6,"button",33),f("click",function(){let l=M(i).$implicit,s=g(2);return S(s.editVariant(l))}),a(7,"mat-icon"),r(8,"edit"),n(),a(9,"span"),r(10,"Edit"),n()(),a(11,"button",33),f("click",function(){let l=M(i).$implicit,s=g(2);return S(s.deleteVariant(l))}),a(12,"mat-icon"),r(13,"delete"),n(),a(14,"span"),r(15,"Delete"),n()()()()}if(t&2){let i=F(5);m(),u("matMenuTriggerFor",i)}}function Yt(t,e){t&1&&_(0,"tr",34)}function Zt(t,e){t&1&&_(0,"tr",35)}function te(t,e){if(t&1&&(a(0,"div",13)(1,"table",15),p(2,16),d(3,$t,2,0,"th",17)(4,Ot,2,1,"td",18),c(),p(5,19),d(6,Qt,2,0,"th",17)(7,zt,2,1,"td",18),c(),p(8,20),d(9,Wt,2,0,"th",17)(10,jt,2,1,"td",18),c(),p(11,21),d(12,qt,2,0,"th",17)(13,Gt,2,1,"td",18),c(),p(14,22),d(15,Jt,2,0,"th",23)(16,Kt,2,1,"td",18),c(),p(17,24),d(18,Ut,2,0,"th",23)(19,Xt,16,1,"td",18),c(),d(20,Yt,1,0,"tr",25)(21,Zt,1,0,"tr",26),n(),_(22,"mat-paginator",27),n()),t&2){let i=g();m(),u("dataSource",i.dataSource),m(19),u("matHeaderRowDef",i.displayedColumns),m(),u("matRowDefColumns",i.displayedColumns),m(),u("pageSizeOptions",L(4,Bt))}}var Ht=class t{displayedColumns=["name","atLeast","atMost","options","published","actions"];dataSource;searchText="";dialog=C(Et);productService=C(Pt);storeStore=C(z);snackBar=C(Q);paginator;sort;variants=dt({params:()=>({storeId:this.storeStore.selectedStore()?._id}),stream:({params:e})=>this.productService.getStoreGroupOption(e.storeId).pipe(R(i=>{this.dataSource=new Vt(i),this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort}))});applyFilter(e){let i=e.target.value;this.dataSource.filter=i.trim().toLowerCase()}openDialog(){this.dialog.open(E,{width:"500px",data:{isEdit:!1}}).afterClosed().subscribe(i=>{(i?.success||i===!0)&&this.variants.reload()})}editVariant(e){this.dialog.open(E,{width:"500px",data:{isEdit:!0,variant:e}}).afterClosed().subscribe(o=>{(o?.success||o===!0)&&(console.log("Reloading variants after edit"),this.variants.reload())})}deleteVariant(e){this.dialog.open(kt,{width:"350px",data:{message:`Are you sure you want to delete ${e.name}?`}}).afterClosed().subscribe(o=>{o&&this.productService.deleteVariant(e._id).subscribe({next:()=>{this.variants.reload()}})})}togglePublished(e){let i=D(w({},e),{enabled:!e.enabled});this.productService.updateVariant(i,e._id).subscribe({next:()=>{this.snackBar.open("Variant status updated successfully","Close",{duration:3e3,horizontalPosition:"end",verticalPosition:"top"}),this.variants.reload()},error:()=>{this.snackBar.open("Error updating variant status","Close",{duration:3e3,horizontalPosition:"end",verticalPosition:"top"})}})}reloadVariants(){this.variants.reload()}static \u0275fac=function(i){return new(i||t)};static \u0275cmp=k({type:t,selectors:[["app-variants"]],viewQuery:function(i,o){if(i&1&&(x(v,5),x(V,5)),i&2){let l;y(l=T())&&(o.paginator=l.first),y(l=T())&&(o.sort=l.first)}},decls:22,vars:2,consts:[["menu","matMenu"],["title","Modifiers","subtitle","Manage product variants and options"],["actions",""],["matButton","","actions","","title","Reload variants","matTooltip","Reload",3,"click"],["matButton","filled","color","primary",3,"click"],["appearance","outlined",1,"py-4"],[1,"flex","items-center","p-4","border-b","mb-4"],[1,"w-96"],["appearance","outline",1,"w-full"],["matInput","","placeholder","Search variants",3,"keyup","ngModelChange","ngModel"],[1,"flex","items-center","justify-center","min-h-[300px]"],["icon","error","title","Error","message","An error occurred while fetching variants. Please try again later."],["icon","category","title","No Variants","message","No variants found matching your criteria."],[1,"table-container","rounded-lg","overflow-x-auto"],["diameter","40"],["mat-table","","matSort","",1,"min-w-full",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","","mat-sort-header","","class","bg-gray-50",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","atLeast"],["matColumnDef","atMost"],["matColumnDef","options"],["matColumnDef","published"],["mat-header-cell","","class","bg-gray-50",4,"matHeaderCellDef"],["matColumnDef","actions"],["mat-header-row","","class","bg-gray-50",4,"matHeaderRowDef"],["mat-row","","class","hover:bg-gray-50 transition",4,"matRowDef","matRowDefColumns"],["aria-label","Select page of variants",3,"pageSizeOptions"],["mat-header-cell","","mat-sort-header","",1,"bg-gray-50"],["mat-cell",""],["mat-header-cell","",1,"bg-gray-50"],["color","primary",3,"change","checked"],["mat-icon-button","","aria-label","Variant actions",3,"matMenuTriggerFor"],["mat-menu-item","",3,"click"],["mat-header-row","",1,"bg-gray-50"],["mat-row","",1,"hover:bg-gray-50","transition"]],template:function(i,o){i&1&&(a(0,"app-page-header",1),p(1,2),a(2,"button",3),f("click",function(){return o.reloadVariants()}),a(3,"mat-icon"),r(4,"refresh"),n(),r(5," Refresh "),n(),a(6,"button",4),f("click",function(){return o.openDialog()}),a(7,"mat-icon"),r(8,"add"),n(),r(9," ADD VARIANT "),n(),c(),n(),a(10,"mat-card",5)(11,"mat-card-content")(12,"div",6)(13,"div",7)(14,"mat-form-field",8)(15,"mat-label"),r(16,"Search"),n(),a(17,"input",9),f("keyup",function(s){return o.applyFilter(s)}),A("ngModelChange",function(s){return B(o.searchText,s)||(o.searchText=s),s}),n()()()(),P(18,At,2,0,"div",10)(19,Lt,1,0,"app-no-record",11)(20,Nt,1,0,"app-no-record",12)(21,te,23,5,"div",13),n()()),i&2&&(m(17),H("ngModel",o.searchText),m(),I(o.variants.isLoading()?18:o.variants.error()?19:o.variants.hasValue()&&o.dataSource.data.length===0?20:o.variants.hasValue()?21:-1))},dependencies:[vt,pt,ut,gt,_t,ct,ht,ft,Ct,Mt,St,yt,v,Rt,V,Dt,J,q,G,ot,nt,at,lt,rt,O,$,N,j,W,Y,U,K,X,st,mt,xt,bt,wt,Tt,it,Z,tt,et,Ft,It],encapsulation:2})};export{Ht as VariantsComponent};
