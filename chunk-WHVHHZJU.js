import{a as L}from"./chunk-N4WB6XHF.js";import{a as G,b as Ut,c as Jt,d as ee}from"./chunk-D54P5HEE.js";import{a as $,b as z}from"./chunk-HI5TUZJE.js";import{a as Kt,b as Xt,c as Yt,d as Zt,g as te}from"./chunk-HDWLNSMT.js";import{a as Wt}from"./chunk-XISJ3OTQ.js";import"./chunk-MS4AQ6UA.js";import{a as Pt,b as Rt,c as Nt,d as Vt,e as Bt,f as qt,g as At,h as Ht,i as jt,j as Gt,k as Lt,l as $t,m as A,n as Qt}from"./chunk-553G7WQ4.js";import{b as zt}from"./chunk-UDNOIW3J.js";import{a as H,b as j}from"./chunk-E5GOXSYX.js";import"./chunk-BGOXKF75.js";import"./chunk-Q3BO6IZX.js";import{c as F,d as Et,j as P,k as R,l as N,m as V}from"./chunk-JURQBM4X.js";import{a as xt,c as Ot,e as yt}from"./chunk-2OS3A6OW.js";import{a as T}from"./chunk-UHZERJ3B.js";import"./chunk-L3V4XNTA.js";import{a as wt,b as Tt,c as It,d as kt}from"./chunk-DU2I3CEK.js";import"./chunk-URU65OXG.js";import{c as Ft}from"./chunk-45N66JJF.js";import"./chunk-JMDTRE27.js";import{b as I,d as S,g as k,h as ut,l as ft,m as _t,n as gt,o as Ct,q as St,r as ht,u as Mt,v as bt,w as vt}from"./chunk-7VZONRG3.js";import{a as Dt,b as B}from"./chunk-USY657EX.js";import{O as q,i as ct,j as D,k as w}from"./chunk-FG3IKYWR.js";import"./chunk-V6BWQRYA.js";import{i as st,o as dt,p as E}from"./chunk-2NDSKVKU.js";import{Bb as O,Cb as y,Hb as s,Ib as r,Jb as n,Kb as d,Lb as g,Mb as C,Ob as Q,Sb as f,Tb as _,Xb as W,Y as et,Yb as U,Za as l,Zb as J,bc as ot,cb as v,ea as c,gc as a,hc as K,ic as X,jb as x,ka as M,kc as nt,la as b,lc as rt,mc as at,pb as u,qc as mt,ua as it,vc as lt,xc as pt}from"./chunk-EV5SF5GC.js";import{a as Z,b as tt}from"./chunk-EQDQRRRY.js";function de(t,e){t&1&&(r(0,"mat-error"),a(1," Name is required "),n())}function ce(t,e){t&1&&(r(0,"mat-error"),a(1," Price is required "),n())}function ue(t,e){t&1&&(r(0,"mat-error"),a(1," Price must be 0 or greater "),n())}function fe(t,e){t&1&&d(0,"mat-spinner",13)}var h=class t{constructor(e,i,o){this.fb=e;this.dialogRef=i;this.data=o;this.optionForm=this.fb.group({name:["",S.required],price:[0,[S.required,S.min(0)]],inStock:[!0],store:[this.storeStore.selectedStore()?._id,S.required]}),o.isEdit&&o.option&&this.optionForm.patchValue(o.option)}productService=c(L);storeStore=c(q);snackBar=c(T);isSubmitting=it(!1);optionForm;onSubmit(){if(this.optionForm.valid){this.isSubmitting.set(!0);let e=this.optionForm.getRawValue();(this.data.isEdit?this.productService.updateOption(e,this.data.option._id):this.productService.saveOption(e)).subscribe({next:()=>{this.snackBar.open(`Option ${this.data.isEdit?"updated":"created"} successfully`,"Close",{duration:3e3,horizontalPosition:"end",verticalPosition:"top"}),this.dialogRef.close(!0)},error:()=>{this.snackBar.open(`Error ${this.data.isEdit?"updating":"creating"} option`,"Close",{duration:3e3,horizontalPosition:"end",verticalPosition:"top"}),this.isSubmitting.set(!1)}})}}onCancel(){this.dialogRef.close()}static \u0275fac=function(i){return new(i||t)(v(Mt),v(Kt),v(Xt))};static \u0275cmp=x({type:t,selectors:[["app-option-dialog"]],decls:25,vars:8,consts:[[1,"p-6"],["mat-dialog-title","",1,"text-xl","font-bold","mb-4"],[3,"ngSubmit","formGroup"],[1,"space-y-4"],["appearance","outline",1,"w-full"],["matInput","","formControlName","name","placeholder","Enter option name"],[4,"ngIf"],["matInput","","type","number","formControlName","price","min","0"],[1,"flex","items-center","p-4","bg-gray-50","rounded-lg"],["formControlName","inStock","color","primary"],[1,"flex","justify-end","space-x-2","mt-6","pt-4","border-t","border-gray-200"],["mat-button","","type","button",3,"click"],["mat-raised-button","","color","primary","type","submit",3,"disabled"],["diameter","20",1,"mr-2"]],template:function(i,o){if(i&1&&(r(0,"div",0)(1,"h2",1),a(2),n(),r(3,"form",2),f("ngSubmit",function(){return o.onSubmit()}),r(4,"div",3)(5,"mat-form-field",4)(6,"mat-label"),a(7,"Name"),n(),d(8,"input",5),u(9,de,2,0,"mat-error",6),n(),r(10,"mat-form-field",4)(11,"mat-label"),a(12,"Price"),n(),d(13,"input",7),u(14,ce,2,0,"mat-error",6)(15,ue,2,0,"mat-error",6),n(),r(16,"div",8)(17,"mat-slide-toggle",9),a(18," In Stock "),n()()(),r(19,"div",10)(20,"button",11),f("click",function(){return o.onCancel()}),a(21,"Cancel"),n(),r(22,"button",12),O(23,fe,1,0,"mat-spinner",13),a(24),n()()()()),i&2){let m,p,Y;l(2),X(" ",o.data.isEdit?"Edit Option":"Create New Option"," "),l(),s("formGroup",o.optionForm),l(6),s("ngIf",(m=o.optionForm.get("name"))==null?null:m.hasError("required")),l(5),s("ngIf",(p=o.optionForm.get("price"))==null?null:p.hasError("required")),l(),s("ngIf",(Y=o.optionForm.get("price"))==null?null:Y.hasError("min")),l(7),s("disabled",!o.optionForm.valid||o.isSubmitting()),l(),y(o.isSubmitting()?23:-1),l(),X(" ",o.data.isEdit?"Update":"Create"," ")}},dependencies:[E,st,te,Zt,R,P,F,Et,V,N,w,D,zt,B,vt,_t,I,gt,k,ut,ht,Ct,St,j,H,z,$],encapsulation:2})};var _e=()=>[5,10,25,100];function ge(t,e){t&1&&(r(0,"div",9),d(1,"mat-spinner",13),n())}function Ce(t,e){t&1&&d(0,"app-no-record",10)}function Se(t,e){t&1&&d(0,"app-no-record",11)}function he(t,e){t&1&&(r(0,"th",26),a(1,"Name"),n())}function Me(t,e){if(t&1&&(r(0,"td",27),a(1),n()),t&2){let i=e.$implicit;l(),K(i.name)}}function be(t,e){t&1&&(r(0,"th",26),a(1,"Price"),n())}function ve(t,e){if(t&1&&(r(0,"td",27),a(1),lt(2,"currency"),n()),t&2){let i,o=e.$implicit,m=_(2);l(),K(pt(2,1,o.price,(i=m.storeStore.selectedStore())==null?null:i.currency))}}function xe(t,e){t&1&&(r(0,"th",28),a(1,"In Stock"),n())}function Oe(t,e){if(t&1){let i=Q();r(0,"td",27)(1,"mat-slide-toggle",29),f("change",function(){let m=M(i).$implicit,p=_(2);return b(p.toggleInStock(m))}),n()()}if(t&2){let i=e.$implicit;l(),s("checked",i.inStock)}}function ye(t,e){t&1&&(r(0,"th",30),a(1,"Actions"),n())}function Ee(t,e){if(t&1){let i=Q();r(0,"td",27)(1,"button",31)(2,"mat-icon"),a(3,"more_vert"),n()(),r(4,"mat-menu",null,0)(6,"button",32),f("click",function(){let m=M(i).$implicit,p=_(2);return b(p.editOption(m))}),r(7,"mat-icon"),a(8,"edit"),n(),r(9,"span"),a(10,"Edit"),n()(),r(11,"button",32),f("click",function(){let m=M(i).$implicit,p=_(2);return b(p.deleteOption(m))}),r(12,"mat-icon"),a(13,"delete"),n(),r(14,"span"),a(15,"Delete"),n()()()()}if(t&2){let i=ot(5);l(),s("matMenuTriggerFor",i)}}function De(t,e){t&1&&d(0,"tr",33)}function we(t,e){t&1&&d(0,"tr",34)}function Te(t,e){if(t&1&&(r(0,"div",12)(1,"table",14),g(2,15),u(3,he,2,0,"th",16)(4,Me,2,1,"td",17),C(),g(5,18),u(6,be,2,0,"th",16)(7,ve,3,4,"td",17),C(),g(8,19),u(9,xe,2,0,"th",20)(10,Oe,2,1,"td",17),C(),g(11,21),u(12,ye,2,0,"th",22)(13,Ee,16,1,"td",17),C(),u(14,De,1,0,"tr",23)(15,we,1,0,"tr",24),n(),d(16,"mat-paginator",25),n()),t&2){let i=_();l(),s("dataSource",i.dataSource),l(13),s("matHeaderRowDef",i.displayedColumns),l(),s("matRowDefColumns",i.displayedColumns),l(),s("pageSizeOptions",mt(4,_e))}}var ie=class t{displayedColumns=["name","price","inStock","actions"];dataSource;searchText="";dialog=c(Yt);productService=c(L);storeStore=c(q);snackBar=c(T);paginator;sort;options=Ft({params:()=>({storeId:this.storeStore.selectedStore()?._id}),stream:({params:e})=>this.productService.getStoreOptions(e.storeId).pipe(et(i=>{this.dataSource=new $t(i),this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort}))});applyFilter(e){let i=e.target.value;this.dataSource.filter=i.trim().toLowerCase()}openDialog(){this.dialog.open(h,{width:"500px",data:{isEdit:!1}}).afterClosed().subscribe(i=>{i&&this.options.reload()})}editOption(e){this.dialog.open(h,{width:"500px",data:{isEdit:!0,option:e}}).afterClosed().subscribe(o=>{o&&this.options.reload()})}deleteOption(e){this.dialog.open(ee,{width:"350px",data:{message:`Are you sure you want to delete ${e.name}?`}}).afterClosed().subscribe(o=>{o&&this.productService.deleteOptionItem(e._id).subscribe({next:()=>{this.options.reload()}})})}toggleInStock(e){let i=tt(Z({},e),{inStock:!e.inStock});this.productService.updateOption(i,e._id).subscribe({next:()=>{this.snackBar.open("Option status updated successfully","Close",{duration:3e3,horizontalPosition:"end",verticalPosition:"top"}),this.options.reload()},error:()=>{this.snackBar.open("Error updating option status","Close",{duration:3e3,horizontalPosition:"end",verticalPosition:"top"})}})}static \u0275fac=function(i){return new(i||t)};static \u0275cmp=x({type:t,selectors:[["app-options"]],viewQuery:function(i,o){if(i&1&&(W(A,5),W(G,5)),i&2){let m;U(m=J())&&(o.paginator=m.first),U(m=J())&&(o.sort=m.first)}},decls:17,vars:2,consts:[["menu","matMenu"],[1,"options-container","!bg-white"],[1,"!bg-white"],[1,"flex","items-center","space-x-4","p-4"],[1,"w-80"],["appearance","outline",1,"w-full"],["matInput","","placeholder","Search options",3,"keyup","ngModelChange","ngModel"],[1,"flex-shrink-0","ml-auto"],["mat-raised-button","","color","primary",1,"h-[48px]","px-6","font-medium",3,"click"],[1,"flex","items-center","justify-center","min-h-[300px]"],["icon","error","title","Error","message","An error occurred while fetching options. Please try again later."],["icon","list","title","No Options","message","No options found matching your criteria."],[1,"table-container","!bg-white"],["diameter","40"],["mat-table","","matSort","",1,"!bg-white",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","price"],["matColumnDef","inStock"],["mat-header-cell","",4,"matHeaderCellDef"],["matColumnDef","actions"],["mat-header-cell","","class","w-20",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["aria-label","Select page of options",1,"!bg-white",3,"pageSizeOptions"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],["mat-header-cell",""],["color","primary",3,"change","checked"],["mat-header-cell","",1,"w-20"],["mat-icon-button","","aria-label","Option actions",3,"matMenuTriggerFor"],["mat-menu-item","",3,"click"],["mat-header-row",""],["mat-row",""]],template:function(i,o){i&1&&(r(0,"mat-card",1)(1,"mat-card-content",2)(2,"div",3)(3,"div",4)(4,"mat-form-field",5)(5,"mat-label"),a(6,"Search"),n(),r(7,"input",6),f("keyup",function(p){return o.applyFilter(p)}),at("ngModelChange",function(p){return rt(o.searchText,p)||(o.searchText=p),p}),n()()(),r(8,"div",7)(9,"button",8),f("click",function(){return o.openDialog()}),r(10,"mat-icon"),a(11,"add"),n(),a(12," ADD OPTION "),n()()(),O(13,ge,2,0,"div",9)(14,Ce,1,0,"app-no-record",10)(15,Se,1,0,"app-no-record",11)(16,Te,17,5,"div",12),n()()),i&2&&(l(7),nt("ngModel",o.searchText),l(6),y(o.options.isLoading()?13:o.options.error()?14:o.options.hasValue()&&o.dataSource.data.length===0?15:o.options.hasValue()?16:-1))},dependencies:[E,dt,Lt,Pt,Nt,At,Vt,Rt,Ht,Bt,qt,jt,Gt,Qt,A,Jt,G,Ut,yt,xt,Ot,R,P,F,V,N,w,D,ct,B,Dt,kt,Tt,wt,It,j,H,Wt,bt,I,k,ft,z,$],encapsulation:2})};export{ie as OptionsComponent};
