import{a as co}from"./chunk-CYMVCCWO.js";import{a as ao,b as lo,c as so}from"./chunk-S4F62WBS.js";import{a as Co,b as ho}from"./chunk-WVMGUUDE.js";import"./chunk-BRU3VHNH.js";import{a as Ct}from"./chunk-KNO5HCLP.js";import{a as mo}from"./chunk-GWC7K72H.js";import{a as ro,b as uo,c as po,d as fo}from"./chunk-A6CFPM4N.js";import{a as oo,b as no,c as Te,d as _t,e as go,g as _o}from"./chunk-CUXCECGE.js";import"./chunk-H3PMPS6B.js";import"./chunk-JRHYUNXY.js";import"./chunk-FSCIILJA.js";import{a as to,b as io}from"./chunk-GLKBUJUX.js";import{a as eo}from"./chunk-CQRXSTAL.js";import{a as ft,b as gt}from"./chunk-2OEO6EUM.js";import{a as zi}from"./chunk-RBBRHSN5.js";import{b as $i}from"./chunk-S35VCKTJ.js";import{a as Hi,c as Xi,e as Ji,f as Yi}from"./chunk-CU623SSI.js";import{a as pt}from"./chunk-GU4Z36JA.js";import{a as Ki}from"./chunk-W4KXP7Q5.js";import{a as Wi,b as Zi}from"./chunk-GZXF4TWP.js";import{a as ji,b as qi,c as Ui,d as te,e as ie,f as $e,g as je,h as oe,i as ne,j as re,k as ae}from"./chunk-Y6EIGA75.js";import{a as Gi,b as Ni,c as Li}from"./chunk-HJ3KAQ7K.js";import{a as Qi}from"./chunk-5HSGNHP2.js";import{h as Ai}from"./chunk-Y2RO63AQ.js";import{a as Qe}from"./chunk-JZKRHT5H.js";import{a as Le}from"./chunk-O4OM35BU.js";import{a as Mi,b as Di,c as Ti,g as wi}from"./chunk-LUSGELTX.js";import{a as Pi,b as Ei,c as Oi,e as Ri,f as Ii,g as Vi,h as Fi,k as Bi,l as Ne}from"./chunk-FJYLQSWC.js";import{a as ki,b as Ge}from"./chunk-4XV2UKEU.js";import{a as oi}from"./chunk-CP5EC6RD.js";import"./chunk-CCJ2KI64.js";import"./chunk-6RCOBA75.js";import"./chunk-A24HMJCQ.js";import{a as pi,b as fi,c as gi,d as _i}from"./chunk-Q4U6FYZ3.js";import{a as h,b as Ie,c as Ve,d as Fe,e as Ee,f as Be,g as J,h as Y,i as E}from"./chunk-QC7H4KPM.js";import{a as vi,b as Si}from"./chunk-WZDQ5XTC.js";import{d as ii}from"./chunk-R6JGHN2R.js";import{a as yi,c as ut,d as xi}from"./chunk-BXJEGH2V.js";import"./chunk-64WHNS37.js";import"./chunk-TIVXUJ22.js";import"./chunk-WAHSRZAW.js";import"./chunk-XLZTIYSF.js";import{b as ee,c as De,d as ue}from"./chunk-UMV4DCPT.js";import{a as de,b as mt,d as Me,e as bi,h as me}from"./chunk-G3VZM262.js";import"./chunk-BCE7WRWQ.js";import{a as pe,b as fe}from"./chunk-6I3AJKA7.js";import{A as Z,B as Ae,b as nt,d as Oe,g as rt,h as at,k as Ci,m as lt,n as hi,s as st,t as ct,z as dt}from"./chunk-W7NMJLMQ.js";import"./chunk-F5SZ3AU3.js";import{a as ci}from"./chunk-4UBDYPTG.js";import{a as di}from"./chunk-YXRAJPAB.js";import"./chunk-UVV7QZRX.js";import"./chunk-TILT22SG.js";import"./chunk-BFT2MTJY.js";import{a as it,c as mi,e as ui,h as ot}from"./chunk-3E3PJ7Q7.js";import{a as li,j as si}from"./chunk-FO4KTVQ3.js";import{f as ri,g as ai}from"./chunk-TRZH7NMW.js";import"./chunk-GXTELBJV.js";import{b as $,c as G}from"./chunk-JPRPNQOM.js";import{$ as ni,K as ti,Z as xe,_ as q,aa as Re,ba as A,c as ye,d as Q,f as Vt,i as ei}from"./chunk-3LDCGXHW.js";import{l as Zt,q as Se,s as B}from"./chunk-6PFJHDFS.js";import{$c as W,B as Gt,C as Ue,Gb as Ht,Gc as tt,H as Nt,I as Ze,Ib as _,Jb as C,Kb as Pe,Lc as L,Mb as U,Mc as Rt,Nb as z,Nc as It,Ob as v,Pb as r,Pc as K,Qb as a,Rb as R,Sb as se,Tb as ce,V as j,Vc as x,Y as be,Ya as et,Yb as S,_c as X,aa as Lt,ac as p,ba as Qt,bb as c,c as H,cc as d,da as Ot,f as Ye,fa as m,gc as Xt,hc as Jt,ic as Yt,ka as f,la as g,m as Ke,mc as Kt,oa as $t,oc as ve,qb as V,r as We,rb as Ut,rc as l,sa as jt,sc as k,tc as w,uc as Wt,vb as zt,wa as P,wb as ze,za as qt}from"./chunk-J2AK4FW5.js";import{a as D,b as F}from"./chunk-GAL4ENT6.js";var He=class{name;activate;position;color;icon;items;store;foods;constructor(t){this.name=t.name||"",this.activate=t.activate??!0,this.position=t.position||0,this.color=t.color||"#CFDDDB",this.icon=t.icon||"lunch_dining",this.items=t.items||0,this.store=t.store||"",this.foods=t.foods||[]}};var To={categories:[],selectedCategory:null,isLoading:!1,error:null},ht=Ie({providedIn:"root"},Be(To),Ve(({categories:o})=>({categoryCount:x(()=>o().length)})),Ee((o,t=m(Ki))=>{function e(b){h(o,{selectedCategory:b})}function i(b){let M=new He(b);h(o,{categories:[M,...o.categories()]})}function n(b,M){let O=o.categories().findIndex(y=>y._id===b);if(O!==-1){let y=[...o.categories()];y[O]=D(D({},y[O]),M),h(o,{categories:y})}else console.error(`Category with ID ${b} not found`)}function s(b){let M=o.categories().filter(O=>O._id!==b);h(o,{categories:M})}let u=Y(H(be(()=>h(o,{isLoading:!0,error:null,categories:[]})),j(b=>t.getStoreMenus(b).pipe(J({next(M){e(M[0]),h(o,{isLoading:!1,error:M,categories:M})},error(M){h(o,{isLoading:!1,error:M,categories:[]})}}))))),T=Y(H(be(()=>h(o,{isLoading:!0,error:null})),j(b=>{let M=new He(b);return t.createMenu(M).pipe(J({next(O){h(o,{isLoading:!1,error:null,categories:[O,...o.categories()]})},error(O){h(o,{isLoading:!1,error:O})}}))}))),N=Y(H(j(b=>t.deleteMenu(b).pipe(J({next(M){h(o,{isLoading:!1,error:null})},error(M){h(o,{isLoading:!1,error:M})}}))))),le=Y(H(j(({category:b,categoryId:M,reload:O=!0})=>(h(o,{isLoading:O,error:null}),t.updateMenu(M,b).pipe(J({next(y){h(o,{isLoading:!1,error:null}),n(M,y)},error(y){h(o,{isLoading:!1,error:y})}}))))));return{createCategory:i,updateCategory:n,deleteCategory:s,selectCategory:e,createCategory$:T,getCategories$:u,deleteCategory$:N,updateCategory$:le}}),Fe({onInit(o){let e=m(E).selectedStore();e?._id&&o.getCategories$(e._id)}}));var wo={products:[],error:null,isLoading:!1,searchQuery:"",changedPhotoOnEdit:!1,attachedFiles:[]},bt=Ie({providedIn:"root"},Be(wo),Ve(o=>{let t=m(ht),e=x(()=>{let i=t.selectedCategory(),n=o.searchQuery().toLowerCase();return n.length>0?o.products().filter(s=>s.name?.toLowerCase().includes(n)||s.description?.toLowerCase().includes(n)||s.barcode?.toLowerCase().includes(n)):i?o.products().filter(s=>s?.menu?._id===i?._id):[]});return{productCount:x(()=>o.products().length),filteredProducts:e,filterProductCount:x(()=>e().length)}}),Ee(o=>{function t(b){h(o,{searchQuery:b})}function e(b){return o.products().find(M=>M?.barcode===b)}function i(b){h(o,{changedPhotoOnEdit:b})}function n(b){h(o,{attachedFiles:b})}function s(){h(o,{searchQuery:""})}function u(b){let M=o.products().map(O=>O._id===b?F(D({},O),{quantity:O.quantity+1}):O);h(o,{products:M})}function T(b){let M=o.products().map(O=>O._id===b?F(D({},O),{quantity:Math.max(0,O.quantity-1)}):O);h(o,{products:M})}function N(b){h(o,{products:[b,...o.products()]})}function le(b){let M=o.products().filter(O=>O._id!==b);h(o,{products:M})}return{updateSearchQuery:t,clearSearchQuery:s,deleteProduct:le,searchByBarcode:e,createProduct:N,decrementQuantity:T,incrementQuantity:u,updateChangedPhotoOnEdit:i,updateAttachedFiles:n}}),Ee((o,t=m(pt))=>{let e=Y(H(be(()=>h(o,{isLoading:!0,error:null,products:[]})),j(s=>t.getStoreProducts(s).pipe(J({next(u){h(o,{isLoading:!1,error:null,products:u})},error(u){h(o,{isLoading:!1,error:u,products:[]})}})))));function i(s,u){let T=o.products().findIndex(N=>N._id===s);if(T!==-1){let N=[...o.products()];N[T]=D(D({},N[T]),u),h(o,{products:N})}else console.error(`Product with ID ${s} not found`)}let n=Y(H(j(s=>t.deleteProduct(s).pipe(J({next(u){h(o,{isLoading:!1,error:null})},error(u){h(o,{isLoading:!1,error:u})}})))));return{updateProduct:i,getStoreProducts:e,deleteProducts$:n}}),Fe({onInit(o){let e=m(E).selectedStore();e?._id&&o.getStoreProducts(e._id)}}));var ko={variants:[],error:null,isLoading:!1,selectedVariant:null,selectedVariants:[]},vt=Ie({providedIn:"root"},Be(ko),Ve(({variants:o})=>({menuCount:x(()=>o().length)})),Ee((o,t=m(pt))=>{function e(y){h(o,{selectedVariant:y})}function i(y){h(o,{variants:[...o.variants(),y]}),e(y)}function n(y,I){let _e=o.variants().findIndex(he=>he._id===y);if(_e!==-1){let he=[...o.variants()];he[_e]=D(D({},he[_e]),I),h(o,{variants:he})}else console.error(`Category with ID ${y} not found`)}function s(y){let I=o.variants().filter(_e=>_e._id!==y);h(o,{variants:I})}function u(y){h(o,{selectedVariants:y})}function T(y){let I=o.variants().filter(_e=>_e.products.includes(y));console.log("Filtered variants for product:",I),h(o,{selectedVariants:I})}let N=Y(H(be(()=>h(o,{isLoading:!0,error:null,variants:[]})),j(y=>t.getStoreGroupOption(y).pipe(J({next(I){h(o,{isLoading:!1,error:null,variants:I})},error(I){h(o,{isLoading:!1,error:I,variants:[]})}}))))),le=Y(H(be(()=>h(o,{isLoading:!0,error:null})),j(y=>t.createVariant(y).pipe(J({next(I){h(o,{isLoading:!1,error:null,variants:[y,...o.variants()]})},error(I){h(o,{isLoading:!1,error:I})}}))))),b=Y(H(j(({variant:y,variantId:I,reload:_e=!0})=>(h(o,{isLoading:_e,error:null}),t.updateVariant(y,I).pipe(J({next(he){n(I,y),h(o,{isLoading:!1,error:null})},error(he){h(o,{isLoading:!1,error:he})}})))))),M=Y(H(j(y=>t.deleteVariant(y).pipe(J({next(I){h(o,{isLoading:!1,error:null})},error(I){h(o,{isLoading:!1,error:I})}}))))),O=Y(H(j(y=>t.removeProductIdFromVariant(y.variantId,y.productId).pipe(J({next(I){h(o,{isLoading:!1,error:null})},error(I){h(o,{isLoading:!1,error:I})}})))));return{setSelectedVariant:e,createVariant:i,updateVariant:n,deleteVariant:s,updateSelectedVariants:u,getProductVariants:T,loadVariants:N,createVariant$:le,updateVariant$:b,deleteVariant$:M,removeProductIds$:O}}),Fe({onInit(o){let e=m(E).selectedStore()?._id;e&&o.loadVariants(e)}}));function Eo(o,t){o&1&&(r(0,"span",22),l(1,"Out of stock"),a())}function Oo(o,t){if(o&1){let e=S();r(0,"div",23)(1,"button",25),p("click",function(n){f(e);let s=d(2).$index,u=d().$index;return d(2).decrease(u,s),g(n.stopPropagation())}),r(2,"mat-icon"),l(3,"remove"),a()(),r(4,"span",26),l(5),a(),r(6,"button",27),p("click",function(n){f(e);let s=d(2).$index,u=d().$index;return d(2).increase(u,s),g(n.stopPropagation())}),r(7,"mat-icon"),l(8,"add"),a()()()}if(o&2){let e=d(2).$implicit;c(),v("disabled",e.quantity<=1),c(4),k(e.quantity)}}function Ro(o,t){if(o&1&&(r(0,"div",23)(1,"span",24),l(2),L(3,"currency"),a(),_(4,Oo,9,2,"div",23),a()),o&2){let e=d().$implicit,i=d(3);c(2),w(" +",It(3,2,e.price,i.product.store==null?null:i.product.store.currency)," "),c(2),C(e.selected?4:-1)}}function Io(o,t){if(o&1){let e=S();r(0,"mat-list-option",19),p("selectedChange",function(n){let s=f(e).$index,u=d().$index,T=d(2);return g(T.checkedChange(u,s,n))}),r(1,"div",20)(2,"div")(3,"span",21),l(4),L(5,"titlecase"),a(),_(6,Eo,2,0,"span",22),a(),_(7,Ro,5,5,"div",23),a()()}if(o&2){let e=t.$implicit;v("selected",e.selected)("disabled",!e.inStock),c(4),k(Rt(5,5,e.name)),c(2),C(e.inStock?-1:6),c(),C(e.inStock?7:-1)}}function Vo(o,t){if(o&1&&(r(0,"div",8)(1,"div",13)(2,"div")(3,"h3",14),l(4),L(5,"titlecase"),a(),r(6,"p",15),l(7),a()(),r(8,"span",16),l(9),a()(),r(10,"mat-selection-list",17),U(11,Io,8,7,"mat-list-option",18,Pe),a()()),o&2){let e=t.$implicit;c(4),k(Rt(5,16,e.name)),c(3),w(" Choose ",e.atLeast===e.atMost?e.atLeast:"between "+e.atLeast+" and "+e.atMost," "),c(),ve("bg-red-100",e.atLeast>0&&e.invalid)("text-red-700",e.atLeast>0&&e.invalid)("bg-green-100",!e.invalid)("text-green-700",!e.invalid)("bg-gray-100",e.atLeast===0&&e.invalid)("text-gray-600",e.atLeast===0&&e.invalid),c(),w(" ",e.atLeast>0?"Required":"Optional"," "),c(),v("multiple",!0),c(),z(e.options)}}function Fo(o,t){if(o&1){let e=S();U(0,Vo,13,18,"div",8,Pe),r(2,"div",9)(3,"button",10),p("click",function(){f(e);let n=d();return g(n.updateQuantityTotal("down"))}),r(4,"mat-icon"),l(5,"remove"),a()(),r(6,"span",11),l(7),a(),r(8,"button",12),p("click",function(){f(e);let n=d();return g(n.updateQuantityTotal("up"))}),r(9,"mat-icon"),l(10,"add"),a()()()}if(o&2){let e=d();z(e.variantStore.selectedVariants()),c(3),v("disabled",e.quantity()<=1),c(4),k(e.quantity())}}function Bo(o,t){o&1&&(r(0,"div",4),R(1,"mat-spinner",28),r(2,"p",29),l(3,"Loading options..."),a()())}var St=class o{dialogRef=m(te);dialogData=m(ie);isActivity=x(()=>this.storeStore.selectedStore()?.category==="Activities");product=this.dialogData.product;isEditing=P(this.dialogData?.isEditing??!1);productStore=m(bt);variantStore=m(vt);storeStore=m(E);quantity=P(this.product?.quantity||1);minDate=P(new Date);activityForm=new Ci;variant=qt(()=>{console.log("Selected variants updated:",this.variantStore.selectedVariants()),this.variantStore.selectedVariants()});updateAreAllVariantsValid=x(()=>this.variantStore.selectedVariants().every(e=>!e.invalid));ngOnInit(){if(this.isEditing()&&this.product.options&&this.product.options.length>0){let t=JSON.parse(JSON.stringify(this.product.options));this.variantStore.updateSelectedVariants(t)}this.activityForm.valueChanges.subscribe(t=>{t&&(this.product=F(D({},this.product),{activityDateTime:t}))})}closeModal(){this.variant.destroy(),this.dialogRef.close()}submit(){if(this.isActivity()&&!this.product.activityDateTime){alert("Please select activity date and time");return}this.variant.destroy();let e=this.variantStore.selectedVariants().map(i=>F(D({},i),{options:i.options.filter(n=>n.selected)}));this.product.quantity=this.quantity(),this.dialogRef.close(F(D({},this.product),{options:e,activityDateTime:this.isActivity()?this.product.activityDateTime:void 0}))}updateQuantityTotal(t){t==="up"?this.quantity.update(e=>e+1):this.quantity.update(e=>Math.max(1,e-1))}increase(t,e){let i=this.variantStore.selectedVariants(),n=F(D({},i[t].options[e]),{quantity:i[t].options[e].quantity+1}),s=[...i[t].options.slice(0,e),n,...i[t].options.slice(e+1)],u=F(D({},i[t]),{options:s}),T=[...i.slice(0,t),u,...i.slice(t+1)];this.variantStore.updateSelectedVariants(T)}decrease(t,e){let i=this.variantStore.selectedVariants(),n=Math.max(1,i[t].options[e].quantity-1),s=F(D({},i[t].options[e]),{quantity:n}),u=[...i[t].options.slice(0,e),s,...i[t].options.slice(e+1)],T=F(D({},i[t]),{options:u}),N=[...i.slice(0,t),T,...i.slice(t+1)];this.variantStore.updateSelectedVariants(N)}checkedChange(t,e,i){let s=this.deepClone(this.variantStore.selectedVariants()).map((u,T)=>{if(T===t){let N=u.options.map((b,M)=>M===e?F(D({},b),{selected:i}):b),le=N.filter(b=>b.selected===!0);return F(D({},u),{options:N,invalid:!(le.length>=u.atLeast&&le.length<=u.atMost)})}return u});this.variantStore.updateSelectedVariants(s)}deepClone(t){return JSON.parse(JSON.stringify(t))}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=V({type:o,selectors:[["app-product-options"]],decls:16,vars:9,consts:[["mat-dialog-title",""],[1,"mb-4","pt-4"],[1,"text-sm","text-gray-500","mb-2"],[1,"text-lg","font-semibold","text-primary"],[1,"flex","flex-col","items-center","justify-center","py-8","gap-4"],["align","end",1,"border-t","border-outline-variant"],["mat-button","","mat-dialog-close",""],["mat-flat-button","","color","primary",3,"click","disabled"],[1,"mb-4"],[1,"flex","items-center","gap-2","mr-auto"],["mat-mini-fab","","color","primary",3,"click","disabled"],[1,"w-10","text-center","text-xl","font-semibold"],["mat-mini-fab","","color","primary",3,"click"],[1,"flex","items-start","justify-between","mb-2"],[1,"text-base","font-medium"],[1,"text-xs","text-gray-500"],[1,"px-2","py-0.5","text-xs","font-medium","rounded-full"],[1,"!py-0",3,"multiple"],[1,"!h-auto","!py-2",3,"selected","disabled"],[1,"!h-auto","!py-2",3,"selectedChange","selected","disabled"],[1,"flex","items-center","justify-between","w-full"],[1,"text-sm"],[1,"block","text-xs","text-red-500"],[1,"flex","items-center","gap-2"],[1,"text-sm","text-gray-600"],["matIconButton","","color","warn",3,"click","disabled"],[1,"w-8","text-center","text-lg","font-semibold"],["matIconButton","","color","primary",3,"click"],["diameter","40"],[1,"text-gray-500"]],template:function(e,i){e&1&&(r(0,"h2",0),l(1),a(),r(2,"mat-dialog-content")(3,"div",1)(4,"p",2),l(5),a(),r(6,"span",3),l(7),L(8,"currency"),a()(),_(9,Fo,11,2)(10,Bo,4,0,"div",4),a(),r(11,"mat-dialog-actions",5)(12,"button",6),l(13,"Cancel"),a(),r(14,"button",7),p("click",function(){return i.submit()}),l(15),a()()),e&2&&(c(),k(i.product.name),c(4),k(i.product.description),c(2),w(" ",It(8,6,i.product.price,(i.product.store==null?null:i.product.store.currency)||"USD")," "),c(2),C(i.variantStore.isLoading()?10:9),c(5),v("disabled",!i.updateAreAllVariantsValid()),c(),w(" ",i.isEditing()?"Update":"Add to Order"," "))},dependencies:[B,Ae,ae,je,oe,re,ne,A,q,Re,xe,G,$,$i,fe,pe,ee,ue,Ai,oi,Ne,Bi,Fi,Zt,Se],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;max-height:100%}.text-primary[_ngcontent-%COMP%]{color:#1976d2}mat-selection-list[_ngcontent-%COMP%]   .mat-mdc-list-item[_ngcontent-%COMP%]{border-bottom:1px solid rgba(0,0,0,.06)}mat-selection-list[_ngcontent-%COMP%]   .mat-mdc-list-item[_ngcontent-%COMP%]:last-child{border-bottom:none}"]})};function Go(o,t){if(o&1&&R(0,"img",2),o&2){let e=d();v("src",e.product().photos[0],et)("alt",e.product().name)}}function No(o,t){o&1&&(r(0,"div",3)(1,"mat-icon",13),l(2,"image"),a()())}function Lo(o,t){o&1&&(r(0,"div",4),l(1," Out of stock "),a())}function Qo(o,t){if(o&1&&(r(0,"div",5),l(1),a()),o&2){let e=d();c(),w(" Low: ",e.product().qty," ")}}function $o(o,t){if(o&1&&(r(0,"span",10),l(1),L(2,"currency"),a()),o&2){let e=d();c(),w(" ",K(2,1,e.product().costPrice,e.currency(),"symbol","1.0-0")," ")}}function jo(o,t){if(o&1){let e=S();r(0,"div",14)(1,"button",16),p("click",function(){f(e);let n=d(2);return g(n.removeOrDeleteProduct(n.product()))}),r(2,"mat-icon",17),l(3,"remove"),a()(),r(4,"span",18),l(5),a(),r(6,"button",19),p("click",function(n){f(e);let s=d(2);return g(s.onAddToCart(n))}),r(7,"mat-icon",17),l(8,"add"),a()()()}if(o&2){let e=d(2);c(5),w(" ",e.productQuantity()," ")}}function qo(o,t){if(o&1){let e=S();r(0,"button",20),p("click",function(n){f(e);let s=d(2);return g(s.onAddToCart(n))}),r(1,"mat-icon"),l(2,"add_shopping_cart"),a(),l(3," Add "),a()}if(o&2){let e=d(2);v("disabled",e.isOutOfStock())}}function Uo(o,t){if(o&1&&_(0,jo,9,1,"div",14)(1,qo,4,1,"button",15),o&2){let e=d();C(e.isProductInCart()?0:1)}}function zo(o,t){if(o&1){let e=S();r(0,"button",21),p("click",function(n){f(e);let s=d();return g(s.onOpenOptions(n))}),r(1,"mat-icon"),l(2,"tune"),a(),l(3," Options "),a()}if(o&2){let e=d();v("disabled",e.isOutOfStock())}}var xt=class o{storeStore=m(E);cartStore=m(Te);variantStore=m(vt);dialog=m($e);breakpointObserver=m(ye);product=W.required();cartQuantity=W(0);addToCart=X();increment=X();decrement=X();openOptions=X();currency=x(()=>this.storeStore.selectedStore()?.currency||"\u20A6");hasOptions=x(()=>{let t=this.product();return t.options&&t.options.length>0});isProductInCart=x(()=>{let t=this.cartStore.selectedCart();return t?t.products.find(e=>e._id===this.product()._id):!1});productQuantity=x(()=>{let t=this.cartStore.selectedCart();if(t){let e=t.products.find(i=>i._id===this.product()._id);return e?e.quantity:0}return 0});isOutOfStock=x(()=>!this.product().active);isLowStock=x(()=>{let t=this.product();return t.active&&t.qty!==void 0&&t.qty<=5});onAddToCart(t){t.stopPropagation(),this.addToCart.emit(this.product())}removeOrDeleteProduct(t){this.productQuantity()>1?this.cartStore.decrementProductQuantity(t._id):(this.cartStore.updateCartAction("delete"),this.cartStore.removeFromCart(this.cartStore.selectedCart()._id,t._id))}onOpenOptions(t){t.stopPropagation(),this.openProductOptionsDialog()}openProductOptionsDialog(){this.variantStore.getProductVariants(this.product()._id);let t=this.cartStore.selectedCart(),e=null,i=!1;t&&(e=t.products.find(T=>T._id===this.product()._id)||null,i=!!e);let n={product:e||this.product(),isEditing:i},s=this.dialog.open(St,{width:"100%",maxWidth:"500px",panelClass:"product-options-dialog-panel",data:n});this.breakpointObserver.isMatched([Q.XSmall,Q.Small])&&s.updateSize("100vw","100vh"),s.afterClosed().subscribe(T=>{T&&(this.cartStore.updateCartAction(i?"edit":"add"),this.cartStore.selectedCart()||this.cartStore.createCart(),this.cartStore.addToCart(this.cartStore.selectedCart()._id,T,i))})}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=V({type:o,selectors:[["app-product-card"]],inputs:{product:[1,"product"],cartQuantity:[1,"cartQuantity"]},outputs:{addToCart:"addToCart",increment:"increment",decrement:"decrement",openOptions:"openOptions"},decls:17,vars:11,consts:[["appearance","outlined",1,"overflow-hidden","hover:shadow-lg","transition-shadow","duration-200","cursor-pointer","h-full","flex","flex-col"],[1,"relative","aspect-square","bg-gray-100","overflow-hidden"],[1,"w-full","h-full","object-cover","hover:scale-105","transition-transform","duration-300",3,"src","alt"],[1,"w-full","h-full","flex","items-center","justify-center","bg-gray-50"],[1,"absolute","top-2","right-2","px-2","py-0.5","text-xs","font-medium","rounded-full","bg-red-100","text-red-700"],[1,"absolute","top-2","right-2","px-2","py-0.5","text-xs","font-medium","rounded-full","bg-amber-100","text-amber-700"],[1,"p-4","flex-1","flex","flex-col"],[1,"font-medium","text-gray-900","text-sm","line-clamp-2","mt-2","min-h-[2.5rem]","leading-5"],[1,"flex","items-center","gap-2"],[1,"primary-text","font-bold","text-lg"],[1,"text-gray-400","primary-text","text-sm","line-through"],[1,"p-2","border-t","border-outline-variant"],["matButton","outlined","color","accent",1,"w-full",3,"disabled"],[1,"!text-5xl","!w-12","!h-12","text-gray-300"],[1,"flex","items-center","gap-1","w-full","justify-between"],["matButton","outlined","color","primary",1,"w-full",3,"disabled"],["mat-mini-fab","","color","warn",1,"!w-8","!h-8","!min-w-0",3,"click"],[1,"!text-lg"],[1,"w-8","text-center","font-semibold","text-gray-900"],["mat-mini-fab","","color","primary",1,"!w-8","!h-8","!min-w-0",3,"click"],["matButton","outlined","color","primary",1,"w-full",3,"click","disabled"],["matButton","outlined","color","accent",1,"w-full",3,"click","disabled"]],template:function(e,i){e&1&&(r(0,"mat-card",0)(1,"div",1),_(2,Go,1,2,"img",2)(3,No,3,0,"div",3),_(4,Lo,2,0,"div",4)(5,Qo,2,1,"div",5),a(),r(6,"mat-card-content",6)(7,"h3",7),l(8),a(),r(9,"div",8)(10,"span",9),l(11),L(12,"currency"),a(),_(13,$o,3,6,"span",10),a()(),r(14,"mat-card-actions",11),_(15,Uo,2,1)(16,zo,4,1,"button",12),a()()),e&2&&(c(2),C(i.product().photos&&i.product().photos.length>0?2:3),c(2),C(i.isOutOfStock()?4:i.isLowStock()?5:-1),c(4),w(" ",i.product().name," "),c(3),w(" ",K(12,6,i.product().price,i.currency(),"symbol","1.0-0")," "),c(2),C(i.product().costPrice&&i.product().costPrice>i.product().price?13:-1),c(2),C(i.hasOptions()?16:15))},dependencies:[B,ot,it,ui,mi,A,q,Re,G,$,Se],styles:["[_nghost-%COMP%]{display:block}.primary-text[_ngcontent-%COMP%]{color:var(--mat-sys-primary-color)}.line-clamp-2[_ngcontent-%COMP%]{display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden}"]})};function Xo(o,t){}var bo="_mat-bottom-sheet-enter",vo="_mat-bottom-sheet-exit",Jo=(()=>{class o extends ji{_breakpointSubscription;_animationsDisabled=Vt();_animationState="void";_animationStateChanged=new jt;_destroyed;constructor(){super();let e=m(ye);this._breakpointSubscription=e.observe([Q.Medium,Q.Large,Q.XLarge]).subscribe(()=>{let i=this._elementRef.nativeElement.classList;i.toggle("mat-bottom-sheet-container-medium",e.isMatched(Q.Medium)),i.toggle("mat-bottom-sheet-container-large",e.isMatched(Q.Large)),i.toggle("mat-bottom-sheet-container-xlarge",e.isMatched(Q.XLarge))})}enter(){this._destroyed||(this._animationState="visible",this._changeDetectorRef.markForCheck(),this._changeDetectorRef.detectChanges(),this._animationsDisabled&&this._simulateAnimation(bo))}exit(){this._destroyed||(this._elementRef.nativeElement.setAttribute("mat-exit",""),this._animationState="hidden",this._changeDetectorRef.markForCheck(),this._animationsDisabled&&this._simulateAnimation(vo))}ngOnDestroy(){super.ngOnDestroy(),this._breakpointSubscription.unsubscribe(),this._destroyed=!0}_simulateAnimation(e){this._ngZone.run(()=>{this._handleAnimationEvent(!0,e),setTimeout(()=>this._handleAnimationEvent(!1,e))})}_trapFocus(){super._trapFocus({preventScroll:!0})}_handleAnimationEvent(e,i){let n=i===bo;(n||i===vo)&&this._animationStateChanged.emit({toState:n?"visible":"hidden",phase:e?"start":"done"})}static \u0275fac=function(i){return new(i||o)};static \u0275cmp=V({type:o,selectors:[["mat-bottom-sheet-container"]],hostAttrs:["tabindex","-1",1,"mat-bottom-sheet-container"],hostVars:9,hostBindings:function(i,n){i&1&&p("animationstart",function(u){return n._handleAnimationEvent(!0,u.animationName)})("animationend",function(u){return n._handleAnimationEvent(!1,u.animationName)})("animationcancel",function(u){return n._handleAnimationEvent(!1,u.animationName)}),i&2&&(Ht("role",n._config.role)("aria-modal",n._config.ariaModal)("aria-label",n._config.ariaLabel),ve("mat-bottom-sheet-container-animations-enabled",!n._animationsDisabled)("mat-bottom-sheet-container-enter",n._animationState==="visible")("mat-bottom-sheet-container-exit",n._animationState==="hidden"))},features:[zt],decls:1,vars:0,consts:[["cdkPortalOutlet",""]],template:function(i,n){i&1&&ze(0,Xo,0,0,"ng-template",0)},dependencies:[ri],styles:[`@keyframes _mat-bottom-sheet-enter{from{transform:translateY(100%)}to{transform:none}}@keyframes _mat-bottom-sheet-exit{from{transform:none}to{transform:translateY(100%)}}.mat-bottom-sheet-container{box-shadow:0px 8px 10px -5px rgba(0, 0, 0, 0.2), 0px 16px 24px 2px rgba(0, 0, 0, 0.14), 0px 6px 30px 5px rgba(0, 0, 0, 0.12);padding:8px 16px;min-width:100vw;box-sizing:border-box;display:block;outline:0;max-height:80vh;overflow:auto;position:relative;background:var(--mat-bottom-sheet-container-background-color, var(--mat-sys-surface-container-low));color:var(--mat-bottom-sheet-container-text-color, var(--mat-sys-on-surface));font-family:var(--mat-bottom-sheet-container-text-font, var(--mat-sys-body-large-font));font-size:var(--mat-bottom-sheet-container-text-size, var(--mat-sys-body-large-size));line-height:var(--mat-bottom-sheet-container-text-line-height, var(--mat-sys-body-large-line-height));font-weight:var(--mat-bottom-sheet-container-text-weight, var(--mat-sys-body-large-weight));letter-spacing:var(--mat-bottom-sheet-container-text-tracking, var(--mat-sys-body-large-tracking))}@media(forced-colors: active){.mat-bottom-sheet-container{outline:1px solid}}.mat-bottom-sheet-container-animations-enabled{transform:translateY(100%)}.mat-bottom-sheet-container-animations-enabled.mat-bottom-sheet-container-enter{animation:_mat-bottom-sheet-enter 195ms cubic-bezier(0, 0, 0.2, 1) forwards}.mat-bottom-sheet-container-animations-enabled.mat-bottom-sheet-container-exit{animation:_mat-bottom-sheet-exit 375ms cubic-bezier(0.4, 0, 1, 1) backwards}.mat-bottom-sheet-container-xlarge,.mat-bottom-sheet-container-large,.mat-bottom-sheet-container-medium{border-top-left-radius:var(--mat-bottom-sheet-container-shape, 28px);border-top-right-radius:var(--mat-bottom-sheet-container-shape, 28px)}.mat-bottom-sheet-container-medium{min-width:384px;max-width:calc(100vw - 128px)}.mat-bottom-sheet-container-large{min-width:512px;max-width:calc(100vw - 256px)}.mat-bottom-sheet-container-xlarge{min-width:576px;max-width:calc(100vw - 384px)}
`],encapsulation:2})}return o})(),Yo=new Ot("MatBottomSheetData"),Bt=class{viewContainerRef;injector;panelClass;direction;data=null;hasBackdrop=!0;backdropClass;disableClose=!1;ariaLabel=null;ariaModal=!1;closeOnNavigation=!0;autoFocus="first-tabbable";restoreFocus=!0;scrollStrategy;height="";minHeight;maxHeight},qe=class{_ref;get instance(){return this._ref.componentInstance}get componentRef(){return this._ref.componentRef}containerInstance;disableClose;_afterOpened=new Ye;_result;_closeFallbackTimeout;constructor(t,e,i){this._ref=t,this.containerInstance=i,this.disableClose=e.disableClose,i._animationStateChanged.pipe(Ue(n=>n.phase==="done"&&n.toState==="visible"),Ze(1)).subscribe(()=>{this._afterOpened.next(),this._afterOpened.complete()}),i._animationStateChanged.pipe(Ue(n=>n.phase==="done"&&n.toState==="hidden"),Ze(1)).subscribe(()=>{clearTimeout(this._closeFallbackTimeout),this._ref.close(this._result)}),t.overlayRef.detachments().subscribe(()=>{this._ref.close(this._result)}),Gt(this.backdropClick(),this.keydownEvents().pipe(Ue(n=>n.keyCode===27))).subscribe(n=>{!this.disableClose&&(n.type!=="keydown"||!ti(n))&&(n.preventDefault(),this.dismiss())})}dismiss(t){this.containerInstance&&(this.containerInstance._animationStateChanged.pipe(Ue(e=>e.phase==="start"),Ze(1)).subscribe(()=>{this._closeFallbackTimeout=setTimeout(()=>this._ref.close(this._result),500),this._ref.overlayRef.detachBackdrop()}),this._result=t,this.containerInstance.exit(),this.containerInstance=null)}afterDismissed(){return this._ref.closed}afterOpened(){return this._afterOpened}backdropClick(){return this._ref.backdropClick}keydownEvents(){return this._ref.keydownEvents}},Ko=new Ot("mat-bottom-sheet-default-options"),At=(()=>{class o{_injector=m($t);_parentBottomSheet=m(o,{optional:!0,skipSelf:!0});_animationsDisabled=Vt();_defaultOptions=m(Ko,{optional:!0});_bottomSheetRefAtThisLevel=null;_dialog=m(qi);get _openedBottomSheetRef(){let e=this._parentBottomSheet;return e?e._openedBottomSheetRef:this._bottomSheetRefAtThisLevel}set _openedBottomSheetRef(e){this._parentBottomSheet?this._parentBottomSheet._openedBottomSheetRef=e:this._bottomSheetRefAtThisLevel=e}constructor(){}open(e,i){let n=D(D({},this._defaultOptions||new Bt),i),s;return this._dialog.open(e,F(D({},n),{disableClose:!0,closeOnOverlayDetachments:!1,maxWidth:"100%",container:Jo,scrollStrategy:n.scrollStrategy||li(this._injector),positionStrategy:si(this._injector).centerHorizontally().bottom("0"),disableAnimations:this._animationsDisabled,templateContext:()=>({bottomSheetRef:s}),providers:(u,T,N)=>(s=new qe(u,n,N),[{provide:qe,useValue:s},{provide:Yo,useValue:n.data}])})),s.afterDismissed().subscribe(()=>{this._openedBottomSheetRef===s&&(this._openedBottomSheetRef=null)}),this._openedBottomSheetRef?(this._openedBottomSheetRef.afterDismissed().subscribe(()=>s.containerInstance?.enter()),this._openedBottomSheetRef.dismiss()):s.containerInstance.enter(),this._openedBottomSheetRef=s,s}dismiss(e){this._openedBottomSheetRef&&this._openedBottomSheetRef.dismiss(e)}ngOnDestroy(){this._bottomSheetRefAtThisLevel&&this._bottomSheetRefAtThisLevel.dismiss()}static \u0275fac=function(i){return new(i||o)};static \u0275prov=Lt({token:o,factory:o.\u0275fac,providedIn:"root"})}return o})(),So=(()=>{class o{static \u0275fac=function(i){return new(i||o)};static \u0275mod=Ut({type:o});static \u0275inj=Qt({providers:[At],imports:[Ui,ai,ei]})}return o})();function Wo(o,t){if(o&1&&(se(0,"div",2)(1,"span",3),l(2),ce(),se(3,"span",4),l(4),L(5,"currency"),ce()()),o&2){let e,i=d();c(2),w("Tax (",(e=i.storeStore.selectedStore())==null?null:e.tax,"%)"),c(2),k(K(5,2,i.cartTotals().tax,i.currency(),"symbol","1.0-0"))}}var Mt=class o{storeStore=m(E);cartStore=m(Te);cartService=m(_t);cartSummary=X();cart=W();isActivity=x(()=>this.storeStore.selectedStore()?.category==="683fd24cca109bb62f6b3bd4");cartTotals=x(()=>{let t=this.cartStore.selectedCart()||this.cart(),e=this.cartService.generateCartSummary(t,this.storeStore.selectedStore());return this.cartSummary.emit(e),e});subtotal=W(0);taxRate=W(0);disabled=W(!0);checkoutLabel=W("Checkout");checkout=X();currency=x(()=>this.storeStore.selectedStore()?.currency||"\u20A6");onCheckout(){this.checkout.emit()}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=V({type:o,selectors:[["app-checkout-summary"]],inputs:{cart:[1,"cart"],subtotal:[1,"subtotal"],taxRate:[1,"taxRate"],disabled:[1,"disabled"],checkoutLabel:[1,"checkoutLabel"]},outputs:{cartSummary:"cartSummary",checkout:"checkout"},decls:27,vars:25,consts:[[1,"p-2"],[1,"space-y-2","mb-4"],[1,"flex","justify-between","text-sm"],[1,"text-on-surface-variant"],[1,"font-medium"],[1,"flex","justify-between","text-lg","font-bold","pt-3","border-t","border-outline-variant"],[1,"primary-text"]],template:function(e,i){if(e&1&&(se(0,"div",0)(1,"div",1)(2,"div",2)(3,"span",3),l(4,"Delivery Fee"),ce(),se(5,"span",4),l(6),L(7,"currency"),ce()(),se(8,"div",2)(9,"span",3),l(10,"Discount"),ce(),se(11,"span",4),l(12),L(13,"currency"),ce()(),se(14,"div",2)(15,"span",3),l(16,"Subtotal"),ce(),se(17,"span",4),l(18),L(19,"currency"),ce()(),_(20,Wo,6,7,"div",2),se(21,"div",5)(22,"span"),l(23,"Total"),ce(),se(24,"span",6),l(25),L(26,"currency"),ce()()()()),e&2){let n;c(6),k(K(7,5,i.cartTotals().deliveryFee,i.currency(),"symbol","1.0-0")),c(6),k(K(13,10,i.cartTotals().discount,i.currency(),"symbol","1.0-0")),c(6),k(K(19,15,i.cartTotals().subtotal,i.currency(),"symbol","1.0-0")),c(2),C(((n=i.storeStore.selectedStore())==null?null:n.tax)>0?20:-1),c(5),k(K(26,20,i.cartTotals().totalCost,i.currency(),"symbol","1.0-0"))}},dependencies:[B,A,G,Se],styles:["[_nghost-%COMP%]{display:block}.primary-text[_ngcontent-%COMP%]{color:var(--mat-sys-primary)}.text-on-surface-variant[_ngcontent-%COMP%]{color:var(--mat-sys-on-surface-variant)}.border-outline-variant[_ngcontent-%COMP%]{border-color:var(--mat-sys-outline-variant)}"]})};var xo=(o,t)=>t._id;function Zo(o,t){o&1&&(r(0,"mat-icon",13),l(1,"search"),a(),l(2," Search Guest "))}function en(o,t){o&1&&(r(0,"mat-icon",13),l(1,"hotel"),a(),l(2," Select by Room "))}function tn(o,t){o&1&&(r(0,"mat-option",7)(1,"div",14),R(2,"mat-spinner",15),r(3,"span"),l(4,"Loading rooms..."),a()()())}function on(o,t){o&1&&(r(0,"mat-option",7),l(1,"No occupied rooms found"),a())}function nn(o,t){if(o&1&&(r(0,"span",19),l(1),a()),o&2){let e=d().$implicit,i=d(2);c(),w(" - ",i.getRoomGuestName(e)," ")}}function rn(o,t){if(o&1&&(r(0,"mat-option",16)(1,"div",14)(2,"mat-icon",17),l(3,"door_front"),a(),r(4,"span",18),l(5),a(),_(6,nn,2,1,"span",19),a()()),o&2){let e=t.$implicit;v("value",e),c(5),w("Room ",e.roomNumber),c(),C(e.currentGuest?6:-1)}}function an(o,t){if(o&1&&U(0,rn,7,3,"mat-option",16,xo),o&2){let e=d();z(e.occupiedRooms())}}function ln(o,t){o&1&&(r(0,"div",21)(1,"mat-icon",23),l(2,"person_off"),a(),r(3,"p",24),l(4,"No guest information available for this room"),a()())}function sn(o,t){if(o&1&&(r(0,"mat-radio-button",26)(1,"div",27)(2,"mat-icon",28),l(3,"person"),a(),r(4,"div")(5,"div",18),l(6),a(),r(7,"div",19),l(8),a()()()()),o&2){let e=t.$implicit,i=d(3);v("value",e),c(6),k(i.guestService.getGuestName(e)),c(2),w(" ",e.email||e.phone||"No contact info"," ")}}function cn(o,t){if(o&1){let e=S();r(0,"mat-radio-group",25),p("change",function(n){f(e);let s=d(2);return g(s.onRoomGuestSelected(n.value))}),U(1,sn,9,3,"mat-radio-button",26,xo),a()}if(o&2){let e=d(2);v("value",e.selectedGuest()),c(),z(e.availableRoomGuests())}}function dn(o,t){if(o&1&&(r(0,"div",8)(1,"h4",20),l(2),a(),_(3,ln,5,0,"div",21)(4,cn,3,1,"mat-radio-group",22),a()),o&2){let e,i=d();c(2),w(" Guests in Room ",(e=i.selectedRoom())==null?null:e.roomNumber," "),c(),C(i.availableRoomGuests().length===0?3:4)}}function mn(o,t){if(o&1){let e=S();r(0,"div",9)(1,"div",29)(2,"div",30)(3,"mat-icon",31),l(4,"check_circle"),a(),r(5,"div")(6,"div",32),l(7),a(),r(8,"div",33),l(9),a()()(),r(10,"button",34),p("click",function(){f(e);let n=d();return g(n.removeGuest())}),r(11,"mat-icon"),l(12,"close"),a()()()()}if(o&2){let e,i=d();c(7),k(i.guestService.getGuestName(i.selectedGuest())),c(2),w(" ",((e=i.selectedGuest())==null?null:e.email)||((e=i.selectedGuest())==null?null:e.phone)||"No contact info"," ")}}function un(o,t){if(o&1){let e=S();r(0,"button",35),p("click",function(){f(e);let n=d();return g(n.confirmSelection())}),l(1," Confirm "),a()}}var Dt=class o{dialogRef=m(te);dialogData=m(ie);guestService=m(Ct);roomsService=m(mo);storeStore=m(E);selectedGuest=P(this.dialogData?.selectedGuest||null);selectionMode=P("search");occupiedRooms=P([]);loadingRooms=P(!1);selectedRoom=P(null);roomGuests=P([]);availableRoomGuests=x(()=>{let t=this.selectedRoom();if(!t)return[];let e=[];if(t.currentReservation&&typeof t.currentReservation=="object"){let i=t.currentReservation;if(i.rooms&&Array.isArray(i.rooms)){let n=i.rooms.find(s=>(typeof s.room=="object"?s.room._id:s.room)===t._id);n?.assignedGuest&&typeof n.assignedGuest=="object"&&e.push(n.assignedGuest)}}return e.length===0&&t.currentGuest&&typeof t.currentGuest=="object"&&e.push(t.currentGuest),e});ngOnInit(){this.loadOccupiedRooms()}loadOccupiedRooms(){let t=this.storeStore.selectedStore()?._id;t&&(this.loadingRooms.set(!0),this.roomsService.getRooms(t,{status:["occupied"]}).subscribe({next:e=>{this.occupiedRooms.set(e),this.loadingRooms.set(!1)},error:()=>{this.loadingRooms.set(!1)}}))}onRoomSelected(t){this.selectedRoom.set(t),this.selectionMode()==="room"&&this.selectedGuest.set(null)}onRoomGuestSelected(t){this.selectedGuest.set(t)}onGuestSelected(t){this.selectedGuest.set(t)}removeGuest(){this.selectedGuest.set(null),this.dialogRef.close({guest:null,action:"remove"})}confirmSelection(){this.dialogRef.close({guest:this.selectedGuest(),action:"select"})}onTabChange(t){this.selectionMode.set(t===0?"search":"room"),this.selectedGuest.set(null),this.selectedRoom.set(null)}getRoomGuestName(t){return t.currentGuest?typeof t.currentGuest=="string"?t.currentGuest:this.guestService.getGuestName(t.currentGuest):""}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=V({type:o,selectors:[["app-guest-selection-dialog"]],decls:24,vars:4,consts:[["mat-dialog-title",""],[3,"selectedTabChange"],["mat-tab-label",""],[1,"pt-4"],["label","Search Guest","placeholder","Search by name, email or phone...",3,"guestSelected"],["appearance","outline",1,"w-full"],[3,"selectionChange"],["disabled",""],[1,"mt-4"],[1,"mt-4","p-3","bg-green-50","border","border-green-200","rounded-lg"],["align","end"],["mat-button","","mat-dialog-close",""],["matButton","filled","color","primary"],[1,"mr-2"],[1,"flex","items-center","gap-2"],["diameter","20"],[3,"value"],[1,"text-primary"],[1,"font-medium"],[1,"text-gray-500","text-sm"],[1,"text-sm","font-medium","text-gray-600","mb-2"],[1,"text-gray-500","text-sm","p-4","bg-gray-50","rounded-lg","text-center"],[1,"flex","flex-col","gap-2",3,"value"],[1,"text-gray-400"],[1,"mt-2"],[1,"flex","flex-col","gap-2",3,"change","value"],[1,"guest-radio-option",3,"value"],[1,"flex","items-center","gap-3","py-2"],[1,"text-gray-500"],[1,"flex","items-center","justify-between"],[1,"flex","items-center","gap-3"],[1,"text-green-600"],[1,"font-medium","text-green-800"],[1,"text-green-600","text-sm"],["mat-icon-button","","color","warn","matTooltip","Remove selection",3,"click"],["matButton","filled","color","primary",3,"click"]],template:function(e,i){e&1&&(r(0,"h2",0),l(1,"Select Hotel Guest"),a(),r(2,"mat-dialog-content")(3,"mat-tab-group",1),p("selectedTabChange",function(s){return i.onTabChange(s.index)}),r(4,"mat-tab"),ze(5,Zo,3,0,"ng-template",2),r(6,"div",3)(7,"app-guest-search",4),p("guestSelected",function(s){return i.onGuestSelected(s)}),a()()(),r(8,"mat-tab"),ze(9,en,3,0,"ng-template",2),r(10,"div",3)(11,"mat-form-field",5)(12,"mat-label"),l(13,"Select Occupied Room"),a(),r(14,"mat-select",6),p("selectionChange",function(s){return i.onRoomSelected(s.value)}),_(15,tn,5,0,"mat-option",7)(16,on,2,0,"mat-option",7)(17,an,2,0),a()(),_(18,dn,5,2,"div",8),a()()(),_(19,mn,13,2,"div",9),a(),r(20,"mat-dialog-actions",10)(21,"button",11),l(22,"Cancel"),a(),_(23,un,2,0,"button",12),a()),e&2&&(c(15),C(i.loadingRooms()?15:i.occupiedRooms().length===0?16:17),c(3),C(i.selectedRoom()?18:-1),c(),C(i.selectedGuest()?19:-1),c(4),C(i.selectedGuest()?23:-1))},dependencies:[B,ae,je,oe,re,ne,A,q,xe,G,$,Ne,Ge,wi,Mi,Di,Ti,Si,me,de,vi,ii,ee,fe,pe,so,ao,lo,Qe,Le,Z,co],styles:["mat-dialog-content[_ngcontent-%COMP%]{min-width:450px;max-width:550px;max-height:70vh}.guest-radio-option[_ngcontent-%COMP%]{display:block;padding:.5rem;border-radius:.5rem;border:1px solid #e5e7eb;transition:all .2s ease}.guest-radio-option[_ngcontent-%COMP%]:hover{background-color:#f9fafb;border-color:#d1d5db}.guest-radio-option.mat-mdc-radio-checked[_ngcontent-%COMP%]{background-color:#eff6ff;border-color:#3b82f6}  .mat-mdc-radio-button .mdc-radio{margin-right:.5rem}"]})};var pn=(o,t)=>t._id;function fn(o,t){o&1&&R(0,"mat-spinner",6)}function gn(o,t){o&1&&(r(0,"div",8),R(1,"mat-spinner",16),a())}function _n(o,t){if(o&1){let e=S();r(0,"div",9)(1,"mat-icon",17),l(2,"person_off"),a(),r(3,"p",18),l(4),a(),r(5,"button",19),p("click",function(){f(e);let n=d();return g(n.openCreateCustomerDialog())}),r(6,"mat-icon"),l(7,"add"),a(),l(8," Create New Customer "),a()()}if(o&2){let e=d();c(4),w('No customers found matching "',e.searchQuery(),'"')}}function Cn(o,t){o&1&&(r(0,"mat-icon",25),l(1,"check_circle"),a())}function hn(o,t){if(o&1){let e=S();r(0,"mat-list-item",21),p("click",function(){let n=f(e).$implicit,s=d(2);return g(s.onCustomerSelected(n))}),r(1,"mat-icon",22),l(2,"person"),a(),r(3,"div",23),l(4),a(),r(5,"div",24),l(6),a(),_(7,Cn,2,0,"mat-icon",25),a()}if(o&2){let e,i,n,s=t.$implicit,u=d(2);ve("bg-blue-50",((e=u.selectedCustomer())==null?null:e._id)===s._id)("border-blue-300",((i=u.selectedCustomer())==null?null:i._id)===s._id),c(4),k(s.name||"No Name"),c(2),w(" ",s.email||s.phoneNumber||"No contact info"," "),c(),C(((n=u.selectedCustomer())==null?null:n._id)===s._id?7:-1)}}function bn(o,t){if(o&1&&(r(0,"mat-list",10),U(1,hn,8,7,"mat-list-item",20,pn),a()),o&2){let e=d();c(),z(e.filteredCustomers())}}function vn(o,t){o&1&&(r(0,"div",11),l(1," Type at least 2 characters to search "),a())}function Sn(o,t){if(o&1){let e=S();r(0,"div",12)(1,"div",26)(2,"div",27)(3,"mat-icon",28),l(4,"check_circle"),a(),r(5,"div")(6,"div",29),l(7),a(),r(8,"div",30),l(9),a()()(),r(10,"button",31),p("click",function(){f(e);let n=d();return g(n.removeCustomer())}),r(11,"mat-icon"),l(12,"close"),a()()()()}if(o&2){let e=d();c(7),k(e.getCustomerDisplayName(e.selectedCustomer())),c(2),w(" ",e.getCustomerContact(e.selectedCustomer())," ")}}function yn(o,t){if(o&1){let e=S();r(0,"button",32),p("click",function(){f(e);let n=d();return g(n.confirmSelection())}),l(1," Confirm "),a()}}var wt=class o{dialogRef=m(te);dialogData=m(ie);customerService=m(to);storeStore=m(E);dialog=m($e);selectedCustomer=P(this.dialogData?.selectedCustomer||null);searchQuery=P("");customers=P([]);filteredCustomers=P([]);loading=P(!1);searchPerformed=P(!1);searchSubject=new Ye;constructor(){this.searchSubject.pipe(Nt(300),j(t=>{if(!t||t.length<2)return this.filteredCustomers.set([]),this.searchPerformed.set(!1),Ke([]);this.loading.set(!0),this.searchPerformed.set(!0);let e=this.customers();if(e.length>0){let i=e.filter(n=>n.name?.toLowerCase().includes(t.toLowerCase())||n.email?.toLowerCase().includes(t.toLowerCase())||n.phoneNumber?.includes(t));return this.filteredCustomers.set(i),this.loading.set(!1),Ke(i)}return Ke([])}),yi()).subscribe()}ngOnInit(){this.loadCustomers()}loadCustomers(){let t=this.storeStore.selectedStore()?._id;t&&(this.loading.set(!0),this.customerService.getStoreCustomers(t).subscribe({next:e=>{this.customers.set(e),this.loading.set(!1)},error:()=>{this.loading.set(!1)}}))}onSearch(t){this.searchQuery.set(t),this.searchSubject.next(t)}onCustomerSelected(t){this.selectedCustomer.set(t)}removeCustomer(){this.selectedCustomer.set(null),this.dialogRef.close({customer:null,action:"remove"})}confirmSelection(){this.dialogRef.close({customer:this.selectedCustomer(),action:"select"})}openCreateCustomerDialog(){this.dialog.open(io,{width:"500px",data:{isEdit:!1}}).afterClosed().subscribe(e=>{e&&this.loadCustomers()})}getCustomerDisplayName(t){return t?t.name||t.email||"Unknown Customer":""}getCustomerContact(t){return t?t.email||t.phoneNumber||"No contact info":""}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=V({type:o,selectors:[["app-customer-selection-dialog"]],decls:25,vars:5,consts:[["mat-dialog-title","",1,"flex","items-center","justify-between"],["mat-stroked-button","","color","primary",3,"click"],[1,"min-w-[450px]"],["appearance","outline",1,"w-full"],["matPrefix","",1,"mr-2"],["matInput","","placeholder","Search by name, email or phone...","autocomplete","off",3,"input","value"],["matSuffix","","diameter","20"],[1,"customer-results","mt-2"],[1,"flex","items-center","justify-center","p-8"],[1,"text-center","p-6","bg-gray-50","rounded-lg"],[1,"customer-list"],[1,"text-center","p-4","text-gray-500","text-sm"],[1,"mt-4","p-3","bg-green-50","border","border-green-200","rounded-lg"],["align","end"],["mat-button","","mat-dialog-close",""],["mat-flat-button","","color","primary"],["diameter","40"],[1,"text-gray-400","text-4xl"],[1,"text-gray-500","mt-2"],["mat-stroked-button","","color","primary",1,"mt-3",3,"click"],[1,"customer-item","cursor-pointer","hover:bg-gray-50","rounded-lg","mb-1",3,"bg-blue-50","border-blue-300"],[1,"customer-item","cursor-pointer","hover:bg-gray-50","rounded-lg","mb-1",3,"click"],["matListItemIcon","",1,"text-gray-500"],["matListItemTitle","",1,"font-medium"],["matListItemLine","",1,"text-gray-500","text-sm"],["matListItemMeta","",1,"text-blue-500"],[1,"flex","items-center","justify-between"],[1,"flex","items-center","gap-3"],[1,"text-green-600"],[1,"font-medium","text-green-800"],[1,"text-green-600","text-sm"],["mat-icon-button","","color","warn","matTooltip","Remove selection",3,"click"],["mat-flat-button","","color","primary",3,"click"]],template:function(e,i){e&1&&(r(0,"h2",0)(1,"span"),l(2,"Select Customer"),a(),r(3,"button",1),p("click",function(){return i.openCreateCustomerDialog()}),r(4,"mat-icon"),l(5,"add"),a(),l(6," New Customer "),a()(),r(7,"mat-dialog-content",2)(8,"mat-form-field",3)(9,"mat-label"),l(10,"Search Customer"),a(),r(11,"mat-icon",4),l(12,"search"),a(),r(13,"input",5),p("input",function(s){return i.onSearch(s.target.value)}),a(),_(14,fn,1,0,"mat-spinner",6),a(),r(15,"div",7),_(16,gn,2,0,"div",8)(17,_n,9,1,"div",9)(18,bn,3,0,"mat-list",10)(19,vn,2,0,"div",11),a(),_(20,Sn,13,2,"div",12),a(),r(21,"mat-dialog-actions",13)(22,"button",14),l(23,"Cancel"),a(),_(24,yn,2,0,"button",15),a()),e&2&&(c(13),v("value",i.searchQuery()),c(),C(i.loading()?14:-1),c(2),C(i.loading()&&i.customers().length===0?16:i.searchPerformed()&&i.filteredCustomers().length===0&&i.searchQuery().length>=2?17:i.filteredCustomers().length>0?18:i.searchQuery().length<2&&i.customers().length>0?19:-1),c(4),C(i.selectedCustomer()?20:-1),c(4),C(i.selectedCustomer()?24:-1))},dependencies:[B,ae,je,oe,re,ne,A,q,xe,G,$,Ne,Ii,Vi,Ri,Ei,Pi,Oi,Ge,ee,me,de,Me,bi,ue,De,fe,pe,Qe,Le,Z],styles:["mat-dialog-content[_ngcontent-%COMP%]{min-width:450px;max-width:550px;max-height:70vh}.customer-list[_ngcontent-%COMP%]{max-height:300px;overflow-y:auto}.customer-item[_ngcontent-%COMP%]{border:1px solid transparent;transition:all .2s ease}.customer-item[_ngcontent-%COMP%]:hover{background-color:#f9fafb;border-color:#e5e7eb}.customer-item.bg-blue-50[_ngcontent-%COMP%]{border-color:#93c5fd}"]})};var Dn=o=>({prefix:o});function Tn(o,t){if(o&1&&R(0,"input",8),o&2){let e,i=d();v("options",tt(2,Dn,((e=i.storeStore.selectedStore())==null?null:e.currency)+" "))("placeholder",i.valueLabel)}}function wn(o,t){if(o&1&&R(0,"input",9),o&2){let e=d();v("placeholder",e.valueLabel)}}function kn(o,t){o&1&&(r(0,"mat-error"),l(1,"Value is required"),a())}function Pn(o,t){o&1&&(r(0,"mat-error"),l(1,"Value must be a positive number"),a())}function En(o,t){if(o&1){let e=S();r(0,"button",15),p("click",function(){f(e);let n=d();return g(n.onRemoveDiscount())}),l(1," Remove Discount "),a()}}var kt=class o{dialogRef=m(te);data=m(ie);fb=m(dt);storeStore=m(E);discountForm=this.fb.group({discountType:[this.data?.discount?.discountType||"Amount",Oe.required],value:[this.data?.discount?.value||"",[Oe.required,Oe.min(0)]],reference:[this.data?.discount?.reference||""]});get f(){return this.discountForm.controls}get valueLabel(){return this.f.discountType.value==="Amount"?"Enter Amount":"Enter Percentage"}get valueIcon(){return this.f.discountType.value==="Amount"?"attach_money":"percent"}onCancel(){this.dialogRef.close()}onApply(){this.discountForm.valid&&this.dialogRef.close(this.discountForm.getRawValue())}onRemoveDiscount(){this.dialogRef.close({discountType:"",value:0,reference:""})}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=V({type:o,selectors:[["app-add-discount"]],decls:35,vars:8,consts:[["mat-dialog-title",""],[3,"formGroup"],[1,"toggle-section"],["formControlName","discountType","aria-label","Discount Type"],["value","Amount"],["value","Percentage"],["appearance","outline",1,"full-width"],["matPrefix",""],["matInput","","currencyMask","","formControlName","value",3,"options","placeholder"],["matInput","","type","number","formControlName","value",3,"placeholder"],["matInput","","type","text","formControlName","reference","placeholder","Enter reference or reason"],["align","end"],["mat-button","","color","warn"],["mat-button","",3,"click"],["mat-flat-button","","color","primary",3,"click","disabled"],["mat-button","","color","warn",3,"click"]],template:function(e,i){e&1&&(r(0,"h2",0),l(1,"Apply Discount"),a(),r(2,"mat-dialog-content")(3,"form",1)(4,"div",2)(5,"mat-button-toggle-group",3)(6,"mat-button-toggle",4)(7,"mat-icon"),l(8,"attach_money"),a(),l(9," Amount "),a(),r(10,"mat-button-toggle",5)(11,"mat-icon"),l(12,"percent"),a(),l(13," Percentage "),a()()(),r(14,"mat-form-field",6)(15,"mat-label"),l(16),a(),r(17,"mat-icon",7),l(18),a(),_(19,Tn,1,4,"input",8)(20,wn,1,1,"input",9),_(21,kn,2,0,"mat-error"),_(22,Pn,2,0,"mat-error"),a(),r(23,"mat-form-field",6)(24,"mat-label"),l(25,"Reference (Optional)"),a(),r(26,"mat-icon",7),l(27,"note"),a(),R(28,"input",10),a()()(),r(29,"mat-dialog-actions",11),_(30,En,2,0,"button",12),r(31,"button",13),p("click",function(){return i.onCancel()}),l(32,"Cancel"),a(),r(33,"button",14),p("click",function(){return i.onApply()}),l(34," Apply "),a()()),e&2&&(c(3),v("formGroup",i.discountForm),c(13),k(i.valueLabel),c(2),k(i.valueIcon),c(),C(i.f.discountType.value==="Amount"?19:20),c(2),C(i.f.value.hasError("required")&&i.f.value.touched?21:-1),c(),C(i.f.value.hasError("min")?22:-1),c(8),C(i.data.discount!=null&&i.data.discount.value?30:-1),c(3),v("disabled",i.discountForm.invalid))},dependencies:[B,Z,lt,nt,hi,rt,at,Ae,ct,st,ae,oe,re,ne,A,q,Li,Gi,Ni,ee,me,de,mt,Me,ue,De,G,$,gt,ft],styles:[".toggle-section[_ngcontent-%COMP%]{margin-bottom:24px}.toggle-section[_ngcontent-%COMP%]   mat-button-toggle-group[_ngcontent-%COMP%]{width:100%}.toggle-section[_ngcontent-%COMP%]   mat-button-toggle-group[_ngcontent-%COMP%]   mat-button-toggle[_ngcontent-%COMP%]{flex:1}.toggle-section[_ngcontent-%COMP%]   mat-button-toggle-group[_ngcontent-%COMP%]   mat-button-toggle[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{margin-right:8px}.full-width[_ngcontent-%COMP%]{width:100%;margin-bottom:16px}"],changeDetection:0})};var On=o=>({prefix:o});function Rn(o,t){o&1&&(r(0,"mat-error"),l(1,"Delivery fee is required"),a())}function In(o,t){o&1&&(r(0,"mat-error"),l(1,"Delivery fee must be a positive number"),a())}function Vn(o,t){if(o&1){let e=S();r(0,"button",9),p("click",function(){f(e);let n=d();return g(n.onRemoveDelivery())}),l(1," Remove Delivery "),a()}}var Pt=class o{dialogRef=m(te);data=m(ie);fb=m(dt);storeStore=m(E);deliveryForm=this.fb.group({deliveryFee:[this.data?.deliveryFee||"",[Oe.required,Oe.min(0)]]});get f(){return this.deliveryForm.controls}onCancel(){this.dialogRef.close()}onApply(){this.deliveryForm.valid&&this.dialogRef.close(this.deliveryForm.getRawValue())}onRemoveDelivery(){this.dialogRef.close({deliveryFee:0,address:""})}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=V({type:o,selectors:[["app-add-delivery"]],decls:18,vars:8,consts:[["mat-dialog-title",""],[3,"formGroup"],["appearance","outline",1,"full-width"],["matPrefix",""],["matInput","","currencyMask","","formControlName","deliveryFee","placeholder","Enter delivery fee",3,"options"],["align","end"],["mat-button","","color","warn"],["mat-button","",3,"click"],["mat-flat-button","","color","primary",3,"click","disabled"],["mat-button","","color","warn",3,"click"]],template:function(e,i){if(e&1&&(r(0,"h2",0),l(1,"Add Delivery Fee"),a(),r(2,"mat-dialog-content")(3,"form",1)(4,"mat-form-field",2)(5,"mat-label"),l(6,"Delivery Fee"),a(),r(7,"mat-icon",3),l(8,"local_shipping"),a(),R(9,"input",4),_(10,Rn,2,0,"mat-error"),_(11,In,2,0,"mat-error"),a()()(),r(12,"mat-dialog-actions",5),_(13,Vn,2,0,"button",6),r(14,"button",7),p("click",function(){return i.onCancel()}),l(15,"Cancel"),a(),r(16,"button",8),p("click",function(){return i.onApply()}),l(17," Apply "),a()()),e&2){let n;c(3),v("formGroup",i.deliveryForm),c(6),v("options",tt(6,On,((n=i.storeStore.selectedStore())==null?null:n.currency)+" ")),c(),C(i.f.deliveryFee.hasError("required")&&i.f.deliveryFee.touched?10:-1),c(),C(i.f.deliveryFee.hasError("min")?11:-1),c(2),C(i.data.deliveryFee?13:-1),c(3),v("disabled",i.deliveryForm.invalid)}},dependencies:[B,Z,lt,nt,rt,at,Ae,ct,st,ae,oe,re,ne,A,q,ee,me,de,mt,Me,ue,De,G,$,gt,ft],styles:[".full-width[_ngcontent-%COMP%]{width:100%;margin-bottom:16px}"],changeDetection:0})};function Fn(o,t){o&1&&(r(0,"div",4),R(1,"mat-spinner"),a())}function Bn(o,t){o&1&&R(0,"app-no-record",5)}function An(o,t){if(o&1){let e=S();r(0,"div")(1,"app-table-card",12),p("tableClick",function(n){f(e);let s=d(2);return g(s.onTableSelect(n))}),a()()}if(o&2){let e=t.$implicit;ve("opacity-50",e.orderId)("pointer-events-none",e.orderId),c(),v("table",e)("hideActions",!0)}}function Gn(o,t){o&1&&R(0,"app-no-record",11)}function Nn(o,t){if(o&1&&(r(0,"div",9),U(1,An,2,6,"div",10,Pe),a(),_(3,Gn,1,0,"app-no-record",11)),o&2){let e=d();c(),z(e.filteredTables),c(2),C(e.filteredTables.length===0?3:-1)}}function Ln(o,t){if(o&1){let e=S();r(0,"button",13),p("click",function(){f(e);let n=d();return g(n.onRemoveSelection())}),l(1," Remove Selection "),a()}}var Et=class o{dialogRef=m(te);data=m(ie);tableService=m(eo);storeStore=m(E);searchQuery=P("");selectedTable=P(this.data?.selectedTable||null);tablesResource=xi({params:()=>({storeId:this.storeStore.selectedStore()._id}),stream:({params:t})=>this.tableService.getStoreTables(t.storeId)});onSearchChange(t){this.searchQuery.set(t)}get filteredTables(){let t=this.tablesResource.value()||[],e=this.searchQuery().toLowerCase();return(e?t.filter(n=>n.name.toLowerCase().includes(e)):t).sort((n,s)=>{let u=!!n.orderId,T=!!s.orderId;return u===T?0:u?1:-1})}onTableSelect(t){if(t.orderId)return;let e={action:"select",table:t};this.dialogRef.close(e)}onRemoveSelection(){let t={action:"remove"};this.dialogRef.close(t)}onCancel(){this.dialogRef.close()}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=V({type:o,selectors:[["app-table-selection-dialog"]],decls:16,vars:5,consts:[["mat-dialog-title",""],["appearance","outline",1,"w-full","mb-4"],["matInput","","placeholder","Search by table name...",3,"input","value"],["matPrefix",""],[1,"flex","items-center","justify-center","py-12"],["icon","error_outline","title","Failed to Load Tables","message","Unable to load tables. Please try again."],["align","end"],["mat-button","","color","warn"],["mat-button","",3,"click"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4","max-h-[60vh]","overflow-y-auto"],[3,"opacity-50","pointer-events-none"],["icon","table_restaurant","title","No Tables Found","message","No tables match your search criteria."],[3,"tableClick","table","hideActions"],["mat-button","","color","warn",3,"click"]],template:function(e,i){e&1&&(r(0,"h2",0),l(1,"Select Table"),a(),r(2,"mat-dialog-content")(3,"mat-form-field",1)(4,"mat-label"),l(5,"Search tables"),a(),r(6,"input",2),p("input",function(s){return i.onSearchChange(s.target.value)}),a(),r(7,"mat-icon",3),l(8,"search"),a()(),_(9,Fn,2,0,"div",4),_(10,Bn,1,0,"app-no-record",5),_(11,Nn,4,1),a(),r(12,"mat-dialog-actions",6),_(13,Ln,2,0,"button",7),r(14,"button",8),p("click",function(){return i.onCancel()}),l(15,"Cancel"),a()()),e&2&&(c(6),v("value",i.searchQuery()),c(3),C(i.tablesResource.isLoading()?9:-1),c(),C(i.tablesResource.error()?10:-1),c(),C(i.tablesResource.value()&&!i.tablesResource.isLoading()?11:-1),c(2),C(i.selectedTable()?13:-1))},dependencies:[B,ae,oe,re,ne,A,q,G,$,ee,me,de,Me,ue,De,fe,pe,Z,uo,Qi],styles:["[_nghost-%COMP%]{display:block}"]})};function Qn(o,t){if(o&1){let e=S();R(0,"mat-divider"),r(1,"button",6),p("click",function(){f(e);let n=d();return g(n.clearBuyerSelection())}),r(2,"mat-icon"),l(3,"close"),a(),r(4,"span"),l(5,"Clear Selection"),a()()}}function $n(o,t){if(o&1){let e=S();r(0,"button",22),p("click",function(){f(e);let n=d();return g(n.onSelectTable())}),r(1,"mat-icon"),l(2,"table_restaurant"),a(),r(3,"span",23),l(4),a()()}if(o&2){let e,i,n=d();v("matTooltip",(e=n.tableStore.selectedTable())==null?null:e.name),c(4),k((i=n.tableStore.selectedTable())==null?null:i.name)}}function jn(o,t){if(o&1){let e=S();r(0,"button",24),p("click",function(){f(e);let n=d();return g(n.onSelectTable())}),r(1,"mat-icon"),l(2,"table_restaurant"),a(),r(3,"span",5),l(4,"Table"),a()()}}function qn(o,t){if(o&1){let e=S();r(0,"button",25),p("click",function(){f(e);let n=d();return g(n.closeCart())}),r(1,"mat-icon"),l(2,"close"),a()()}}function Un(o,t){if(o&1){let e=S();r(0,"div",11)(1,"button",26),p("click",function(){f(e);let n=d();return g(n.cancelSales())}),r(2,"mat-icon"),l(3,"delete_outline"),a(),r(4,"span"),l(5,"Clear Cart"),a()()()}}function zn(o,t){if(o&1&&R(0,"img",29),o&2){let e=d().$implicit;v("src",e.photos[0],et)("alt",e.name)}}function Hn(o,t){o&1&&(r(0,"div",30)(1,"mat-icon",43),l(2,"image"),a()())}function Xn(o,t){if(o&1&&(r(0,"p",34),l(1),a()),o&2){let e=d().$implicit,i=d();c(),w(" ",i.getOptionsDisplay(e).join(", ")," ")}}function Jn(o,t){if(o&1){let e=S();r(0,"mat-card",13)(1,"div",27)(2,"div",28),_(3,zn,1,2,"img",29)(4,Hn,3,0,"div",30),a(),r(5,"div",31)(6,"h4",32),l(7),a(),r(8,"p",33),l(9),L(10,"currency"),a(),_(11,Xn,2,1,"p",34),r(12,"div",35)(13,"div",36)(14,"button",37),p("click",function(){let n=f(e).$implicit,s=d();return g(s.removeOrDeleteProduct(n))}),r(15,"mat-icon"),l(16,"remove"),a()(),r(17,"span",38),l(18),a(),r(19,"button",39),p("click",function(n){let s=f(e).$implicit,u=d();return g(u.onAddToCart(n,s))}),r(20,"mat-icon"),l(21,"add"),a()()(),r(22,"span",40),l(23),L(24,"currency"),a()()(),r(25,"button",41),p("click",function(){let n=f(e).$implicit,s=d();return g(s.onRemoveItem(n._id))}),r(26,"mat-icon",42),l(27,"close"),a()()()()}if(o&2){let e=t.$implicit,i=d();c(3),C(e.photos&&e.photos.length>0?3:4),c(4),k(e.name),c(2),w(" ",K(10,6,e.price,i.currency(),"symbol","1.0-0")," "),c(2),C(i.getOptionsDisplay(e).length>0?11:-1),c(7),k(e.quantity),c(5),w(" ",K(24,11,i.getProductTotal(e),i.currency(),"symbol","1.0-0")," ")}}function Yn(o,t){o&1&&(r(0,"div",14)(1,"mat-icon",44),l(2,"shopping_cart"),a(),r(3,"p",45),l(4,"Cart is empty"),a(),r(5,"p",46),l(6,"Add products to start an order"),a()())}function Kn(o,t){if(o&1){let e=S();r(0,"div",16)(1,"app-checkout-summary",47),p("cartSummary",function(n){f(e);let s=d();return g(s.cartSummaryChange(n))}),a()()}}var Je=class o{storeStore=m(E);accountService=m(di);cartStore=m(Te);cartService=m(_t);tableStore=m(fo);guestService=m(Ct);saleTypeStore=m(go);dialog=m($e);breakpointObserver=m(ye);bottomSheetRef=m(qe,{optional:!0});snackBar=m(ci);orderStore=m(_o);selectedUser=this.accountService.currentUserValue;cartSummary=P(null);selectedGuest=P(null);selectedCustomer=P(null);selectedBuyerName=x(()=>{let t=this.selectedGuest(),e=this.selectedCustomer();return t?this.guestService.getGuestName(t):e?e.name||e.email||"Customer":"Buyer"});hasSelectedBuyer=x(()=>!!this.selectedGuest()||!!this.selectedCustomer());buyerType=x(()=>this.selectedGuest()?"guest":this.selectedCustomer()?"customer":null);items=W([]);taxRate=W(0);increment=X();decrement=X();removeItem=X();clearCart=X();addToCart=X();currency=x(()=>this.storeStore.selectedStore()?.currency||"\u20A6");itemsCount=x(()=>this.cartStore.selectedCart()?.products.reduce((t,e)=>t+e.quantity,0));isMobile=ut(this.breakpointObserver.observe([Q.XSmall,Q.Small]).pipe(We(t=>t.matches)),{initialValue:!1});cartItemTap(t){(t?.options).length>0?this.openOptions(t):this.cartStore.updateCartAction("add")}openOptions(t){}isEmpty=x(()=>(console.log("Cart products length:",this.cartStore.selectedCart()),!this.cartStore.selectedCart()||this.cartStore.selectedCart()?.products.length===0));onAddToCart(t,e){t.stopPropagation(),this.bottomSheetRef&&this.cartStore.incrementProductQuantity(e._id),this.addToCart.emit(e)}getProductTotal(t){let e=t.price*t.quantity;if(t.options&&t.options.length>0){let i=this.cartService.getTotalForSelectedOptions(t.options);return e+i*t.quantity}return e}removeOrDeleteProduct(t){t.quantity>1?this.cartStore.decrementProductQuantity(t._id):this.deleteProductFromCart(t._id)}deleteProductFromCart(t){this.cartStore.updateCartAction("delete"),this.cartStore.removeFromCart(this.cartStore.selectedCart()._id,t)}getOptionsDisplay(t){if(!t.options||t.options.length===0)return[];let e=[];return t.options.forEach(i=>{i.options&&i.options.forEach(n=>{n.selected&&e.push(`${n.name}${n.quantity>1?" x"+n.quantity:""}`)})}),e}onIncrement(t){this.increment.emit(t)}onDecrement(t){this.decrement.emit(t)}onRemoveItem(t){this.deleteProductFromCart(t),this.removeItem.emit(t)}resetSalesSection(){this.cartStore.removeSelectedCart(),this.saleTypeStore.setDefaultSaleType(),this.tableStore.clearSelectedTable(),this.selectedCustomer.set(null),this.selectedGuest.set(null),this.clearCart.emit()}cancelSales(){this.dialog.open(zi,{width:"400px",data:{title:"Cancel Sale",message:"Are you sure you want to cancel this sale? This action cannot be undone."}}).afterClosed().subscribe(e=>{e&&(this.snackBar.open("Sale cancelled","Close",{duration:3e3,horizontalPosition:"center",verticalPosition:"bottom"}),this.resetSalesSection())})}ngOnDestroy(){!this.breakpointObserver.isMatched([Q.XSmall,Q.Small])&&!this.bottomSheetRef&&this.resetSalesSection()}closeCart(){this.bottomSheetRef&&this.bottomSheetRef.dismiss()}onSelectCustomer(){this.openCustomerSelectionDialog()}onSelectTable(){let t={selectedTable:this.tableStore.selectedTable()};this.dialog.open(Et,{data:t}).afterClosed().subscribe(i=>{i&&(i.action==="select"&&i.table?(this.tableStore.selectTable(i.table._id),this.snackBar.open(`Table "${i.table.name}" selected`,"Close",{duration:3e3,horizontalPosition:"center",verticalPosition:"bottom"})):i.action==="remove"&&(this.tableStore.clearSelectedTable(),this.snackBar.open("Table selection removed","Close",{duration:3e3,horizontalPosition:"center",verticalPosition:"bottom"})))})}onSelectOrderType(){console.log("Select order type")}onSelectGuest(){this.openGuestSelectionDialog()}openCustomerSelectionDialog(){let t={selectedCustomer:this.selectedCustomer()};this.dialog.open(wt,{width:"500px",maxHeight:"80vh",data:t}).afterClosed().subscribe(i=>{if(i){if(i.action==="select"&&i.customer){this.selectedGuest.set(null),this.selectedCustomer.set(i.customer);let n=this.cartStore.selectedCart();n&&this.cartStore.updateCartUser(n._id,i.customer._id),this.snackBar.open(`Customer "${i.customer.name||i.customer.email}" selected`,"Close",{duration:3e3,horizontalPosition:"center",verticalPosition:"bottom"})}else if(i.action==="remove"){this.selectedCustomer.set(null);let n=this.cartStore.selectedCart();n&&this.cartStore.updateCartUser(n._id,""),this.snackBar.open("Customer removed","Close",{duration:3e3,horizontalPosition:"center",verticalPosition:"bottom"})}}})}openGuestSelectionDialog(){let t={selectedGuest:this.selectedGuest()};this.dialog.open(Dt,{width:"500px",maxHeight:"80vh",data:t}).afterClosed().subscribe(i=>{i&&(i.action==="select"&&i.guest?(this.selectedCustomer.set(null),this.selectedGuest.set(i.guest),this.snackBar.open(`Guest "${this.guestService.getGuestName(i.guest)}" selected`,"Close",{duration:3e3,horizontalPosition:"center",verticalPosition:"bottom"})):i.action==="remove"&&(this.selectedGuest.set(null),this.snackBar.open("Guest removed","Close",{duration:3e3,horizontalPosition:"center",verticalPosition:"bottom"})))})}onSelectBuyer(){this.selectedGuest()?this.openGuestSelectionDialog():this.selectedCustomer()&&this.openCustomerSelectionDialog()}clearBuyerSelection(){this.selectedGuest.set(null),this.selectedCustomer.set(null)}onApplyDiscount(){this.dialog.open(kt,{width:"450px",data:{discount:this.cartStore.selectedCart()?.discount}}).afterClosed().subscribe(e=>{if(e){let i=this.cartStore.selectedCart();i&&(this.cartStore.updateCartDiscount(i._id,e),e.value>0?this.snackBar.open(`Discount applied: ${e.discountType} - ${e.value}`,"Close",{duration:3e3,horizontalPosition:"center",verticalPosition:"bottom"}):this.snackBar.open("Discount removed","Close",{duration:3e3,horizontalPosition:"center",verticalPosition:"bottom"}))}})}onApplyDelivery(){this.dialog.open(Pt,{width:"450px",data:{deliveryFee:this.cartStore.selectedCart()?.delivery,address:""}}).afterClosed().subscribe(e=>{if(e){let i=this.cartStore.selectedCart();i&&(this.cartStore.updateCartDelivery(i._id,e.deliveryFee),e.deliveryFee>0?this.snackBar.open(`Delivery fee applied: ${e.deliveryFee}`,"Close",{duration:3e3,horizontalPosition:"center",verticalPosition:"bottom"}):this.snackBar.open("Delivery fee removed","Close",{duration:3e3,horizontalPosition:"center",verticalPosition:"bottom"}))}})}onGenerateBill(){console.log("Generate bill")}onPendOrder(){this.cartStore.selectedCart()&&(this.cartStore.addSelectedCartToPending(),this.cartStore.removeSelectedCart(),this.snackBar.open("Order pending","Close",{duration:3e3,horizontalPosition:"center",verticalPosition:"bottom"}))}cartSummaryChange(t){this.cartSummary.set(t)}onCheckout(){let t={totalAmount:this.cartSummary()?.totalCost||0,currency:this.currency()};this.dialog.open(po,{width:"450px",data:t}).afterClosed().subscribe(i=>{i&&(i.action==="confirm"&&i.paymentMethod&&this.cartStore.selectedCart()&&this.cartStore.updateSelectedCartPaymentMethod(i.paymentMethod),this.processCheckout())})}processCheckout(){this.saleTypeStore.setSelectedSaleType(this.tableStore.selectedTable()?"table":"quick",this.saleTypeStore.isEditing());let t=this.cartStore.selectedCart(),e=this.tableStore.selectedTable(),i=this.saleTypeStore.selectedSale(),n=this.storeStore.selectedStore();if(!t){this.snackBar.open("No cart selected","Close",{duration:3e3,horizontalPosition:"center",verticalPosition:"bottom"});return}if(!n){this.snackBar.open("No store selected","Close",{duration:3e3,horizontalPosition:"center",verticalPosition:"bottom"});return}if(console.log("Selected sale type:",i.id),!i){this.snackBar.open("Please select a sale type","Close",{duration:3e3,horizontalPosition:"center",verticalPosition:"bottom"});return}this.cartStore.updateCartSummary(this.cartSummary());let s=this.saleTypeStore.isEditing();if(console.log(s,"is editing sale type - before processing"),s){let T=this.orderStore.selectedOrder();if(!T){this.snackBar.open("No order selected for editing","Close",{duration:3e3,horizontalPosition:"center",verticalPosition:"bottom"});return}let le={cart:F(D({},t),{cartSummary:this.cartSummary()??void 0}),storeId:n._id,user:this.selectedCustomer()??void 0,table:e??void 0,salesType:i,type:i.id,payment:t?.paymentMethod?.name,total:this.cartSummary().totalCost,subTotal:this.cartSummary().subtotal,discount:this.cartSummary().discount,tax:this.cartSummary().tax,shippingFee:this.cartSummary().deliveryFee,paymentStatus:t?.paymentMethod?.name?"Paid":"Unpaid",note:t?.note,vendorCommissionAmount:0,orderInstruction:t?.note,staff:this.selectedUser?._id,category:t.paymentMethod?.name?"Complete":"Processing",settled:!!t.paymentMethod?.name};console.log("Updating order with payload:",le),this.orderStore.updateOrder$({orderId:T._id,updates:le}),this.saleTypeStore.stopEditing(),this.snackBar.open("Order updated successfully","Close",{duration:2e3})}else this.orderStore.syncOrder$({_id:oo(),cart:t,store:n,user:this.selectedCustomer()??void 0,table:e??void 0,guest:this.selectedGuest()??void 0,salesType:i,type:i.id,payment:t.paymentMethod?.name,salesChannel:"Point of Sale",total:this.cartSummary().totalCost,subTotal:this.cartSummary().subtotal,discount:this.cartSummary().discount,tax:this.cartSummary().tax,shippingFee:this.cartSummary().deliveryFee,paymentStatus:t.paymentMethod?.name?"Paid":"Unpaid",note:t.note,orderInstruction:t.note,createdAt:new Date,synced:!0,category:t.paymentMethod?.name?"Complete":"Processing",settled:!!t.paymentMethod?.name,reference:no(),staff:this.selectedUser?._id,storeId:n._id}),this.snackBar.open("Order Created","Print",{duration:2e3});let u=this.orderStore.selectedOrder();u&&e&&i.id==="table"&&(this.tableStore.updateTableOrder(e._id,u),this.tableStore.updateTableOrderSync(e._id,{orderId:u._id})),u&&this.orderStore.selectOrder(u),this.resetSalesSection(),this.bottomSheetRef&&this.bottomSheetRef.dismiss()}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=V({type:o,selectors:[["app-cart"]],inputs:{items:[1,"items"],taxRate:[1,"taxRate"]},outputs:{increment:"increment",decrement:"decrement",removeItem:"removeItem",clearCart:"clearCart",addToCart:"addToCart"},decls:47,vars:15,consts:[["buyerMenu","matMenu"],[1,"h-full","flex","flex-col"],[1,"border-b","border-outline-variant"],[1,"flex","items-center","gap-2","p-2"],["matButton","outlined",1,"!flex-1",3,"matMenuTriggerFor"],[1,"text-xs"],["mat-menu-item","",3,"click"],["matButton","outlined",1,"!flex-1",3,"matTooltip"],["matButton","outlined"],["matIconButton","","title","Close cart"],[1,"flex-1","overflow-auto","p-2"],[1,"mb-3","flex","justify-end"],[1,"space-y-3"],["appearance","outlined",1,"p-3"],[1,"flex","flex-col","items-center","justify-center","h-full","min-h-[300px]","text-gray-400"],[1,"border-t","border-outline-variant"],[1,"border-b","border-gray-100","p-2"],[1,"flex","items-center","gap-2","p-2","border-b","border-gray-100"],["matButton","outlined",1,"!flex-1",3,"click"],[1,"ml-1"],[1,"p-3"],["matButton","filled","color","primary",1,"w-full","!h-12","!text-base",3,"click"],["matButton","outlined",1,"!flex-1",3,"click","matTooltip"],[1,"text-xs","truncate","max-w-[60px]"],["matButton","outlined",3,"click"],["matIconButton","","title","Close cart",3,"click"],["mat-button","","color","warn",3,"click"],[1,"flex","gap-3"],[1,"w-16","h-16","rounded-lg","overflow-hidden","bg-gray-100","flex-shrink-0"],[1,"w-full","h-full","object-cover",3,"src","alt"],[1,"w-full","h-full","flex","items-center","justify-center"],[1,"flex-1","min-w-0"],[1,"font-medium","text-sm","truncate"],[1,"primary-text","font-semibold","text-sm","mt-0.5"],[1,"text-xs","text-gray-500","mt-1","truncate"],[1,"flex","items-center","justify-between","mt-2"],[1,"flex","items-center","gap-2"],["mat-mini-fab","","color","warn",3,"click"],[1,"w-8","text-center","font-semibold","text-lg"],["mat-mini-fab","","color","primary",3,"click"],[1,"font-semibold"],["mat-icon-button","","color","warn",1,"!w-8","!h-8","self-start",3,"click"],[1,"!text-lg"],[1,"text-gray-300"],[1,"!text-6xl","!w-16","!h-16","mb-4"],[1,"text-lg","font-medium"],[1,"text-sm"],[3,"cartSummary"]],template:function(e,i){if(e&1){let n=S();r(0,"div",1)(1,"div",2)(2,"div",3)(3,"button",4)(4,"mat-icon"),l(5,"person"),a(),r(6,"span",5),l(7),a()(),r(8,"mat-menu",null,0)(10,"button",6),p("click",function(){return f(n),g(i.openCustomerSelectionDialog())}),r(11,"mat-icon"),l(12,"person"),a(),r(13,"span"),l(14,"Customer"),a()(),r(15,"button",6),p("click",function(){return f(n),g(i.openGuestSelectionDialog())}),r(16,"mat-icon"),l(17,"hotel"),a(),r(18,"span"),l(19,"Guest"),a()(),_(20,Qn,6,0),a(),_(21,$n,5,2,"button",7)(22,jn,5,0,"button",8),_(23,qn,3,0,"button",9),a()(),r(24,"div",10),_(25,Un,6,0,"div",11),r(26,"div",12),U(27,Jn,28,16,"mat-card",13,Pe,!1,Yn,7,0,"div",14),a()(),r(30,"div",15),_(31,Kn,2,0,"div",16),r(32,"div",17)(33,"button",18),p("click",function(){return f(n),g(i.onApplyDiscount())}),r(34,"mat-icon"),l(35,"local_offer"),a(),r(36,"span",19),l(37,"Discount"),a()(),r(38,"button",18),p("click",function(){return f(n),g(i.onApplyDelivery())}),r(39,"mat-icon"),l(40,"local_shipping"),a(),r(41,"span",19),l(42,"Delivery"),a()()(),r(43,"div",20)(44,"button",21),p("click",function(){return f(n),g(i.onCheckout())}),l(45),L(46,"currency"),a()()()()}if(e&2){let n,s,u=Kt(9);c(3),v("matMenuTriggerFor",u),c(4),k(i.selectedBuyerName()),c(13),C(i.selectedCustomer()||i.selectedGuest()?20:-1),c(),C(i.tableStore.selectedTable()?21:22),c(2),C(i.isMobile()?23:-1),c(2),C(i.isEmpty()?-1:25),c(2),z((n=i.cartStore.selectedCart())==null?null:n.products),c(4),C(i.isEmpty()?-1:31),c(14),Wt(" Checkout ",i.itemsCount()," items (",K(46,10,((s=i.cartSummary())==null?null:s.totalCost)||0,i.currency(),"symbol","1.0-0"),") ")}},dependencies:[B,ot,it,A,q,Re,xe,G,$,_i,fi,pi,gi,Qe,Le,Mt,Ge,ki,Se],styles:["[_nghost-%COMP%]{display:block;height:100%}.primary-text[_ngcontent-%COMP%]{color:var(--mat-sys-primary)}.bg-primary[_ngcontent-%COMP%]{background-color:var(--mat-sys-primary)}.text-on-primary[_ngcontent-%COMP%]{color:var(--mat-sys-on-primary)}.text-on-surface-variant[_ngcontent-%COMP%]{color:var(--mat-sys-on-surface-variant)}.border-outline-variant[_ngcontent-%COMP%]{border-color:var(--mat-sys-outline-variant)}"]})};var Wn=["searchComponent"],Do=(o,t)=>t._id;function Zn(o,t){o&1&&R(0,"mat-spinner",12)}function er(o,t){if(o&1&&(r(0,"mat-icon",23),l(1),a()),o&2){let e=d().$implicit;c(),k(e.icon)}}function tr(o,t){if(o&1){let e=S();r(0,"mat-chip-option",22),p("click",function(){let n=f(e).$implicit,s=d(2);return g(s.selectCategory(n))}),_(1,er,2,1,"mat-icon",23),l(2),a()}if(o&2){let e,i=t.$implicit,n=d(2);v("selected",((e=n.categoryStore.selectedCategory())==null?null:e._id)===i._id)("disabled",i.activate===!1),c(),C(i.icon?1:-1),c(),w(" ",i.name," ")}}function ir(o,t){if(o&1&&(r(0,"mat-chip-listbox",13),U(1,tr,3,4,"mat-chip-option",21,Do),a()),o&2){let e=d();c(),z(e.categoryStore.categories())}}function or(o,t){o&1&&(r(0,"div",15),R(1,"mat-spinner",24),a())}function nr(o,t){o&1&&(r(0,"div",16)(1,"mat-icon",25),l(2,"inventory_2"),a(),r(3,"p",26),l(4,"No products found"),a(),r(5,"p",27),l(6,"Select a category or search for products"),a()())}function rr(o,t){if(o&1){let e=S();r(0,"app-product-card",29),p("addToCart",function(n){f(e);let s=d(2);return g(s.addToCart({product:n,isEditing:!1}))})("increment",function(n){f(e);let s=d(2);return g(s.incrementQuantity(n))})("decrement",function(n){f(e);let s=d(2);return g(s.decrementQuantity(n))})("openOptions",function(n){f(e);let s=d(2);return g(s.openOptionsDialog(n))}),a()}if(o&2){let e=t.$implicit,i=d(2);v("product",e)("cartQuantity",i.getCartQuantity(e._id))}}function ar(o,t){if(o&1&&(r(0,"div",17),U(1,rr,1,2,"app-product-card",28,Do),a()),o&2){let e=d();c(),z(e.productStore.filteredProducts())}}var Mo=class o{categoryStore=m(ht);storeStore=m(E);productStore=m(bt);cartStore=m(Te);bottomSheet=m(At);breakpointObserver=m(ye);isMobile=ut(this.breakpointObserver.observe([Q.XSmall,Q.Small]).pipe(We(t=>t.matches)),{initialValue:!1});searchFilter="";searchComponent;searchProduct(t){if(this.storeStore.selectedStore()?.posSettings?.useBarcodeScanner){let e=this.productStore.searchByBarcode(t),i=this.cartStore.selectedCart(),n=null,s=!1;i&&e&&(n=i.products.find(u=>u._id===e._id),s=!!n,console.log("Barcode scan found product:",e.name,"Editing:",s)),e&&this.addToCart({product:e,isEditing:s})}else this.productStore.updateSearchQuery(t)}selectCategory(t){this.categoryStore.selectCategory(t)}clearSearch(){this.productStore.clearSearchQuery()}toggleBarcodeScanner(t){let e=this.storeStore.selectedStore();e&&this.storeStore.updateStore$({posSettings:F(D({},e.posSettings),{useBarcodeScanner:t})})}currencySymbol=x(()=>this.storeStore.selectedStore()?.currency||"\u20A6");cartItems=P([]);taxRate=P(0);getCartQuantity(t){return this.cartItems().find(i=>i.product._id===t)?.quantity||0}addToCart(t){this.createCart(),this.cartStore.addToCart(this.cartStore.selectedCart()._id,t.product,t.isEditing),this.searchComponent.clearFilter()}createCart(){this.cartStore.selectedCart()||this.cartStore.createCart()}incrementQuantity(t){t.qty!==void 0&&this.getCartQuantity(t._id)>=t.qty||this.cartItems.update(e=>e.map(i=>i.product._id===t._id?F(D({},i),{quantity:i.quantity+1}):i))}decrementQuantity(t){this.getCartQuantity(t._id)<=1?this.removeFromCart(t._id):this.cartItems.update(i=>i.map(n=>n.product._id===t._id?F(D({},n),{quantity:n.quantity-1}):n))}removeFromCart(t){this.cartItems.update(e=>e.filter(i=>i.product._id!==t))}clearCart(){this.cartItems.set([])}checkout(){console.log("Checkout:",this.cartItems())}openCartModal(){this.bottomSheet.open(Je,{panelClass:"cart-bottom-sheet"})}openOptionsDialog(t){console.log("Open options dialog for:",t.name)}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=V({type:o,selectors:[["checkout"]],viewQuery:function(e,i){if(e&1&&Xt(Wn,5),e&2){let n;Jt(n=Yt())&&(i.searchComponent=n.first)}},decls:24,vars:9,consts:[["searchComponent",""],[1,"flex","h-[calc(100vh-64px)]","lg:h-[calc(100vh-64px)]"],[1,"w-full","lg:w-[70%]","h-full","lg:border-r","border-gray-200","flex","flex-col"],[1,"p-4","border-b","border-outline-variant"],[1,"flex","items-center","gap-3"],[1,"flex-1"],["searchText","Search by barcode or product",3,"filterChange","rightTap","filter","showRightIcon"],[1,"hidden","lg:flex","items-center","gap-2","shrink-0"],[1,"text-sm","text-gray-600","whitespace-nowrap"],["color","primary",3,"change","checked"],[1,"px-4","py-3","border-b","border-outline-variant"],[1,"flex","items-center","gap-3","overflow-x-auto","scrollbar-hide"],["diameter","20"],["aria-label","Select a category",1,"flex-nowrap"],[1,"flex-1","p-4","overflow-auto","pb-20","lg:pb-4"],[1,"flex","justify-center","items-center","h-full"],[1,"flex","flex-col","items-center","justify-center","h-full","text-gray-400"],[1,"grid","grid-cols-2","md:grid-cols-2","lg:grid-cols-3","xl:grid-cols-4","2xl:grid-cols-5","gap-3","lg:gap-4"],[1,"hidden","lg:block","lg:w-[30%]","h-full"],[3,"increment","decrement","removeItem","clearCart","addToCart","checkout","items","taxRate"],["mat-fab","","color","primary","matBadgeColor","warn","matBadgeSize","large",1,"!fixed","!bottom-[88px]","!right-4","!z-[60]","lg:!hidden",3,"click","matBadge","matBadgeHidden"],[3,"selected","disabled"],[3,"click","selected","disabled"],["matChipAvatar",""],["diameter","40"],[1,"!text-6xl","!w-16","!h-16","mb-4"],[1,"text-lg","font-medium"],[1,"text-sm"],[3,"product","cartQuantity"],[3,"addToCart","increment","decrement","openOptions","product","cartQuantity"]],template:function(e,i){if(e&1){let n=S();r(0,"div",1)(1,"div",2)(2,"div",3)(3,"div",4)(4,"div",5)(5,"app-search",6,0),p("filterChange",function(u){return f(n),g(i.searchProduct(u))})("rightTap",function(){return f(n),g(i.clearSearch())}),a()(),r(7,"div",7)(8,"span",8),l(9,"Barcode Scanner"),a(),r(10,"mat-slide-toggle",9),p("change",function(u){return f(n),g(i.toggleBarcodeScanner(u.checked))}),a()()()(),r(11,"div",10)(12,"div",11),_(13,Zn,1,0,"mat-spinner",12)(14,ir,3,0,"mat-chip-listbox",13),a()(),r(15,"div",14),_(16,or,2,0,"div",15)(17,nr,7,0,"div",16)(18,ar,3,0,"div",17),a()(),r(19,"div",18)(20,"app-cart",19),p("increment",function(u){return f(n),g(i.incrementQuantity(u))})("decrement",function(u){return f(n),g(i.decrementQuantity(u))})("removeItem",function(u){return f(n),g(i.removeFromCart(u))})("clearCart",function(){return f(n),g(i.clearCart())})("addToCart",function(u){return f(n),g(i.addToCart({product:u,isEditing:!1}))})("checkout",function(){return f(n),g(i.checkout())}),a()()(),r(21,"button",20),p("click",function(){return f(n),g(i.openCartModal())}),r(22,"mat-icon"),l(23,"shopping_cart"),a()()}if(e&2){let n,s,u;c(5),v("filter",i.searchFilter)("showRightIcon",!0),c(5),v("checked",((n=i.storeStore.selectedStore())==null||n.posSettings==null?null:n.posSettings.useBarcodeScanner)??!1),c(3),C(i.categoryStore.isLoading()?13:14),c(3),C(i.productStore.isLoading()?16:i.productStore.filteredProducts().length===0?17:18),c(4),v("items",i.cartItems())("taxRate",i.taxRate()),c(),v("matBadge",((s=i.cartStore.selectedCart())==null||s.products==null?null:s.products.length)||0)("matBadgeHidden",!(!((u=i.cartStore.selectedCart())==null||u.products==null)&&u.products.length))}},dependencies:[B,Z,ro,xt,Je,Yi,Hi,Ji,Xi,G,$,fe,pe,Zi,Wi,A,ni,ho,Co,So],styles:["[_nghost-%COMP%]{display:block;height:100%}.scrollbar-hide[_ngcontent-%COMP%]::-webkit-scrollbar{display:none}.scrollbar-hide[_ngcontent-%COMP%]{-ms-overflow-style:none;scrollbar-width:none}.line-clamp-2[_ngcontent-%COMP%]{display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden}mat-chip-listbox[_ngcontent-%COMP%]     .mdc-evolution-chip-set__chips{flex-wrap:nowrap}"]})};export{Mo as Checkout};
