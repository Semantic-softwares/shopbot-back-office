import{a as Re,b as ke,c as Ie}from"./chunk-HAT37PYE.js";import{a as Te}from"./chunk-RUZ72OGJ.js";import{a as Fe,b as we}from"./chunk-4OM7C35U.js";import"./chunk-MS4AQ6UA.js";import{a as ye,b as Ce}from"./chunk-5W5E6AGV.js";import"./chunk-3RK6DDJD.js";import{a as Se,b as Ee}from"./chunk-57GZGP3R.js";import"./chunk-JQGESV5S.js";import{d as W}from"./chunk-FNFXBZOZ.js";import{b as ue,c as fe,d as xe}from"./chunk-AQ3KQLE6.js";import{a as H}from"./chunk-4WFQ5GOX.js";import{c as _e}from"./chunk-KNNK3RCH.js";import{b as be}from"./chunk-WVHZJWJP.js";import"./chunk-ETOXAU7Y.js";import"./chunk-5LES5XKI.js";import{a as me,b as se,d as de,e as ce,h as pe}from"./chunk-QMUPRLKR.js";import{B as ae,D as re,b as K,d as v,g as J,h as Q,i as Y,m as Z,n as X,p as ee,q as te,s as ie,w as oe,x as ne}from"./chunk-CXVWFC6J.js";import"./chunk-JTLCVARK.js";import{g as le}from"./chunk-UOL4Y3DN.js";import{a as ge,b as he}from"./chunk-MCIFQNRK.js";import"./chunk-OHZSVTBE.js";import{a as ve}from"./chunk-P7SQXTVL.js";import"./chunk-IKGBOHBU.js";import"./chunk-SIHSJGX2.js";import{Y as L}from"./chunk-BPRDVRQX.js";import"./chunk-KP7TGH7C.js";import"./chunk-M2YK6UF7.js";import{a as I}from"./chunk-AGZJ637K.js";import{a as U,c as j}from"./chunk-WTFDJO4H.js";import"./chunk-TQDHD3WD.js";import{B as G,i as z,t as D}from"./chunk-DWCYWQVU.js";import{Db as u,Eb as f,Fb as A,Gb as R,Hb as x,Ib as g,Jb as c,Kb as o,Lb as i,Mb as p,Mc as k,Qb as w,Ub as _,Vb as s,X as E,Xa as M,_a as r,dc as P,fa as S,g as V,hc as B,ic as n,jc as h,kb as $,kc as b,la as y,ma as C,va as F,wc as q}from"./chunk-5AECHVKR.js";import"./chunk-EQDQRRRY.js";var Me=()=>[],Ae=(a,t)=>t._id,T=(a,t)=>t.value;function Oe(a,t){a&1&&n(0," Update room information and settings ")}function Ve(a,t){a&1&&n(0," Add a new room to your hotel inventory ")}function $e(a,t){a&1&&p(0,"mat-spinner",11)}function Pe(a,t){a&1&&(o(0,"div",12),p(1,"mat-spinner",14),o(2,"span",15),n(3,"Loading room data..."),i()())}function Be(a,t){if(a&1&&(o(0,"mat-error"),n(1),i()),a&2){let e=s(2);r(),h(e.getFieldError("roomNumber"))}}function qe(a,t){if(a&1&&(o(0,"mat-option",31)(1,"div",85)(2,"span"),n(3),i(),o(4,"span",86),n(5),i()()()),a&2){let e=t.$implicit;c("value",e._id),r(3),h(e.name),r(2),b("$",e.basePrice,"/night")}}function ze(a,t){if(a&1&&(o(0,"mat-error"),n(1),i()),a&2){let e=s(2);r(),h(e.getFieldError("roomType"))}}function De(a,t){if(a&1&&(o(0,"mat-option",31),n(1),i()),a&2){let e=t.$implicit;c("value",e.value),r(),h(e.label)}}function Ge(a,t){if(a&1&&(o(0,"mat-option",31),n(1),i()),a&2){let e=t.$implicit;c("value",e.value),r(),h(e.label)}}function Ue(a,t){if(a&1&&(o(0,"mat-option",31),n(1),i()),a&2){let e=t.$implicit;c("value",e),r(),h(e)}}function je(a,t){if(a&1&&(o(0,"mat-error"),n(1),i()),a&2){let e=s(2);r(),h(e.getFieldError("capacity"))}}function We(a,t){if(a&1&&(o(0,"mat-error"),n(1),i()),a&2){let e=s(2);r(),h(e.getFieldError("maxOccupancy"))}}function Le(a,t){if(a&1&&(o(0,"mat-error"),n(1),i()),a&2){let e=s(2);r(),h(e.getFieldError("priceOverride"))}}function He(a,t){if(a&1&&(o(0,"mat-option",31)(1,"span",55)(2,"mat-icon",87),n(3),i(),n(4),i()()),a&2){let e=t.$implicit;c("value",e.value),r(3),h(e.icon),r(),b(" ",e.label," ")}}function Ke(a,t){a&1&&(o(0,"mat-icon",89),n(1,"star"),i())}function Je(a,t){if(a&1&&(o(0,"mat-option",31)(1,"span",55)(2,"div",88),x(3,Ke,2,0,"mat-icon",89,A),i(),n(5),i()()),a&2){let e=t.$implicit;c("value",e.value),r(3),g(q(2,Me).constructor(e.value)),r(2),b(" ",e.label," ")}}function Qe(a,t){if(a&1&&(o(0,"mat-option",31)(1,"span",53),p(2,"span",90),n(3),i()()),a&2){let e=t.$implicit;c("value",e.value),r(2),c("ngClass","bg-"+e.color+"-500 ring-"+e.color+"-200"),r(),b(" ",e.label," ")}}function Ye(a,t){if(a&1&&(o(0,"mat-option",31)(1,"span",53),p(2,"span",90),n(3),i()()),a&2){let e=t.$implicit;c("value",e.value),r(2),c("ngClass","bg-"+e.color+"-500 ring-"+e.color+"-200"),r(),b(" ",e.label," ")}}function Ze(a,t){if(a&1){let e=w();o(0,"div",92)(1,"span"),n(2),i(),o(3,"button",93),_("click",function(){let m=y(e).$implicit,d=s(3);return C(d.removeAmenity(m))}),o(4,"mat-icon",94),n(5,"close"),i()()()}if(a&2){let e=t.$implicit;r(2),h(e)}}function Xe(a,t){if(a&1&&(o(0,"div")(1,"h4",47),n(2),i(),o(3,"div",91),x(4,Ze,6,1,"div",92,R),i()()),a&2){let e=s(2);r(2),b("Selected Amenities (",e.getSelectedAmenities().length,")"),r(2),g(e.getSelectedAmenities())}}function et(a,t){if(a&1){let e=w();o(0,"button",95),_("click",function(){let m=y(e).$implicit,d=s(2);return C(d.toggleAmenity(m))}),n(1),i()}if(a&2){let e=t.$implicit,l=s(2);B(l.isAmenitySelected(e)?"bg-blue-600 text-white border-blue-600":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"),r(),b(" ",e," ")}}function tt(a,t){if(a&1){let e=w();o(0,"div",98)(1,"div",100),p(2,"img",101),i(),o(3,"button",102),_("click",function(){let m=y(e).$index,d=s(3);return C(d.removeSelectedFile(m))}),o(4,"mat-icon",103),n(5,"close"),i()(),o(6,"div",104),n(7),i()()}if(a&2){let e=t.$implicit;r(2),c("src",e.preview,M)("alt",e.name),r(5),b(" ",e.name," ")}}function it(a,t){a&1&&(p(0,"mat-spinner",11),o(1,"span"),n(2,"Uploading..."),i())}function ot(a,t){a&1&&(o(0,"mat-icon"),n(1,"cloud_upload"),i(),o(2,"span"),n(3,"Upload Photos"),i())}function nt(a,t){if(a&1){let e=w();o(0,"button",105),_("click",function(){y(e);let m=s(3);return C(m.uploadPhotos())}),u(1,it,3,0)(2,ot,4,0),i()}if(a&2){let e=s(3);c("disabled",e.uploading()),r(),f(e.uploading()?1:2)}}function at(a,t){if(a&1&&(o(0,"div",75)(1,"h4",96),n(2),i(),o(3,"div",97),x(4,tt,8,3,"div",98,A),i(),u(6,nt,3,2,"button",99),i()),a&2){let e=s(2);r(2),b("Selected Photos (",e.selectedFiles.length,")"),r(2),g(e.selectedFiles),r(2),f(!e.isEditMode()||e.isEditMode()&&!e.saving()?6:-1)}}function rt(a,t){if(a&1){let e=w();o(0,"div",98)(1,"div",100),p(2,"img",101),i(),o(3,"button",102),_("click",function(){let m=y(e).$implicit,d=s(3);return C(d.removeExistingPhoto(m))}),o(4,"mat-icon",103),n(5,"close"),i()()()}if(a&2){let e=t.$implicit,l=t.$index;r(2),c("src",e,M)("alt","Room photo "+(l+1))}}function lt(a,t){if(a&1&&(o(0,"div",75)(1,"h4",96),n(2),i(),o(3,"div",97),x(4,rt,6,2,"div",98,R),i()()),a&2){let e=s(2);r(2),b("Current Photos (",e.existingPhotos().length,")"),r(2),g(e.existingPhotos())}}function mt(a,t){if(a&1){let e=w();o(0,"div",13)(1,"form",16),_("ngSubmit",function(){y(e);let m=s();return C(m.onSubmit())}),o(2,"div",17)(3,"div",18)(4,"h3",19)(5,"mat-icon",20),n(6,"info"),i(),n(7," Basic Information "),i()(),o(8,"div",21)(9,"div",22)(10,"div",23)(11,"mat-form-field",24)(12,"mat-label"),n(13,"Room Number *"),i(),p(14,"input",25),o(15,"mat-icon",26),n(16,"hotel"),i(),u(17,Be,2,1,"mat-error"),i()(),o(18,"div",23)(19,"mat-form-field",24)(20,"mat-label"),n(21,"Room Name"),i(),p(22,"input",27),o(23,"mat-icon",26),n(24,"badge"),i()()(),o(25,"div",28)(26,"mat-form-field",24)(27,"mat-label"),n(28,"Description"),i(),p(29,"textarea",29),i()(),o(30,"div",23)(31,"mat-form-field",24)(32,"mat-label"),n(33,"Room Type *"),i(),o(34,"mat-select",30),x(35,qe,6,3,"mat-option",31,Ae),i(),u(37,ze,2,1,"mat-error"),i()(),o(38,"div",23)(39,"mat-form-field",24)(40,"mat-label"),n(41,"Floor"),i(),o(42,"mat-select",32)(43,"mat-option",31),n(44,"No floor specified"),i(),x(45,De,2,2,"mat-option",31,T),i()()(),o(47,"div",23)(48,"mat-form-field",24)(49,"mat-label"),n(50,"Room Size"),i(),o(51,"mat-select",33),x(52,Ge,2,2,"mat-option",31,T),i()()(),o(54,"div",23)(55,"mat-form-field",24)(56,"mat-label"),n(57,"Bed Configuration"),i(),o(58,"mat-select",34)(59,"mat-option",35),n(60,"Select bed configuration"),i(),x(61,Ue,2,2,"mat-option",31,R),i()()(),o(63,"div",23)(64,"mat-form-field",24)(65,"mat-label"),n(66,"Standard Capacity"),i(),p(67,"input",36),o(68,"mat-icon",26),n(69,"people"),i(),u(70,je,2,1,"mat-error"),i()(),o(71,"div",23)(72,"mat-form-field",24)(73,"mat-label"),n(74,"Maximum Occupancy"),i(),p(75,"input",37),o(76,"mat-icon",26),n(77,"group"),i(),u(78,We,2,1,"mat-error"),i()(),o(79,"div",23)(80,"mat-form-field",24)(81,"mat-label"),n(82,"Price Override"),i(),p(83,"input",38),o(84,"span",39),n(85,"$"),i(),o(86,"mat-icon",26),n(87,"attach_money"),i(),u(88,Le,2,1,"mat-error"),i()(),o(89,"div",23)(90,"mat-form-field",24)(91,"mat-label"),n(92,"View Type"),i(),o(93,"mat-select",40),x(94,He,5,3,"mat-option",31,T),i()()(),o(96,"div",23)(97,"mat-form-field",24)(98,"mat-label"),n(99,"Quality Rating"),i(),o(100,"mat-select",41),x(101,Je,6,3,"mat-option",31,T),i()()(),o(103,"div",23)(104,"mat-form-field",24)(105,"mat-label"),n(106,"Room Status *"),i(),o(107,"mat-select",42),x(108,Qe,4,3,"mat-option",31,T),i()()(),o(110,"div",23)(111,"mat-form-field",24)(112,"mat-label"),n(113,"Housekeeping Status *"),i(),o(114,"mat-select",43),x(115,Ye,4,3,"mat-option",31,T),i()()()()()(),o(117,"div",17)(118,"div",18)(119,"h3",19)(120,"mat-icon",44),n(121,"luxury_dining"),i(),n(122," Room Amenities "),i(),o(123,"p",45),n(124,"Select the amenities available in this room"),i()(),o(125,"div",21)(126,"div",46),u(127,Xe,6,1,"div"),o(128,"div")(129,"h4",47),n(130,"Available Amenities"),i(),o(131,"div",48),x(132,et,2,3,"button",49,R),i()()()()(),o(134,"div",17)(135,"div",18)(136,"h3",19)(137,"mat-icon",50),n(138,"accessible"),i(),n(139," Accessibility Features "),i(),o(140,"p",45),n(141,"Select accessibility features available in this room"),i()(),o(142,"div",51)(143,"div",52)(144,"div",53)(145,"mat-checkbox",54)(146,"span",55)(147,"mat-icon",56),n(148,"accessible"),i(),n(149," Wheelchair Accessible "),i()()(),o(150,"div",53)(151,"mat-checkbox",57)(152,"span",55)(153,"mat-icon",56),n(154,"hearing"),i(),n(155," Hearing Accessible "),i()()(),o(156,"div",53)(157,"mat-checkbox",58)(158,"span",55)(159,"mat-icon",56),n(160,"visibility"),i(),n(161," Visually Accessible "),i()()(),o(162,"div",53)(163,"mat-checkbox",59)(164,"span",55)(165,"mat-icon",56),n(166,"shower"),i(),n(167," Roll-in Shower "),i()()(),o(168,"div",53)(169,"mat-checkbox",60)(170,"span",55)(171,"mat-icon",56),n(172,"support"),i(),n(173," Grab Bars "),i()()()()()(),o(174,"div",17)(175,"div",18)(176,"h3",19)(177,"mat-icon",61),n(178,"star"),i(),n(179," Room Features "),i(),o(180,"p",45),n(181,"Select the amenities and features available in this room"),i()(),o(182,"div",62)(183,"div",63)(184,"div",53)(185,"mat-checkbox",64)(186,"span",55)(187,"mat-icon",56),n(188,"balcony"),i(),n(189," Balcony "),i()()(),o(190,"div",53)(191,"mat-checkbox",65)(192,"span",55)(193,"mat-icon",56),n(194,"kitchen"),i(),n(195," Kitchen "),i()()(),o(196,"div",53)(197,"mat-checkbox",66)(198,"span",55)(199,"mat-icon",56),n(200,"bathtub"),i(),n(201," Bathtub "),i()()(),o(202,"div",53)(203,"mat-checkbox",67)(204,"span",55)(205,"mat-icon",56),n(206,"ac_unit"),i(),n(207," A/C "),i()()(),o(208,"div",53)(209,"mat-checkbox",68)(210,"span",55)(211,"mat-icon",56),n(212,"wifi"),i(),n(213," WiFi "),i()()(),o(214,"div",53)(215,"mat-checkbox",69)(216,"span",55)(217,"mat-icon",56),n(218,"tv"),i(),n(219," Television "),i()()(),o(220,"div",53)(221,"mat-checkbox",70)(222,"span",55)(223,"mat-icon",56),n(224,"waves"),i(),n(225," Ocean View "),i()()(),o(226,"div",53)(227,"mat-checkbox",71)(228,"span",55)(229,"mat-icon",56),n(230,"location_city"),i(),n(231," City View "),i()()()()()(),o(232,"div",17)(233,"div",18)(234,"h3",19)(235,"mat-icon",72),n(236,"photo_library"),i(),n(237," Room Photos "),i(),o(238,"p",45),n(239,"Upload photos to showcase this room"),i()(),o(240,"div",21)(241,"div",46)(242,"div",73)(243,"input",74,0),_("change",function(m){y(e);let d=s();return C(d.onPhotosSelected(m))}),i(),o(245,"div",75)(246,"div",76)(247,"mat-icon",77),n(248,"cloud_upload"),i()(),o(249,"div")(250,"button",78),_("click",function(){y(e);let m=P(244);return C(m.click())}),n(251," Choose photos to upload "),i(),o(252,"p",79),n(253,"or drag and drop images here"),i()(),o(254,"p",80),n(255,"PNG, JPG, WEBP up to 10MB each"),i()()(),u(256,at,7,2,"div",75),u(257,lt,6,1,"div",75),i()()(),o(258,"div",17)(259,"div",18)(260,"h3",19)(261,"mat-icon",81),n(262,"note"),i(),n(263," Additional Notes "),i()(),o(264,"div",21)(265,"div",82)(266,"div")(267,"mat-form-field",24)(268,"mat-label"),n(269,"General Notes"),i(),p(270,"textarea",83),i()(),o(271,"div")(272,"mat-form-field",24)(273,"mat-label"),n(274,"Maintenance Notes"),i(),p(275,"textarea",84),i()()()()()()()}if(a&2){let e=s();r(),c("formGroup",e.roomForm),r(16),f(e.isFieldInvalid("roomNumber")?17:-1),r(18),g(e.roomTypes()),r(2),f(e.isFieldInvalid("roomType")?37:-1),r(6),c("value",null),r(2),g(e.floorOptions),r(7),g(e.sizeOptions),r(9),g(e.bedConfigurationOptions),r(9),f(e.isFieldInvalid("capacity")?70:-1),r(8),f(e.isFieldInvalid("maxOccupancy")?78:-1),r(10),f(e.isFieldInvalid("priceOverride")?88:-1),r(6),g(e.viewTypeOptions),r(7),g(e.qualityRatingOptions),r(7),g(e.roomStatusOptions),r(7),g(e.housekeepingStatusOptions),r(12),f(e.getSelectedAmenities().length>0?127:-1),r(5),g(e.amenitiesOptions),r(124),f(e.selectedFiles.length>0?256:-1),r(),f(e.isEditMode()&&e.existingPhotos().length>0?257:-1)}}var Ne=class a{destroy$=new V;fb=S(ae);router=S(j);route=S(U);roomsService=S(Te);storeStore=S(ve);snackBar=S(H);http=S(G);loading=F(!1);saving=F(!1);uploading=F(!1);roomTypes=F([]);currentRoom=F(null);selectedFiles=[];existingPhotos=F([]);isEditMode=k(()=>!!this.currentRoom());pageTitle=k(()=>this.isEditMode()?"Edit Room":"Create New Room");submitButtonText=k(()=>this.saving()?"Saving...":this.isEditMode()?"Update Room":"Create Room");roomForm;roomStatusOptions=[{value:"available",label:"Available",color:"green"},{value:"occupied",label:"Occupied",color:"purple"},{value:"maintenance",label:"Maintenance",color:"orange"},{value:"cleaning",label:"Cleaning",color:"cyan"},{value:"out_of_order",label:"Out of Order",color:"red"}];housekeepingStatusOptions=[{value:"clean",label:"Clean",color:"green"},{value:"dirty",label:"Dirty",color:"orange"},{value:"inspected",label:"Inspected",color:"cyan"},{value:"out_of_order",label:"Out of Order",color:"red"}];viewTypeOptions=ke;bedConfigurationOptions=Ie;amenitiesOptions=Re;floorOptions=Array.from({length:20},(t,e)=>({value:e+1,label:`Floor ${e+1}`}));sizeOptions=[{value:"small",label:"Small (< 200 sq ft)"},{value:"medium",label:"Medium (200-400 sq ft)"},{value:"large",label:"Large (400-600 sq ft)"},{value:"extra-large",label:"Extra Large (> 600 sq ft)"}];convertSizeToNumber(t){return{small:150,medium:300,large:500,"extra-large":700}[t]||300}convertSizeToString(t){return t<200?"small":t<400?"medium":t<600?"large":"extra-large"}qualityRatingOptions=[{value:1,label:"1 Star"},{value:2,label:"2 Stars"},{value:3,label:"3 Stars"},{value:4,label:"4 Stars"},{value:5,label:"5 Stars"}];ngOnInit(){this.initializeForm(),this.loadRoomTypes(),this.checkForEditMode()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}initializeForm(){this.roomForm=this.fb.group({roomNumber:["",[v.required,v.pattern(/^[A-Za-z0-9\-_]+$/)]],name:[""],description:[""],roomType:["",v.required],floor:[null],size:["medium"],bedConfiguration:[""],capacity:[2,[v.min(1),v.max(20)]],maxOccupancy:[2,[v.min(1),v.max(20)]],priceOverride:[null,[v.min(0)]],viewType:["interior"],qualityRating:[3,[v.min(1),v.max(5)]],status:["available",v.required],housekeepingStatus:["clean",v.required],notes:[""],maintenanceNotes:[""],amenities:[[]],features:this.fb.group({hasBalcony:[!1],hasKitchen:[!1],hasBathtub:[!1],hasAirConditioning:[!1],hasWifi:[!1],hasTV:[!1],oceanView:[!1],cityView:[!1]}),accessibilityFeatures:this.fb.group({wheelchairAccessible:[!1],hearingAccessible:[!1],visuallyAccessible:[!1],rollInShower:[!1],grabBars:[!1]})})}loadRoomTypes(){let t=this.storeStore.selectedStore()?._id;if(!t){this.showError("No store selected");return}this.loading.set(!0),this.roomsService.getRoomTypes(t).pipe(E(this.destroy$)).subscribe({next:e=>{this.roomTypes.set(e.filter(l=>l.active)),this.loading.set(!1)},error:e=>{this.showError("Failed to load room types"),this.loading.set(!1)}})}checkForEditMode(){let t=this.route.snapshot.paramMap.get("id");t&&(this.loading.set(!0),this.roomsService.getRoom(t).pipe(E(this.destroy$)).subscribe({next:e=>{this.currentRoom.set(e),this.populateForm(e),this.loading.set(!1)},error:e=>{this.showError("Failed to load room details"),this.router.navigate(["../"],{relativeTo:this.route})}}))}populateForm(t){let e=typeof t.roomType=="string"?t.roomType:t.roomType._id;this.roomForm.patchValue({roomNumber:t.roomNumber,name:t.name||"",description:t.description||"",roomType:e,floor:t.floor||null,size:t.size?this.convertSizeToString(t.size):"medium",bedConfiguration:t.bedConfiguration||"",capacity:t.capacity||2,maxOccupancy:t.maxOccupancy||t.capacity||2,priceOverride:t.priceOverride||null,viewType:t.viewType||"interior",qualityRating:t.qualityRating||3,status:t.status,housekeepingStatus:t.housekeepingStatus,notes:t.notes||"",maintenanceNotes:t.maintenanceNotes||"",amenities:t.amenities||[],features:{hasBalcony:t.features.hasBalcony||!1,hasKitchen:t.features.hasKitchen||!1,hasBathtub:t.features.hasBathtub||!1,hasAirConditioning:t.features.hasAirConditioning||!1,hasWifi:t.features.hasWifi||!1,hasTV:t.features.hasTV||!1,oceanView:t.features.oceanView||!1,cityView:t.features.cityView||!1},accessibilityFeatures:{wheelchairAccessible:t.accessibilityFeatures?.wheelchairAccessible||!1,hearingAccessible:t.accessibilityFeatures?.hearingAccessible||!1,visuallyAccessible:t.accessibilityFeatures?.visuallyAccessible||!1,rollInShower:t.accessibilityFeatures?.rollInShower||!1,grabBars:t.accessibilityFeatures?.grabBars||!1}}),this.existingPhotos.set(t.photos||[])}onPhotosSelected(t){let e=t.target;e.files&&this.processSelectedFiles(Array.from(e.files))}processSelectedFiles(t){this.selectedFiles=[],t.forEach(e=>{if(e.type.startsWith("image/")){let l=new FileReader;l.onload=m=>{this.selectedFiles.push({file:e,name:e.name,preview:m.target?.result})},l.readAsDataURL(e)}})}removeSelectedFile(t){this.selectedFiles.splice(t,1)}uploadPhotos(){if(this.selectedFiles.length===0)return;this.uploading.set(!0);let t=new FormData;if(this.selectedFiles.forEach(e=>{t.append("files",e.file)}),this.isEditMode()){let e=this.currentRoom()?._id;e&&this.http.post(`${I.apiUrl}/rooms/upload/${e}`,t).pipe(E(this.destroy$)).subscribe({next:l=>{this.showSuccess("Photos uploaded successfully"),this.selectedFiles=[];let m=[...this.existingPhotos(),...l.photos];this.existingPhotos.set(m),this.uploading.set(!1)},error:l=>{this.showError("Failed to upload photos: "+(l.error?.message||l.message)),this.uploading.set(!1)}})}else this.showError("Please save the room first before uploading photos"),this.uploading.set(!1)}uploadPhotosForNewRoom(t){if(this.selectedFiles.length===0){this.router.navigate(["../"],{relativeTo:this.route});return}let e=new FormData;this.selectedFiles.forEach(l=>{e.append("files",l.file)}),this.http.post(`${I.apiUrl}/rooms/upload/${t}`,e).pipe(E(this.destroy$)).subscribe({next:l=>{this.showSuccess("Room created and photos uploaded successfully"),this.router.navigate(["../"],{relativeTo:this.route})},error:l=>{this.showError("Room created but photo upload failed: "+(l.error?.message||l.message)),this.router.navigate(["../"],{relativeTo:this.route})}})}removeExistingPhoto(t){let e=this.currentRoom()?._id;e&&this.http.delete(`${I.apiUrl}/rooms/${e}/photo`,{body:{photoUrl:t}}).pipe(E(this.destroy$)).subscribe({next:()=>{let l=this.existingPhotos().filter(m=>m!==t);this.existingPhotos.set(l),this.showSuccess("Photo removed successfully")},error:l=>{this.showError("Failed to remove photo: "+(l.error?.message||l.message))}})}onSubmit(){if(this.roomForm.invalid){this.markFormGroupTouched(this.roomForm);return}let t=this.storeStore.selectedStore()?._id;if(!t){this.showError("No store selected");return}this.saving.set(!0);let e=this.roomForm.value,l={roomType:e.roomType,roomNumber:e.roomNumber,name:e.name,description:e.description,floor:e.floor,size:this.convertSizeToNumber(e.size),bedConfiguration:e.bedConfiguration,capacity:e.capacity,maxOccupancy:e.maxOccupancy,priceOverride:e.priceOverride,viewType:e.viewType,qualityRating:e.qualityRating,status:e.status,housekeepingStatus:e.housekeepingStatus,notes:e.notes,maintenanceNotes:e.maintenanceNotes,amenities:e.amenities,features:e.features,accessibilityFeatures:e.accessibilityFeatures};(this.isEditMode()?this.roomsService.updateRoom(this.currentRoom()._id,l):this.roomsService.createRoom(t,l)).pipe(E(this.destroy$)).subscribe({next:d=>{let N=this.isEditMode()?"Room updated successfully":"Room created successfully";if(this.showSuccess(N),!this.isEditMode()&&this.selectedFiles.length>0){let O=d._id||d.id;O?this.uploadPhotosForNewRoom(O):this.router.navigate(["../"],{relativeTo:this.route})}else this.router.navigate(["../"],{relativeTo:this.route})},error:d=>{let N=this.isEditMode()?"Failed to update room":"Failed to create room";this.showError(N+": "+(d.error?.message||d.message)),this.saving.set(!1)}})}onCancel(){this.router.navigate(["../"],{relativeTo:this.route})}markFormGroupTouched(t){Object.keys(t.controls).forEach(e=>{let l=t.get(e);l instanceof Y?this.markFormGroupTouched(l):l?.markAsTouched()})}showSuccess(t){this.snackBar.open(t,"Close",{duration:3e3,panelClass:["success-snackbar"]})}showError(t){this.snackBar.open(t,"Close",{duration:5e3,panelClass:["error-snackbar"]})}isFieldInvalid(t){let e=this.roomForm.get(t);return!!(e&&e.invalid&&e.touched)}getFieldError(t){let e=this.roomForm.get(t);if(e?.errors){if(e.errors.required)return`${t} is required`;if(e.errors.pattern)return`${t} format is invalid`;if(e.errors.min)return`${t} must be greater than ${e.errors.min.min}`;if(e.errors.max)return`${t} must be less than ${e.errors.max.max}`}return""}getRoomTypeName(t){return this.roomTypes().find(l=>l._id===t||l.id===t)?.name||"Unknown"}toggleAmenity(t){let e=this.roomForm.get("amenities")?.value||[],l=e.indexOf(t),m;l>-1?m=e.filter(d=>d!==t):m=[...e,t],this.roomForm.patchValue({amenities:m})}isAmenitySelected(t){return(this.roomForm.get("amenities")?.value||[]).includes(t)}removeAmenity(t){let l=(this.roomForm.get("amenities")?.value||[]).filter(m=>m!==t);this.roomForm.patchValue({amenities:l})}getSelectedAmenities(){return this.roomForm.get("amenities")?.value||[]}static \u0275fac=function(e){return new(e||a)};static \u0275cmp=$({type:a,selectors:[["app-room-form"]],decls:21,vars:7,consts:[["fileInput",""],[1,"bg-gradient-to-r","from-blue-50","to-indigo-50","border-b","border-blue-100"],[1,"max-w-7xl","mx-auto","px-4","sm:px-6","lg:px-8"],[1,"flex","justify-between","items-center","py-6"],[1,"flex","items-center","gap-4"],["type","button",1,"p-2","text-gray-600","hover:text-gray-900","hover:bg-white/60","rounded-lg","transition-all","duration-200",3,"click"],[1,"text-3xl","font-bold","text-gray-900","mb-1"],[1,"text-sm","text-gray-600"],[1,"flex","items-center","gap-3"],["type","button",1,"px-4","py-2","text-sm","font-medium","text-gray-700","bg-white","border","border-gray-300","rounded-lg","hover:bg-gray-50","hover:border-gray-400","transition-all","duration-200",3,"click"],["type","submit","form","roomForm",1,"!bg-gradient-to-r","!from-blue-600","!to-blue-700","hover:!from-blue-700","hover:!to-blue-800","!text-white","px-6","py-2","rounded-lg","font-medium","transition-all","duration-200","shadow-lg","hover:shadow-xl","disabled:opacity-50","disabled:cursor-not-allowed","flex","items-center","gap-2",3,"disabled"],["diameter","16",1,"!text-white"],[1,"flex","justify-center","items-center","py-12","bg-white"],[1,"max-w-4xl","mx-auto","px-4","sm:px-6","lg:px-8","py-8"],["diameter","40",1,"!text-blue-600"],[1,"ml-3","text-gray-600"],["id","roomForm",1,"space-y-8",3,"ngSubmit","formGroup"],[1,"bg-white","rounded-lg","shadow-sm","border","border-gray-200","overflow-hidden"],[1,"bg-gradient-to-r","from-gray-50","to-gray-100","px-6","py-4","border-b","border-gray-200"],[1,"text-lg","font-semibold","text-gray-900","flex","items-center","gap-2"],[1,"text-blue-600"],[1,"p-6"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-6"],[1,"md:col-span-1"],["appearance","outline",1,"w-full","[&_.mdc-text-field--outlined]:!bg-gray-50","[&_.mdc-text-field--outlined]:!border-gray-200","hover:[&_.mdc-text-field--outlined]:!border-blue-300","[&_.mdc-text-field--focused_.mdc-text-field--outlined]:!border-blue-500"],["matInput","","formControlName","roomNumber","placeholder","e.g., 101, A-201",1,"!bg-gray-50"],["matSuffix","",1,"text-gray-400"],["matInput","","formControlName","name","placeholder","e.g., Ocean Suite, Presidential Room",1,"!bg-gray-50"],[1,"md:col-span-2"],["matInput","","formControlName","description","rows","2","placeholder","Brief description of the room...",1,"!bg-gray-50"],["formControlName","roomType"],[3,"value"],["formControlName","floor"],["formControlName","size"],["formControlName","bedConfiguration"],["value",""],["matInput","","type","number","formControlName","capacity","min","1","max","20",1,"!bg-gray-50"],["matInput","","type","number","formControlName","maxOccupancy","min","1","max","20",1,"!bg-gray-50"],["matInput","","type","number","formControlName","priceOverride","min","0","step","0.01","placeholder","Leave empty to use room type price",1,"!bg-gray-50"],["matPrefix",""],["formControlName","viewType"],["formControlName","qualityRating"],["formControlName","status"],["formControlName","housekeepingStatus"],[1,"text-indigo-600"],[1,"text-sm","text-gray-600","mt-1"],[1,"space-y-4"],[1,"text-sm","font-medium","text-gray-700","mb-3"],[1,"grid","grid-cols-2","md:grid-cols-3","lg:grid-cols-4","gap-3"],["type","button",1,"flex","items-center","justify-center","p-3","border","rounded-lg","text-sm","font-medium","transition-all","duration-200",3,"class"],[1,"text-teal-600"],["formGroupName","accessibilityFeatures",1,"p-6"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4"],[1,"flex","items-center"],["formControlName","wheelchairAccessible",1,"!text-teal-600"],[1,"flex","items-center","gap-2"],[1,"text-lg","text-gray-600"],["formControlName","hearingAccessible",1,"!text-teal-600"],["formControlName","visuallyAccessible",1,"!text-teal-600"],["formControlName","rollInShower",1,"!text-teal-600"],["formControlName","grabBars",1,"!text-teal-600"],[1,"text-green-600"],["formGroupName","features",1,"p-6"],[1,"grid","grid-cols-2","md:grid-cols-4","gap-4"],["formControlName","hasBalcony",1,"!text-blue-600"],["formControlName","hasKitchen",1,"!text-blue-600"],["formControlName","hasBathtub",1,"!text-blue-600"],["formControlName","hasAirConditioning",1,"!text-blue-600"],["formControlName","hasWifi",1,"!text-blue-600"],["formControlName","hasTV",1,"!text-blue-600"],["formControlName","oceanView",1,"!text-blue-600"],["formControlName","cityView",1,"!text-blue-600"],[1,"text-purple-600"],[1,"border-2","border-dashed","border-gray-300","rounded-lg","p-6","text-center","hover:border-blue-400","transition-colors","duration-200"],["type","file","multiple","","accept","image/*",1,"hidden",3,"change"],[1,"space-y-3"],[1,"w-16","h-16","bg-gray-100","rounded-full","flex","items-center","justify-center","mx-auto"],[1,"text-3xl","text-gray-400"],["type","button",1,"text-blue-600","hover:text-blue-700","font-medium",3,"click"],[1,"text-sm","text-gray-500","mt-1"],[1,"text-xs","text-gray-400"],[1,"text-orange-600"],[1,"space-y-6"],["matInput","","formControlName","notes","rows","3","placeholder","Any special notes about this room...",1,"!bg-gray-50"],["matInput","","formControlName","maintenanceNotes","rows","3","placeholder","Maintenance history or special requirements...",1,"!bg-gray-50"],[1,"flex","items-center","justify-between","w-full"],[1,"text-sm","text-gray-500"],[1,"text-gray-500"],[1,"flex"],[1,"text-yellow-400","text-sm"],[1,"w-3","h-3","rounded-full","mr-3","ring-2",3,"ngClass"],[1,"flex","flex-wrap","gap-2"],[1,"flex","items-center","gap-2","bg-blue-100","text-blue-800","px-3","py-1","rounded-full","text-sm"],["type","button",1,"w-4","h-4","flex","items-center","justify-center","hover:bg-blue-200","rounded-full",3,"click"],[1,"text-xs"],["type","button",1,"flex","items-center","justify-center","p-3","border","rounded-lg","text-sm","font-medium","transition-all","duration-200",3,"click"],[1,"text-sm","font-medium","text-gray-700"],[1,"grid","grid-cols-2","md:grid-cols-3","gap-3"],[1,"relative","group"],["type","button",1,"w-full","px-4","py-2","bg-blue-600","text-white","rounded-lg","hover:bg-blue-700","disabled:bg-gray-400","disabled:cursor-not-allowed","transition-colors","duration-200","flex","items-center","justify-center","gap-2",3,"disabled"],[1,"aspect-square","rounded-lg","overflow-hidden","bg-gray-100"],[1,"w-full","h-full","object-cover",3,"src","alt"],["type","button",1,"absolute","top-2","right-2","w-6","h-6","bg-red-500","text-white","rounded-full","flex","items-center","justify-center","opacity-0","group-hover:opacity-100","transition-opacity","duration-200","hover:bg-red-600",3,"click"],[1,"text-sm"],[1,"absolute","bottom-0","left-0","right-0","bg-black","bg-opacity-50","text-white","text-xs","p-2","truncate"],["type","button",1,"w-full","px-4","py-2","bg-blue-600","text-white","rounded-lg","hover:bg-blue-700","disabled:bg-gray-400","disabled:cursor-not-allowed","transition-colors","duration-200","flex","items-center","justify-center","gap-2",3,"click","disabled"]],template:function(e,l){e&1&&(o(0,"div",1)(1,"div",2)(2,"div",3)(3,"div",4)(4,"button",5),_("click",function(){return l.onCancel()}),o(5,"mat-icon"),n(6,"arrow_back"),i()(),o(7,"div")(8,"h1",6),n(9),i(),o(10,"p",7),u(11,Oe,1,0)(12,Ve,1,0),i()()(),o(13,"div",8)(14,"button",9),_("click",function(){return l.onCancel()}),n(15," Cancel "),i(),o(16,"button",10),u(17,$e,1,0,"mat-spinner",11),n(18),i()()()()(),u(19,Pe,4,0,"div",12),u(20,mt,276,10,"div",13)),e&2&&(r(9),h(l.pageTitle()),r(2),f(l.isEditMode()?11:12),r(5),c("disabled",l.saving()||l.loading()),r(),f(l.saving()?17:-1),r(),b(" ",l.submitButtonText()," "),r(),f(l.loading()?19:-1),r(),f(l.loading()?-1:20))},dependencies:[D,z,re,Z,K,X,J,Q,ne,oe,ee,ie,te,ue,pe,me,se,de,ce,xe,fe,Ce,ye,W,we,Fe,L,he,ge,le,be,_e,Ee,Se],encapsulation:2})};export{Ne as RoomFormComponent};
