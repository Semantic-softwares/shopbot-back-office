import{a as d}from"./chunk-LJSEVW7O.js";import{A as m,B as b}from"./chunk-DWCYWQVU.js";import{Z as a,aa as R,ea as u,s as h,va as n}from"./chunk-5AECHVKR.js";import{a as p,b as g}from"./chunk-EQDQRRRY.js";var y=class l{constructor(t){this.http=t}baseUrl=d.apiUrl;roomsSignal=n([]);roomTypesSignal=n([]);loadingSignal=n(!1);errorSignal=n(null);rooms=this.roomsSignal.asReadonly();roomTypes=this.roomTypesSignal.asReadonly();loading=this.loadingSignal.asReadonly();error=this.errorSignal.asReadonly();getRooms(t,e){this.loadingSignal.set(!0),this.errorSignal.set(null);let o=new m;return e&&(e.status?.length&&(o=o.set("status",e.status.join(","))),e.housekeepingStatus?.length&&(o=o.set("housekeepingStatus",e.housekeepingStatus.join(","))),e.roomType?.length&&(o=o.set("roomType",e.roomType.join(","))),e.floor?.length&&(o=o.set("floor",e.floor.join(","))),e.search&&(o=o.set("search",e.search))),this.http.get(`${this.baseUrl}/rooms/${t}/store`,{params:o}).pipe(a(s=>{this.roomsSignal.set(s),this.loadingSignal.set(!1)}),h(s=>s))}getRoomsByFloor(t){return this.http.get(`${this.baseUrl}/rooms/${t}/by-floor`)}getRoom(t){return this.http.get(`${this.baseUrl}/rooms/${t}`)}createRoom(t,e){let o=g(p({},e),{store:t});return this.http.post(`${this.baseUrl}/rooms`,o).pipe(a(s=>{let i=this.roomsSignal();this.roomsSignal.set([...i,s])}))}updateRoom(t,e){return this.http.put(`${this.baseUrl}/rooms/${t}`,e).pipe(a(o=>{let s=this.roomsSignal(),i=s.findIndex(r=>r._id===t||r.id===t);if(i!==-1){let r=[...s];r[i]=o,this.roomsSignal.set(r)}}))}updateRoomStatus(t,e,o){let s={status:e,notes:o};return this.http.put(`${this.baseUrl}/rooms/${t}/status`,s)}updateHousekeepingStatus(t,e,o){let s={housekeepingStatus:e,notes:o};return this.http.put(`${this.baseUrl}/rooms/${t}/housekeeping`,s)}deleteRoom(t){return this.http.delete(`${this.baseUrl}/rooms/${t}`).pipe(a(()=>{let e=this.roomsSignal();this.roomsSignal.set(e.filter(o=>o._id!==t&&o.id!==t))}))}getAvailableRooms(t,e,o,s){let i=new m().set("checkIn",e).set("checkOut",o);return s&&(i=i.set("roomTypeId",s)),this.http.get(`${this.baseUrl}/rooms/${t}/availability`,{params:i})}getRoomStats(t){return this.http.get(`${this.baseUrl}/rooms/${t}/stats`)}getMaintenanceRooms(t){return this.http.get(`${this.baseUrl}/rooms/${t}/maintenance`)}bulkUpdateRoomStatus(t,e,o){let s={roomIds:t,status:e,notes:o};return this.http.put(`${this.baseUrl}/rooms/bulk/status`,s)}getRoomTypes(t,e){this.loadingSignal.set(!0),this.errorSignal.set(null);let o=new m;return e&&(e.active!==void 0&&(o=o.set("active",e.active.toString())),e.minPrice!==void 0&&(o=o.set("minPrice",e.minPrice.toString())),e.maxPrice!==void 0&&(o=o.set("maxPrice",e.maxPrice.toString())),e.amenities?.length&&(o=o.set("amenities",e.amenities.join(","))),e.search&&(o=o.set("search",e.search))),this.http.get(`${this.baseUrl}/room-types/${t}/store`,{params:o}).pipe(a(s=>{this.roomTypesSignal.set(s),this.loadingSignal.set(!1)}),h(s=>s))}getRoomType(t){return this.http.get(`${this.baseUrl}/room-types/${t}`)}createRoomType(t,e){let o=g(p({},e),{store:t});return this.http.post(`${this.baseUrl}/room-types`,o).pipe(a(s=>{let i=this.roomTypesSignal();this.roomTypesSignal.set([...i,s])}))}updateRoomType(t,e){return this.http.put(`${this.baseUrl}/room-types/${t}`,e).pipe(a(o=>{let s=this.roomTypesSignal(),i=s.findIndex(r=>r._id===t||r.id===t);if(i!==-1){let r=[...s];r[i]=o,this.roomTypesSignal.set(r)}}))}deleteRoomType(t){return this.http.delete(`${this.baseUrl}/room-types/${t}`).pipe(a(()=>{let e=this.roomTypesSignal();this.roomTypesSignal.set(e.filter(o=>o._id!==t&&o.id!==t))}))}getAvailableRoomTypes(t,e,o){let s=new m().set("checkIn",e).set("checkOut",o);return this.http.get(`${this.baseUrl}/room-types/${t}/availability`,{params:s})}updateRoomTypesSortOrder(t,e){return this.http.put(`${this.baseUrl}/room-types/${t}/sort-order`,e)}getRoomTypeStats(t){return this.http.get(`${this.baseUrl}/room-types/${t}/stats`)}clearState(){this.roomsSignal.set([]),this.roomTypesSignal.set([]),this.errorSignal.set(null),this.loadingSignal.set(!1)}setLoading(t){this.loadingSignal.set(t)}setError(t){this.errorSignal.set(t)}static \u0275fac=function(e){return new(e||l)(u(b))};static \u0275prov=R({token:l,factory:l.\u0275fac,providedIn:"root"})};export{y as a};
