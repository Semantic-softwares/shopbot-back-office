import{a as Me}from"./chunk-LGUUKHX2.js";import{a as Re}from"./chunk-KFDGSJF3.js";import{a as Te}from"./chunk-C2RERFOP.js";import{a as he}from"./chunk-HZC625BF.js";import{h as ve}from"./chunk-3UMN7V3H.js";import{a as h,b as ye}from"./chunk-SLNANJBJ.js";import{a as pe,b as se,c as de,d as _e,e as ue,f as fe,g as Ce,h as xe,i as Se,j as be,k as ge}from"./chunk-SNJMCTTD.js";import"./chunk-GGOIOYKP.js";import"./chunk-LXK533WH.js";import{a as Ee}from"./chunk-PVER7R6N.js";import{d as ie,e as ne,f as oe,g as ae}from"./chunk-B3QUAYVA.js";import{a as re,b as le,c as me,d as ce}from"./chunk-EMC432UM.js";import"./chunk-FK6H3RFT.js";import"./chunk-BA3SXM5W.js";import{a as J}from"./chunk-NWQQ2VP3.js";import"./chunk-M54QIQPD.js";import"./chunk-ZXNLXZXA.js";import"./chunk-2NVE2BM3.js";import"./chunk-KAQLA7HR.js";import"./chunk-Y7XAAAUB.js";import{c as ee,d as te}from"./chunk-USTUFZ7V.js";import"./chunk-DXWLW3LX.js";import{b as U,d as W}from"./chunk-7JNU3RG5.js";import"./chunk-3SKQMCZR.js";import"./chunk-UJ5WOJLI.js";import{a as Z}from"./chunk-W6FIBOPD.js";import{E as K}from"./chunk-EQD33MW2.js";import"./chunk-3R2L4BJM.js";import"./chunk-Y4VWLT32.js";import"./chunk-CDKFCYZ5.js";import{b as X,c as Y}from"./chunk-2HLT5ZQQ.js";import{X as Q,Y as j,_ as G}from"./chunk-UUZHPQZB.js";import"./chunk-CQ6SLR32.js";import"./chunk-BFT2MTJY.js";import{e as H,g as A}from"./chunk-QAO3BBZ5.js";import"./chunk-KTA4MFBX.js";import{i as q,n as B,r as z,t as N}from"./chunk-HUSU2JWO.js";import{Eb as T,Fb as w,Fc as F,Hc as M,Ib as D,Ic as $,Jb as L,Jc as O,Kb as p,Lb as n,Mb as o,Nb as b,Rb as d,Sb as _,Ub as v,V as R,Yb as S,Za as m,_b as s,ca as f,cc as P,dc as k,ec as V,ha as C,ia as x,ic as y,mb as E,nc as a,oc as u,pc as I,sb as c}from"./chunk-HCNG3XRF.js";import"./chunk-EQDQRRRY.js";var De=(e,i,t,r)=>({"bg-green-100 text-green-800":e,"bg-yellow-100 text-yellow-800":i,"bg-red-100 text-red-800":t,"bg-gray-100 text-gray-800":r}),Le=(e,i)=>i.value;function Pe(e,i){if(e&1){let t=v();n(0,"a",29),S("click",function(){let l=C(t).$implicit,g=s(2);return x(g.onTabChange(l.value))}),n(1,"div",30)(2,"h3",31),a(3),o(),n(4,"p",32),a(5),o()()()}if(e&2){let t=i.$implicit,r=s(2);p("active",r.activeTab===t.value),m(3),u(t.label),m(2),u(t.count)}}function ke(e,i){e&1&&(n(0,"th",33),a(1,"Receipt no."),o())}function Ve(e,i){if(e&1&&(n(0,"td",34),a(1),o()),e&2){let t=i.$implicit;m(),u(t.receiptNo)}}function Ie(e,i){e&1&&(n(0,"th",33),a(1,"Date"),o())}function Fe(e,i){if(e&1&&(n(0,"td",34),a(1),o()),e&2){let t=i.$implicit;m(),u(t.date)}}function $e(e,i){e&1&&(n(0,"th",33),a(1,"Ordered by"),o())}function Oe(e,i){if(e&1&&(n(0,"td",34),a(1),o()),e&2){let t=i.$implicit;m(),u((t==null||t.orderedBy==null?null:t.orderedBy.name)??"Admin")}}function qe(e,i){e&1&&(n(0,"th",33),a(1,"Status"),o())}function Be(e,i){if(e&1&&(n(0,"td",34)(1,"span",35),a(2),o()()),e&2){let t=i.$implicit;m(),p("ngClass",F(2,De,t.category==="Complete",t.category==="Processing",t.category==="Cancel",t.category!=="Complete"&&t.category!=="Processing"&&t.category!=="Cancel")),m(),I(" ",t.category," ")}}function ze(e,i){e&1&&(n(0,"th",33),a(1,"Payment Type"),o())}function Ne(e,i){if(e&1&&(n(0,"td",34),a(1),o()),e&2){let t=i.$implicit;m(),u(t.type)}}function He(e,i){e&1&&(n(0,"th",33),a(1,"Order Type"),o())}function Ae(e,i){if(e&1&&(n(0,"td",34),a(1),M(2,"titlecase"),o()),e&2){let t=i.$implicit;m(),u($(2,1,t.ordertype))}}function Qe(e,i){e&1&&(n(0,"th",33),a(1,"Total"),o())}function je(e,i){if(e&1&&(n(0,"td",34),a(1),M(2,"currency"),o()),e&2){let t,r=i.$implicit,l=s(2);m(),u(O(2,1,r.total,(t=l.storeStore.selectedStore())==null?null:t.currency))}}function Ge(e,i){e&1&&(n(0,"th",33),a(1,"Actions"),o())}function Je(e,i){if(e&1){let t=v();n(0,"td",34)(1,"button",36)(2,"mat-icon"),a(3,"more_vert"),o()(),n(4,"mat-menu",null,2)(6,"button",12),S("click",function(){let l=C(t).$implicit,g=s(2);return x(g.viewRecipesDetails(l._id))}),n(7,"mat-icon"),a(8,"visibility"),o(),n(9,"span"),a(10,"View Receipt Details"),o()(),n(11,"button",12),S("click",function(){let l=C(t).$implicit,g=s(2);return x(g.deleteReceipt(l))}),n(12,"mat-icon"),a(13,"delete"),o(),n(14,"span"),a(15,"Delete"),o()()()()}if(e&2){let t=y(5);m(),p("matMenuTriggerFor",t)}}function Ke(e,i){e&1&&b(0,"tr",37)}function Ue(e,i){e&1&&b(0,"tr",38)}function We(e,i){if(e&1){let t=v();n(0,"nav",7),D(1,Pe,6,3,"a",8,Le),o(),n(3,"mat-tab-nav-panel",null,0)(5,"div",9)(6,"button",10)(7,"mat-icon",11),a(8,"file_download"),o(),a(9," Export Data "),o(),n(10,"mat-menu",null,1)(12,"button",12),S("click",function(){C(t);let l=s();return x(l.exportData("pdf"))}),n(13,"mat-icon"),a(14,"picture_as_pdf"),o(),n(15,"span"),a(16,"Export as PDF"),o()(),n(17,"button",12),S("click",function(){C(t);let l=s();return x(l.exportData("csv"))}),n(18,"mat-icon"),a(19,"description"),o(),n(20,"span"),a(21,"Export as CSV"),o()(),n(22,"button",12),S("click",function(){C(t);let l=s();return x(l.exportData("excel"))}),n(23,"mat-icon"),a(24,"table_chart"),o(),n(25,"span"),a(26,"Export as Excel"),o()()()(),n(27,"div",13)(28,"div",14)(29,"table",15),d(30,16),c(31,ke,2,0,"th",17)(32,Ve,2,1,"td",18),_(),d(33,19),c(34,Ie,2,0,"th",17)(35,Fe,2,1,"td",18),_(),d(36,20),c(37,$e,2,0,"th",17)(38,Oe,2,1,"td",18),_(),d(39,21),c(40,qe,2,0,"th",17)(41,Be,3,7,"td",18),_(),d(42,22),c(43,ze,2,0,"th",17)(44,Ne,2,1,"td",18),_(),d(45,23),c(46,He,2,0,"th",17)(47,Ae,3,3,"td",18),_(),d(48,24),c(49,Qe,2,0,"th",17)(50,je,3,4,"td",18),_(),d(51,25),c(52,Ge,2,0,"th",17)(53,Je,16,1,"td",18),_(),c(54,Ke,1,0,"tr",26)(55,Ue,1,0,"tr",27),o(),b(56,"mat-paginator",28),o()()()}if(e&2){let t=y(4),r=y(11),l=s();p("tabPanel",t),m(),L(l.tabStats),m(5),p("matMenuTriggerFor",r),m(23),p("dataSource",l.dataSource.value().orders),m(25),p("matHeaderRowDef",l.displayedColumns),m(),p("matRowDefColumns",l.displayedColumns),m(),p("pageSize",l.pageSize)("pageSizeOptions",l.pageSizeOptions)}}function Xe(e,i){e&1&&(n(0,"div",6),b(1,"mat-spinner",39),o())}var we=class e{queryParams=f(he);orderService=f(Ee);router=f(A);route=f(H);storeStore=f(J);query=ee(this.queryParams.getAllParams$);activeTab="all";tabStats;dataSource=te({params:()=>({storeId:this.storeStore.selectedStore()?._id,query:this.query()}),stream:({params:i})=>this.orderService.getSalesReceipts(i.storeId,i.query).pipe(R(t=>{let r=t.data;this.tabStats=[{label:"All Receipts",value:"all",count:r.allReceipts},{label:"Sales",value:"sales",count:r.sales},{label:"Refunds",value:"refund",count:r.refund}]}))});displayedColumns=["receiptNo","date","category","type","total","orderedBy","ordertype","actions"];paginator;pageSize=10;pageSizeOptions=[5,10,25,50];exportService=f(Te);exportData(i){if(!this.dataSource.value())return;let t=this.dataSource.value().orders,r="receipts";switch(i){case"pdf":this.exportService.exportToPdf(t,r,{from:this.query().start,to:this.query().end});break;case"csv":this.exportService.exportToCSV(t,r);break;case"excel":this.exportService.exportToExcel(t,r);break}}onTabChange(i){this.activeTab=i,this.queryParams.add({type:i})}viewRecipesDetails(i){this.router.navigate(["../",i,"details"],{relativeTo:this.route})}deleteReceipt(i){confirm("Are you sure you want to delete this receipt?")&&this.orderService.deleteOrder(i).subscribe({next:()=>{this.dataSource.reload()},error:t=>{console.error("Error deleting receipt:",t)}})}static \u0275fac=function(t){return new(t||e)};static \u0275cmp=E({type:e,selectors:[["app-list-receipts"]],viewQuery:function(t,r){if(t&1&&P(h,5),t&2){let l;k(l=V())&&(r.paginator=l.first)}},decls:7,vars:1,consts:[["tabPanel",""],["exportMenu","matMenu"],["menu","matMenu"],[1,"p-4","bg-gray-50","min-h-screen"],[1,"flex","justify-between","items-center","mb-6","bg-white","p-4","rounded-lg","shadow-sm"],[1,"bg-white","rounded-lg","shadow-sm"],[1,"flex","items-center","justify-center","min-h-[300px]"],["mat-tab-nav-bar","",1,"grid","grid-cols-3",3,"tabPanel"],["mat-tab-link","",1,"!h-auto","!min-h-[100px]","!px-4","!py-4","border-b",3,"active"],[1,"p-6","flex","justify-between","items-center","border-b"],["mat-flat-button","","color","primary",3,"matMenuTriggerFor"],[1,"mr-2"],["mat-menu-item","",3,"click"],[1,"p-6"],[1,"table-container"],["mat-table","","matSort","",1,"!bg-white","w-full",3,"dataSource"],["matColumnDef","receiptNo"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","date"],["matColumnDef","orderedBy"],["matColumnDef","category"],["matColumnDef","type"],["matColumnDef","ordertype"],["matColumnDef","total"],["matColumnDef","actions"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["showFirstLastButtons","","aria-label","Select page",1,"!bg-white",3,"pageSize","pageSizeOptions"],["mat-tab-link","",1,"!h-auto","!min-h-[100px]","!px-4","!py-4","border-b",3,"click","active"],[1,"text-center"],[1,"text-gray-600","font-medium","mb-1"],[1,"text-2xl","font-semibold"],["mat-header-cell",""],["mat-cell",""],[1,"inline-block","px-2","py-1","rounded-full","text-xs","font-semibold",3,"ngClass"],["mat-icon-button","",3,"matMenuTriggerFor"],["mat-header-row",""],["mat-row",""],["diameter","40"]],template:function(t,r){t&1&&(n(0,"div",3)(1,"div",4),b(2,"date-range-selector")(3,"app-employee-selector"),o(),n(4,"div",5),T(5,We,57,7)(6,Xe,2,0,"div",6),o()()),t&2&&(m(5),w(r.dataSource.hasValue()?5:6))},dependencies:[N,q,ge,pe,de,Ce,_e,se,xe,ue,fe,Se,be,ye,h,ce,le,re,me,G,j,Q,Y,X,ve,U,W,ae,ie,oe,ne,K,Me,Re,Z,B,z],styles:["[_nghost-%COMP%]     .mat-mdc-tab-nav-bar{border-bottom:none}.mat-mdc-tab-link[_ngcontent-%COMP%]{opacity:1!important}"]})};export{we as ListReceiptsComponent};
