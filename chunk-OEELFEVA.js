import{a as se,b as le,c as me,d as ce}from"./chunk-ALAT4ORY.js";import{a as Se}from"./chunk-SD3GJBKE.js";import{b as pe}from"./chunk-3F2QXBNK.js";import{a as ve,b as ge,c as _e,e as be,f as fe,g as ye,j as he,l as Me}from"./chunk-FJYLQSWC.js";import{a as de,b as ue}from"./chunk-4XV2UKEU.js";import{a as Y,b as Z,c as ee,d as te,e as ie}from"./chunk-CDJZX4I4.js";import{a as ne,b as oe,c as re,d as ae}from"./chunk-Q4U6FYZ3.js";import{i as K}from"./chunk-QC7H4KPM.js";import{c as T}from"./chunk-BXJEGH2V.js";import"./chunk-64WHNS37.js";import"./chunk-TIVXUJ22.js";import"./chunk-WAHSRZAW.js";import"./chunk-XLZTIYSF.js";import"./chunk-W7NMJLMQ.js";import{a as J}from"./chunk-YXRAJPAB.js";import{a as G}from"./chunk-UVV7QZRX.js";import"./chunk-TILT22SG.js";import"./chunk-BFT2MTJY.js";import"./chunk-FO4KTVQ3.js";import"./chunk-TRZH7NMW.js";import"./chunk-GXTELBJV.js";import{b as Q,c as W}from"./chunk-JPRPNQOM.js";import{Z as H,ba as X,c as q,d as C}from"./chunk-3LDCGXHW.js";import{e as V,f as B,g as U,h as $,i as z,l as j}from"./chunk-ZLVQTB5B.js";import"./chunk-6PFJHDFS.js";import{Fc as u,Ib as A,Jb as F,Kb as v,Mb as g,Nb as _,Ob as l,Pb as a,Qb as r,Rb as b,Vc as w,Ya as N,Yb as S,ac as k,bb as o,cc as f,fa as p,ka as h,la as M,mc as x,qb as R,r as O,rc as m,sc as d,tc as I,wa as D}from"./chunk-J2AK4FW5.js";import{a as P,b as E}from"./chunk-GAL4ENT6.js";var y=()=>["store-settings"];function Ie(n,e){if(n&1&&(a(0,"a",5),b(1,"img",14),r()),n&2){let t,i=f();l("routerLink",u(3,y)),o(),l("routerLink",u(4,y))("src",(t=i.storeStore.selectedStore())==null?null:t.logo,N)}}function we(n,e){n&1&&(a(0,"a",6)(1,"mat-icon"),m(2,"store"),r()())}function Ce(n,e){if(n&1){let t=S();a(0,"button",15),k("click",function(){let s=h(t).$implicit,c=f();return M(c.selectStore(s))}),m(1),r()}if(n&2){let t,i=e.$implicit,s=f();l("disabled",i._id===((t=s.storeStore.selectedStore())==null?null:t._id)),o(),I(" ",i.name)}}function Te(n,e){if(n&1&&(a(0,"a",17,1)(2,"mat-icon",18),m(3),r(),a(4,"span",19),m(5),r()()),n&2){let t=e.$implicit,i=x(1);l("routerLink",t.link)("activated",i.isActive),o(3),d(t.icon),o(2),d(t.label)}}function Le(n,e){if(n&1&&(a(0,"mat-expansion-panel",12)(1,"mat-expansion-panel-header")(2,"mat-panel-title")(3,"span",16),m(4),r()()(),g(5,Te,6,4,"a",17,v),r()),n&2){let t=e.$implicit;l("expanded",!0),o(4),I(" ",t==null?null:t.name," "),o(),_(t.children)}}var ke=class n{router=p(U);route=p(V);authService=p(J);rolesService=p(G);storeStore=p(K);breakpointObserver=p(q);userToggledOpen=D(!1);isMobile=T(this.breakpointObserver.observe([C.XSmall,C.Small]).pipe(O(e=>e.matches)),{initialValue:!1});opened=w(()=>this.isMobile()?this.userToggledOpen():!0);currentUser=T(this.authService.currentUser,{initialValue:null});hasAllRequiredPermissions=this.authService.hasAnyPermission(["manage_users","manage_events","manage_companies","manage_dashboard","manage_settings"]);sectionPermissions={Reports:["erp.orders.view","erp.products.view","finance.reports.view","finance.transactions.view"],Items:["erp.products.view","erp.products.create","erp.products.edit"],Tables:["erp.products.view","erp.products.edit"],Inventory:["erp.inventory.view","erp.inventory.create","erp.inventory.edit","erp.suppliers.view"],Employees:["settings.staff.view","settings.staff.create","settings.staff.edit"],Customers:["erp.products.view"],Settings:["settings.store.view","settings.store.edit"]};allNavItems=[{name:"Reports",children:[{icon:"leaderboard",label:"Sales summary",link:"./reports/summary",permission:"view_company"},{icon:"shop",label:"Sales by item",link:"./reports/sales-by-item",permission:"view_timeline"},{icon:"category",label:"Sales by category",link:"./reports/sales-by-category",permission:"view_company"},{icon:"diversity_1",label:"Sales by employee",link:"./reports/sales-by-employee",permission:"manage_home"},{icon:"payments",label:"Sales by payment type",link:"./reports/sales-by-payment-type",permission:"manage_home"},{icon:"description",label:"Receipts",link:"./reports/receipts",permission:"manage_home"}]},{name:"Items",children:[{icon:"local_mall",label:"Products",link:"./items/products",permission:"view_company"},{icon:"category_search",label:"Categories",link:"./items/categories",permission:"view_timeline"},{icon:"palette",label:"Modifiers",link:"./items/variants",permission:"view_company"},{icon:"check_box",label:"Options",link:"./items/options",permission:"view_company"},{icon:"restaurant",label:"Stations",link:"./items/stations",permission:"view_company"}]},{name:"Tables",children:[{icon:"table_restaurant",label:"Tables",link:"./tables/list",permission:"view_company"},{icon:"category",label:"Table Categories",link:"./tables/categories/list",permission:"view_company"}]},{name:"Inventory",children:[{icon:"warehouse",label:"Suppliers",link:"./inventory/suppliers",permission:"view_company"},{icon:"inventory_2",label:"Restock",link:"./inventory/restock",permission:"view_company"},{icon:"calculate",label:"Reconciliations",link:"./inventory/reconciliations",permission:"view_company"}]},{name:"Employees",children:[{icon:"assignment_ind",label:"Employees",link:"./employees/list",permission:"view_company"},{icon:"access_time",label:"Timecards",link:"./employees/timecards/list",permission:"view_company"}]},{name:"Customers",children:[{icon:"groups",label:"Customers",link:"./customers/list",permission:"view_company"}]},{name:"Settings",children:[{icon:"settings",label:"Settings",link:"./settings",permission:"view_company"}]}];navItems=w(()=>this.rolesService.isAdmin()?this.allNavItems:this.allNavItems.map(e=>E(P({},e),{children:e.children.filter(t=>this.canAccessMenuItem(t))})).filter(e=>e.children.length>0));canAccessMenuItem(e){let t=this.allNavItems.find(s=>s.children.some(c=>c.link===e.link))?.name;if(!t)return!1;let i=this.sectionPermissions[t]||[];return this.rolesService.isAdmin()?!0:this.rolesService.hasAny(i)}openLink(e){this.router.navigate([e],{relativeTo:this.route})}toggleSidenav(){this.userToggledOpen.update(e=>!e)}goToProfile(){this.router.navigate(["dashboard","general","profile"])}selectStore(e){console.log("Selected store:",e),this.storeStore.setSelectedStore(e),window.location.reload()}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=R({type:n,selectors:[["app-dashboard"]],decls:27,vars:10,consts:[["menu","matMenu"],["rla","routerLinkActive"],[1,"dashboard-container"],["title","ERP",3,"menuToggle"],[1,"!w-[20em]","!rounded-[0px]","px-2",3,"mode","opened"],["matListItemIcon","",1,"block","!mr-6",3,"routerLink"],["matListItemIcon","",1,"block"],["matListItemTitle","",3,"routerLink"],["matListItemLine","",3,"routerLink"],["matListItemMeta","","mat-icon-button","",1,"block",3,"matMenuTriggerFor"],["mat-menu-item","",3,"disabled"],["multi",""],[1,"mat-elevation-z0",3,"expanded"],[1,"p-4","h-screen"],[1,"!w-full","!min-w-10","!mr-5","!max-w-100","h-10","rounded-full","object-cover",3,"routerLink","src"],["mat-menu-item","",3,"click","disabled"],[1,"flex","items-center"],["mat-list-item","","routerLinkActive","active-link",3,"routerLink","activated"],["matListItemIcon","",1,"material-icons-outlined"],["matListItemTitle",""]],template:function(t,i){if(t&1){let s=S();a(0,"div",2)(1,"app-toolbar",3),k("menuToggle",function(){return h(s),M(i.toggleSidenav())}),r(),a(2,"mat-sidenav-container")(3,"mat-sidenav",4)(4,"mat-list")(5,"mat-list-item"),A(6,Ie,2,5,"a",5)(7,we,3,0,"a",6),a(8,"h2",7),m(9),r(),a(10,"div",8),m(11),r(),a(12,"a",9)(13,"mat-icon"),m(14,"keyboard_arrow_down"),r()()(),b(15,"mat-divider"),r(),a(16,"mat-menu",null,0),g(18,Ce,2,2,"button",10,v),r(),a(20,"mat-nav-list")(21,"mat-accordion",11),g(22,Le,7,2,"mat-expansion-panel",12,v),r()()(),a(24,"mat-sidenav-content")(25,"div",13),b(26,"router-outlet"),r()()()()}if(t&2){let s,c,L,xe=x(17);o(3),l("mode",i.isMobile()?"over":"side")("opened",i.opened()),o(3),F((s=i.storeStore.selectedStore())!=null&&s.logo?6:7),o(2),l("routerLink",u(8,y)),o(),d((c=i.currentUser())==null||c.role==null?null:c.role.name),o(),l("routerLink",u(9,y)),o(),d((L=i.storeStore.selectedStore())==null?null:L.name),o(),l("matMenuTriggerFor",xe),o(6),_(i.storeStore.stores()),o(4),_(i.navItems())}},dependencies:[ce,le,me,se,pe,Me,fe,he,ye,be,de,ge,ve,_e,W,Q,X,H,ae,oe,ne,re,j,B,$,z,ie,te,Y,Z,ee,ue,Se],styles:["[_nghost-%COMP%]{display:block;height:100%}.dashboard-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%}mat-toolbar[_ngcontent-%COMP%]{position:sticky;top:0;z-index:1000}mat-sidenav-container[_ngcontent-%COMP%]{flex:1;height:100%}mat-sidenav[_ngcontent-%COMP%]{box-shadow:2px 0 6px #0000001a}.mat-expansion-panel-spacing[_ngcontent-%COMP%]{margin:0}.mat-expansion-panel-body[_ngcontent-%COMP%]{padding:0 24px}.mat-sidenav-content[_ngcontent-%COMP%]{display:flex;flex-direction:column}.content[_ngcontent-%COMP%]{flex:1}.active-link[_ngcontent-%COMP%]{background:#0000000a;color:#1976d2}.active-link[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#1976d2}.mdc-list-item__content[_ngcontent-%COMP%]{margin-left:5px!important}"]})};export{ke as DashboardComponent};
