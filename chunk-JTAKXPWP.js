import{a as Z}from"./chunk-M2YK6UF7.js";import{a as U}from"./chunk-LJSEVW7O.js";import{A as H,B as K}from"./chunk-DWCYWQVU.js";import{E as A,Lc as w,M as F,Mc as x,Nc as L,W,Z as $,aa as M,b as P,c as R,fa as p,g as _,ka as O,l as E,p as T,pa as D,ra as b,ua as j,va as z}from"./chunk-5AECHVKR.js";import{a as r,b as h}from"./chunk-EQDQRRRY.js";var I=class e{hostServer=U.apiUrl;_httpClient=p(K);sessionStorageService=p(Z);createStore(t){return this._httpClient.post(`${this.hostServer}/stores/web`,t)}getStoreCategories(){return this._httpClient.get(`${this.hostServer}/categories`)}deliveryZones(){return this._httpClient.get(`${this.hostServer}/delivery-zones`)}getMerchantStore(t){return this._httpClient.get(`${this.hostServer}/stores/merchant/${t}`)}getMerchantStores(t){return this._httpClient.get(`${this.hostServer}/stores/${t}/vendors`)}updateStore(t,n){return this._httpClient.put(`${this.hostServer}/stores/${t}`,n)}get getStoreLocally(){return this.sessionStorageService.getStore()}get getStoresLocally(){return this.sessionStorageService.getStores()}saveStoresLocally(t){this.sessionStorageService.setStores(t)}saveStoreLocally(t){this.sessionStorageService.setStore(t)}deleteStoreLocally(){this.sessionStorageService.removeStore()}getStore(t){return this._httpClient.get(`${this.hostServer}/stores/${t}`)}addStore(t){return this._httpClient.post(`${this.hostServer}/stores`,t)}getStoreOrders(t){return this._httpClient.get(`${this.hostServer}/orders/store/${t}/orders`)}deleteStoreOrders(t){return this._httpClient.delete(`${this.hostServer}/orders/${t}`)}updateOrderStatus(t,n,o){return this._httpClient.put(`${this.hostServer}/orders/${t}/status/${n}`,o)}uploadLogo(t,n){return this._httpClient.post(`${this.hostServer}/stores/upload/${n}/logo`,t)}uploadBanner(t,n){return this._httpClient.post(`${this.hostServer}/stores/upload/${n}/banner`,t)}getOrderStat(t){let n=new H({fromObject:t});return this._httpClient.get(`${this.hostServer}/dashboard/total-store-sales?${n.toString()}`)}getIncompleteData(t){return this._httpClient.get(`${this.hostServer}/stores/in-complete-data/${t}`)}getDeliveryZonesFromServer(){return this._httpClient.get(`${this.hostServer}/delivery-zones`)}static \u0275fac=function(n){return new(n||e)};static \u0275prov=M({token:e,factory:e.\u0275fac,providedIn:"root"})};function B(e){let t=w(()=>e());return et(t)?new Proxy(e,{get(n,o){return o in t?(j(n[o])||Object.defineProperty(n,o,{value:x(()=>n()[o]),configurable:!0}),B(n[o])):n[o]}}):e}var tt=[WeakSet,WeakMap,Promise,Date,Error,RegExp,ArrayBuffer,DataView,Function];function et(e){if(e===null||typeof e!="object"||nt(e))return!1;let t=Object.getPrototypeOf(e);if(t===Object.prototype)return!0;for(;t&&t!==Object.prototype;){if(tt.includes(t.constructor))return!1;t=Object.getPrototypeOf(t)}return t===Object.prototype}function nt(e){return typeof e?.[Symbol.iterator]=="function"}var ot=new WeakMap,a=Symbol("STATE_SOURCE");function l(e,...t){e[a].update(n=>t.reduce((o,c)=>r(r({},o),typeof c=="function"?c(o):c),n)),st(e)}function rt(e){return e[a]()}function it(e){return ot.get(e[a])||[]}function st(e){let t=it(e);for(let n of t){let o=w(()=>rt(e));n(o)}}function q(...e){let t=[...e],n=typeof t[0]=="function"?{}:t.shift(),o=t;return(()=>{class s{constructor(){let d=o.reduce((g,X)=>X(g),ct()),{stateSignals:S,props:y,methods:m,hooks:i}=d,f=r(r(r({},S),y),m);this[a]=d[a];for(let g of Reflect.ownKeys(f))this[g]=f[g];let{onInit:v,onDestroy:C}=i;v&&v(),C&&p(b).onDestroy(C)}static \u0275fac=function(S){return new(S||s)};static \u0275prov=M({token:s,factory:s.\u0275fac,providedIn:n.providedIn||null})}return s})()}function ct(){return{[a]:z({}),stateSignals:{},props:{},methods:{},hooks:{}}}function at(e){return t=>{let n=e(r(r(r({[a]:t[a]},t.stateSignals),t.props),t.methods));return Reflect.ownKeys(n),h(r({},t),{props:r(r({},t.props),n)})}}function V(e){return at(e)}function Y(e){return t=>{let n=r(r(r({[a]:t[a]},t.stateSignals),t.props),t.methods),o=typeof e=="function"?e(n):e,c=s=>{let u=o[s],d=t.hooks[s];return u?()=>{d&&d(),u(n)}:d};return h(r({},t),{hooks:{onInit:c("onInit"),onDestroy:c("onDestroy")}})}}function G(e){return t=>{let n=e(r(r(r({[a]:t[a]},t.stateSignals),t.props),t.methods));return Reflect.ownKeys(n),h(r({},t),{methods:r(r({},t.methods),n)})}}function J(e){return t=>{let n=typeof e=="function"?e():e,o=Reflect.ownKeys(n);t[a].update(s=>r(r({},s),n));let c=o.reduce((s,u)=>{let d=x(()=>t[a]()[u]);return h(r({},s),{[u]:B(d)})},{});return h(r({},t),{stateSignals:r(r({},t.stateSignals),c)})}}function Q(e,t,n){let o=typeof e=="function"?{next:e,error:t,complete:n}:e;return c=>c.pipe($({next:o.next,complete:o.complete}),A(s=>(o.error(s),E)),o.finalize?F(o.finalize):s=>s)}function k(e,t){t?.injector||O(k);let n=t?.injector??p(D),o=new _,c=e(o).subscribe();n.get(b).onDestroy(()=>c.unsubscribe());let s=(u,d)=>{if(lt(u))return o.next(u),{destroy:P};let S=ut(),y=d?.injector??S??n;if(j(u)){let i=L(()=>{let f=u();w(()=>o.next(f))},{injector:y});return c.add({unsubscribe:()=>i.destroy()}),i}let m=u.subscribe(i=>o.next(i));return c.add(m),y!==n&&y.get(b).onDestroy(()=>m.unsubscribe()),{destroy:()=>m.unsubscribe()}};return s.destroy=c.unsubscribe.bind(c),s}function lt(e){return!j(e)&&!T(e)}function ut(){try{return p(D)}catch{return}}var dt={stores:[],isLoading:!1,selectedStore:null,error:null,logoPath:null,bannerPath:null},Ft=q({providedIn:"root"},J(dt),V(({stores:e})=>({storesCount:x(()=>e().length)})),G((e,t=p(I))=>{function n(i){l(e,{isLoading:i})}function o(i){t.saveStoreLocally(i),l(e,{selectedStore:i})}function c(i){t.saveStoresLocally(i),l(e,{stores:i})}function s(){l(e,{stores:[]})}function u(){let i=t.getStoreLocally;i&&l(e,{selectedStore:i})}function d(i,f){let v=e.selectedStore();if(v){let C=v.staffs.map(g=>g._id===i?r(r({},g),f):g);l(e,{selectedStore:h(r({},v),{staffs:C})})}}function S(i){let f=e.selectedStore();f&&l(e,{selectedStore:h(r(r({},f),i),{_id:f._id})})}function y(i){l(e,{logoPath:i})}let m=k(R($(()=>l(e,{isLoading:!0,error:null})),W(i=>t.updateStore(e.selectedStore()._id,i).pipe(Q({next(f){l(e,{isLoading:!1,error:null,logoPath:null,bannerPath:null}),S(i)},error(f){l(e,{isLoading:!1,error:f})}})))));return{setSelectedStores:c,clearStores:s,updateStore$:m,updateStore:S,updateStoreStaffs:d,setSelectedStore:o,initializeFromStorage:u,updateLogoPath:y,setLoadingState:n}}),Y({onInit(e,t=p(I)){let n=t.getStoresLocally,o=t.getStoreLocally;n&&n.length>0&&l(e,{stores:n}),o&&l(e,{selectedStore:o})}}));export{I as a,Ft as b};
