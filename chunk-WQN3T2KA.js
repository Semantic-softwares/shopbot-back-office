import{a as H}from"./chunk-2GMONTI5.js";import{a as V,b as Ie,c as Re,d as Qe}from"./chunk-3TORYUNM.js";import{a as A,b as z}from"./chunk-2AWCRCPE.js";import{a as Be,b as Ne,c as Ve,d as Ae,e as ze,f as He,g as Ge}from"./chunk-HZXTKPL4.js";import{a as ke}from"./chunk-KBSD74U4.js";import{a as B,b as he,c as Me,d as Te,e as Se,f as ve,g as xe,h as we,i as Ee,j as Pe,k as De,m as N,n as Le}from"./chunk-BVWLPZES.js";import"./chunk-RENLSJYB.js";import{a as Fe,b as Oe}from"./chunk-LFBEZKOS.js";import"./chunk-3PXGCNL7.js";import"./chunk-OFYZMDZT.js";import{c as L,d as de,f as pe,j as F,k as O,l as k,m as I}from"./chunk-FG7UG2DW.js";import{a as me,c as se,e as ce}from"./chunk-FMUIVSDW.js";import{a as D}from"./chunk-7ZWB6L3W.js";import"./chunk-Z3XTQNGP.js";import{a as fe,b as Ce,c as be,d as _e}from"./chunk-6GBZAIAA.js";import"./chunk-GN3UZQS3.js";import{c as ye}from"./chunk-ZZPE5R5A.js";import"./chunk-NGPRL7P4.js";import{b as ee,d as Q,g as te,h as ae,m as oe,o as ie,r as re,w as ne,y as le}from"./chunk-YEMWNPSS.js";import{a as ge,b as ue}from"./chunk-DPX2PQEH.js";import{P as R,j as Z,k as E,l as P}from"./chunk-OEJYD25C.js";import"./chunk-SRUZJ52Y.js";import{i as X,p as w}from"./chunk-A4R7E6RR.js";import{Bb as q,Cb as U,Ec as W,Hb as s,Ib as o,Jb as i,Kb as p,Lb as C,Mb as b,Ob as G,Sb as g,Tb as _,Xb as S,Yb as v,Za as m,Zb as x,bc as Y,ea as c,gc as n,hc as J,ic as f,jb as T,ka as h,la as M,pb as u,qc as K,ua as $}from"./chunk-XUJKWI36.js";import"./chunk-EQDQRRRY.js";function Ke(a,e){a&1&&(o(0,"mat-error"),n(1," Category name is required "),i())}function We(a,e){a&1&&(o(0,"mat-error"),n(1," Category name must be at least 2 characters "),i())}var y=class a{fb=c(ne);tableCategoryService=c(H);storeStore=c(R);snackBar=c(D);dialogRef=c(Be);data=c(Ne);categoryForm;isEdit=!1;isLoading=!1;ngOnInit(){this.isEdit=this.data?.mode==="edit",this.initForm(),this.isEdit&&this.data.category&&this.populateForm(this.data.category)}initForm(){this.categoryForm=this.fb.group({name:["",[Q.required,Q.minLength(2)]],active:[!0],store:[this.storeStore.selectedStore()?._id]})}populateForm(e){this.categoryForm.patchValue({name:e.name,active:e.active,store:typeof e.store=="object"?e.store._id:e.store})}onSubmit(){if(this.categoryForm.valid){this.isLoading=!0;let e=this.categoryForm.value;this.isEdit?this.tableCategoryService.updateTableCategory(this.data.category._id,e).subscribe({next:()=>{this.snackBar.open("Table category updated successfully","Close",{duration:3e3,horizontalPosition:"end",verticalPosition:"top"}),this.dialogRef.close(!0)},error:t=>{console.error("Error updating table category:",t),this.snackBar.open("Error updating table category","Close",{duration:3e3,horizontalPosition:"end",verticalPosition:"top"}),this.isLoading=!1}}):this.tableCategoryService.createTableCategory(e).subscribe({next:()=>{this.snackBar.open("Table category created successfully","Close",{duration:3e3,horizontalPosition:"end",verticalPosition:"top"}),this.dialogRef.close(!0)},error:t=>{console.error("Error creating table category:",t),this.snackBar.open("Error creating table category","Close",{duration:3e3,horizontalPosition:"end",verticalPosition:"top"}),this.isLoading=!1}})}}onCancel(){this.dialogRef.close(!1)}static \u0275fac=function(t){return new(t||a)};static \u0275cmp=T({type:a,selectors:[["app-create-table-category"]],decls:21,vars:8,consts:[[1,"dialog-container"],["mat-dialog-title","",1,"text-xl","font-semibold","text-gray-900","mb-4"],[1,"space-y-4",3,"ngSubmit","formGroup"],[1,"space-y-4"],["appearance","outline",1,"w-full"],["matInput","","formControlName","name","placeholder","Enter category name"],[4,"ngIf"],[1,"flex","items-center","gap-3"],["formControlName","active","color","primary"],[1,"text-sm","text-gray-600"],[1,"flex","justify-end","gap-3","pt-4"],["mat-button","","type","button",3,"click","disabled"],["mat-raised-button","","color","primary","type","submit",3,"disabled"]],template:function(t,r){if(t&1&&(o(0,"div",0)(1,"h2",1),n(2),i(),o(3,"form",2),g("ngSubmit",function(){return r.onSubmit()}),o(4,"mat-dialog-content",3)(5,"mat-form-field",4)(6,"mat-label"),n(7,"Category Name"),i(),p(8,"input",5),u(9,Ke,2,0,"mat-error",6)(10,We,2,0,"mat-error",6),i(),o(11,"div",7)(12,"mat-slide-toggle",8),n(13," Active "),i(),o(14,"span",9),n(15),i()()(),o(16,"mat-dialog-actions",10)(17,"button",11),g("click",function(){return r.onCancel()}),n(18," Cancel "),i(),o(19,"button",12),n(20),i()()()()),t&2){let l,d,j;m(2),f(" ",r.isEdit?"Edit Table Category":"Create New Table Category"," "),m(),s("formGroup",r.categoryForm),m(6),s("ngIf",(l=r.categoryForm.get("name"))==null?null:l.hasError("required")),m(),s("ngIf",(d=r.categoryForm.get("name"))==null?null:d.hasError("minlength")),m(5),f(" ",(j=r.categoryForm.get("active"))!=null&&j.value?"Category is active":"Category is inactive"," "),m(2),s("disabled",r.isLoading),m(2),s("disabled",r.categoryForm.invalid||r.isLoading),m(),f(" ",r.isLoading?"Saving...":r.isEdit?"Update Category":"Create Category"," ")}},dependencies:[w,X,le,oe,ee,te,ae,ie,re,Ge,Ae,He,ze,O,F,L,de,I,k,P,E,z,A],styles:[".dialog-container[_ngcontent-%COMP%]{min-width:400px}.dialog-container[_ngcontent-%COMP%]   .mat-mdc-form-field[_ngcontent-%COMP%]   .mat-mdc-form-field-subscript-wrapper[_ngcontent-%COMP%]{display:none}.dialog-container[_ngcontent-%COMP%]   .mat-mdc-dialog-content[_ngcontent-%COMP%]{max-height:60vh;overflow-y:auto}.dialog-container[_ngcontent-%COMP%]   .mat-mdc-slide-toggle[_ngcontent-%COMP%]{--mdc-switch-selected-track-color: #1976d2;--mdc-switch-selected-handle-color: #1976d2}"]})};var Xe=()=>[5,10,25,100];function Ze(a,e){a&1&&(o(0,"div",10),p(1,"mat-spinner",14),i())}function et(a,e){a&1&&p(0,"app-no-record",11)}function tt(a,e){a&1&&(o(0,"th",27),n(1,"Category Name"),i())}function at(a,e){if(a&1&&(o(0,"td",28),n(1),i()),a&2){let t=e.$implicit;m(),J(t.name)}}function ot(a,e){a&1&&(o(0,"th",29),n(1,"Tables Count"),i())}function it(a,e){if(a&1&&(o(0,"td",30)(1,"span",31),n(2),i()()),a&2){let t=e.$implicit;m(2),f(" ",(t.tables==null?null:t.tables.length)||0," tables ")}}function rt(a,e){a&1&&(o(0,"th",29),n(1,"Status"),i())}function nt(a,e){if(a&1){let t=G();o(0,"td",30)(1,"mat-slide-toggle",32),g("change",function(){let l=h(t).$implicit,d=_(2);return M(d.toggleCategoryStatus(l))}),i()()}if(a&2){let t=e.$implicit;m(),s("checked",t.active)}}function lt(a,e){a&1&&(o(0,"th",29),n(1,"Actions"),i())}function mt(a,e){if(a&1){let t=G();o(0,"td",30)(1,"button",33)(2,"mat-icon"),n(3,"more_vert"),i()(),o(4,"mat-menu",null,0)(6,"button",34),g("click",function(){let l=h(t).$implicit,d=_(2);return M(d.editCategory(l))}),o(7,"mat-icon"),n(8,"edit"),i(),o(9,"span"),n(10,"Edit"),i()(),o(11,"button",34),g("click",function(){let l=h(t).$implicit,d=_(2);return M(d.deleteCategory(l))}),o(12,"mat-icon"),n(13,"delete"),i(),o(14,"span"),n(15,"Delete"),i()()()()}if(a&2){let t=Y(5);m(),s("matMenuTriggerFor",t)}}function st(a,e){a&1&&p(0,"tr",35)}function ct(a,e){a&1&&p(0,"tr",36)}function dt(a,e){if(a&1&&(o(0,"div",12)(1,"table",15),C(2,16),u(3,tt,2,0,"th",17)(4,at,2,1,"td",18),b(),C(5,19),u(6,ot,2,0,"th",20)(7,it,3,1,"td",21),b(),C(8,22),u(9,rt,2,0,"th",20)(10,nt,2,1,"td",21),b(),C(11,23),u(12,lt,2,0,"th",20)(13,mt,16,1,"td",21),b(),u(14,st,1,0,"tr",24)(15,ct,1,0,"tr",25),i(),p(16,"mat-paginator",26),i()),a&2){let t=_();m(),s("dataSource",t.filteredCategories()),m(13),s("matHeaderRowDef",t.displayedColumns),m(),s("matRowDefColumns",t.displayedColumns),m(),s("pageSizeOptions",K(4,Xe))}}function pt(a,e){a&1&&p(0,"app-no-record",13)}var je=class a{tableCategoryService=c(H);storeStore=c(R);dialog=c(Ve);snackBar=c(D);searchTerm=$("");displayedColumns=["name","tables","active","actions"];dataSource=ye({params:()=>({storeId:this.storeStore.selectedStore()?._id}),stream:({params:e})=>this.tableCategoryService.getStoreTableCategories(e.storeId)});filteredCategories=W(()=>{let e=this.searchTerm().toLowerCase();return this.dataSource.value()?.filter(t=>t.name.toLowerCase().includes(e))??[]});paginator;sort;table;onSearch(e){let t=e.target;this.searchTerm.set(t.value)}addCategory(){this.dialog.open(y,{width:"500px",data:{mode:"create"}}).afterClosed().subscribe(t=>{t&&this.dataSource.reload()})}editCategory(e){this.dialog.open(y,{width:"500px",data:{mode:"edit",category:e}}).afterClosed().subscribe(r=>{r&&this.dataSource.reload()})}deleteCategory(e){this.dialog.open(Qe,{width:"400px",data:{message:`Are you sure you want to delete ${e.name}?`}}).afterClosed().subscribe(r=>{r&&this.tableCategoryService.deleteTableCategory(e._id).subscribe({next:()=>{this.snackBar.open("Table category deleted successfully","Close",{duration:3e3,horizontalPosition:"end",verticalPosition:"top"}),this.dataSource.reload()},error:l=>{console.error("Error deleting table category:",l),this.snackBar.open("Error deleting table category","Close",{duration:3e3,horizontalPosition:"end",verticalPosition:"top"})}})})}toggleCategoryStatus(e){let t={active:!e.active};this.tableCategoryService.updateTableCategory(e._id,t).subscribe({next:()=>{this.snackBar.open("Table category status updated successfully","Close",{duration:3e3,horizontalPosition:"end",verticalPosition:"top"}),this.dataSource.reload()},error:()=>{this.snackBar.open("Error updating table category status","Close",{duration:3e3,horizontalPosition:"end",verticalPosition:"top"})}})}static \u0275fac=function(t){return new(t||a)};static \u0275cmp=T({type:a,selectors:[["app-list-table-categories"]],viewQuery:function(t,r){if(t&1&&(S(N,5),S(V,5),S(B,5)),t&2){let l;v(l=x())&&(r.paginator=l.first),v(l=x())&&(r.sort=l.first),v(l=x())&&(r.table=l.first)}},decls:19,vars:1,consts:[["menu","matMenu"],[1,"table-categories-container","!bg-white","!rounded-xl","!shadow-lg","border","border-gray-100"],[1,"!bg-white"],[1,"flex","flex-col","md:flex-row","justify-between","gap-4","p-4","border-b"],[1,"flex","flex-col","sm:flex-row","gap-4","flex-grow"],["appearance","outline",1,"w-full","sm:w-48","md:w-72","lg:w-96"],["matPrefix",""],["matInput","","placeholder","Search table categories",3,"input"],[1,"flex","gap-3","justify-end"],["mat-raised-button","","color","primary",3,"click"],[1,"flex","items-center","justify-center","min-h-[300px]"],["icon","category","title","No Table Categories","message","No table categories found matching your criteria."],[1,"table-container","rounded-lg","overflow-x-auto","mt-4"],["icon","error","title","Error","message","An error occurred while fetching the data. Please try again later."],["diameter","40"],["mat-table","","matSort","",1,"!bg-white","min-w-full","rounded-lg",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","","mat-sort-header","","class","bg-gray-50",4,"matHeaderCellDef"],["mat-cell","","class","font-semibold",4,"matCellDef"],["matColumnDef","tables"],["mat-header-cell","","class","bg-gray-50",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","active"],["matColumnDef","actions"],["mat-header-row","","class","bg-gray-50",4,"matHeaderRowDef"],["mat-row","","class","hover:bg-gray-50 transition",4,"matRowDef","matRowDefColumns"],["aria-label","Select page of categories",1,"!bg-white",3,"pageSizeOptions"],["mat-header-cell","","mat-sort-header","",1,"bg-gray-50"],["mat-cell","",1,"font-semibold"],["mat-header-cell","",1,"bg-gray-50"],["mat-cell",""],[1,"px-2","py-1","bg-blue-100","text-blue-800","rounded-full","text-xs"],["color","primary",3,"change","checked"],["mat-icon-button","","aria-label","Category actions",3,"matMenuTriggerFor"],["mat-menu-item","",3,"click"],["mat-header-row","",1,"bg-gray-50"],["mat-row","",1,"hover:bg-gray-50","transition"]],template:function(t,r){t&1&&(o(0,"mat-card",1)(1,"mat-card-content",2)(2,"div",3)(3,"div",4)(4,"mat-form-field",5)(5,"mat-label"),n(6,"Search"),i(),o(7,"mat-icon",6),n(8,"search"),i(),o(9,"input",7),g("input",function(d){return r.onSearch(d)}),i()()(),o(10,"div",8)(11,"button",9),g("click",function(){return r.addCategory()}),o(12,"mat-icon"),n(13,"add"),i(),n(14," ADD CATEGORY "),i()()(),q(15,Ze,2,0,"div",10)(16,et,1,0,"app-no-record",11)(17,dt,17,5,"div",12)(18,pt,1,0,"app-no-record",13),i()()),t&2&&(m(15),U(r.dataSource.isLoading()?15:r.dataSource.hasValue()&&r.filteredCategories().length===0?16:r.dataSource.hasValue()?17:r.dataSource.error()?18:-1))},dependencies:[w,De,B,Me,xe,Te,he,we,Se,ve,Ee,Pe,Le,N,Re,V,Ie,ce,me,se,O,F,L,pe,I,k,P,E,Z,ue,ge,_e,Ce,fe,be,Oe,Fe,z,A,ke],styles:[".table-categories-container[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   .mat-mdc-table[_ngcontent-%COMP%]{border-radius:8px}.table-categories-container[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   .mat-mdc-table[_ngcontent-%COMP%]   .mat-mdc-header-cell[_ngcontent-%COMP%]{font-weight:600;color:#374151;background-color:#f9fafb}.table-categories-container[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   .mat-mdc-table[_ngcontent-%COMP%]   .mat-mdc-row[_ngcontent-%COMP%]:hover{background-color:#f9fafb}.mat-mdc-form-field[_ngcontent-%COMP%]   .mat-mdc-form-field-subscript-wrapper[_ngcontent-%COMP%]{display:none}.mat-mdc-card[_ngcontent-%COMP%]{box-shadow:0 1px 3px #0000001a,0 1px 2px #0000000f}"]})};export{je as ListTableCategoriesComponent};
