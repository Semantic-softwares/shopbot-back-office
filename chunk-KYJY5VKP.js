import{Gc as f,Hc as x,Ic as h,Jc as k,Kc as I,X as D,_ as d,d as m,fa as b,i as y,pa as w,ra as l,va as v}from"./chunk-FR2FBSQW.js";import{a as p,b as g}from"./chunk-EQDQRRRY.js";function T(n){n||(n=b(l));let e=new m(t=>{if(n.destroyed){t.next();return}return n.onDestroy(t.next.bind(t))});return t=>t.pipe(D(e))}function F(n,e){let t=e?.injector??b(w),o=new y(1),i=h(()=>{let r;try{r=n()}catch(u){f(()=>o.error(u));return}f(()=>o.next(r))},{injector:t,manualCleanup:!0});return t.get(l).onDestroy(()=>{i.destroy(),o.complete()}),o.asObservable()}function L(n,e){let o=!e?.manualCleanup?e?.injector?.get(l)??b(l):null,i=j(e?.equal),r;e?.requireSync?r=v({kind:0},{equal:i}):r=v({kind:1,value:e?.initialValue},{equal:i});let u,a=n.subscribe({next:s=>r.set({kind:1,value:s}),error:s=>{r.set({kind:2,error:s}),u?.()},complete:()=>{u?.()}});if(e?.requireSync&&r().kind===0)throw new d(601,!1);return u=o?.onDestroy(a.unsubscribe.bind(a)),x(()=>{let s=r();switch(s.kind){case 1:return s.value;case 2:throw s.error;case 0:throw new d(601,!1)}},{equal:e?.equal})}function j(n=Object.is){return(e,t)=>e.kind===1&&t.kind===1&&n(e.value,t.value)}function N(n){return k(g(p({},n),{loader:void 0,stream:e=>{let t,o=()=>t.unsubscribe();e.abortSignal.addEventListener("abort",o);let i=v({value:void 0}),r,u=new Promise(c=>r=c);function a(c){i.set(c),r?.(i),r=void 0}let s=n.stream??n.loader;if(s===void 0)throw new d(990,!1);return t=s(e).subscribe({next:c=>a({value:c}),error:c=>{a({error:I(c)}),e.abortSignal.removeEventListener("abort",o)},complete:()=>{r&&a({error:new d(991,!1)}),e.abortSignal.removeEventListener("abort",o)}}),u}}))}export{T as a,F as b,L as c,N as d};
