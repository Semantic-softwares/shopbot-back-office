import{a as Be,b as De,c as qe}from"./chunk-IUP742CL.js";import{a as Pe}from"./chunk-S2GGJVYE.js";import{a as Oe}from"./chunk-Z32AMKXI.js";import{a as Ve,b as $e}from"./chunk-B276YSOB.js";import{f as Ae}from"./chunk-6IVFTPYN.js";import"./chunk-XRIZFGOF.js";import{b as Ie}from"./chunk-IQCUWJKP.js";import"./chunk-DSVTILZD.js";import{i as Y}from"./chunk-I4XKOMFF.js";import{a as Ne,b as ke}from"./chunk-T3N63WKP.js";import{d as L}from"./chunk-WAEUNFFU.js";import"./chunk-JOC3JCWJ.js";import"./chunk-AXVKE7YV.js";import"./chunk-UDXHODBD.js";import"./chunk-XBTGTIDL.js";import{b as Fe,c as Te,d as we}from"./chunk-3JUXLSAM.js";import{a as be,b as Ce,d as ye,e as Se,h as Ee}from"./chunk-TKNXELSU.js";import"./chunk-JT5P23LW.js";import{a as Re,b as Me}from"./chunk-4CSV6WDD.js";import{B as _e,b as le,d as g,g as me,h as se,i as de,m as ce,n as pe,q as ue,s as fe,t as he,u as xe,v as ge,z as ve}from"./chunk-APGJ2ZCU.js";import"./chunk-KLDQLPSD.js";import{a as Q}from"./chunk-6XJLFJNL.js";import"./chunk-R35DVJIH.js";import{a as N}from"./chunk-BFT2MTJY.js";import{a as ee,b as te,c as ie,d as oe,f as ne,g as ae,h as re}from"./chunk-SV3V3KFF.js";import"./chunk-FTUKKUPK.js";import"./chunk-J6S3CU5H.js";import"./chunk-SBJI2VOL.js";import{b as Z,c as X}from"./chunk-A5WKFY2Q.js";import{Z as K,aa as J}from"./chunk-PD333HOR.js";import{e as W,g as H}from"./chunk-JWHH2AW2.js";import{g as G,s as U,y as j}from"./chunk-T7PMTSVA.js";import{$b as b,Ec as z,Hb as u,Ib as f,Jb as A,Kb as R,Lb as h,Mb as x,Nb as d,Ob as o,Pb as i,Qb as p,Ub as P,Uc as M,V as E,Vb as B,Xa as I,Xb as T,ab as l,bc as s,ea as S,f as V,ja as C,ka as y,lc as D,pb as $,pc as q,qc as n,rc as v,sc as _,va as F}from"./chunk-ZCSDIQ3M.js";import"./chunk-GAL4ENT6.js";var Ge=()=>[],Ue=(a,t)=>t._id,w=(a,t)=>t.value;function je(a,t){a&1&&p(0,"mat-spinner",5)}function We(a,t){a&1&&(o(0,"mat-icon"),n(1,"save"),i())}function He(a,t){a&1&&(o(0,"div",6),p(1,"mat-spinner",8),i())}function Le(a,t){if(a&1&&(o(0,"mat-error"),n(1),i()),a&2){let e=s(2);l(),v(e.getFieldError("roomNumber"))}}function Ke(a,t){if(a&1&&(o(0,"mat-option",20)(1,"div",73)(2,"span"),n(3),i(),o(4,"span",74),n(5),i()()()),a&2){let e=t.$implicit;d("value",e._id),l(3),v(e.name),l(2),_("$",e.basePrice,"/night")}}function Je(a,t){if(a&1&&(o(0,"mat-error"),n(1),i()),a&2){let e=s(2);l(),v(e.getFieldError("roomType"))}}function Qe(a,t){if(a&1&&(o(0,"mat-option",20),n(1),i()),a&2){let e=t.$implicit;d("value",e.value),l(),v(e.label)}}function Ye(a,t){if(a&1&&(o(0,"mat-option",20),n(1),i()),a&2){let e=t.$implicit;d("value",e.value),l(),v(e.label)}}function Ze(a,t){if(a&1&&(o(0,"mat-option",20),n(1),i()),a&2){let e=t.$implicit;d("value",e),l(),v(e)}}function Xe(a,t){if(a&1&&(o(0,"mat-error"),n(1),i()),a&2){let e=s(2);l(),v(e.getFieldError("capacity"))}}function et(a,t){if(a&1&&(o(0,"mat-error"),n(1),i()),a&2){let e=s(2);l(),v(e.getFieldError("maxOccupancy"))}}function tt(a,t){if(a&1&&(o(0,"mat-error"),n(1),i()),a&2){let e=s(2);l(),v(e.getFieldError("priceOverride"))}}function it(a,t){if(a&1&&(o(0,"mat-option",20)(1,"span",45)(2,"mat-icon",75),n(3),i(),n(4),i()()),a&2){let e=t.$implicit;d("value",e.value),l(3),v(e.icon),l(),_(" ",e.label," ")}}function ot(a,t){a&1&&(o(0,"mat-icon",77),n(1,"star"),i())}function nt(a,t){if(a&1&&(o(0,"mat-option",20)(1,"span",45)(2,"div",76),h(3,ot,2,0,"mat-icon",77,A),i(),n(5),i()()),a&2){let e=t.$implicit;d("value",e.value),l(3),x(z(2,Ge).constructor(e.value)),l(2),_(" ",e.label," ")}}function at(a,t){if(a&1&&(o(0,"mat-option",20)(1,"span",43),p(2,"span",78),n(3),i()()),a&2){let e=t.$implicit;d("value",e.value),l(2),d("ngClass","bg-"+e.color+"-500 ring-"+e.color+"-200"),l(),_(" ",e.label," ")}}function rt(a,t){if(a&1&&(o(0,"mat-option",20)(1,"span",43),p(2,"span",78),n(3),i()()),a&2){let e=t.$implicit;d("value",e.value),l(2),d("ngClass","bg-"+e.color+"-500 ring-"+e.color+"-200"),l(),_(" ",e.label," ")}}function lt(a,t){if(a&1){let e=T();o(0,"div",80)(1,"span"),n(2),i(),o(3,"button",81),b("click",function(){let m=C(e).$implicit,c=s(3);return y(c.removeAmenity(m))}),o(4,"mat-icon",82),n(5,"close"),i()()()}if(a&2){let e=t.$implicit;l(2),v(e)}}function mt(a,t){if(a&1&&(o(0,"div")(1,"h4",37),n(2),i(),o(3,"div",79),h(4,lt,6,1,"div",80,R),i()()),a&2){let e=s(2);l(2),_("Selected Amenities (",e.getSelectedAmenities().length,")"),l(2),x(e.getSelectedAmenities())}}function st(a,t){if(a&1){let e=T();o(0,"button",83),b("click",function(){let m=C(e).$implicit,c=s(2);return y(c.toggleAmenity(m))}),n(1),i()}if(a&2){let e=t.$implicit,r=s(2);q(r.isAmenitySelected(e)?"bg-blue-600 text-white border-blue-600":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"),l(),_(" ",e," ")}}function dt(a,t){if(a&1){let e=T();o(0,"div",86)(1,"div",88),p(2,"img",89),i(),o(3,"button",90),b("click",function(){let m=C(e).$index,c=s(3);return y(c.removeSelectedFile(m))}),o(4,"mat-icon",91),n(5,"close"),i()(),o(6,"div",92),n(7),i()()}if(a&2){let e=t.$implicit;l(2),d("src",e.preview,I)("alt",e.name),l(5),_(" ",e.name," ")}}function ct(a,t){a&1&&(p(0,"mat-spinner",94),o(1,"span"),n(2,"Uploading..."),i())}function pt(a,t){a&1&&(o(0,"mat-icon"),n(1,"cloud_upload"),i(),o(2,"span"),n(3,"Upload Photos"),i())}function ut(a,t){if(a&1){let e=T();o(0,"button",93),b("click",function(){C(e);let m=s(3);return y(m.uploadPhotos())}),u(1,ct,3,0)(2,pt,4,0),i()}if(a&2){let e=s(3);d("disabled",e.uploading()),l(),f(e.uploading()?1:2)}}function ft(a,t){if(a&1&&(o(0,"div",64)(1,"h4",84),n(2),i(),o(3,"div",85),h(4,dt,8,3,"div",86,A),i(),u(6,ut,3,2,"button",87),i()),a&2){let e=s(2);l(2),_("Selected Photos (",e.selectedFiles.length,")"),l(2),x(e.selectedFiles),l(2),f(!e.isEditMode()||e.isEditMode()&&!e.saving()?6:-1)}}function ht(a,t){if(a&1){let e=T();o(0,"div",86)(1,"div",88),p(2,"img",89),i(),o(3,"button",90),b("click",function(){let m=C(e).$implicit,c=s(3);return y(c.removeExistingPhoto(m))}),o(4,"mat-icon",91),n(5,"close"),i()()()}if(a&2){let e=t.$implicit,r=t.$index;l(2),d("src",e,I)("alt","Room photo "+(r+1))}}function xt(a,t){if(a&1&&(o(0,"div",64)(1,"h4",84),n(2),i(),o(3,"div",85),h(4,ht,6,2,"div",86,R),i()()),a&2){let e=s(2);l(2),_("Current Photos (",e.existingPhotos().length,")"),l(2),x(e.existingPhotos())}}function gt(a,t){if(a&1){let e=T();o(0,"div",7)(1,"form",9),b("ngSubmit",function(){C(e);let m=s();return y(m.onSubmit())}),o(2,"mat-card",10)(3,"mat-card-header")(4,"mat-icon",11),n(5,"info"),i(),o(6,"mat-card-title"),n(7,"Basic Information"),i()(),o(8,"mat-card-content",12)(9,"div",13)(10,"div")(11,"mat-form-field",14)(12,"mat-label"),n(13,"Room Number *"),i(),p(14,"input",15),o(15,"mat-icon",16),n(16,"hotel"),i(),u(17,Le,2,1,"mat-error"),i()(),o(18,"div")(19,"mat-form-field",14)(20,"mat-label"),n(21,"Room Name"),i(),p(22,"input",17),o(23,"mat-icon",16),n(24,"badge"),i()()()(),o(25,"div")(26,"mat-form-field",14)(27,"mat-label"),n(28,"Description"),i(),p(29,"textarea",18),i()(),o(30,"div",13)(31,"div")(32,"mat-form-field",14)(33,"mat-label"),n(34,"Room Type *"),i(),o(35,"mat-select",19),h(36,Ke,6,3,"mat-option",20,Ue),i(),u(38,Je,2,1,"mat-error"),i()(),o(39,"div")(40,"mat-form-field",14)(41,"mat-label"),n(42,"Floor"),i(),o(43,"mat-select",21)(44,"mat-option",20),n(45,"No floor specified"),i(),h(46,Qe,2,2,"mat-option",20,w),i()()()(),o(48,"div",13)(49,"div")(50,"mat-form-field",14)(51,"mat-label"),n(52,"Room Size"),i(),o(53,"mat-select",22),h(54,Ye,2,2,"mat-option",20,w),i()()(),o(56,"div")(57,"mat-form-field",14)(58,"mat-label"),n(59,"Bed Configuration"),i(),o(60,"mat-select",23)(61,"mat-option",24),n(62,"Select bed configuration"),i(),h(63,Ze,2,2,"mat-option",20,R),i()()()()()(),o(65,"mat-card",10)(66,"mat-card-header")(67,"mat-icon",25),n(68,"people"),i(),o(69,"mat-card-title"),n(70,"Capacity & Pricing"),i()(),o(71,"mat-card-content",12)(72,"div",26)(73,"div")(74,"mat-form-field",14)(75,"mat-label"),n(76,"Standard Capacity"),i(),p(77,"input",27),o(78,"mat-icon",16),n(79,"people"),i(),u(80,Xe,2,1,"mat-error"),i()(),o(81,"div")(82,"mat-form-field",14)(83,"mat-label"),n(84,"Maximum Occupancy"),i(),p(85,"input",28),o(86,"mat-icon",16),n(87,"group"),i(),u(88,et,2,1,"mat-error"),i()(),o(89,"div")(90,"mat-form-field",14)(91,"mat-label"),n(92,"Price Override"),i(),p(93,"input",29),o(94,"span",30),n(95,"$\xA0"),i(),u(96,tt,2,1,"mat-error"),i()()(),o(97,"div",13)(98,"div")(99,"mat-form-field",14)(100,"mat-label"),n(101,"View Type"),i(),o(102,"mat-select",31),h(103,it,5,3,"mat-option",20,w),i()()(),o(105,"div")(106,"mat-form-field",14)(107,"mat-label"),n(108,"Quality Rating"),i(),o(109,"mat-select",32),h(110,nt,6,3,"mat-option",20,w),i()()()()()(),o(112,"mat-card",10)(113,"mat-card-header")(114,"mat-icon",33),n(115,"toggle_on"),i(),o(116,"mat-card-title"),n(117,"Room Status"),i()(),o(118,"mat-card-content",12)(119,"div",13)(120,"div")(121,"mat-form-field",14)(122,"mat-label"),n(123,"Room Status *"),i(),o(124,"mat-select",34),h(125,at,4,3,"mat-option",20,w),i()()(),o(127,"div")(128,"mat-form-field",14)(129,"mat-label"),n(130,"Housekeeping Status *"),i(),o(131,"mat-select",35),h(132,rt,4,3,"mat-option",20,w),i()()()()()(),o(134,"mat-card",10)(135,"mat-card-header")(136,"mat-icon",36),n(137,"room_service"),i(),o(138,"mat-card-title"),n(139,"Room Amenities"),i(),o(140,"mat-card-subtitle"),n(141,"Select the amenities available in this room"),i()(),o(142,"mat-card-content",12),u(143,mt,6,1,"div"),o(144,"div")(145,"h4",37),n(146,"Available Amenities"),i(),o(147,"div",38),h(148,st,2,3,"button",39,R),i()()()(),o(150,"mat-card",40)(151,"mat-card-header")(152,"mat-icon",41),n(153,"accessible"),i(),o(154,"mat-card-title"),n(155,"Accessibility Features"),i(),o(156,"mat-card-subtitle"),n(157,"Select accessibility features available in this room"),i()(),o(158,"mat-card-content",12)(159,"div",42)(160,"div",43)(161,"mat-checkbox",44)(162,"span",45)(163,"mat-icon",46),n(164,"accessible"),i(),n(165," Wheelchair Accessible "),i()()(),o(166,"div",43)(167,"mat-checkbox",47)(168,"span",45)(169,"mat-icon",46),n(170,"hearing"),i(),n(171," Hearing Accessible "),i()()(),o(172,"div",43)(173,"mat-checkbox",48)(174,"span",45)(175,"mat-icon",46),n(176,"visibility"),i(),n(177," Visually Accessible "),i()()(),o(178,"div",43)(179,"mat-checkbox",49)(180,"span",45)(181,"mat-icon",46),n(182,"shower"),i(),n(183," Roll-in Shower "),i()()(),o(184,"div",43)(185,"mat-checkbox",50)(186,"span",45)(187,"mat-icon",46),n(188,"support"),i(),n(189," Grab Bars "),i()()()()()(),o(190,"mat-card",51)(191,"mat-card-header")(192,"mat-icon",52),n(193,"star"),i(),o(194,"mat-card-title"),n(195,"Room Features"),i(),o(196,"mat-card-subtitle"),n(197,"Select the features available in this room"),i()(),o(198,"mat-card-content",12)(199,"div",53)(200,"div",43)(201,"mat-checkbox",54)(202,"span",45)(203,"mat-icon",46),n(204,"balcony"),i(),n(205," Balcony "),i()()(),o(206,"div",43)(207,"mat-checkbox",55)(208,"span",45)(209,"mat-icon",46),n(210,"kitchen"),i(),n(211," Kitchen "),i()()(),o(212,"div",43)(213,"mat-checkbox",56)(214,"span",45)(215,"mat-icon",46),n(216,"bathtub"),i(),n(217," Bathtub "),i()()(),o(218,"div",43)(219,"mat-checkbox",57)(220,"span",45)(221,"mat-icon",46),n(222,"ac_unit"),i(),n(223," A/C "),i()()(),o(224,"div",43)(225,"mat-checkbox",58)(226,"span",45)(227,"mat-icon",46),n(228,"wifi"),i(),n(229," WiFi "),i()()(),o(230,"div",43)(231,"mat-checkbox",59)(232,"span",45)(233,"mat-icon",46),n(234,"tv"),i(),n(235," Television "),i()()(),o(236,"div",43)(237,"mat-checkbox",60)(238,"span",45)(239,"mat-icon",46),n(240,"waves"),i(),n(241," Ocean View "),i()()(),o(242,"div",43)(243,"mat-checkbox",61)(244,"span",45)(245,"mat-icon",46),n(246,"location_city"),i(),n(247," City View "),i()()()()()(),o(248,"mat-card",10)(249,"mat-card-header")(250,"mat-icon",33),n(251,"photo_library"),i(),o(252,"mat-card-title"),n(253,"Room Photos"),i(),o(254,"mat-card-subtitle"),n(255,"Upload photos to showcase this room"),i()(),o(256,"mat-card-content",12)(257,"div",62)(258,"input",63,0),b("change",function(m){C(e);let c=s();return y(c.onPhotosSelected(m))}),i(),o(260,"div",64)(261,"div",65)(262,"mat-icon",66),n(263,"cloud_upload"),i()(),o(264,"div")(265,"button",67),b("click",function(){C(e);let m=D(259);return y(m.click())}),n(266," Choose photos to upload "),i(),o(267,"p",68),n(268,"or drag and drop images here"),i()(),o(269,"p",69),n(270,"PNG, JPG, WEBP up to 10MB each"),i()()(),u(271,ft,7,2,"div",64),u(272,xt,6,1,"div",64),i()(),o(273,"mat-card",10)(274,"mat-card-header")(275,"mat-icon",70),n(276,"notes"),i(),o(277,"mat-card-title"),n(278,"Additional Notes"),i()(),o(279,"mat-card-content",12)(280,"div")(281,"mat-form-field",14)(282,"mat-label"),n(283,"General Notes"),i(),p(284,"textarea",71),i()(),o(285,"div")(286,"mat-form-field",14)(287,"mat-label"),n(288,"Maintenance Notes"),i(),p(289,"textarea",72),i()()()()()()}if(a&2){let e=s();l(),d("formGroup",e.roomForm),l(16),f(e.isFieldInvalid("roomNumber")?17:-1),l(19),x(e.roomTypes()),l(2),f(e.isFieldInvalid("roomType")?38:-1),l(6),d("value",null),l(2),x(e.floorOptions),l(8),x(e.sizeOptions),l(9),x(e.bedConfigurationOptions),l(17),f(e.isFieldInvalid("capacity")?80:-1),l(8),f(e.isFieldInvalid("maxOccupancy")?88:-1),l(8),f(e.isFieldInvalid("priceOverride")?96:-1),l(7),x(e.viewTypeOptions),l(7),x(e.qualityRatingOptions),l(15),x(e.roomStatusOptions),l(7),x(e.housekeepingStatusOptions),l(11),f(e.getSelectedAmenities().length>0?143:-1),l(5),x(e.amenitiesOptions),l(123),f(e.selectedFiles.length>0?271:-1),l(),f(e.isEditMode()&&e.existingPhotos().length>0?272:-1)}}var ze=class a{destroy$=new V;fb=S(ve);router=S(H);route=S(W);roomsService=S(Pe);storeStore=S(Y);snackBar=S(Q);http=S(j);loading=F(!1);saving=F(!1);uploading=F(!1);roomTypes=F([]);currentRoom=F(null);selectedFiles=[];existingPhotos=F([]);isEditMode=M(()=>!!this.currentRoom());pageTitle=M(()=>this.isEditMode()?"Edit Room":"Create New Room");submitButtonText=M(()=>this.saving()?"Saving...":this.isEditMode()?"Update Room":"Create Room");roomForm;roomStatusOptions=[{value:"available",label:"Available",color:"green"},{value:"occupied",label:"Occupied",color:"purple"},{value:"maintenance",label:"Maintenance",color:"orange"},{value:"cleaning",label:"Cleaning",color:"cyan"},{value:"out_of_order",label:"Out of Order",color:"red"}];housekeepingStatusOptions=[{value:"clean",label:"Clean",color:"green"},{value:"dirty",label:"Dirty",color:"orange"},{value:"inspected",label:"Inspected",color:"cyan"},{value:"out_of_order",label:"Out of Order",color:"red"}];viewTypeOptions=De;bedConfigurationOptions=qe;amenitiesOptions=Be;floorOptions=Array.from({length:20},(t,e)=>({value:e+1,label:`Floor ${e+1}`}));sizeOptions=[{value:"small",label:"Small (< 200 sq ft)"},{value:"medium",label:"Medium (200-400 sq ft)"},{value:"large",label:"Large (400-600 sq ft)"},{value:"extra-large",label:"Extra Large (> 600 sq ft)"}];convertSizeToNumber(t){return{small:150,medium:300,large:500,"extra-large":700}[t]||300}convertSizeToString(t){return t<200?"small":t<400?"medium":t<600?"large":"extra-large"}qualityRatingOptions=[{value:1,label:"1 Star"},{value:2,label:"2 Stars"},{value:3,label:"3 Stars"},{value:4,label:"4 Stars"},{value:5,label:"5 Stars"}];ngOnInit(){this.initializeForm(),this.loadRoomTypes(),this.checkForEditMode()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}initializeForm(){this.roomForm=this.fb.group({roomNumber:["",[g.required,g.pattern(/^[A-Za-z0-9\-_]+$/)]],name:[""],description:[""],roomType:["",g.required],floor:[null],size:["medium"],bedConfiguration:[""],capacity:[2,[g.min(1),g.max(20)]],maxOccupancy:[2,[g.min(1),g.max(20)]],priceOverride:[null,[g.min(0)]],viewType:["interior"],qualityRating:[3,[g.min(1),g.max(5)]],status:["available",g.required],housekeepingStatus:["clean",g.required],notes:[""],maintenanceNotes:[""],amenities:[[]],features:this.fb.group({hasBalcony:[!1],hasKitchen:[!1],hasBathtub:[!1],hasAirConditioning:[!1],hasWifi:[!1],hasTV:[!1],oceanView:[!1],cityView:[!1]}),accessibilityFeatures:this.fb.group({wheelchairAccessible:[!1],hearingAccessible:[!1],visuallyAccessible:[!1],rollInShower:[!1],grabBars:[!1]})})}loadRoomTypes(){let t=this.storeStore.selectedStore()?._id;if(!t){this.showError("No store selected");return}this.loading.set(!0),this.roomsService.getRoomTypes(t).pipe(E(this.destroy$)).subscribe({next:e=>{this.roomTypes.set(e.filter(r=>r.active)),this.loading.set(!1)},error:e=>{this.showError("Failed to load room types"),this.loading.set(!1)}})}checkForEditMode(){let t=this.route.snapshot.paramMap.get("id");t&&(this.loading.set(!0),this.roomsService.getRoom(t).pipe(E(this.destroy$)).subscribe({next:e=>{this.currentRoom.set(e),this.populateForm(e),this.loading.set(!1)},error:e=>{this.showError("Failed to load room details"),this.router.navigate(["../"],{relativeTo:this.route})}}))}populateForm(t){let e=typeof t.roomType=="string"?t.roomType:t.roomType._id;this.roomForm.patchValue({roomNumber:t.roomNumber,name:t.name||"",description:t.description||"",roomType:e,floor:t.floor||null,size:t.size?this.convertSizeToString(t.size):"medium",bedConfiguration:t.bedConfiguration||"",capacity:t.capacity||2,maxOccupancy:t.maxOccupancy||t.capacity||2,priceOverride:t.priceOverride||null,viewType:t.viewType||"interior",qualityRating:t.qualityRating||3,status:t.status,housekeepingStatus:t.housekeepingStatus,notes:t.notes||"",maintenanceNotes:t.maintenanceNotes||"",amenities:t.amenities||[],features:{hasBalcony:t.features.hasBalcony||!1,hasKitchen:t.features.hasKitchen||!1,hasBathtub:t.features.hasBathtub||!1,hasAirConditioning:t.features.hasAirConditioning||!1,hasWifi:t.features.hasWifi||!1,hasTV:t.features.hasTV||!1,oceanView:t.features.oceanView||!1,cityView:t.features.cityView||!1},accessibilityFeatures:{wheelchairAccessible:t.accessibilityFeatures?.wheelchairAccessible||!1,hearingAccessible:t.accessibilityFeatures?.hearingAccessible||!1,visuallyAccessible:t.accessibilityFeatures?.visuallyAccessible||!1,rollInShower:t.accessibilityFeatures?.rollInShower||!1,grabBars:t.accessibilityFeatures?.grabBars||!1}}),this.existingPhotos.set(t.photos||[])}onPhotosSelected(t){let e=t.target;e.files&&this.processSelectedFiles(Array.from(e.files))}processSelectedFiles(t){this.selectedFiles=[],t.forEach(e=>{if(e.type.startsWith("image/")){let r=new FileReader;r.onload=m=>{this.selectedFiles.push({file:e,name:e.name,preview:m.target?.result})},r.readAsDataURL(e)}})}removeSelectedFile(t){this.selectedFiles.splice(t,1)}uploadPhotos(){if(this.selectedFiles.length===0)return;this.uploading.set(!0);let t=new FormData;if(this.selectedFiles.forEach(e=>{t.append("files",e.file)}),this.isEditMode()){let e=this.currentRoom()?._id;e&&this.http.post(`${N.apiUrl}/rooms/upload/${e}`,t).pipe(E(this.destroy$)).subscribe({next:r=>{this.showSuccess("Photos uploaded successfully"),this.selectedFiles=[];let m=[...this.existingPhotos(),...r.photos];this.existingPhotos.set(m),this.uploading.set(!1)},error:r=>{this.showError("Failed to upload photos: "+(r.error?.message||r.message)),this.uploading.set(!1)}})}else this.showError("Please save the room first before uploading photos"),this.uploading.set(!1)}uploadPhotosForNewRoom(t){if(this.selectedFiles.length===0){this.router.navigate(["../"],{relativeTo:this.route});return}let e=new FormData;this.selectedFiles.forEach(r=>{e.append("files",r.file)}),this.http.post(`${N.apiUrl}/rooms/upload/${t}`,e).pipe(E(this.destroy$)).subscribe({next:r=>{this.showSuccess("Room created and photos uploaded successfully"),this.router.navigate(["../"],{relativeTo:this.route})},error:r=>{this.showError("Room created but photo upload failed: "+(r.error?.message||r.message)),this.router.navigate(["../"],{relativeTo:this.route})}})}removeExistingPhoto(t){let e=this.currentRoom()?._id;e&&this.http.delete(`${N.apiUrl}/rooms/${e}/photo`,{body:{photoUrl:t}}).pipe(E(this.destroy$)).subscribe({next:()=>{let r=this.existingPhotos().filter(m=>m!==t);this.existingPhotos.set(r),this.showSuccess("Photo removed successfully")},error:r=>{this.showError("Failed to remove photo: "+(r.error?.message||r.message))}})}onSubmit(){if(this.roomForm.invalid){this.markFormGroupTouched(this.roomForm);return}let t=this.storeStore.selectedStore()?._id;if(!t){this.showError("No store selected");return}this.saving.set(!0);let e=this.roomForm.value,r={roomType:e.roomType,roomNumber:e.roomNumber,name:e.name,description:e.description,floor:e.floor,size:this.convertSizeToNumber(e.size),bedConfiguration:e.bedConfiguration,capacity:e.capacity,maxOccupancy:e.maxOccupancy,priceOverride:e.priceOverride,viewType:e.viewType,qualityRating:e.qualityRating,status:e.status,housekeepingStatus:e.housekeepingStatus,notes:e.notes,maintenanceNotes:e.maintenanceNotes,amenities:e.amenities,features:e.features,accessibilityFeatures:e.accessibilityFeatures};(this.isEditMode()?this.roomsService.updateRoom(this.currentRoom()._id,r):this.roomsService.createRoom(t,r)).pipe(E(this.destroy$)).subscribe({next:c=>{let k=this.isEditMode()?"Room updated successfully":"Room created successfully";if(this.showSuccess(k),!this.isEditMode()&&this.selectedFiles.length>0){let O=c._id||c.id;O?this.uploadPhotosForNewRoom(O):this.router.navigate(["../"],{relativeTo:this.route})}else this.router.navigate(["../"],{relativeTo:this.route})},error:c=>{let k=this.isEditMode()?"Failed to update room":"Failed to create room";this.showError(k+": "+(c.error?.message||c.message)),this.saving.set(!1)}})}onCancel(){this.router.navigate(["../"],{relativeTo:this.route})}markFormGroupTouched(t){Object.keys(t.controls).forEach(e=>{let r=t.get(e);r instanceof de?this.markFormGroupTouched(r):r?.markAsTouched()})}showSuccess(t){this.snackBar.open(t,"Close",{duration:3e3,panelClass:["success-snackbar"]})}showError(t){this.snackBar.open(t,"Close",{duration:5e3,panelClass:["error-snackbar"]})}isFieldInvalid(t){let e=this.roomForm.get(t);return!!(e&&e.invalid&&e.touched)}getFieldError(t){let e=this.roomForm.get(t);if(e?.errors){if(e.errors.required)return`${t} is required`;if(e.errors.pattern)return`${t} format is invalid`;if(e.errors.min)return`${t} must be greater than ${e.errors.min.min}`;if(e.errors.max)return`${t} must be less than ${e.errors.max.max}`}return""}getRoomTypeName(t){return this.roomTypes().find(r=>r._id===t||r.id===t)?.name||"Unknown"}toggleAmenity(t){let e=this.roomForm.get("amenities")?.value||[],r=e.indexOf(t),m;r>-1?m=e.filter(c=>c!==t):m=[...e,t],this.roomForm.patchValue({amenities:m})}isAmenitySelected(t){return(this.roomForm.get("amenities")?.value||[]).includes(t)}removeAmenity(t){let r=(this.roomForm.get("amenities")?.value||[]).filter(m=>m!==t);this.roomForm.patchValue({amenities:r})}getSelectedAmenities(){return this.roomForm.get("amenities")?.value||[]}static \u0275fac=function(e){return new(e||a)};static \u0275cmp=$({type:a,selectors:[["app-room-form"]],decls:12,vars:7,consts:[["fileInput",""],[3,"title","subtitle"],["actions",""],["mat-stroked-button","",3,"click"],["mat-flat-button","","color","primary","type","submit","form","roomForm",3,"disabled"],["diameter","20"],[1,"flex","justify-center","items-center","py-16"],[1,"max-w-4xl","mx-auto","py-8"],["diameter","40"],["id","roomForm",1,"space-y-6",3,"ngSubmit","formGroup"],["appearance","outlined"],["mat-card-avatar","",1,"text-blue-600"],[1,"p-6!","space-y-6"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-6"],["appearance","outline",1,"w-full"],["matInput","","formControlName","roomNumber","placeholder","e.g., 101, A-201"],["matSuffix","",1,"text-gray-400"],["matInput","","formControlName","name","placeholder","e.g., Ocean Suite, Presidential Room"],["matInput","","formControlName","description","rows","2","placeholder","Brief description of the room..."],["formControlName","roomType"],[3,"value"],["formControlName","floor"],["formControlName","size"],["formControlName","bedConfiguration"],["value",""],["mat-card-avatar","",1,"text-green-600"],[1,"grid","grid-cols-1","md:grid-cols-3","gap-6"],["matInput","","type","number","formControlName","capacity","min","1","max","20"],["matInput","","type","number","formControlName","maxOccupancy","min","1","max","20"],["matInput","","type","number","formControlName","priceOverride","min","0","step","0.01","placeholder","Leave empty to use room type price"],["matPrefix",""],["formControlName","viewType"],["formControlName","qualityRating"],["mat-card-avatar","",1,"text-purple-600"],["formControlName","status"],["formControlName","housekeepingStatus"],["mat-card-avatar","",1,"text-indigo-600"],[1,"text-sm","font-medium","text-gray-700","mb-3"],[1,"grid","grid-cols-2","md:grid-cols-3","lg:grid-cols-4","gap-3"],["type","button",1,"flex","items-center","justify-center","p-3","border","rounded-lg","text-sm","font-medium","transition-all","duration-200",3,"class"],["appearance","outlined","formGroupName","accessibilityFeatures"],["mat-card-avatar","",1,"text-teal-600"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4"],[1,"flex","items-center"],["formControlName","wheelchairAccessible",1,"text-teal-600"],[1,"flex","items-center","gap-2"],[1,"text-lg","text-gray-600"],["formControlName","hearingAccessible",1,"text-teal-600"],["formControlName","visuallyAccessible",1,"text-teal-600"],["formControlName","rollInShower",1,"text-teal-600"],["formControlName","grabBars",1,"text-teal-600"],["appearance","outlined","formGroupName","features"],["mat-card-avatar","",1,"text-amber-600"],[1,"grid","grid-cols-2","md:grid-cols-4","gap-4"],["formControlName","hasBalcony",1,"text-blue-600"],["formControlName","hasKitchen",1,"text-blue-600"],["formControlName","hasBathtub",1,"text-blue-600"],["formControlName","hasAirConditioning",1,"text-blue-600"],["formControlName","hasWifi",1,"text-blue-600"],["formControlName","hasTV",1,"text-blue-600"],["formControlName","oceanView",1,"text-blue-600"],["formControlName","cityView",1,"text-blue-600"],[1,"border-2","border-dashed","border-gray-300","rounded-lg","p-6","text-center","hover:border-blue-400","transition-colors","duration-200"],["type","file","multiple","","accept","image/*",1,"hidden",3,"change"],[1,"space-y-3"],[1,"w-16","h-16","bg-gray-100","rounded-full","flex","items-center","justify-center","mx-auto"],[1,"text-3xl","text-gray-400"],["type","button",1,"text-blue-600","hover:text-blue-700","font-medium",3,"click"],[1,"text-sm","text-gray-500","mt-1"],[1,"text-xs","text-gray-400"],["mat-card-avatar","",1,"text-orange-600"],["matInput","","formControlName","notes","rows","3","placeholder","Any special notes about this room..."],["matInput","","formControlName","maintenanceNotes","rows","3","placeholder","Maintenance history or special requirements..."],[1,"flex","items-center","justify-between","w-full"],[1,"text-sm","text-gray-500"],[1,"text-gray-500"],[1,"flex"],[1,"text-yellow-400","text-sm"],[1,"w-3","h-3","rounded-full","mr-3","ring-2",3,"ngClass"],[1,"flex","flex-wrap","gap-2"],[1,"flex","items-center","gap-2","bg-blue-100","text-blue-800","px-3","py-1","rounded-full","text-sm"],["type","button",1,"w-4","h-4","flex","items-center","justify-center","hover:bg-blue-200","rounded-full",3,"click"],[1,"text-xs"],["type","button",1,"flex","items-center","justify-center","p-3","border","rounded-lg","text-sm","font-medium","transition-all","duration-200",3,"click"],[1,"text-sm","font-medium","text-gray-700"],[1,"grid","grid-cols-2","md:grid-cols-3","gap-3"],[1,"relative","group"],["type","button",1,"w-full","px-4","py-2","bg-blue-600","text-white","rounded-lg","hover:bg-blue-700","disabled:bg-gray-400","disabled:cursor-not-allowed","transition-colors","duration-200","flex","items-center","justify-center","gap-2",3,"disabled"],[1,"aspect-square","rounded-lg","overflow-hidden","bg-gray-100"],[1,"w-full","h-full","object-cover",3,"src","alt"],["type","button",1,"absolute","top-2","right-2","w-6","h-6","bg-red-500","text-white","rounded-full","flex","items-center","justify-center","opacity-0","group-hover:opacity-100","transition-opacity","duration-200","hover:bg-red-600",3,"click"],[1,"text-sm"],[1,"absolute","bottom-0","left-0","right-0","bg-black","bg-opacity-50","text-white","text-xs","p-2","truncate"],["type","button",1,"w-full","px-4","py-2","bg-blue-600","text-white","rounded-lg","hover:bg-blue-700","disabled:bg-gray-400","disabled:cursor-not-allowed","transition-colors","duration-200","flex","items-center","justify-center","gap-2",3,"click","disabled"],["diameter","16"]],template:function(e,r){e&1&&(o(0,"app-page-header",1),P(1,2),o(2,"button",3),b("click",function(){return r.onCancel()}),o(3,"mat-icon"),n(4,"close"),i(),n(5," Cancel "),i(),o(6,"button",4),u(7,je,1,0,"mat-spinner",5)(8,We,2,0,"mat-icon"),n(9),i(),B(),i(),u(10,He,2,0,"div",6),u(11,gt,290,10,"div",7)),e&2&&(d("title",r.pageTitle())("subtitle",r.isEditMode()?"Update room information and settings":"Add a new room to your hotel inventory"),l(6),d("disabled",r.saving()||r.loading()),l(),f(r.saving()?7:8),l(2),_(" ",r.submitButtonText()," "),l(),f(r.loading()?10:-1),l(),f(r.loading()?-1:11))},dependencies:[U,G,_e,ce,le,pe,me,se,ge,xe,he,fe,ue,Fe,Ee,be,Ce,ye,Se,we,Te,ke,Ne,L,$e,Ve,J,K,X,Z,re,ee,ae,ie,ne,oe,te,Ie,Ae,Me,Re,Oe],encapsulation:2})};export{ze as RoomFormComponent};
