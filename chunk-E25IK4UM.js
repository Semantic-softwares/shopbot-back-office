import{a as G}from"./chunk-364PT26L.js";import{a as te}from"./chunk-M7CDMT4F.js";import{a as j,b as Yt,c as Zt}from"./chunk-GYR27UWT.js";import{a as L,b as $}from"./chunk-4FCLVNHT.js";import{a as Xt}from"./chunk-ONWZVE76.js";import{a as H,b as Kt}from"./chunk-4XAEWKNS.js";import{a as qt,b as At,c as Ht,d as jt,e as Gt,f as Lt,g as $t,h as zt,i as Qt,j as Wt,k as Ut,l as Jt}from"./chunk-SNJMCTTD.js";import"./chunk-YCI4GSMN.js";import{b as Dt}from"./chunk-XPW44I4H.js";import"./chunk-2NVE2BM3.js";import{a as B,b as q}from"./chunk-W6FIBOPD.js";import{b as P,c as R,d as N}from"./chunk-7JNU3RG5.js";import{a as w}from"./chunk-GGWIF4RR.js";import{a as Pt,b as Rt,c as Nt,e as Vt,h as Bt}from"./chunk-GS72R6E5.js";import"./chunk-GGOIOYKP.js";import"./chunk-LXK533WH.js";import{a as Tt,b as It,c as kt,d as Ft}from"./chunk-EMC432UM.js";import{a as A}from"./chunk-PQXLVIGM.js";import"./chunk-ZXNLXZXA.js";import"./chunk-KAQLA7HR.js";import"./chunk-Y7XAAAUB.js";import{e as wt}from"./chunk-TRTRKQKZ.js";import"./chunk-5WBVJVYM.js";import{a as vt,c as xt,g as Ot}from"./chunk-X7SU23UW.js";import{a as k,b as yt,h as F}from"./chunk-3SKQMCZR.js";import{C as ht,D as Mt,E as bt,b as T,d as M,g as I,h as ct,l as ut,m as ft,n as _t,s as gt,t as Ct,y as St}from"./chunk-EQD33MW2.js";import"./chunk-UJ5WOJLI.js";import"./chunk-3R2L4BJM.js";import"./chunk-Y4VWLT32.js";import"./chunk-CDKFCYZ5.js";import{b as Et,c as V}from"./chunk-2HLT5ZQQ.js";import{X as dt,Y as E,_ as D}from"./chunk-UUZHPQZB.js";import"./chunk-CQ6SLR32.js";import"./chunk-C3MGKPDK.js";import"./chunk-KTA4MFBX.js";import{r as pt,t as st}from"./chunk-HUSU2JWO.js";import{Bc as at,Eb as f,Fb as _,Hc as lt,Jc as mt,Kb as d,Lb as r,Mb as n,Nb as s,Rb as S,Sb as h,Ub as z,V as tt,Yb as u,Za as m,_b as C,ca as c,cc as Q,dc as W,ec as U,gb as O,ha as v,ia as x,ic as it,mb as y,nc as a,oc as J,pc as K,sb as g,sc as ot,ta as et,tc as nt,uc as rt}from"./chunk-HCNG3XRF.js";import{a as Y,b as Z}from"./chunk-EQDQRRRY.js";function pe(t,e){t&1&&(r(0,"mat-error"),a(1," Name is required "),n())}function se(t,e){t&1&&(r(0,"mat-error"),a(1," Price is required "),n())}function de(t,e){t&1&&(r(0,"mat-error"),a(1," Price must be 0 or greater "),n())}function ce(t,e){t&1&&s(0,"mat-spinner",12)}var b=class t{constructor(e,i,o){this.fb=e;this.dialogRef=i;this.data=o;this.optionForm=this.fb.group({name:["",M.required],price:[0,[M.required,M.min(0)]],inStock:[!0],store:[this.storeStore.selectedStore()?._id,M.required]}),o.isEdit&&o.option&&this.optionForm.patchValue(o.option)}productService=c(G);storeStore=c(A);snackBar=c(w);isSubmitting=et(!1);optionForm;onSubmit(){if(this.optionForm.valid){this.isSubmitting.set(!0);let e=this.optionForm.getRawValue();(this.data.isEdit?this.productService.updateOption(e,this.data.option._id):this.productService.saveOption(e)).subscribe({next:()=>{this.snackBar.open(`Option ${this.data.isEdit?"updated":"created"} successfully`,"Close",{duration:3e3,horizontalPosition:"end",verticalPosition:"top"}),this.dialogRef.close(!0)},error:()=>{this.snackBar.open(`Error ${this.data.isEdit?"updating":"creating"} option`,"Close",{duration:3e3,horizontalPosition:"end",verticalPosition:"top"}),this.isSubmitting.set(!1)}})}}onCancel(){this.dialogRef.close()}static \u0275fac=function(i){return new(i||t)(O(ht),O(Pt),O(Rt))};static \u0275cmp=y({type:t,selectors:[["app-option-dialog"]],decls:25,vars:8,consts:[[1,"p-6"],["mat-dialog-title","",1,"text-xl","font-bold","mb-4"],[3,"ngSubmit","formGroup"],[1,"space-y-4"],["appearance","outline",1,"w-full"],["matInput","","formControlName","name","placeholder","Enter option name"],["matInput","","type","number","formControlName","price","min","0"],[1,"flex","items-center","p-4","bg-gray-50","rounded-lg"],["formControlName","inStock","color","primary"],[1,"flex","justify-end","space-x-2","mt-6","pt-4","border-t","border-gray-200"],["mat-button","","type","button",3,"click"],["mat-raised-button","","color","primary","type","submit",3,"disabled"],["diameter","20",1,"mr-2"]],template:function(i,o){if(i&1&&(r(0,"div",0)(1,"h2",1),a(2),n(),r(3,"form",2),u("ngSubmit",function(){return o.onSubmit()}),r(4,"div",3)(5,"mat-form-field",4)(6,"mat-label"),a(7,"Name"),n(),s(8,"input",5),f(9,pe,2,0,"mat-error"),n(),r(10,"mat-form-field",4)(11,"mat-label"),a(12,"Price"),n(),s(13,"input",6),f(14,se,2,0,"mat-error"),f(15,de,2,0,"mat-error"),n(),r(16,"div",7)(17,"mat-slide-toggle",8),a(18," In Stock "),n()()(),r(19,"div",9)(20,"button",10),u("click",function(){return o.onCancel()}),a(21,"Cancel"),n(),r(22,"button",11),f(23,ce,1,0,"mat-spinner",12),a(24),n()()()()),i&2){let l,p,X;m(2),K(" ",o.data.isEdit?"Edit Option":"Create New Option"," "),m(),d("formGroup",o.optionForm),m(6),_((l=o.optionForm.get("name"))!=null&&l.hasError("required")?9:-1),m(5),_((p=o.optionForm.get("price"))!=null&&p.hasError("required")?14:-1),m(),_((X=o.optionForm.get("price"))!=null&&X.hasError("min")?15:-1),m(7),d("disabled",!o.optionForm.valid||o.isSubmitting()),m(),_(o.isSubmitting()?23:-1),m(),K(" ",o.data.isEdit?"Update":"Create"," ")}},dependencies:[Bt,Vt,P,F,k,yt,N,R,D,E,Dt,V,bt,ft,T,_t,I,ct,St,Ct,gt,q,B,$,L],encapsulation:2})};var ue=()=>[5,10,25,100];function fe(t,e){t&1&&(r(0,"div",9),s(1,"mat-spinner",13),n())}function _e(t,e){t&1&&s(0,"app-no-record",10)}function ge(t,e){t&1&&s(0,"app-no-record",11)}function Ce(t,e){t&1&&(r(0,"th",26),a(1,"Name"),n())}function Se(t,e){if(t&1&&(r(0,"td",27),a(1),n()),t&2){let i=e.$implicit;m(),J(i.name)}}function he(t,e){t&1&&(r(0,"th",26),a(1,"Price"),n())}function Me(t,e){if(t&1&&(r(0,"td",27),a(1),lt(2,"currency"),n()),t&2){let i,o=e.$implicit,l=C(2);m(),J(mt(2,1,o.price,(i=l.storeStore.selectedStore())==null?null:i.currency))}}function be(t,e){t&1&&(r(0,"th",28),a(1,"In Stock"),n())}function ve(t,e){if(t&1){let i=z();r(0,"td",27)(1,"mat-slide-toggle",29),u("change",function(){let l=v(i).$implicit,p=C(2);return x(p.toggleInStock(l))}),n()()}if(t&2){let i=e.$implicit;m(),d("checked",i.inStock)}}function xe(t,e){t&1&&(r(0,"th",30),a(1,"Actions"),n())}function Oe(t,e){if(t&1){let i=z();r(0,"td",27)(1,"button",31)(2,"mat-icon"),a(3,"more_vert"),n()(),r(4,"mat-menu",null,0)(6,"button",32),u("click",function(){let l=v(i).$implicit,p=C(2);return x(p.editOption(l))}),r(7,"mat-icon"),a(8,"edit"),n(),r(9,"span"),a(10,"Edit"),n()(),r(11,"button",32),u("click",function(){let l=v(i).$implicit,p=C(2);return x(p.deleteOption(l))}),r(12,"mat-icon"),a(13,"delete"),n(),r(14,"span"),a(15,"Delete"),n()()()()}if(t&2){let i=it(5);m(),d("matMenuTriggerFor",i)}}function ye(t,e){t&1&&s(0,"tr",33)}function Ee(t,e){t&1&&s(0,"tr",34)}function De(t,e){if(t&1&&(r(0,"div",12)(1,"table",14),S(2,15),g(3,Ce,2,0,"th",16)(4,Se,2,1,"td",17),h(),S(5,18),g(6,he,2,0,"th",16)(7,Me,3,4,"td",17),h(),S(8,19),g(9,be,2,0,"th",20)(10,ve,2,1,"td",17),h(),S(11,21),g(12,xe,2,0,"th",22)(13,Oe,16,1,"td",17),h(),g(14,ye,1,0,"tr",23)(15,Ee,1,0,"tr",24),n(),s(16,"mat-paginator",25),n()),t&2){let i=C();m(),d("dataSource",i.dataSource),m(13),d("matHeaderRowDef",i.displayedColumns),m(),d("matRowDefColumns",i.displayedColumns),m(),d("pageSizeOptions",at(4,ue))}}var ee=class t{displayedColumns=["name","price","inStock","actions"];dataSource;searchText="";dialog=c(Nt);productService=c(G);storeStore=c(A);snackBar=c(w);paginator;sort;options=wt({params:()=>({storeId:this.storeStore.selectedStore()?._id}),stream:({params:e})=>this.productService.getStoreOptions(e.storeId).pipe(tt(i=>{this.dataSource=new Jt(i),this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort}))});applyFilter(e){let i=e.target.value;this.dataSource.filter=i.trim().toLowerCase()}openDialog(){this.dialog.open(b,{width:"500px",data:{isEdit:!1}}).afterClosed().subscribe(i=>{i&&this.options.reload()})}editOption(e){this.dialog.open(b,{width:"500px",data:{isEdit:!0,option:e}}).afterClosed().subscribe(o=>{o&&this.options.reload()})}deleteOption(e){this.dialog.open(te,{width:"350px",data:{message:`Are you sure you want to delete ${e.name}?`}}).afterClosed().subscribe(o=>{o&&this.productService.deleteOptionItem(e._id).subscribe({next:()=>{this.options.reload()}})})}toggleInStock(e){let i=Z(Y({},e),{inStock:!e.inStock});this.productService.updateOption(i,e._id).subscribe({next:()=>{this.snackBar.open("Option status updated successfully","Close",{duration:3e3,horizontalPosition:"end",verticalPosition:"top"}),this.options.reload()},error:()=>{this.snackBar.open("Error updating option status","Close",{duration:3e3,horizontalPosition:"end",verticalPosition:"top"})}})}static \u0275fac=function(i){return new(i||t)};static \u0275cmp=y({type:t,selectors:[["app-options"]],viewQuery:function(i,o){if(i&1&&(Q(H,5),Q(j,5)),i&2){let l;W(l=U())&&(o.paginator=l.first),W(l=U())&&(o.sort=l.first)}},decls:17,vars:2,consts:[["menu","matMenu"],[1,"options-container","!bg-white"],[1,"!bg-white"],[1,"flex","items-center","space-x-4","p-4"],[1,"w-80"],["appearance","outline",1,"w-full"],["matInput","","placeholder","Search options",3,"keyup","ngModelChange","ngModel"],[1,"flex-shrink-0","ml-auto"],["mat-raised-button","","color","primary",1,"h-[48px]","px-6","font-medium",3,"click"],[1,"flex","items-center","justify-center","min-h-[300px]"],["icon","error","title","Error","message","An error occurred while fetching options. Please try again later."],["icon","list","title","No Options","message","No options found matching your criteria."],[1,"table-container","!bg-white"],["diameter","40"],["mat-table","","matSort","",1,"!bg-white",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","price"],["matColumnDef","inStock"],["mat-header-cell","",4,"matHeaderCellDef"],["matColumnDef","actions"],["mat-header-cell","","class","w-20",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["aria-label","Select page of options",1,"!bg-white",3,"pageSizeOptions"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],["mat-header-cell",""],["color","primary",3,"change","checked"],["mat-header-cell","",1,"w-20"],["mat-icon-button","","aria-label","Option actions",3,"matMenuTriggerFor"],["mat-menu-item","",3,"click"],["mat-header-row",""],["mat-row",""]],template:function(i,o){i&1&&(r(0,"mat-card",1)(1,"mat-card-content",2)(2,"div",3)(3,"div",4)(4,"mat-form-field",5)(5,"mat-label"),a(6,"Search"),n(),r(7,"input",6),u("keyup",function(p){return o.applyFilter(p)}),rt("ngModelChange",function(p){return nt(o.searchText,p)||(o.searchText=p),p}),n()()(),r(8,"div",7)(9,"button",8),u("click",function(){return o.openDialog()}),r(10,"mat-icon"),a(11,"add"),n(),a(12," ADD OPTION "),n()()(),f(13,fe,2,0,"div",9)(14,_e,1,0,"app-no-record",10)(15,ge,1,0,"app-no-record",11)(16,De,17,5,"div",12),n()()),i&2&&(m(7),ot("ngModel",o.searchText),m(6),_(o.options.isLoading()?13:o.options.error()?14:o.options.hasValue()&&o.dataSource.data.length===0?15:o.options.hasValue()?16:-1))},dependencies:[st,Ut,qt,Ht,$t,jt,At,zt,Gt,Lt,Qt,Wt,Kt,H,Zt,j,Yt,Ot,vt,xt,P,F,k,N,R,D,E,dt,V,Et,Ft,It,Tt,kt,q,B,Xt,Mt,T,I,ut,$,L,pt],encapsulation:2})};export{ee as OptionsComponent};
