import{a as ne}from"./chunk-BRU3VHNH.js";import{a as oe}from"./chunk-KNO5HCLP.js";import{a as ee,b as te,c as ie}from"./chunk-FSCIILJA.js";import{a as Z}from"./chunk-JZKRHT5H.js";import{i as $}from"./chunk-QC7H4KPM.js";import{d as O}from"./chunk-R6JGHN2R.js";import{b as K,c as Q,d as X}from"./chunk-UMV4DCPT.js";import{a as q,d as H,h as J}from"./chunk-G3VZM262.js";import{b as Y}from"./chunk-6I3AJKA7.js";import{B as W,b as z,g as B,k as U,p as R}from"./chunk-W7NMJLMQ.js";import{b as k,c as j}from"./chunk-JPRPNQOM.js";import{ba as P}from"./chunk-3LDCGXHW.js";import{s as L}from"./chunk-6PFJHDFS.js";import{$c as l,H as M,Ib as c,Jb as g,L as v,Lc as F,Mb as N,Mc as E,Nb as V,Ob as f,Pb as a,Qb as r,Rb as x,U as G,V as b,W as _,Yb as T,_c as h,ac as w,bb as n,f as S,fa as p,ka as y,la as D,m as C,mc as A,qb as I,rc as s,sc as u,wa as d}from"./chunk-J2AK4FW5.js";var se=(i,e)=>e._id;function le(i,e){i&1&&(a(0,"span"),s(1,"Searching..."),r())}function ue(i,e){if(i&1&&(a(0,"mat-option",6)(1,"span",8),s(2),F(3,"getGuestName"),r(),a(4,"span",9),s(5),r()()),i&2){let t=e.$implicit;f("value",t),n(2),u(E(3,3,t)),n(3),u(t==null?null:t.email)}}function me(i,e){i&1&&(a(0,"mat-option",7),s(1,"No guests found"),r())}var ae=class i{placeholder=l("Search for guest by name or email...");label=l("Select Guest");initialValue=l("");guestType=l(void 0);guestSelected=h();searchCleared=h();guestService=p(oe);storeStore=p($);destroy$=new S;guestSearchControl=new U("");filteredGuests=d([]);isLoading=d(!1);ngOnInit(){this.initializeSearchControl()}initializeSearchControl(){this.guestSearchControl.valueChanges.pipe(G(""),M(300),v(),b(e=>{if(!e||e.length<2)return this.filteredGuests.set([]),C({guests:[],total:0,page:1,totalPages:0});this.isLoading.set(!0);let t=this.storeStore.selectedStore()?._id;return this.guestService.searchGuests(e,1,10,t)}),_(this.destroy$)).subscribe(e=>{this.filteredGuests.set(e?.guests||[]),this.isLoading.set(!1)},e=>{console.error("Error searching guests:",e),this.filteredGuests.set([]),this.isLoading.set(!1)}),this.initialValue()&&this.guestSearchControl.setValue(this.initialValue())}onGuestSelected(e){this.guestSearchControl.setValue(`${this.guestService.getGuestName(e)}`),this.guestSelected.emit(e)}onClear(){this.guestSearchControl.setValue(""),this.filteredGuests.set([]),this.searchCleared.emit()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=I({type:i,selectors:[["app-guest-search"]],inputs:{placeholder:[1,"placeholder"],label:[1,"label"],initialValue:[1,"initialValue"],guestType:[1,"guestType"]},outputs:{guestSelected:"guestSelected",searchCleared:"searchCleared"},decls:13,vars:6,consts:[["guestAutoComplete","matAutocomplete"],[1,"w-full"],["appearance","outline",1,"w-full"],["matPrefix","",1,"text-gray-500","material-icons-outlined"],["matInput","",3,"formControl","placeholder","matAutocomplete"],[3,"optionSelected"],[3,"value"],["disabled",""],[1,"font-medium"],[1,"text-sm","text-gray-500","ml-2"]],template:function(t,o){if(t&1){let m=T();a(0,"div",1)(1,"mat-form-field",2)(2,"mat-label"),s(3),r(),a(4,"mat-icon",3),s(5,"search"),r(),x(6,"input",4),c(7,le,2,0,"span"),a(8,"mat-autocomplete",5,0),w("optionSelected",function(re){return y(m),D(o.onGuestSelected(re.option.value))}),N(10,ue,6,5,"mat-option",6,se),c(12,me,2,0,"mat-option",7),r()()()}if(t&2){let m=A(9);n(3),u(o.label()),n(3),f("formControl",o.guestSearchControl)("placeholder",o.placeholder())("matAutocomplete",m),n(),g(o.isLoading()?7:-1),n(3),V(o.filteredGuests()),n(2),g(o.filteredGuests().length===0&&!o.isLoading()?12:-1)}},dependencies:[L,W,z,B,R,K,J,q,H,X,Q,ie,ee,O,te,j,k,Y,P,Z,ne],styles:["[_nghost-%COMP%]{display:block;width:100%}"]})};export{ae as a};
