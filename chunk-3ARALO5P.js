import{a as A}from"./chunk-CZ2MIGG7.js";import{c as le}from"./chunk-UAGP56HF.js";import"./chunk-QXGZPCFY.js";import{g as re}from"./chunk-HA7VDR7W.js";import{a as ne,b as ae}from"./chunk-7C3RSL2D.js";import{o as Y,p as ee,q as te}from"./chunk-FSA22CPB.js";import{b as oe}from"./chunk-TS4O77IX.js";import"./chunk-M2YK6UF7.js";import{H as O}from"./chunk-BVQK7CK4.js";import{a as ie}from"./chunk-AGZJ637K.js";import{c as X}from"./chunk-WTFDJO4H.js";import"./chunk-TQDHD3WD.js";import{B as K,j as W,k as Q,p as Z,q,t as J}from"./chunk-DWCYWQVU.js";import{Cc as C,E as S,Ec as D,Jb as u,Kb as t,Lb as i,Mb as f,Nc as N,Qb as U,Ub as g,Vb as E,X as p,_a as o,aa as L,ba as P,fa as v,fc as b,g as G,h as y,ic as r,jc as c,kb as M,kc as _,la as B,lb as V,lc as $,ma as F,n as x,qb as R,s as k,va as m}from"./chunk-5AECHVKR.js";import"./chunk-EQDQRRRY.js";var de=(()=>{class l{static \u0275fac=function(e){return new(e||l)};static \u0275mod=V({type:l});static \u0275inj=P({imports:[A,O,A,O]})}return l})();var T=class l{http=v(K);baseUrl=ie.apiUrl+"/analytics";dashboardStatsSubject=new y(null);dashboardStats$=this.dashboardStatsSubject.asObservable();recentActivitiesSubject=new y([]);recentActivities$=this.recentActivitiesSubject.asObservable();loadingSubject=new y(!1);loading$=this.loadingSubject.asObservable();errorSubject=new y(null);error$=this.errorSubject.asObservable();getDashboardStats(n){return this.loadingSubject.next(!0),this.errorSubject.next(null),this.http.get(`${this.baseUrl}/dashboard/${n}`).pipe(k(a=>(this.dashboardStatsSubject.next(a),this.loadingSubject.next(!1),a)),S(a=>{console.error("Error fetching dashboard stats:",a),this.errorSubject.next("Failed to load dashboard statistics"),this.loadingSubject.next(!1);let e={totalRooms:50,availableRooms:12,occupancyRate:76,checkedInGuests:38,todayCheckins:8,todayCheckouts:5,todayRevenue:4250,monthlyRevenue:125e3,lastUpdated:new Date};return this.dashboardStatsSubject.next(e),x(e)}))}getOccupancyTrend(n,a=7){return this.http.get(`${this.baseUrl}/occupancy-trend/${n}?days=${a}`).pipe(S(e=>{console.error("Error fetching occupancy trend:",e);let s=Array.from({length:a},(w,h)=>{let d=new Date;return d.setDate(d.getDate()-(a-1-h)),{date:d.toISOString().split("T")[0],occupancyRate:Math.floor(Math.random()*40)+60,occupiedRooms:Math.floor(Math.random()*20)+30,totalRooms:50}});return x(s)}))}getRevenueTrend(n,a=7){return this.http.get(`${this.baseUrl}/revenue-trend/${n}?days=${a}`).pipe(S(e=>{console.error("Error fetching revenue trend:",e);let s=Array.from({length:a},(w,h)=>{let d=new Date;return d.setDate(d.getDate()-(a-1-h)),{date:d.toISOString().split("T")[0],revenue:Math.floor(Math.random()*3e3)+2e3,reservationCount:Math.floor(Math.random()*10)+5}});return x(s)}))}getRecentActivities(n,a=10){return this.http.get(`${this.baseUrl}/recent-activities/${n}?limit=${a}`).pipe(k(e=>(this.recentActivitiesSubject.next(e),e)),S(e=>{console.error("Error fetching recent activities:",e);let s=[{id:"1",title:"John Doe checked in to room 205",icon:"check_in",type:"Check-in",time:"15m ago",timestamp:new Date(Date.now()-15*60*1e3)},{id:"2",title:"New reservation by Sarah Wilson",icon:"book_online",type:"Reservation",time:"32m ago",timestamp:new Date(Date.now()-32*60*1e3)},{id:"3",title:"Mike Johnson checked out from room 102",icon:"check_out",type:"Check-out",time:"1h ago",timestamp:new Date(Date.now()-60*60*1e3)},{id:"4",title:"Room 301 maintenance completed",icon:"build",type:"Maintenance",time:"2h ago",timestamp:new Date(Date.now()-2*60*60*1e3)},{id:"5",title:"Payment received from Lisa Chen",icon:"payment",type:"Payment",time:"3h ago",timestamp:new Date(Date.now()-3*60*60*1e3)}];return this.recentActivitiesSubject.next(s),x(s)}))}refreshData(n){this.getDashboardStats(n).subscribe(),this.getRecentActivities(n).subscribe()}clearError(){this.errorSubject.next(null)}static \u0275fac=function(a){return new(a||l)};static \u0275prov=L({token:l,factory:l.\u0275fac,providedIn:"root"})};function me(l,n){if(l&1){let a=U();t(0,"div",56)(1,"div",10)(2,"div",52)(3,"mat-icon",57),r(4,"error"),i(),t(5,"span",58),r(6),i()(),t(7,"button",59),g("click",function(){B(a);let s=E();return F(s.clearError())}),t(8,"mat-icon"),r(9,"close"),i()()()()}if(l&2){let a=E();o(6),c(a.error())}}function pe(l,n){if(l&1&&(t(0,"div",60)(1,"div",61)(2,"mat-icon",62),r(3),i()(),t(4,"div",63)(5,"p",64),r(6),i(),t(7,"p",65),r(8),i()(),t(9,"div",55),r(10),i()()),l&2){let a=n.$implicit;o(3),c(a.icon),o(3),c(a.title),o(2),c(a.time),o(2),c(a.type)}}function ue(l,n){l&1&&(t(0,"div",66)(1,"mat-icon",67),r(2,"history"),i(),t(3,"p"),r(4,"Recent activity will appear here"),i()())}var ce=class l{router=v(X);analyticsService=v(T);destroy$=new G;storeStore=v(oe);get currency(){return this.storeStore.selectedStore()?.currencyCode||this.storeStore.selectedStore()?.currency||"$"}get defaultValue(){return"0"}dashboardStats=m(null);recentActivities=m([]);loading=m(!1);error=m(null);lastUpdated=m(new Date);storeChangeEffect=N(()=>{let n=this.storeStore.selectedStore();n?._id&&(console.log("Store changed in overview component:",n.name,n._id),this.refreshData(),this.loadChartData())});occupancyChartData=m({labels:[],datasets:[{data:[],label:"Occupancy Rate (%)",backgroundColor:"rgba(59, 130, 246, 0.1)",borderColor:"rgba(59, 130, 246, 1)",borderWidth:2,fill:!0,tension:.4}]});occupancyChartOptions={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1}},scales:{y:{beginAtZero:!0,max:100,ticks:{callback:function(n){return n+"%"}}}}};revenueChartData=m({labels:[],datasets:[{data:[],label:"Daily Revenue",backgroundColor:"rgba(34, 197, 94, 0.8)",borderColor:"rgba(34, 197, 94, 1)",borderWidth:1}]});revenueChartOptions={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1}},scales:{y:{beginAtZero:!0,ticks:{callback:n=>this.currency+n}}}};ngOnInit(){this.analyticsService.dashboardStats$.pipe(p(this.destroy$)).subscribe(n=>{this.dashboardStats.set(n),n&&this.lastUpdated.set(n.lastUpdated)}),this.analyticsService.recentActivities$.pipe(p(this.destroy$)).subscribe(n=>{this.recentActivities.set(n)}),this.analyticsService.loading$.pipe(p(this.destroy$)).subscribe(n=>{this.loading.set(n)}),this.analyticsService.error$.pipe(p(this.destroy$)).subscribe(n=>{this.error.set(n)})}loadChartData(){let n=this.storeStore.selectedStore();if(!n?._id){console.log("No store selected, skipping chart data load");return}this.analyticsService.getOccupancyTrend(n._id,7).pipe(p(this.destroy$)).subscribe(a=>{this.occupancyChartData.set({labels:a.map(e=>new Date(e.date).toLocaleDateString("en-US",{weekday:"short"})),datasets:[{data:a.map(e=>e.occupancyRate),label:"Occupancy Rate (%)",backgroundColor:"rgba(59, 130, 246, 0.1)",borderColor:"rgba(59, 130, 246, 1)",borderWidth:2,fill:!0,tension:.4}]})}),this.analyticsService.getRevenueTrend(n._id,7).pipe(p(this.destroy$)).subscribe(a=>{this.revenueChartData.set({labels:a.map(e=>new Date(e.date).toLocaleDateString("en-US",{weekday:"short"})),datasets:[{data:a.map(e=>e.revenue),label:`Daily Revenue (${this.currency})`,backgroundColor:"rgba(34, 197, 94, 0.8)",borderColor:"rgba(34, 197, 94, 1)",borderWidth:1}]})})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}refreshData(){let n=this.storeStore.selectedStore();if(!n?._id){console.log("No store selected, skipping data refresh");return}this.analyticsService.refreshData(n._id),this.loadChartData()}clearError(){this.analyticsService.clearError()}navigateTo(n){this.router.navigate([n],{relativeTo:this.router.routerState.root})}static \u0275fac=function(a){return new(a||l)};static \u0275cmp=M({type:l,selectors:[["app-overview"]],decls:134,vars:38,consts:[[1,"min-h-screen","bg-gradient-to-br","from-slate-50","to-blue-50","p-4","md:p-6","lg:p-8"],[1,"max-w-7xl","mx-auto","space-y-6"],[1,"text-center","space-y-2"],[1,"flex","items-center","justify-center","space-x-4"],[1,"text-3xl","md:text-4xl","font-bold","text-gray-800"],["mat-icon-button","",1,"!text-blue-600","hover:!bg-blue-50",3,"click","disabled"],[1,"text-gray-600","text-lg"],["class","bg-red-50 border border-red-200 rounded-lg p-4 max-w-2xl mx-auto",4,"ngIf"],[1,"grid","grid-cols-1","md:grid-cols-2","lg:grid-cols-4","gap-6"],[1,"bg-white","rounded-xl","shadow-sm","border","border-gray-100","hover:shadow-lg","transition-all","duration-300","p-6"],[1,"flex","items-center","justify-between"],[1,"text-sm","font-medium","text-gray-500","uppercase","tracking-wide"],[1,"text-3xl","font-bold","text-gray-900","mt-2"],[1,"text-sm","text-emerald-600","mt-1"],[1,"font-medium"],[1,"p-3","bg-blue-50","rounded-lg"],[1,"text-blue-600","!text-2xl"],[1,"text-sm","text-amber-600","mt-1"],[1,"p-3","bg-emerald-50","rounded-lg"],[1,"text-emerald-600","!text-2xl"],[1,"text-sm","text-purple-600","mt-1"],[1,"p-3","bg-purple-50","rounded-lg"],[1,"text-purple-600","!text-2xl"],[1,"text-sm","text-green-600","mt-1"],[1,"p-3","bg-green-50","rounded-lg"],[1,"text-green-600","!text-2xl"],[1,"grid","grid-cols-1","lg:grid-cols-2","gap-6"],[1,"bg-white","rounded-xl","shadow-sm","border","border-gray-100","p-6"],[1,"flex","items-center","justify-between","mb-6"],[1,"text-lg","font-semibold","text-gray-800"],[1,"flex","items-center","space-x-2","text-sm","text-gray-500"],[1,"w-3","h-3","bg-blue-500","rounded-full"],[1,"h-64","relative"],["baseChart","","type","line",1,"!h-full","!w-full",3,"data","options"],[1,"w-3","h-3","bg-green-500","rounded-full"],["baseChart","","type","bar",1,"!h-full","!w-full",3,"data","options"],[1,"text-lg","font-semibold","text-gray-800","mb-6"],[1,"grid","grid-cols-2","md:grid-cols-4","gap-4"],["mat-stroked-button","",1,"!h-20","!flex","!flex-col","!items-center","!justify-center","!space-y-2","!border-blue-200","hover:!bg-blue-50","hover:!border-blue-300","!transition-all","!duration-200",3,"click"],[1,"!text-blue-600"],[1,"!text-sm","!font-medium","!text-gray-700"],["mat-stroked-button","",1,"!h-20","!flex","!flex-col","!items-center","!justify-center","!space-y-2","!border-emerald-200","hover:!bg-emerald-50","hover:!border-emerald-300","!transition-all","!duration-200",3,"click"],[1,"!text-emerald-600"],["mat-stroked-button","",1,"!h-20","!flex","!flex-col","!items-center","!justify-center","!space-y-2","!border-purple-200","hover:!bg-purple-50","hover:!border-purple-300","!transition-all","!duration-200",3,"click"],[1,"!text-purple-600"],["mat-stroked-button","",1,"!h-20","!flex","!flex-col","!items-center","!justify-center","!space-y-2","!border-amber-200","hover:!bg-amber-50","hover:!border-amber-300","!transition-all","!duration-200",3,"click"],[1,"!text-amber-600"],["mat-button","",1,"!text-blue-600","!text-sm"],[1,"space-y-4"],["class","flex items-center space-x-4 p-3 bg-gray-50 rounded-lg",4,"ngFor","ngForOf"],["class","text-center py-8 text-gray-500",4,"ngIf"],[1,"bg-white","rounded-xl","shadow-sm","border","border-gray-100","p-4"],[1,"flex","items-center","space-x-2"],[1,"w-2","h-2","bg-green-500","rounded-full"],[1,"text-sm","text-gray-600"],[1,"text-xs","text-gray-400"],[1,"bg-red-50","border","border-red-200","rounded-lg","p-4","max-w-2xl","mx-auto"],[1,"text-red-600"],[1,"text-red-800"],["mat-icon-button","",1,"!text-red-600",3,"click"],[1,"flex","items-center","space-x-4","p-3","bg-gray-50","rounded-lg"],[1,"p-2","bg-blue-100","rounded-lg"],[1,"!text-blue-600","!text-lg"],[1,"flex-1"],[1,"text-sm","font-medium","text-gray-900"],[1,"text-xs","text-gray-500"],[1,"text-center","py-8","text-gray-500"],[1,"!text-3xl","mb-2"]],template:function(a,e){if(a&1&&(t(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h1",4),r(5,"Hotel Management Dashboard"),i(),t(6,"button",5),g("click",function(){return e.refreshData()}),t(7,"mat-icon"),r(8,"refresh"),i()()(),t(9,"p",6),r(10,"Welcome back! Here's what's happening at your hotel today."),i(),R(11,me,10,1,"div",7),i(),t(12,"div",8)(13,"div",9)(14,"div",10)(15,"div")(16,"p",11),r(17,"Total Rooms"),i(),t(18,"p",12),r(19),i(),t(20,"p",13)(21,"span",14),r(22),i(),r(23," Available "),i()(),t(24,"div",15)(25,"mat-icon",16),r(26,"hotel"),i()()()(),t(27,"div",9)(28,"div",10)(29,"div")(30,"p",11),r(31,"Occupancy Rate"),i(),t(32,"p",12),r(33),i(),t(34,"p",17)(35,"span",14),r(36),i(),r(37," Guests "),i()(),t(38,"div",18)(39,"mat-icon",19),r(40,"people"),i()()()(),t(41,"div",9)(42,"div",10)(43,"div")(44,"p",11),r(45,"Today's Check-ins"),i(),t(46,"p",12),r(47),i(),t(48,"p",20)(49,"span",14),r(50),i(),r(51," Check-outs "),i()(),t(52,"div",21)(53,"mat-icon",22),r(54,"event_available"),i()()()(),t(55,"div",9)(56,"div",10)(57,"div")(58,"p",11),r(59,"Today's Revenue"),i(),t(60,"p",12),r(61),C(62,"number"),i(),t(63,"p",23)(64,"span",14),r(65),C(66,"number"),i(),r(67," This Month "),i()(),t(68,"div",24)(69,"mat-icon",25),r(70,"trending_up"),i()()()()(),t(71,"div",26)(72,"div",27)(73,"div",28)(74,"h3",29),r(75,"Weekly Occupancy"),i(),t(76,"div",30),f(77,"div",31),t(78,"span"),r(79,"Occupancy Rate"),i()()(),t(80,"div",32),f(81,"canvas",33),i()(),t(82,"div",27)(83,"div",28)(84,"h3",29),r(85,"Revenue Trend"),i(),t(86,"div",30),f(87,"div",34),t(88,"span"),r(89,"Daily Revenue"),i()()(),t(90,"div",32),f(91,"canvas",35),i()()(),t(92,"div",27)(93,"h3",36),r(94,"Quick Actions"),i(),t(95,"div",37)(96,"button",38),g("click",function(){return e.navigateTo("./reservations")}),t(97,"mat-icon",39),r(98,"book_online"),i(),t(99,"span",40),r(100,"New Reservation"),i()(),t(101,"button",41),g("click",function(){return e.navigateTo("./checkin-checkout")}),t(102,"mat-icon",42),r(103,"how_to_reg"),i(),t(104,"span",40),r(105,"Check-In / Out"),i()(),t(106,"button",43),g("click",function(){return e.navigateTo("./guests")}),t(107,"mat-icon",44),r(108,"person_add"),i(),t(109,"span",40),r(110,"Manage Guests"),i()(),t(111,"button",45),g("click",function(){return e.navigateTo("./rooms")}),t(112,"mat-icon",46),r(113,"hotel"),i(),t(114,"span",40),r(115,"Room Management"),i()()()(),t(116,"div",27)(117,"div",28)(118,"h3",29),r(119,"Recent Activity"),i(),t(120,"button",47),r(121,"View All"),i()(),t(122,"div",48),R(123,pe,11,4,"div",49)(124,ue,5,0,"div",50),i()(),t(125,"div",51)(126,"div",10)(127,"div",52),f(128,"div",53),t(129,"span",54),r(130,"System Status: Online"),i()(),t(131,"div",55),r(132),C(133,"date"),i()()()()()),a&2){let s,w,h,d,z,j,I,H;o(6),u("disabled",e.loading()),o(),b("animate-spin",e.loading()),o(4),u("ngIf",e.error()),o(7),b("animate-pulse",e.loading()),o(),_(" ",((s=e.dashboardStats())==null?null:s.totalRooms)||e.defaultValue," "),o(3),c(((w=e.dashboardStats())==null?null:w.availableRooms)||e.defaultValue),o(10),b("animate-pulse",e.loading()),o(),_(" ",((h=e.dashboardStats())==null?null:h.occupancyRate)||e.defaultValue,"% "),o(3),c(((d=e.dashboardStats())==null?null:d.checkedInGuests)||e.defaultValue),o(10),b("animate-pulse",e.loading()),o(),_(" ",((z=e.dashboardStats())==null?null:z.todayCheckins)||e.defaultValue," "),o(3),c(((j=e.dashboardStats())==null?null:j.todayCheckouts)||e.defaultValue),o(10),b("animate-pulse",e.loading()),o(),$(" ",e.currency,"",D(62,29,(I=e.dashboardStats())==null?null:I.todayRevenue,"1.0-0")||e.defaultValue," "),o(4),$("",e.currency,"",D(66,32,(H=e.dashboardStats())==null?null:H.monthlyRevenue,"1.0-0")||e.defaultValue),o(16),u("data",e.occupancyChartData())("options",e.occupancyChartOptions),o(10),u("data",e.revenueChartData())("options",e.revenueChartOptions),o(32),u("ngForOf",e.recentActivities()),o(),u("ngIf",!e.recentActivities()||e.recentActivities().length===0),o(8),_(" Last updated: ",D(133,35,e.lastUpdated(),"short")," ")}},dependencies:[J,W,Q,q,Z,re,ae,ne,te,ee,Y,de,le],encapsulation:2})};export{ce as OverviewComponent};
