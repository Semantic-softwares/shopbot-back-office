import{b as Be,c as Le,d as Ne}from"./chunk-B25KU3PS.js";import{a as y,b as Oe,c as Ve}from"./chunk-V6Q2J3ZF.js";import{a as Fe}from"./chunk-LO5LXT4F.js";import{a as Ie}from"./chunk-YZQZHEMG.js";import{a as T}from"./chunk-54QLBB4T.js";import{a as He}from"./chunk-D4ZTXZUT.js";import"./chunk-NYCP7ATN.js";import{f as Re}from"./chunk-XSZYAESL.js";import"./chunk-LCNY3JPX.js";import{a as Pe}from"./chunk-4QMHOUIB.js";import{a as x,b as Ee}from"./chunk-5NCGVO7F.js";import{a as ke}from"./chunk-HOFFRLAS.js";import{a as Te}from"./chunk-OFQMF3WN.js";import{a as Ce,b as _e,c as fe,d as Me,e as he,f as Se,g as xe,h as ye,i as De,j as be,k as we,l as ve}from"./chunk-BAU4EBFS.js";import"./chunk-YHIOFNIN.js";import"./chunk-PYUUH7RE.js";import"./chunk-OKEXGVJ3.js";import"./chunk-O7SXWP4H.js";import{a as Z,b as ee,c as te,d as ie}from"./chunk-4P4GBQE7.js";import{i as G}from"./chunk-ZKQYDJ5W.js";import"./chunk-LCF3SYDV.js";import"./chunk-ZLVLWRZH.js";import{d as ue}from"./chunk-HJGFVW6K.js";import"./chunk-TVH27JLT.js";import"./chunk-G4CZ6LK2.js";import"./chunk-I564X6SI.js";import"./chunk-VTDH2LYT.js";import{b as ce,c as se,d as de}from"./chunk-63HT37SK.js";import{a as le,h as me}from"./chunk-YJCGHVXK.js";import"./chunk-UHBDKNKX.js";import{a as pe,b as ge}from"./chunk-3ZLH5HUN.js";import{A as re,b as oe,g as ne,l as ae}from"./chunk-O5GCTPYR.js";import"./chunk-EGLRIU4H.js";import{a as z,b as W}from"./chunk-5TL46KBL.js";import"./chunk-53AK2UWQ.js";import"./chunk-BFT2MTJY.js";import{a as K,c as U,h as X}from"./chunk-JONI64R4.js";import"./chunk-H7INH462.js";import"./chunk-OOL2KACG.js";import"./chunk-KZJMNFJ3.js";import{b as J,c as Y}from"./chunk-G6I3OKXX.js";import{Z as A,_ as j,ba as q}from"./chunk-4Z2XUZY2.js";import{g as $}from"./chunk-F436VINI.js";import"./chunk-H22US2IH.js";import{Gc as Q,Ib as I,Jb as O,Ob as d,Pb as o,Qb as n,Rb as p,Vb as g,Wb as u,Y as P,Yb as D,ac as C,bb as c,cc as f,fa as _,gc as b,hc as w,ic as v,ka as M,la as h,mc as V,nc as F,qb as R,rc as r,sc as S,tc as H,wb as s,x as E,xc as B,yc as L,zc as N}from"./chunk-P5WOETP4.js";import"./chunk-GAL4ENT6.js";var $e=()=>[5,10,25,100];function Ae(t,i){t&1&&(o(0,"div",8),p(1,"mat-spinner",11),n())}function je(t,i){t&1&&p(0,"app-no-record",9)}function qe(t,i){t&1&&p(0,"th",27)}function ze(t,i){t&1&&(o(0,"td",28)(1,"mat-icon",29),r(2,"drag_indicator"),n()())}function We(t,i){t&1&&(o(0,"th",30),r(1,"Name"),n())}function Ge(t,i){if(t&1&&(o(0,"td",31),r(1),n()),t&2){let e=i.$implicit;c(),S(e.name)}}function Je(t,i){t&1&&(o(0,"th",30),r(1,"Color"),n())}function Ye(t,i){if(t&1&&(o(0,"td",31)(1,"div",32),r(2),n()()),t&2){let e=i.$implicit;c(),F("background-color",e.color),c(),H(" ",e.color," ")}}function Ke(t,i){t&1&&(o(0,"th",30),r(1,"Icon"),n())}function Ue(t,i){if(t&1&&(o(0,"td",31)(1,"mat-icon"),r(2),n()()),t&2){let e=i.$implicit;c(2),S(e==null?null:e.icon)}}function Xe(t,i){t&1&&(o(0,"th",30),r(1,"Items"),n())}function Ze(t,i){if(t&1&&(o(0,"td",31),r(1),n()),t&2){let e=i.$implicit;c(),S(e.items)}}function et(t,i){t&1&&(o(0,"th",33),r(1,"Actions"),n())}function tt(t,i){if(t&1){let e=D();o(0,"td",31)(1,"button",34)(2,"mat-icon"),r(3,"more_vert"),n()(),o(4,"mat-menu",null,0)(6,"button",35),C("click",function(){let l=M(e).$implicit,m=f(2);return h(m.onEditCategory(l))}),o(7,"mat-icon"),r(8,"edit"),n(),o(9,"span"),r(10,"Edit"),n()(),o(11,"button",35),C("click",function(){let l=M(e).$implicit,m=f(2);return h(m.deleteCategory(l))}),o(12,"mat-icon"),r(13,"delete"),n(),o(14,"span"),r(15,"Delete"),n()()()()}if(t&2){let e=V(5);c(),d("matMenuTriggerFor",e)}}function it(t,i){t&1&&p(0,"tr",36)}function ot(t,i){if(t&1&&p(0,"tr",37),t&2){let e=i.$implicit;d("cdkDragData",e)}}function nt(t,i){if(t&1){let e=D();o(0,"div",10)(1,"table",12),C("cdkDropListDropped",function(l){M(e);let m=f();return h(m.onDrop(l))}),g(2,13),s(3,qe,1,0,"th",14)(4,ze,3,0,"td",15),u(),g(5,16),s(6,We,2,0,"th",17)(7,Ge,2,1,"td",18),u(),g(8,19),s(9,Je,2,0,"th",17)(10,Ye,3,3,"td",18),u(),g(11,20),s(12,Ke,2,0,"th",17)(13,Ue,3,1,"td",18),u(),g(14,21),s(15,Xe,2,0,"th",17)(16,Ze,2,1,"td",18),u(),g(17,22),s(18,et,2,0,"th",23)(19,tt,16,1,"td",18),u(),s(20,it,1,0,"tr",24)(21,ot,1,1,"tr",25),n(),p(22,"mat-paginator",26),n()}if(t&2){let e=f();c(),d("dataSource",e.dataSource),c(19),d("matHeaderRowDef",e.displayedColumns),c(),d("matRowDefColumns",e.displayedColumns),c(),d("pageSizeOptions",Q(4,$e))}}var Qe=class t{displayedColumns=["drag","name","color","icon","items","actions"];dataSource;searchText="";dialog=_(Re);router=_($);categoryService=_(He);storeStore=_(G);snackBar=_(z);paginator;sort;categories=ue({params:()=>({storeId:this.storeStore.selectedStore()?._id}),stream:({params:i})=>this.categoryService.getStoreMenus(i.storeId).pipe(P(e=>{this.dataSource=new ve(e),this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort}))});applyFilter(i){let e=i.target.value;this.dataSource.filter=e.trim().toLowerCase()}addCategory(){this.dialog.open(T,{width:"500px",data:{isEdit:!1}}).afterClosed().subscribe(e=>{e&&this.categories.reload()})}onEditCategory(i){this.dialog.open(T,{width:"500px",data:{isEdit:!0,category:i}}).afterClosed().subscribe(a=>{a&&this.categories.reload()})}deleteCategory(i){this.dialog.open(Fe,{width:"350px",data:{message:`Are you sure you want to delete ${i.name}?`}}).afterClosed().subscribe(a=>{a&&(console.log("Category to delete:",i),this.categoryService.deleteMenu(i._id).subscribe({next:()=>{console.log("Category deleted successfully"),this.categories.reload()}}))})}reloadCategories(){this.categories.reload()}onDrop(i){if(i.previousIndex===i.currentIndex)return;let e=this.dataSource.data,a=e[i.previousIndex];e.splice(i.previousIndex,1),e.splice(i.currentIndex,0,a),this.dataSource.data=[...e];let l=e.map((m,k)=>(m.position=k,this.categoryService.updateMenu(m._id,{position:k})));l.length>0&&E(l).subscribe({next:()=>{this.snackBar.open("Categories sorted successfully","Close",{duration:3e3})},error:()=>{this.snackBar.open("Failed to sort categories","Close",{duration:3e3}),this.categories.reload()}})}static \u0275fac=function(e){return new(e||t)};static \u0275cmp=R({type:t,selectors:[["app-categories"]],viewQuery:function(e,a){if(e&1&&(b(x,5),b(y,5)),e&2){let l;w(l=v())&&(a.paginator=l.first),w(l=v())&&(a.sort=l.first)}},decls:17,vars:2,consts:[["menu","matMenu"],["title","Categories","subtitle","Manage your menu categories"],["matButton","","actions","","title","Reload categories","matTooltip","Reload",3,"click"],["matButton","filled","color","primary","actions","",3,"click"],["appearance","outlined",1,"py-4"],[1,"filters","mb-4"],["appearance","outline"],["matInput","","placeholder","Search categories",3,"keyup","ngModelChange","ngModel"],[1,"flex","items-center","justify-center","min-h-[300px]"],["icon","category","title","No Categories","message","No categories found matching your criteria."],[1,"table-container","!bg-white"],["diameter","40"],["mat-table","","matSort","","cdkDropList","",3,"cdkDropListDropped","dataSource"],["matColumnDef","drag"],["mat-header-cell","","class","w-12",4,"matHeaderCellDef"],["mat-cell","","class","cursor-move",4,"matCellDef"],["matColumnDef","name"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","color"],["matColumnDef","icon"],["matColumnDef","items"],["matColumnDef","actions"],["mat-header-cell","","class","w-20",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","","cdkDrag","",3,"cdkDragData",4,"matRowDef","matRowDefColumns"],["aria-label","Select page of categories",3,"pageSizeOptions"],["mat-header-cell","",1,"w-12"],["mat-cell","",1,"cursor-move"],[1,"drag-handle","text-gray-400"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],[1,"color-preview"],["mat-header-cell","",1,"w-20"],["mat-icon-button","","aria-label","Category actions",3,"matMenuTriggerFor"],["mat-menu-item","",3,"click"],["mat-header-row",""],["mat-row","","cdkDrag","",3,"cdkDragData"]],template:function(e,a){e&1&&(o(0,"app-page-header",1)(1,"button",2),C("click",function(){return a.reloadCategories()}),o(2,"mat-icon"),r(3,"refresh"),n(),r(4," Refresh "),n(),o(5,"button",3),C("click",function(){return a.addCategory()}),r(6,"+ ADD CATEGORY"),n()(),o(7,"mat-card",4)(8,"mat-card-content")(9,"div",5)(10,"mat-form-field",6)(11,"mat-label"),r(12,"Search"),n(),o(13,"input",7),C("keyup",function(m){return a.applyFilter(m)}),N("ngModelChange",function(m){return L(a.searchText,m)||(a.searchText=m),m}),n()()(),I(14,Ae,2,0,"div",8)(15,je,1,0,"app-no-record",9)(16,nt,23,5,"div",10),n()()),e&2&&(c(13),B("ngModel",a.searchText),c(),O(a.categories.isLoading()?14:a.categories.hasValue()&&a.categories.value().length===0?15:a.categories.hasValue()?16:-1))},dependencies:[we,Ce,fe,xe,Me,_e,ye,he,Se,De,be,Ee,x,Ve,y,Oe,X,K,U,ce,me,le,de,se,q,j,A,Y,J,ie,ee,Z,te,ke,Te,ge,pe,W,Pe,re,oe,ne,ae,Ne,Le,Be,Ie],styles:[".categories-container[_ngcontent-%COMP%]{margin:20px}.categories-container[_ngcontent-%COMP%]   .actions-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px}.categories-container[_ngcontent-%COMP%]   .actions-row[_ngcontent-%COMP%]   .filters[_ngcontent-%COMP%]{display:flex;gap:16px}.categories-container[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]{width:100%;overflow:auto}.categories-container[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]{width:100%}.categories-container[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   .drag-handle[_ngcontent-%COMP%]{cursor:grab}.categories-container[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   .drag-handle[_ngcontent-%COMP%]:active{cursor:grabbing}.categories-container[_ngcontent-%COMP%]   .color-preview[_ngcontent-%COMP%]{padding:4px 8px;border-radius:4px;display:inline-block;color:#fff;text-shadow:0 0 2px rgba(0,0,0,.5)}  .cdk-drop-list-dragging .cdk-drag-placeholder{opacity:.3}  .cdk-drag-animating{transition:transform .25s cubic-bezier(0,0,.2,1)}  .cdk-drag-preview{box-shadow:0 5px 15px #0000004d;border-radius:4px}"]})};export{Qe as CategoriesComponent};
