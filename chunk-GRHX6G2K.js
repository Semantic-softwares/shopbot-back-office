import{a as T}from"./chunk-QDRS7FS3.js";import"./chunk-S35VCKTJ.js";import"./chunk-CU623SSI.js";import{a as Dt}from"./chunk-GU4Z36JA.js";import{a as x,b as wt,c as yt}from"./chunk-7FQZXLFT.js";import{a as Et}from"./chunk-37MPZNQ6.js";import{a as Rt,b as kt}from"./chunk-GZXF4TWP.js";import{c as Tt}from"./chunk-XNNKKASY.js";import{a as bt}from"./chunk-5HSGNHP2.js";import{a as v,b as Vt}from"./chunk-OYJDXI6U.js";import"./chunk-JZKRHT5H.js";import"./chunk-O4OM35BU.js";import{a as pt,b as ct,c as ut,d as ft,e as _t,f as Ct,g as ht,h as gt,i as Mt,j as St,k as vt,l as xt}from"./chunk-GTRRE3DU.js";import"./chunk-6RCOBA75.js";import{a as K,b as U,c as X,d as Y}from"./chunk-Q4U6FYZ3.js";import{i as z}from"./chunk-QC7H4KPM.js";import"./chunk-P4SPQCUJ.js";import"./chunk-R6JGHN2R.js";import{d as dt}from"./chunk-BXJEGH2V.js";import"./chunk-64WHNS37.js";import"./chunk-TIVXUJ22.js";import"./chunk-W7B5PSOS.js";import"./chunk-XLZTIYSF.js";import{b as ot,c as rt,d as lt}from"./chunk-UMV4DCPT.js";import{a as at,h as nt}from"./chunk-G3VZM262.js";import"./chunk-BCE7WRWQ.js";import{a as mt,b as st}from"./chunk-6I3AJKA7.js";import{A as it,b as Z,g as tt,l as et}from"./chunk-W7NMJLMQ.js";import"./chunk-F5SZ3AU3.js";import{a as O}from"./chunk-4UBDYPTG.js";import"./chunk-TILT22SG.js";import"./chunk-BFT2MTJY.js";import{a as q,c as G,h as J}from"./chunk-3E3PJ7Q7.js";import"./chunk-FO4KTVQ3.js";import"./chunk-TRZH7NMW.js";import"./chunk-GXTELBJV.js";import{b as W,c as j}from"./chunk-JPRPNQOM.js";import{Z as B,_ as Q,ba as $}from"./chunk-3LDCGXHW.js";import"./chunk-6PFJHDFS.js";import{Fc as N,Ib as P,Jb as I,Ob as p,Pb as a,Qb as n,Rb as c,Vb as u,Wb as f,Y as R,Yb as V,ac as _,bb as m,cc as h,fa as C,gc as b,hc as w,ic as y,ka as g,la as M,mc as F,qb as k,rc as r,sc as S,wb as d,wc as H,xc as A,yc as L}from"./chunk-J2AK4FW5.js";import{a as E,b as D}from"./chunk-GAL4ENT6.js";var It=()=>[5,10,25,100];function Ft(t,i){t&1&&(a(0,"div",9),c(1,"mat-spinner",13),n())}function Ht(t,i){t&1&&c(0,"app-no-record",10)}function At(t,i){t&1&&c(0,"app-no-record",11)}function Lt(t,i){t&1&&(a(0,"th",27),r(1,"Name"),n())}function Nt(t,i){if(t&1&&(a(0,"td",28),r(1),n()),t&2){let e=i.$implicit;m(),S(e.name)}}function Bt(t,i){t&1&&(a(0,"th",27),r(1,"At Least"),n())}function Qt(t,i){if(t&1&&(a(0,"td",28),r(1),n()),t&2){let e=i.$implicit;m(),S(e.atLeast)}}function $t(t,i){t&1&&(a(0,"th",27),r(1,"At Most"),n())}function Ot(t,i){if(t&1&&(a(0,"td",28),r(1),n()),t&2){let e=i.$implicit;m(),S(e.atMost)}}function zt(t,i){t&1&&(a(0,"th",29),r(1,"Published"),n())}function Wt(t,i){if(t&1){let e=V();a(0,"td",28)(1,"mat-slide-toggle",30),_("change",function(){let l=g(e).$implicit,s=h(2);return M(s.togglePublished(l))}),n()()}if(t&2){let e=i.$implicit;m(),p("checked",e.enabled)}}function jt(t,i){t&1&&(a(0,"th",31),r(1,"Actions"),n())}function qt(t,i){if(t&1){let e=V();a(0,"td",28)(1,"button",32)(2,"mat-icon"),r(3,"more_vert"),n()(),a(4,"mat-menu",null,0)(6,"button",33),_("click",function(){let l=g(e).$implicit,s=h(2);return M(s.editVariant(l))}),a(7,"mat-icon"),r(8,"edit"),n(),a(9,"span"),r(10,"Edit"),n()(),a(11,"button",33),_("click",function(){let l=g(e).$implicit,s=h(2);return M(s.deleteVariant(l))}),a(12,"mat-icon"),r(13,"delete"),n(),a(14,"span"),r(15,"Delete"),n()()()()}if(t&2){let e=F(5);m(),p("matMenuTriggerFor",e)}}function Gt(t,i){t&1&&c(0,"tr",34)}function Jt(t,i){t&1&&c(0,"tr",35)}function Kt(t,i){if(t&1&&(a(0,"div",12)(1,"table",14),u(2,15),d(3,Lt,2,0,"th",16)(4,Nt,2,1,"td",17),f(),u(5,18),d(6,Bt,2,0,"th",16)(7,Qt,2,1,"td",17),f(),u(8,19),d(9,$t,2,0,"th",16)(10,Ot,2,1,"td",17),f(),u(11,20),d(12,zt,2,0,"th",21)(13,Wt,2,1,"td",17),f(),u(14,22),d(15,jt,2,0,"th",23)(16,qt,16,1,"td",17),f(),d(17,Gt,1,0,"tr",24)(18,Jt,1,0,"tr",25),n(),c(19,"mat-paginator",26),n()),t&2){let e=h();m(),p("dataSource",e.dataSource),m(16),p("matHeaderRowDef",e.displayedColumns),m(),p("matRowDefColumns",e.displayedColumns),m(),p("pageSizeOptions",N(4,It))}}var Pt=class t{displayedColumns=["name","atLeast","atMost","published","actions"];dataSource;searchText="";dialog=C(Tt);productService=C(Dt);storeStore=C(z);snackBar=C(O);paginator;sort;variants=dt({params:()=>({storeId:this.storeStore.selectedStore()?._id}),stream:({params:i})=>this.productService.getStoreGroupOption(i.storeId).pipe(R(e=>{this.dataSource=new xt(e),this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort}))});applyFilter(i){let e=i.target.value;this.dataSource.filter=e.trim().toLowerCase()}openDialog(){this.dialog.open(T,{width:"500px",data:{isEdit:!1}}).afterClosed().subscribe(e=>{(e?.success||e===!0)&&this.variants.reload()})}editVariant(i){this.dialog.open(T,{width:"500px",data:{isEdit:!0,variant:i}}).afterClosed().subscribe(o=>{(o?.success||o===!0)&&(console.log("Reloading variants after edit"),this.variants.reload())})}deleteVariant(i){this.dialog.open(Et,{width:"350px",data:{message:`Are you sure you want to delete ${i.name}?`}}).afterClosed().subscribe(o=>{o&&this.productService.deleteVariant(i._id).subscribe({next:()=>{this.variants.reload()}})})}togglePublished(i){let e=D(E({},i),{enabled:!i.enabled});this.productService.updateVariant(e,i._id).subscribe({next:()=>{this.snackBar.open("Variant status updated successfully","Close",{duration:3e3,horizontalPosition:"end",verticalPosition:"top"}),this.variants.reload()},error:()=>{this.snackBar.open("Error updating variant status","Close",{duration:3e3,horizontalPosition:"end",verticalPosition:"top"})}})}static \u0275fac=function(e){return new(e||t)};static \u0275cmp=k({type:t,selectors:[["app-variants"]],viewQuery:function(e,o){if(e&1&&(b(v,5),b(x,5)),e&2){let l;w(l=y())&&(o.paginator=l.first),w(l=y())&&(o.sort=l.first)}},decls:17,vars:2,consts:[["menu","matMenu"],[1,"variants-container","!bg-white"],[1,"!bg-white"],[1,"flex","items-center","space-x-4","p-4"],[1,"w-80"],["appearance","outline",1,"w-full"],["matInput","","placeholder","Search variants",3,"keyup","ngModelChange","ngModel"],[1,"flex-shrink-0","ml-auto"],["mat-raised-button","","color","primary",1,"h-[48px]","px-6","font-medium",3,"click"],[1,"flex","items-center","justify-center","min-h-[300px]"],["icon","error","title","Error","message","An error occurred while fetching variants. Please try again later."],["icon","category","title","No Variants","message","No variants found matching your criteria."],[1,"table-container","!bg-white"],["diameter","40"],["mat-table","","matSort","",1,"!bg-white",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","atLeast"],["matColumnDef","atMost"],["matColumnDef","published"],["mat-header-cell","",4,"matHeaderCellDef"],["matColumnDef","actions"],["mat-header-cell","","class","w-20",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["aria-label","Select page of variants",1,"!bg-white",3,"pageSizeOptions"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],["mat-header-cell",""],["color","primary",3,"change","checked"],["mat-header-cell","",1,"w-20"],["mat-icon-button","","aria-label","Variant actions",3,"matMenuTriggerFor"],["mat-menu-item","",3,"click"],["mat-header-row",""],["mat-row",""]],template:function(e,o){e&1&&(a(0,"mat-card",1)(1,"mat-card-content",2)(2,"div",3)(3,"div",4)(4,"mat-form-field",5)(5,"mat-label"),r(6,"Search"),n(),a(7,"input",6),_("keyup",function(s){return o.applyFilter(s)}),L("ngModelChange",function(s){return A(o.searchText,s)||(o.searchText=s),s}),n()()(),a(8,"div",7)(9,"button",8),_("click",function(){return o.openDialog()}),a(10,"mat-icon"),r(11,"add"),n(),r(12," ADD VARIANT "),n()()(),P(13,Ft,2,0,"div",9)(14,Ht,1,0,"app-no-record",10)(15,At,1,0,"app-no-record",11)(16,Kt,20,5,"div",12),n()()),e&2&&(m(7),H("ngModel",o.searchText),m(6),I(o.variants.isLoading()?13:o.variants.error()?14:o.variants.hasValue()&&o.dataSource.data.length===0?15:o.variants.hasValue()?16:-1))},dependencies:[vt,pt,ut,ht,ft,ct,gt,_t,Ct,Mt,St,Vt,v,yt,x,wt,J,q,G,ot,nt,at,lt,rt,$,Q,B,j,W,Y,U,K,X,st,mt,bt,it,Z,tt,et,kt,Rt],encapsulation:2})};export{Pt as VariantsComponent};
