import{a as Ct}from"./chunk-BKAAY5R4.js";import{a as ht,b as Et}from"./chunk-LSNVMFZZ.js";import{a as vt}from"./chunk-IYQ6GC44.js";import{a as xt,b as _t}from"./chunk-4SHNZOR7.js";import"./chunk-3PQC2AD7.js";import"./chunk-2KPMOGOH.js";import{i as $}from"./chunk-WFQLSX5X.js";import{a as St,b as bt}from"./chunk-D2CDDOVY.js";import{d as V}from"./chunk-S6O7RC67.js";import"./chunk-KQ2NF2R5.js";import"./chunk-AQTPIICF.js";import"./chunk-GZ7S2I6F.js";import"./chunk-L5R7UQHM.js";import{b as pt,c as ct,d as ut}from"./chunk-VN3HHLBZ.js";import{a as mt,b as lt,e as dt,h as st}from"./chunk-THLNJRLH.js";import"./chunk-GBJWJHBW.js";import{a as ft,b as gt}from"./chunk-YJKLGOC4.js";import{B as ot,b as J,d,g as Q,h as W,m as X,n as Y,q as Z,r as tt,s as et,t as it,v as nt,w as rt,z as at}from"./chunk-ADPCW6JI.js";import"./chunk-UUMWQRYG.js";import{a as G}from"./chunk-VNGKQKTG.js";import"./chunk-UPMF7ZC6.js";import"./chunk-BFT2MTJY.js";import{a as R,b as j,c as H,d as K,f as U,h as L}from"./chunk-EALJFX3J.js";import"./chunk-5AHC55Y5.js";import"./chunk-TVQ3FP64.js";import"./chunk-47XHPHB4.js";import{b as z,c as D}from"./chunk-IYN665YT.js";import{Y as O,Z as q,aa as B}from"./chunk-OYVOT3CA.js";import{e as T,g as w,l as A}from"./chunk-DWM5GR6S.js";import{r as k}from"./chunk-6BQAOBQP.js";import{$a as l,Gb as u,Hb as f,Ib as P,Kb as x,Lb as _,Mb as c,Nb as e,Ob as t,Pb as s,Tb as F,Tc as M,Ub as N,Wb as v,_b as g,ac as h,ea as p,ja as S,ka as b,ob as y,pc as i,qc as E,rc as I,va as C}from"./chunk-H33Y42PP.js";import"./chunk-GAL4ENT6.js";var Mt=(a,n)=>n.value;function Ft(a,n){a&1&&s(0,"mat-spinner",4)}function Nt(a,n){a&1&&(e(0,"mat-icon"),i(1,"save"),t())}function It(a,n){a&1&&(e(0,"mat-error"),i(1,"Station name is required"),t())}function kt(a,n){if(a&1&&(e(0,"mat-option",14),i(1),t()),a&2){let r=n.$implicit;c("value",r.value),l(),E(r.label)}}function Tt(a,n){if(a&1&&(e(0,"mat-option",14),i(1),t()),a&2){let r=n.$implicit;c("value",r.value),l(),E(r.label)}}function wt(a,n){if(a&1){let r=v();e(0,"div",27)(1,"mat-icon",31),i(2,"print_disabled"),t(),e(3,"p",32),i(4,"No printers configured. Add at least one printer to enable printing."),t(),e(5,"button",33),g("click",function(){S(r);let m=h();return b(m.addPrinter())}),e(6,"mat-icon"),i(7,"add"),t(),i(8," Add Printer "),t()()}}function At(a,n){a&1&&(e(0,"mat-error"),i(1,"Invalid IP address"),t())}function Vt(a,n){if(a&1){let r=v();e(0,"mat-card",28)(1,"mat-card-content",34)(2,"div",35)(3,"div",36)(4,"div",37)(5,"mat-form-field",10)(6,"mat-label"),i(7,"Printer Name"),t(),s(8,"input",38),e(9,"mat-icon",12),i(10,"print"),t()(),e(11,"div",39)(12,"mat-form-field",40)(13,"mat-label"),i(14,"IP Address"),t(),s(15,"input",41),u(16,At,2,0,"mat-error"),t(),e(17,"mat-form-field",42)(18,"mat-label"),i(19,"Port"),t(),s(20,"input",43),t()()(),e(21,"div",18)(22,"mat-checkbox",44)(23,"span",20)(24,"mat-icon",21),i(25,"check_circle"),t(),i(26," Enabled "),t()()()(),e(27,"button",45),g("click",function(){let m=S(r).$index,Pt=h();return b(Pt.removePrinter(m))}),e(28,"mat-icon"),i(29,"delete"),t()()()()()}if(a&2){let r,o=n.$implicit,m=n.$index;c("formGroupName",m),l(16),f((r=o.get("ipAddress"))!=null&&r.hasError("pattern")&&((r=o.get("ipAddress"))!=null&&r.touched)?16:-1)}}function Ot(a,n){if(a&1){let r=v();e(0,"button",46),g("click",function(){S(r);let m=h();return b(m.addPrinter())}),e(1,"mat-icon"),i(2,"add"),t(),i(3," Add Another Printer "),t()}}var yt=class a{route=p(T);router=p(w);stationsService=p(vt);storeStore=p($);snackBar=p(G);fb=p(at);isSubmitting=C(!1);isEditMode=C(!1);stationId=C(null);pageTitle=M(()=>this.isEditMode()?"Edit Station":"Create Station");submitButtonText=M(()=>this.isEditMode()?"Update Station":"Create Station");stationForm;stationTypes=[{value:"preparation",label:"Preparation"},{value:"bar",label:"Bar"},{value:"pastry",label:"Pastry"},{value:"grill",label:"Grill"},{value:"other",label:"Other"}];paperSizes=[{value:"80mm",label:"80mm (Standard)"},{value:"58mm",label:"58mm (Compact)"}];constructor(){this.stationForm=this.fb.group({name:["",d.required],description:[""],type:["preparation",d.required],store:[this.storeStore.selectedStore()?._id,d.required],active:[!0],settings:this.fb.group({autoPrint:[!0],paperSize:["80mm"],copiesPerOrder:[1,[d.required,d.min(1)]]}),printers:this.fb.array([])})}ngOnInit(){let n=this.route.snapshot.paramMap.get("id");n&&(this.isEditMode.set(!0),this.stationId.set(n),this.loadStation(n))}get printers(){return this.stationForm.get("printers")}createPrinterFormGroup(n){return this.fb.group({id:[n?.id||this.generatePrinterId()],name:[n?.name||"",d.required],ipAddress:[n?.ipAddress||"",[d.required,d.pattern(/^(\d{1,3}\.){3}\d{1,3}$/)]],port:[n?.port||9100,d.required],enabled:[n?.enabled!==void 0?n.enabled:!0],status:[n?.status||"offline"]})}addPrinter(){this.printers.push(this.createPrinterFormGroup())}removePrinter(n){this.printers.removeAt(n)}generatePrinterId(){return`printer_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}loadStation(n){this.stationsService.getStation(n).subscribe({next:r=>{this.stationForm.patchValue({name:r.name,description:r.description,type:r.type,active:r.active,settings:{autoPrint:r.settings?.autoPrint??!0,paperSize:r.settings?.paperSize||"80mm",copiesPerOrder:r.settings?.copiesPerOrder||1}}),r.printers&&r.printers.length>0&&r.printers.forEach(o=>{this.printers.push(this.createPrinterFormGroup(o))})},error:r=>{this.snackBar.open("Error loading station","Close",{duration:3e3,horizontalPosition:"end",verticalPosition:"top"})}})}onSubmit(){if(!this.stationForm.valid)return;this.isSubmitting.set(!0);let n=this.stationForm.getRawValue(),r=this.stationId();(this.isEditMode()?this.stationsService.updateStation(r,n):this.stationsService.createStation(n)).subscribe({next:m=>{this.snackBar.open(`Station ${this.isEditMode()?"updated":"created"} successfully`,"Close",{duration:3e3,horizontalPosition:"end",verticalPosition:"top"}),this.router.navigate(["/menu/erp/items/stations"])},error:m=>{this.snackBar.open(`Error ${this.isEditMode()?"updating":"creating"} station`,"Close",{duration:3e3,horizontalPosition:"end",verticalPosition:"top"}),this.isSubmitting.set(!1)}})}onCancel(){this.router.navigate(["/menu/erp/items/stations"])}static \u0275fac=function(r){return new(r||a)};static \u0275cmp=y({type:a,selectors:[["app-create-station"]],decls:93,vars:9,consts:[[3,"title","subtitle"],["actions",""],["mat-stroked-button","",3,"click"],["mat-flat-button","","color","primary","type","submit","form","stationForm",3,"disabled"],["diameter","20"],[1,"max-w-4xl","mx-auto","py-8"],["id","stationForm",1,"space-y-6",3,"ngSubmit","formGroup"],["appearance","outlined"],[1,"p-6!","space-y-6"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-6"],["appearance","outline",1,"w-full"],["matInput","","formControlName","name","placeholder","e.g., Main Kitchen","required",""],["matSuffix","",1,"text-gray-400"],["formControlName","type","required",""],[3,"value"],["matInput","","formControlName","description","rows","2","placeholder","Optional description"],["appearance","outlined","formGroupName","settings"],[1,"grid","grid-cols-1","md:grid-cols-3","gap-6"],[1,"flex","items-center"],["formControlName","autoPrint","color","primary"],[1,"flex","items-center","gap-2"],[1,"text-lg","text-gray-600"],["formControlName","paperSize"],["matInput","","type","number","formControlName","copiesPerOrder","min","1"],[1,"text-sm","text-gray-600"],[1,"text-lg","align-middle","mr-1"],["formArrayName","printers"],[1,"border-2","border-dashed","border-gray-300","rounded-lg","p-8","text-center"],["appearance","outlined",1,"mb-4",3,"formGroupName"],["mat-stroked-button","","type","button",1,"w-full"],["formControlName","active","color","primary"],[1,"text-4xl","text-gray-400","mb-2"],[1,"text-gray-600","mb-4"],["mat-raised-button","","color","primary","type","button",3,"click"],[1,"p-4!"],[1,"flex","items-start","gap-4"],[1,"flex-grow-1","space-y-4"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4"],["matInput","","formControlName","name","placeholder","e.g., Kitchen Printer 1","required",""],[1,"grid","grid-cols-3","gap-2"],["appearance","outline",1,"col-span-2"],["matInput","","formControlName","ipAddress","placeholder","192.168.1.100","required",""],["appearance","outline"],["matInput","","type","number","formControlName","port"],["formControlName","enabled","color","primary"],["mat-icon-button","","color","warn","type","button",3,"click"],["mat-stroked-button","","type","button",1,"w-full",3,"click"]],template:function(r,o){if(r&1&&(e(0,"app-page-header",0),F(1,1),e(2,"button",2),g("click",function(){return o.onCancel()}),e(3,"mat-icon"),i(4,"close"),t(),i(5," Cancel "),t(),e(6,"button",3),u(7,Ft,1,0,"mat-spinner",4)(8,Nt,2,0,"mat-icon"),i(9),t(),N(),t(),e(10,"div",5)(11,"form",6),g("ngSubmit",function(){return o.onSubmit()}),e(12,"mat-card",7)(13,"mat-card-header")(14,"mat-card-title"),i(15,"Basic Information"),t()(),e(16,"mat-card-content",8)(17,"div",9)(18,"div")(19,"mat-form-field",10)(20,"mat-label"),i(21,"Station Name"),t(),s(22,"input",11),e(23,"mat-icon",12),i(24,"restaurant"),t(),u(25,It,2,0,"mat-error"),t()(),e(26,"div")(27,"mat-form-field",10)(28,"mat-label"),i(29,"Station Type"),t(),e(30,"mat-select",13),x(31,kt,2,2,"mat-option",14,Mt),t()()()(),e(33,"div")(34,"mat-form-field",10)(35,"mat-label"),i(36,"Description"),t(),s(37,"textarea",15),t()()()(),e(38,"mat-card",16)(39,"mat-card-header")(40,"mat-card-title"),i(41,"Print Settings"),t()(),e(42,"mat-card-content",8)(43,"div",17)(44,"div",18)(45,"mat-slide-toggle",19)(46,"span",20)(47,"mat-icon",21),i(48,"print"),t(),i(49," Auto Print Orders "),t()()(),e(50,"div")(51,"mat-form-field",10)(52,"mat-label"),i(53,"Paper Size"),t(),e(54,"mat-select",22),x(55,Tt,2,2,"mat-option",14,Mt),t()()(),e(57,"div")(58,"mat-form-field",10)(59,"mat-label"),i(60,"Copies Per Order"),t(),s(61,"input",23),t()()(),e(62,"div",24)(63,"mat-icon",25),i(64,"info"),t(),i(65," Automatically print when orders arrive at this station "),t()()(),e(66,"mat-card",7)(67,"mat-card-header")(68,"mat-card-title"),i(69,"Printers"),t(),e(70,"mat-card-subtitle"),i(71,"Configure network printers for this station"),t()(),e(72,"mat-card-content",8)(73,"div",26),u(74,wt,9,0,"div",27),x(75,Vt,30,2,"mat-card",28,P),u(77,Ot,4,0,"button",29),t()()(),e(78,"mat-card",7)(79,"mat-card-header")(80,"mat-card-title"),i(81,"Station Status"),t()(),e(82,"mat-card-content",8)(83,"div",18)(84,"mat-slide-toggle",30)(85,"span",20)(86,"mat-icon",21),i(87,"power_settings_new"),t(),i(88," Station Active "),t()()(),e(89,"div",24)(90,"mat-icon",25),i(91,"info"),t(),i(92," Inactive stations will not receive print jobs "),t()()()()()),r&2){let m;c("title",o.pageTitle())("subtitle",o.isEditMode()?"Update station configuration and printer settings":"Add a new station to manage kitchen printers"),l(6),c("disabled",o.isSubmitting()),l(),f(o.isSubmitting()?7:8),l(2),I(" ",o.submitButtonText()," "),l(2),c("formGroup",o.stationForm),l(14),f((m=o.stationForm.get("name"))!=null&&m.hasError("required")&&((m=o.stationForm.get("name"))!=null&&m.touched)?25:-1),l(6),_(o.stationTypes),l(24),_(o.paperSizes),l(19),f(o.printers.length===0?74:-1),l(),_(o.printers.controls),l(2),f(o.printers.length>0?77:-1)}},dependencies:[k,L,R,H,U,K,j,Ct,pt,st,mt,lt,dt,ut,ct,bt,St,V,B,q,O,D,z,ot,X,J,Y,Q,W,rt,nt,it,et,Z,tt,gt,ft,_t,xt,Et,ht,A],styles:[".section-title[_ngcontent-%COMP%]{font-size:16px;font-weight:600;margin-bottom:16px;color:#333;display:flex;align-items:center}.printer-card[_ngcontent-%COMP%]{border:1px solid #e0e0e0;padding:16px;background-color:#fafafa}.alert[_ngcontent-%COMP%]{padding:12px 16px;border-radius:4px;margin-bottom:16px}.alert-info[_ngcontent-%COMP%]{background-color:#e3f2fd;border:1px solid #90caf9;color:#1976d2}.gap-2[_ngcontent-%COMP%]{gap:8px}"]})};export{yt as CreateStationComponent};
