import{a as E}from"./chunk-AIJP532J.js";import"./chunk-NWQQ2VP3.js";import"./chunk-DXWLW3LX.js";import{g as I}from"./chunk-X7SU23UW.js";import{a as V,b as B}from"./chunk-W6FIBOPD.js";import{a as M,b as w}from"./chunk-GGWIF4RR.js";import"./chunk-Y4VWLT32.js";import"./chunk-CDKFCYZ5.js";import{b as D,c as T}from"./chunk-2HLT5ZQQ.js";import{Y as S,_ as k}from"./chunk-UUZHPQZB.js";import"./chunk-CQ6SLR32.js";import"./chunk-BFT2MTJY.js";import{e as _,g as P}from"./chunk-QAO3BBZ5.js";import"./chunk-KTA4MFBX.js";import{t as h}from"./chunk-HUSU2JWO.js";import{Eb as b,Fb as v,Lb as e,Mb as n,Nb as y,Ub as g,Yb as u,Za as f,_b as m,ca as c,ha as d,ia as p,mb as x,nc as r,oc as C,ta as l}from"./chunk-HCNG3XRF.js";import"./chunk-EQDQRRRY.js";function Y(o,t){o&1&&(e(0,"div",2),y(1,"mat-progress-spinner",3),e(2,"h2",4),r(3,"Processing Your Payment"),n(),e(4,"p",5),r(5,"Please wait while we verify your transaction..."),n()())}function O(o,t){if(o&1){let i=g();e(0,"div",2)(1,"mat-icon",6),r(2,"check_circle"),n(),e(3,"h2",4),r(4,"Payment Successful!"),n(),e(5,"p",7),r(6,"Your subscription has been activated. You can now access all features."),n(),e(7,"button",8),u("click",function(){d(i);let s=m();return p(s.navigateToDashboard())}),r(8," Go to Dashboard "),n()()}}function R(o,t){if(o&1){let i=g();e(0,"div",2)(1,"mat-icon",9),r(2,"error_circle"),n(),e(3,"h2",4),r(4,"Payment Failed"),n(),e(5,"p",10),r(6),n(),e(7,"div",11)(8,"button",12),u("click",function(){d(i);let s=m();return p(s.retryPayment())}),r(9," Retry Payment "),n(),e(10,"button",13),u("click",function(){d(i);let s=m();return p(s.contactSupport())}),r(11," Contact Support "),n()()()}if(o&2){let i=m();f(6),C(i.errorMessage())}}var N=class o{route=c(_);router=c(P);snackBar=c(M);subscriptionService=c(E);isProcessing=l(!0);isSuccess=l(!1);isError=l(!1);errorMessage=l("An error occurred. Please try again.");roomCount=0;reference="";storeId="";ngOnInit(){this.route.queryParams.subscribe(t=>{this.reference=t.reference,this.roomCount=parseInt(t.roomCount||"0",10),this.storeId=t.storeId,this.reference&&this.storeId?this.verifyPayment():this.handleError("Missing payment reference or store ID")})}verifyPayment(){this.subscriptionService.verifyUpgradePayment(this.reference,this.roomCount,this.storeId).subscribe({next:t=>{this.isProcessing.set(!1),this.isSuccess.set(!0),this.snackBar.open("Payment successful! Your subscription is now active.","Close",{duration:5e3})},error:t=>{let i=t.error?.message||"Payment verification failed";this.handleError(i)}})}handleError(t){this.isProcessing.set(!1),this.isError.set(!0),this.errorMessage.set(t)}navigateToDashboard(){this.router.navigate(["/menu/hms"])}retryPayment(){this.router.navigate(["/pricing"])}contactSupport(){window.location.href="mailto:support@shopbot.com"}static \u0275fac=function(i){return new(i||o)};static \u0275cmp=x({type:o,selectors:[["app-payment-callback"]],decls:5,vars:1,consts:[[1,"min-h-screen","flex","items-center","justify-center","bg-gradient-to-br","from-purple-500","to-purple-700","p-4"],[1,"w-full","max-w-md","bg-white","rounded-lg","shadow-lg","p-8"],[1,"flex","flex-col","items-center","gap-6"],["diameter","50","mode","indeterminate"],[1,"text-2xl","font-semibold","text-gray-800"],[1,"text-gray-600","text-sm","text-center"],[1,"text-5xl","text-green-500"],[1,"text-gray-600","text-center"],["mat-raised-button","","color","primary",1,"w-full","mt-2",3,"click"],[1,"text-5xl","text-red-500"],[1,"text-gray-600","text-center","text-sm"],[1,"flex","gap-3","w-full"],["mat-raised-button","","color","accent",1,"flex-1",3,"click"],["mat-stroked-button","",1,"flex-1",3,"click"]],template:function(i,a){i&1&&(e(0,"div",0)(1,"div",1),b(2,Y,6,0,"div",2)(3,O,9,0,"div",2)(4,R,12,1,"div",2),n()()),i&2&&(f(2),v(a.isProcessing()?2:a.isSuccess()?3:a.isError()?4:-1))},dependencies:[h,I,B,V,T,D,k,S,w],encapsulation:2})};export{N as PaymentCallbackComponent};
