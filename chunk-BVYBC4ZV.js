import{a as Ye}from"./chunk-NLFI464S.js";import{a as Le,b as Qe}from"./chunk-J5WNIMVA.js";import{a as $e}from"./chunk-QBBPDKHM.js";import{a as je,b as ze}from"./chunk-LSNVMFZZ.js";import{a as X,b as Z,e as ee,f as te,g as ne,h as ie}from"./chunk-LKRQNUDW.js";import{a as He}from"./chunk-IPDJJ377.js";import{a as Fe,b as Oe,c as Ie,d as we,e as Ne,f as Re,g as Ue,h as Be,i as Ve,j as qe,k as Ge}from"./chunk-DQAEAUAH.js";import{a as De,b as ke,c as Te,g as Ae}from"./chunk-32W4X7QQ.js";import{i as be}from"./chunk-WFQLSX5X.js";import{a as Se,b as Pe}from"./chunk-D2CDDOVY.js";import{d as Ce}from"./chunk-S6O7RC67.js";import{c as Ee}from"./chunk-WD3LGOJ6.js";import{b as J,c as K,d as W}from"./chunk-VN3HHLBZ.js";import{a as Q,b as ye,d as he,h as Y}from"./chunk-THLNJRLH.js";import{a as ve,b as Me}from"./chunk-YJKLGOC4.js";import{B as L,b as V,d as h,g as q,h as G,m as H,s as j,t as z,z as $}from"./chunk-ADPCW6JI.js";import{a as xe}from"./chunk-RRHIWUSE.js";import{b as U,c as B}from"./chunk-IYN665YT.js";import{Z as N,aa as R}from"./chunk-OYVOT3CA.js";import{h as ue,l as ge,m as fe,p as _e,r as w}from"./chunk-6BQAOBQP.js";import{$a as l,Ec as pe,Gb as p,Hb as u,Jc as c,Kc as D,Lc as y,Mb as C,Nb as t,Ob as e,Pb as g,Tb as P,Tc as ae,Ub as E,Wb as O,_b as M,ac as s,ea as x,ja as T,ka as A,lc as ce,ob as F,oc as I,pc as i,qc as S,rc as d,ub as b,va as v}from"./chunk-H33Y42PP.js";function at(a,o){a&1&&(t(0,"div",16)(1,"div",21)(2,"mat-icon",22),i(3,"warning"),e(),t(4,"span",23),i(5," Please confirm all room readiness requirements before proceeding. "),e()()())}var Je=class a{dialogRef=x(X);fb=x($);data=x(Z);loading=v(!1);checkInForm=this.fb.group({isClean:[!1,h.requiredTrue],isMaintained:[!1,h.requiredTrue],amenitiesReady:[!1,h.requiredTrue],notes:[""]});get isFormValid(){return this.checkInForm.valid}get roomNumbers(){return this.data.reservation.rooms?this.data.reservation.rooms.map(o=>{let n=o.room;return typeof n=="string"?n:n.roomNumber||n._id}).join(", "):""}onCancel(){this.dialogRef.close({confirmed:!1})}onConfirm(){if(!this.isFormValid)return;let o=this.checkInForm.value,n={confirmed:!0,roomChecks:{isClean:o.isClean||!1,isMaintained:o.isMaintained||!1,amenitiesReady:o.amenitiesReady||!1},notes:o.notes||void 0};this.dialogRef.close(n)}static \u0275fac=function(n){return new(n||a)};static \u0275cmp=F({type:a,selectors:[["app-check-in-confirmation-dialog"]],decls:46,vars:8,consts:[["mat-dialog-title",""],[1,"bg-gray-50","rounded-lg","p-4","mb-6"],[1,"font-semibold","text-gray-900","mb-3"],[1,"grid","grid-cols-2","gap-4","text-sm"],[1,"text-gray-600"],[1,"font-medium","text-gray-900"],[1,"space-y-4",3,"formGroup"],[1,"font-semibold","text-gray-900"],[1,"space-y-3"],[1,"flex","items-center","gap-3"],["formControlName","isClean","color","primary"],[1,"text-sm","text-gray-700"],["formControlName","isMaintained","color","primary"],["formControlName","amenitiesReady","color","primary"],["appearance","outline",1,"w-full","mt-6"],["matInput","","formControlName","notes","rows","3","placeholder","Any special notes or observations..."],[1,"bg-amber-50","border","border-amber-200","rounded-lg","p-3","mt-6"],["align","end"],["mat-button","",3,"click"],["matButton","filled","color","primary",3,"click","disabled"],[1,"mr-2"],[1,"flex","items-center","gap-2"],[1,"text-amber-600","text-sm"],[1,"text-xs","text-amber-800","font-medium"]],template:function(n,r){n&1&&(t(0,"h2",0),i(1),e(),t(2,"mat-dialog-content")(3,"div",1)(4,"h3",2),i(5,"Guest Information"),e(),t(6,"div",3)(7,"div")(8,"span",4),i(9,"Name:"),e(),t(10,"div",5),i(11),c(12,"getGuestName"),e()(),t(13,"div")(14,"span",4),i(15,"Room(s):"),e(),t(16,"div",5),i(17),e()()()(),t(18,"form",6)(19,"h3",7),i(20,"Room Readiness Checklist"),e(),t(21,"div",8)(22,"div",9),g(23,"mat-checkbox",10),t(24,"span",11),i(25,"Room is clean and housekeeping complete"),e()(),t(26,"div",9),g(27,"mat-checkbox",12),t(28,"span",11),i(29,"All maintenance issues resolved"),e()(),t(30,"div",9),g(31,"mat-checkbox",13),t(32,"span",11),i(33,"Amenities and supplies are stocked"),e()()(),t(34,"mat-form-field",14)(35,"mat-label"),i(36,"Check-in Notes (Optional)"),e(),g(37,"textarea",15),e()(),p(38,at,6,0,"div",16),e(),t(39,"mat-dialog-actions",17)(40,"button",18),M("click",function(){return r.onCancel()}),i(41,"Cancel"),e(),t(42,"button",19),M("click",function(){return r.onConfirm()}),t(43,"mat-icon",20),i(44,"check_circle"),e(),i(45," Confirm Check-In "),e()()),n&2&&(l(),d(" Confirm Check-In (",r.data.reservation.confirmationNumber,`)
`),l(10),S(D(12,6,r.data.reservation.guest)),l(6),S(r.roomNumbers),l(),C("formGroup",r.checkInForm),l(20),u(r.isFormValid?-1:38),l(4),C("disabled",!r.isFormValid||r.loading()))},dependencies:[ie,ee,ne,te,R,N,B,U,ze,je,J,Y,Q,W,K,L,H,V,q,G,z,j,w,$e],styles:[".check-in-dialog[_ngcontent-%COMP%]   .mat-mdc-checkbox[_ngcontent-%COMP%]   .mdc-checkbox[_ngcontent-%COMP%]{margin-right:8px}.check-in-dialog[_ngcontent-%COMP%]   .mat-mdc-form-field[_ngcontent-%COMP%]   .mat-mdc-text-field-wrapper[_ngcontent-%COMP%]{background-color:#fafafa}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.animate-spin[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_spin 1s linear infinite}"]})};var ot=a=>({prefix:a});function rt(a,o){a&1&&(t(0,"mat-icon",28),i(1,"add_circle_outline"),e(),i(2," Add Transaction "))}function lt(a,o){a&1&&(t(0,"mat-form-field",31)(1,"mat-label"),i(2,"Transaction Type"),e(),t(3,"mat-select",45)(4,"mat-option",41),i(5,"Refund"),e(),t(6,"mat-option",46),i(7,"Payment"),e()()())}function mt(a,o){a&1&&(t(0,"mat-error"),i(1,"Amount is required"),e())}function dt(a,o){a&1&&(t(0,"mat-error"),i(1,"Amount must be greater than 0"),e())}function st(a,o){if(a&1&&(t(0,"mat-error"),i(1),e()),a&2){let n,r=s(2);l(),d(" Amount cannot exceed ",((n=r.paymentForm.get("type"))==null?null:n.value)==="refund"?"refund due":"balance due"," ")}}function ct(a,o){if(a&1&&(t(0,"mat-error"),i(1),e()),a&2){let n,r=s(2);l(),d("",((n=r.paymentForm.get("type"))==null?null:n.value)==="refund"?"Refund method":"Payment method"," is required")}}function pt(a,o){if(a&1){let n=O();t(0,"button",49),M("click",function(){T(n);let m=s(3);return A(m.setAmount(100))}),i(1),c(2,"currency"),e()}if(a&2){let n,r=s(3);l(),d(" ",y(2,1,100,(n=r.storeStore.selectedStore())==null?null:n.currency)," ")}}function ut(a,o){if(a&1){let n=O();t(0,"button",49),M("click",function(){T(n);let m=s(3);return A(m.setAmount(50))}),i(1),c(2,"currency"),e()}if(a&2){let n,r=s(3);l(),d(" ",y(2,1,50,(n=r.storeStore.selectedStore())==null?null:n.currency)," ")}}function gt(a,o){if(a&1){let n=O();t(0,"div")(1,"h4",47),i(2,"Quick Amounts"),e(),t(3,"div",48)(4,"button",49),M("click",function(){T(n);let m=s(2);return A(m.setAmount(m.balanceAmount()))}),i(5),c(6,"currency"),e(),p(7,pt,3,4,"button",50),p(8,ut,3,4,"button",50),e()()}if(a&2){let n,r=s(2);l(5),d(" Full Balance (",y(6,3,r.balanceAmount(),(n=r.storeStore.selectedStore())==null?null:n.currency),") "),l(2),u(r.balanceAmount()>=100?7:-1),l(),u(r.balanceAmount()>=50?8:-1)}}function ft(a,o){if(a&1&&(t(0,"div",29),b(1,lt,8,0,"mat-form-field",30),t(2,"mat-form-field",31)(3,"mat-label"),i(4),e(),t(5,"span",32),i(6),e(),g(7,"input",33),p(8,mt,2,0,"mat-error"),p(9,dt,2,0,"mat-error"),p(10,st,2,1,"mat-error"),e(),t(11,"mat-form-field",31)(12,"mat-label"),i(13),e(),t(14,"mat-select",34)(15,"mat-option",35),i(16,"Cash"),e(),t(17,"mat-option",36),i(18,"Credit/Debit Card"),e(),t(19,"mat-option",37),i(20,"Bank Transfer"),e(),t(21,"mat-option",38),i(22,"Mobile Money"),e(),t(23,"mat-option",39),i(24,"Check"),e(),t(25,"mat-option",40),i(26,"Online Payment"),e(),t(27,"mat-option",41),i(28,"Refund"),e()(),p(29,ct,2,1,"mat-error"),e()(),t(30,"mat-form-field",31)(31,"mat-label"),i(32,"Reference Number (Optional)"),e(),g(33,"input",42),e(),t(34,"mat-form-field",31)(35,"mat-label"),i(36,"Notes (Optional)"),e(),g(37,"textarea",43),e(),b(38,gt,9,6,"div",44)),a&2){let n,r,m,f,k,oe,re,le,me,de,se,_=s();l(),C("ngIf",_.balanceAmount()<0),l(3),S(((n=_.paymentForm.get("type"))==null?null:n.value)==="refund"?"Refund Amount":"Payment Amount"),l(2),d("",(r=_.storeStore.selectedStore())==null?null:r.currency,"\xA0"),l(),C("options",pe(12,ot,(m=_.storeStore.selectedStore())==null?null:m.currency))("min",(((f=_.paymentForm.get("type"))==null?null:f.value)==="refund",.01))("max",((k=_.paymentForm.get("type"))==null?null:k.value)==="refund"?_.absBalanceAmount():_.balanceAmount()),l(),u((oe=_.paymentForm.get("amount"))!=null&&oe.hasError("required")?8:-1),l(),u((re=_.paymentForm.get("amount"))!=null&&re.hasError("min")?9:-1),l(),u((le=_.paymentForm.get("amount"))!=null&&le.hasError("max")?10:-1),l(3),S(((me=_.paymentForm.get("type"))==null?null:me.value)==="refund"?"Refund Method":"Payment Method"),l(16),u((de=_.paymentForm.get("method"))!=null&&de.hasError("required")?29:-1),l(9),C("ngIf",((se=_.paymentForm.get("type"))==null?null:se.value)!=="refund")}}function _t(a,o){a&1&&(t(0,"mat-error"),i(1,"Payment status is required"),e())}function Ct(a,o){a&1&&(t(0,"mat-error"),i(1,"Payment method is required"),e())}function xt(a,o){if(a&1&&(t(0,"mat-error",56)(1,"strong"),i(2,'Cannot mark as "Paid in Full":'),e(),i(3," There is still an outstanding balance of "),t(4,"strong"),i(5),c(6,"currency"),e(),i(7,'. Please use "Partial Payment" status or record additional payments first. '),e()),a&2){let n,r=s(2);l(5),S(y(6,1,r.balanceAmount(),(n=r.storeStore.selectedStore())==null?null:n.currency))}}function bt(a,o){if(a&1&&(t(0,"mat-form-field",31)(1,"mat-label"),i(2,"Payment Status"),e(),t(3,"mat-select",51)(4,"mat-option",52),i(5,"Pending Payment"),e(),t(6,"mat-option",53),i(7,"Partial Payment"),e(),t(8,"mat-option",54),i(9,"Paid in Full"),e()(),p(10,_t,2,0,"mat-error"),e(),t(11,"mat-form-field",31)(12,"mat-label"),i(13,"Payment Method"),e(),t(14,"mat-select",34)(15,"mat-option",35),i(16,"Cash"),e(),t(17,"mat-option",36),i(18,"Credit/Debit Card"),e(),t(19,"mat-option",37),i(20,"Bank Transfer"),e(),t(21,"mat-option",38),i(22,"Mobile Money"),e(),t(23,"mat-option",39),i(24,"Check"),e(),t(25,"mat-option",40),i(26,"Online Payment"),e()(),p(27,Ct,2,0,"mat-error"),e(),t(28,"mat-form-field",31)(29,"mat-label"),i(30,"Transaction Reference (Optional)"),e(),g(31,"input",42),e(),t(32,"mat-form-field",31)(33,"mat-label"),i(34,"Payment Notes (Optional)"),e(),g(35,"textarea",55),e(),p(36,xt,8,4,"mat-error",56)),a&2){let n,r,m,f=s();l(10),u((n=f.paymentForm.get("status"))!=null&&n.hasError("required")?10:-1),l(17),u((r=f.paymentForm.get("method"))!=null&&r.hasError("required")?27:-1),l(9),u(((m=f.paymentForm.get("status"))==null?null:m.value)==="paid"&&f.balanceAmount()>0?36:-1)}}function yt(a,o){if(a&1&&(t(0,"mat-icon",28),i(1,"history"),e(),i(2)),a&2){let n=s();l(2),d(" History (",n.transactions().length,") ")}}function ht(a,o){if(a&1&&(t(0,"div",21)(1,"strong"),i(2,"\u26A0\uFE0F Note:"),e(),i(3),e()),a&2){let n=s();l(3),d(" ",n.loadError()," ")}}function vt(a,o){a&1&&(t(0,"div",22),g(1,"mat-progress-spinner",57),e())}function Mt(a,o){a&1&&(t(0,"div",23)(1,"mat-icon",58),i(2,"payment"),e(),t(3,"p"),i(4,"No transactions recorded yet"),e()())}function St(a,o){a&1&&(t(0,"th",73),i(1,"Date"),e())}function Pt(a,o){if(a&1&&(t(0,"td",74),i(1),c(2,"date"),e()),a&2){let n=o.$implicit;l(),d(" ",y(2,1,n.createdAt,"short")," ")}}function Et(a,o){a&1&&(t(0,"th",75),i(1,"Amount"),e())}function Dt(a,o){if(a&1&&(t(0,"td",76),i(1),c(2,"currency"),e()),a&2){let n,r=o.$implicit,m=s(2);l(),d(" ",y(2,1,r.amount,(n=m.storeStore.selectedStore())==null?null:n.currency)," ")}}function kt(a,o){a&1&&(t(0,"th",73),i(1,"Method"),e())}function Tt(a,o){if(a&1&&(t(0,"td",74)(1,"span",77),i(2),c(3,"titlecase"),e()()),a&2){let n=o.$implicit;l(2),d(" ",D(3,1,n.method)," ")}}function At(a,o){a&1&&(t(0,"th",73),i(1,"Type"),e())}function Ft(a,o){if(a&1&&(t(0,"td",74)(1,"span"),i(2),c(3,"titlecase"),e()()),a&2){let n=o.$implicit;l(),I(n.type==="payment"?"px-2 py-1 bg-green-100 text-green-800 rounded text-xs":"px-2 py-1 bg-red-100 text-red-800 rounded text-xs"),l(),d(" ",D(3,3,n.type)," ")}}function Ot(a,o){a&1&&(t(0,"th",73),i(1,"Notes"),e())}function It(a,o){if(a&1&&(t(0,"td",78),i(1),e()),a&2){let n=o.$implicit;l(),d(" ",n.notes||"-"," ")}}function wt(a,o){a&1&&(t(0,"th",75),i(1,"Balance After "),e())}function Nt(a,o){if(a&1&&(t(0,"td",79),i(1),c(2,"currency"),e()),a&2){let n,r=o.$implicit,m=s(2);l(),d(" ",y(2,1,r.balanceAfterTransaction,(n=m.storeStore.selectedStore())==null?null:n.currency)," ")}}function Rt(a,o){a&1&&g(0,"tr",80)}function Ut(a,o){a&1&&g(0,"tr",81)}function Bt(a,o){if(a&1&&(t(0,"table",24),P(1,59),b(2,St,2,0,"th",60)(3,Pt,3,4,"td",61),E(),P(4,62),b(5,Et,2,0,"th",63)(6,Dt,3,4,"td",64),E(),P(7,65),b(8,kt,2,0,"th",60)(9,Tt,4,3,"td",61),E(),P(10,66),b(11,At,2,0,"th",60)(12,Ft,4,5,"td",61),E(),P(13,67),b(14,Ot,2,0,"th",60)(15,It,2,1,"td",68),E(),P(16,69),b(17,wt,2,0,"th",63)(18,Nt,3,4,"td",70),E(),b(19,Rt,1,0,"tr",71)(20,Ut,1,0,"tr",72),e()),a&2){let n=s();C("dataSource",n.transactions()),l(19),C("matHeaderRowDef",n.displayedColumns),l(),C("matRowDefColumns",n.displayedColumns)}}var Ke=class a{fb=x($);dialogRef=x(X);data=x(Z);storeStore=x(be);reservationService=x(Ye);authService=x(xe);currentUser=Ee(this.authService.currentUser,{initialValue:null});queryParamService=x(He);processing=v(!1);loadingTransactions=v(!1);transactions=v([]);loadError=v(null);totalAmount=v(0);paidAmount=v(0);balanceAmount=v(0);paymentPercentage=ae(()=>{let o=this.totalAmount(),n=this.paidAmount();return o>0?Math.round(n/o*100):0});absBalanceAmount=ae(()=>Math.abs(this.balanceAmount()));displayedColumns=["date","amount","method","type","notes","balance"];paymentForm=this.fb.group({amount:[0],status:[""],method:["",h.required],reference:[""],notes:[""],type:["payment"]});constructor(){if(this.data.reservation.status==="checked_out"&&!this.data.isCheckoutFlow){setTimeout(()=>{this.dialogRef.close({confirmed:!1,error:"Cannot edit payment information for checked-out reservations"})});return}}ngOnInit(){this.initializePaymentData(),this.loadTransactions()}initializePaymentData(){let o=this.data.reservation;this.totalAmount.set(o.pricing.total),this.paidAmount.set(o.pricing.paid),this.balanceAmount.set(o.pricing.balance);let n=this.getCurrentPaymentStatus(),r=o.paymentInfo?.method||"cash";if(this.data.isCheckoutFlow){let m=this.balanceAmount()<0;this.paymentForm.get("type")?.setValue(m?"refund":"payment"),this.paymentForm.get("amount")?.setValidators([h.required,h.min(.01),m?h.max(Math.abs(this.balanceAmount())||0):h.max(this.balanceAmount()||0)]),this.paymentForm.patchValue({amount:m?Math.abs(this.balanceAmount()):this.balanceAmount()||0,method:r,type:m?"refund":"payment"})}else this.paymentForm.get("status")?.setValidators([h.required]),this.paymentForm.patchValue({status:n,method:r});this.paymentForm.updateValueAndValidity()}loadTransactions(){this.loadingTransactions.set(!0),this.loadError.set(null);let o=this.storeStore.selectedStore()?._id;if(!o){console.error("Store ID not available"),this.loadingTransactions.set(!1),this.loadError.set("Store information not available");return}this.reservationService.getReservationTransactions(o,this.data.reservation._id).subscribe({next:n=>{this.transactions.set(n),this.loadingTransactions.set(!1),this.loadError.set(null)},error:n=>{console.error("Failed to load transactions:",n),this.loadingTransactions.set(!1),n.status===404?this.loadError.set("Reservation not found. Please refresh and try again."):n.status===403?this.loadError.set("You do not have permission to view transactions for this reservation."):this.loadError.set("Failed to load transaction history. You can still record new payments."),this.transactions.set([])}})}getApprovedExtensionCost(){return this.data.reservation.extensions?this.data.reservation.extensions.filter(n=>n.status==="approved").reduce((n,r)=>n+(r.additionalCost||0),0):0}getApprovedExtensionNights(){return this.data.reservation.extensions?this.data.reservation.extensions.filter(n=>n.status==="approved").reduce((n,r)=>n+(r.additionalNights||0),0):0}hasApprovedExtensions(){return this.getApprovedExtensionCost()>0}getCurrentPaymentStatus(){let o=this.balanceAmount(),n=this.paidAmount();return o<=0?"paid":n>0?"partial":"pending"}getCurrentStatusClass(){switch(this.getCurrentPaymentStatus()){case"paid":return"text-green-600";case"partial":return"text-orange-600";case"pending":return"text-red-600";default:return"text-gray-600"}}canSave(){if(!this.paymentForm.valid)return!1;if(this.data.isCheckoutFlow)return this.paymentForm.get("type")?.value==="refund"?this.paymentForm.valid&&this.balanceAmount()<0&&this.paymentForm.get("amount")?.value>0&&this.paymentForm.get("amount")?.value<=Math.abs(this.balanceAmount()):this.paymentForm.valid&&this.balanceAmount()>0&&this.paymentForm.get("amount")?.value>0&&this.paymentForm.get("amount")?.value<=this.balanceAmount();{let o=this.paymentForm.get("status")?.value,n=this.balanceAmount();if(o==="paid"&&n>0)return!1}return!0}setAmount(o){this.paymentForm.patchValue({amount:o})}onCancel(){this.queryParamService.remove("paymentRedirection"),this.dialogRef.close({confirmed:!1})}onConfirm(){if(this.queryParamService.remove("paymentRedirection"),this.canSave()){this.processing.set(!0);let o=this.storeStore.selectedStore()?._id;if(!o){console.error("Store ID not available"),this.processing.set(!1);return}let n,r=this.currentUser()?._id;this.data.isCheckoutFlow?n={reservation:this.data.reservation._id,amount:this.paymentForm.value.amount,method:this.paymentForm.value.method,type:this.paymentForm.value.type||(this.balanceAmount()<0?"refund":"payment"),notes:this.paymentForm.value.notes||void 0,processedBy:r}:n={reservation:this.data.reservation._id,amount:0,method:this.paymentForm.value.method,type:"adjustment",notes:this.paymentForm.value.notes||void 0,processedBy:r},this.reservationService.createTransaction(o,this.data.reservation._id,n).subscribe({next:m=>{this.processing.set(!1),this.loadTransactions(),this.dialogRef.close({confirmed:!0,paymentData:n,transaction:m})},error:m=>{console.error("Error creating transaction:",m),this.processing.set(!1);let f="Failed to process transaction. Please try again.";m.status===400?f=m.error?.message||"Invalid transaction data":m.status===404&&(f="Reservation not found"),alert(f)}})}}static \u0275fac=function(n){return new(n||a)};static \u0275cmp=F({type:a,selectors:[["app-payment-update-dialog"]],decls:57,vars:31,consts:[["mat-dialog-title",""],[1,"mb-6","p-4","bg-gray-50","rounded-lg"],[1,"text-sm","font-semibold","mb-4"],[1,"grid","grid-cols-2","gap-4","mb-4"],[1,"bg-white","p-3","rounded","border","border-gray-200"],[1,"text-xs","text-gray-600","mb-1"],[1,"text-lg","font-bold"],[1,"text-lg","font-bold","text-green-600"],[1,"text-sm","font-bold"],[1,"mb-4"],[1,"flex","justify-between","items-center","mb-1"],[1,"text-xs","font-medium"],[1,"text-xs","font-semibold"],[1,"h-2","bg-gray-200","rounded-full","overflow-hidden"],[1,"h-full","bg-green-500","transition-all"],["animationDuration","300"],["label","Add Transaction",3,"disabled"],["mat-tab-label",""],[1,"space-y-4","mt-6",3,"formGroup"],["label","Transaction History",3,"disabled"],[1,"mt-6"],[1,"p-4","bg-yellow-50","border","border-yellow-200","rounded","text-sm","text-yellow-700","mb-4"],[1,"flex","justify-center","items-center","py-8"],[1,"text-center","py-8","text-gray-500"],["mat-table","",1,"w-full","mt-4",3,"dataSource"],["align","end"],["mat-button","",3,"click"],["mat-raised-button","","color","primary",3,"click","disabled"],[1,"mr-2"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4"],["appearance","outline","class","w-full",4,"ngIf"],["appearance","outline",1,"w-full"],["matPrefix",""],["matInput","","currencyMask","","step","0.01","formControlName","amount","placeholder","0.00",3,"options","min","max"],["formControlName","method"],["value","cash"],["value","card"],["value","bank_transfer"],["value","mobile_money"],["value","check"],["value","online"],["value","refund"],["matInput","","formControlName","reference","placeholder","Transaction ID, Receipt number, etc."],["matInput","","formControlName","notes","rows","3","placeholder","Additional payment notes..."],[4,"ngIf"],["formControlName","type"],["value","payment"],[1,"text-sm","font-medium","mb-2"],[1,"flex","flex-wrap","gap-2"],["type","button","mat-stroked-button","",3,"click"],["type","button","mat-stroked-button",""],["formControlName","status"],["value","pending"],["value","partial"],["value","paid"],["matInput","","formControlName","notes","rows","3","placeholder","Additional notes about the payment..."],[1,"block"],["diameter","40","mode","indeterminate"],[1,"block","text-4xl","mb-2","opacity-30"],["matColumnDef","date"],["mat-header-cell","","class","text-xs font-semibold",4,"matHeaderCellDef"],["mat-cell","","class","text-sm",4,"matCellDef"],["matColumnDef","amount"],["mat-header-cell","","class","text-xs font-semibold text-right",4,"matHeaderCellDef"],["mat-cell","","class","text-sm text-right font-semibold",4,"matCellDef"],["matColumnDef","method"],["matColumnDef","type"],["matColumnDef","notes"],["mat-cell","","class","text-sm text-gray-600",4,"matCellDef"],["matColumnDef","balance"],["mat-cell","","class","text-sm text-right",4,"matCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","","class","border-b hover:bg-gray-50",4,"matRowDef","matRowDefColumns"],["mat-header-cell","",1,"text-xs","font-semibold"],["mat-cell","",1,"text-sm"],["mat-header-cell","",1,"text-xs","font-semibold","text-right"],["mat-cell","",1,"text-sm","text-right","font-semibold"],[1,"px-2","py-1","bg-blue-100","text-blue-800","rounded","text-xs"],["mat-cell","",1,"text-sm","text-gray-600"],["mat-cell","",1,"text-sm","text-right"],["mat-header-row",""],["mat-row","",1,"border-b","hover:bg-gray-50"]],template:function(n,r){if(n&1&&(t(0,"h2",0),i(1),e(),t(2,"mat-dialog-content")(3,"div",1)(4,"h3",2),i(5,"Payment Breakdown"),e(),t(6,"div",3)(7,"div",4)(8,"div",5),i(9,"Total Amount"),e(),t(10,"div",6),i(11),c(12,"currency"),e()(),t(13,"div",4)(14,"div",5),i(15,"Amount Paid"),e(),t(16,"div",7),i(17),c(18,"currency"),e()(),t(19,"div",4)(20,"div",5),i(21,"Balance Due"),e(),t(22,"div",6),i(23),c(24,"currency"),e()(),t(25,"div",4)(26,"div",5),i(27,"Payment Status"),e(),t(28,"div",8),i(29),c(30,"titlecase"),e()()(),t(31,"div",9)(32,"div",10)(33,"span",11),i(34,"Payment Progress"),e(),t(35,"span",12),i(36),e()(),t(37,"div",13),g(38,"div",14),e()()(),t(39,"mat-tab-group",15)(40,"mat-tab",16),b(41,rt,3,0,"ng-template",17),t(42,"form",18),p(43,ft,39,14)(44,bt,37,3),e()(),t(45,"mat-tab",19),b(46,yt,3,1,"ng-template",17),t(47,"div",20),p(48,ht,4,1,"div",21),p(49,vt,2,0,"div",22)(50,Mt,5,0,"div",23)(51,Bt,21,3,"table",24),e()()()(),t(52,"mat-dialog-actions",25)(53,"a",26),M("click",function(){return r.onCancel()}),i(54,"Cancel"),e(),t(55,"a",27),M("click",function(){return r.onConfirm()}),i(56),e()()),n&2){let m,f,k;l(),d(" Transaction Management (",r.data.reservation.confirmationNumber,`)
`),l(10),d("",y(12,20,r.totalAmount(),(m=r.storeStore.selectedStore())==null?null:m.currency)," "),l(6),S(y(18,23,r.paidAmount(),(f=r.storeStore.selectedStore())==null?null:f.currency)),l(5),I(r.balanceAmount()>0?"text-red-600":"text-green-600"),l(),d(" ",y(24,26,r.balanceAmount(),(k=r.storeStore.selectedStore())==null?null:k.currency)," "),l(5),I(r.getCurrentStatusClass()),l(),d(" ",D(30,29,r.getCurrentPaymentStatus())," "),l(7),d("",r.paymentPercentage(),"%"),l(2),ce("width",r.paymentPercentage(),"%"),l(2),C("disabled",r.loadingTransactions()),l(2),C("formGroup",r.paymentForm),l(),u(r.data.isCheckoutFlow?43:44),l(2),C("disabled",r.loadingTransactions()),l(3),u(r.loadError()?48:-1),l(),u(r.loadingTransactions()?49:r.transactions().length===0?50:51),l(6),C("disabled",!r.canSave()||r.processing()),l(),d(" ",r.processing()?"Processing...":"Save Transaction"," ")}},dependencies:[w,ue,L,H,V,q,G,z,j,ie,ee,ne,te,R,N,J,Y,Q,ye,he,W,K,Pe,Se,Ce,B,U,Me,ve,Ae,De,ke,Te,Ge,Fe,Ie,Ue,we,Oe,Be,Ne,Re,Ve,qe,Qe,Le,ge,_e,fe],styles:["mat-dialog-content[_ngcontent-%COMP%]{max-height:600px;padding:24px}mat-dialog-content[_ngcontent-%COMP%]   mat-tab-group[_ngcontent-%COMP%]     .mat-mdc-tab-list{border-bottom:1px solid #e5e7eb}mat-dialog-content[_ngcontent-%COMP%]   mat-tab-group[_ngcontent-%COMP%]     .mat-mdc-tab{min-width:150px}.bg-gray-50[_ngcontent-%COMP%]{background-color:#f9fafb}.bg-gray-50[_ngcontent-%COMP%]   .bg-white[_ngcontent-%COMP%]{background-color:#fff;border:1px solid #e5e7eb}.bg-gray-50[_ngcontent-%COMP%]   .bg-white[_ngcontent-%COMP%]   .text-gray-600[_ngcontent-%COMP%]{color:#4b5563;font-size:.75rem}.h-2[_ngcontent-%COMP%]{height:.5rem}.h-2.bg-gray-200[_ngcontent-%COMP%]{background-color:#e5e7eb}.h-2[_ngcontent-%COMP%]   .bg-green-500[_ngcontent-%COMP%]{background-color:#10b981}mat-form-field[_ngcontent-%COMP%]{display:block;margin-bottom:1rem}table[_ngcontent-%COMP%]{border-collapse:collapse}table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{padding:.75rem;text-align:left;border-bottom:1px solid #e5e7eb;background-color:#f9fafb}table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:.75rem;border-bottom:1px solid #e5e7eb}table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background-color:#f9fafb}.px-2.py-1.rounded[_ngcontent-%COMP%]{padding:.5rem;border-radius:.25rem;font-size:.75rem;font-weight:600}.bg-blue-100[_ngcontent-%COMP%]{background-color:#dbeafe;color:#0c4a6e}.bg-green-100[_ngcontent-%COMP%]{background-color:#dcfce7;color:#166534}.bg-red-100[_ngcontent-%COMP%]{background-color:#fee2e2;color:#991b1b}.opacity-30[_ngcontent-%COMP%]{opacity:.3}mat-progress-spinner[_ngcontent-%COMP%]{display:block;margin:0 auto}mat-dialog-actions[_ngcontent-%COMP%]{padding:16px 24px;border-top:1px solid #e5e7eb;display:flex;justify-content:flex-end;gap:1rem}mat-dialog-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{min-width:100px}.text-xs[_ngcontent-%COMP%]{font-size:.75rem}.text-sm[_ngcontent-%COMP%]{font-size:.875rem}.text-lg[_ngcontent-%COMP%]{font-size:1.125rem}.font-medium[_ngcontent-%COMP%]{font-weight:500}.font-semibold[_ngcontent-%COMP%]{font-weight:600}.font-bold[_ngcontent-%COMP%]{font-weight:700}.text-gray-500[_ngcontent-%COMP%]{color:#6b7280}.text-gray-600[_ngcontent-%COMP%]{color:#4b5563}.text-green-600[_ngcontent-%COMP%]{color:#16a34a}.text-red-600[_ngcontent-%COMP%]{color:#dc2626}.text-blue-800[_ngcontent-%COMP%]{color:#1e40af}.text-blue-50[_ngcontent-%COMP%]{background-color:#eff6ff}.border-blue-200[_ngcontent-%COMP%]{border:1px solid #bfdbfe}.rounded-lg[_ngcontent-%COMP%]{border-radius:.5rem}.mb-1[_ngcontent-%COMP%]{margin-bottom:.25rem}.mb-2[_ngcontent-%COMP%]{margin-bottom:.5rem}.mb-4[_ngcontent-%COMP%]{margin-bottom:1rem}.mb-6[_ngcontent-%COMP%]{margin-bottom:1.5rem}.p-2[_ngcontent-%COMP%]{padding:.5rem}.p-3[_ngcontent-%COMP%]{padding:.75rem}.p-4[_ngcontent-%COMP%]{padding:1rem}.grid[_ngcontent-%COMP%]{display:grid}.gap-2[_ngcontent-%COMP%]{gap:.5rem}.gap-4[_ngcontent-%COMP%]{gap:1rem}.grid-cols-2[_ngcontent-%COMP%]{grid-template-columns:repeat(2,minmax(0,1fr))}@media(max-width:768px){.grid-cols-2[_ngcontent-%COMP%]{grid-template-columns:1fr}}"]})};export{Je as a,Ke as b};
