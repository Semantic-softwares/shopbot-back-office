import{a as R}from"./chunk-NWQQ2VP3.js";import{a as A}from"./chunk-DXWLW3LX.js";import{c as ee,d as te}from"./chunk-7JNU3RG5.js";import{a as Q,b as U,e as X,h as Z}from"./chunk-3SKQMCZR.js";import"./chunk-UJ5WOJLI.js";import{g as $}from"./chunk-X7SU23UW.js";import{a as oe,b as re}from"./chunk-W6FIBOPD.js";import{B as O,C as W,E as Y,b as z,d,g as G,h as V,m as J,s as H,t as K}from"./chunk-EQD33MW2.js";import"./chunk-3R2L4BJM.js";import{a as q}from"./chunk-GGWIF4RR.js";import{a as j}from"./chunk-VVXEDJF7.js";import{a as D}from"./chunk-CUQFI5AX.js";import"./chunk-Y4VWLT32.js";import"./chunk-CDKFCYZ5.js";import{b as ie,c as ne}from"./chunk-2HLT5ZQQ.js";import{X as T,Y as I,_ as P}from"./chunk-UUZHPQZB.js";import{a as B}from"./chunk-CQ6SLR32.js";import"./chunk-BFT2MTJY.js";import{g as k,h as F}from"./chunk-QAO3BBZ5.js";import"./chunk-KTA4MFBX.js";import"./chunk-HUSU2JWO.js";import{Cb as L,D as C,Eb as u,Fb as p,Kb as S,Lb as e,Mb as t,Nb as c,S as v,Yb as y,Za as l,ca as s,m as h,mb as M,n as w,nc as i,oc as N,ta as E,x as _}from"./chunk-HCNG3XRF.js";import"./chunk-EQDQRRRY.js";function me(o,r){o&1&&(e(0,"mat-error"),i(1,"Store number is required"),t())}function se(o,r){o&1&&(e(0,"mat-error"),i(1,"Enter a valid 4-digit store number"),t())}function de(o,r){o&1&&(e(0,"mat-error"),i(1,"Email is required"),t())}function ue(o,r){o&1&&(e(0,"mat-error"),i(1,"Please enter a valid email"),t())}function pe(o,r){o&1&&(e(0,"mat-error"),i(1,"Password is required"),t())}function ce(o,r){o&1&&(e(0,"span",22),c(1,"mat-spinner",46),i(2," Signing in... "),t())}function fe(o,r){o&1&&i(0," Sign in ")}var le=class o{fb=s(W);authService=s(j);snackBar=s(q);router=s(k);rolesService=s(D);hide=E(!0);loading=E(!1);storeService=s(A);storeStore=s(R);sessionStorage=s(B);clickEvent(r){this.hide.set(!this.hide()),r.stopPropagation()}loginForm=this.fb.group({email:["",[d.required,d.email]],password:["",d.required],storeNumber:["",[d.required,d.minLength(4),d.maxLength(4),d.pattern(/^\d{4}$/)]]});onSubmit(){if(this.loginForm.valid){this.loading.set(!0);let{email:r,password:f,storeNumber:n}=this.loginForm.value;this.authService.login(r,f).pipe(v(a=>{let m=a._id;return _({storeAccess:this.storeService.validateMerchantStoreAccess(n,m),merchantStores:this.storeService.getMerchantStores(m)}).pipe(v(({storeAccess:g,merchantStores:x})=>{if(!g.success||!g.data)return this.clearSessionAndLogout(),w(()=>new Error("You do not have access to this store."));let b=g.data,ae=x&&x.length>0?x:[b];return this.storeStore.setSelectedStores(ae),this.storeStore.setSelectedStore(b),this.snackBar.open("Login successful!","Close",{duration:3e3,horizontalPosition:"end",verticalPosition:"top"}),setTimeout(()=>{this.router.navigate(["/menu/menu"])},1e3),this.loading.set(!1),h(null)}))}),C(a=>(this.snackBar.open(a.error?.message||a.message||"Login failed. Please try again.","Close",{duration:5e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["error-snackbar"]}),this.loading.set(!1),h(null)))).subscribe()}}clearSessionAndLogout(){this.rolesService.clearAccess(),this.sessionStorage.clearAll(),this.storeStore.setSelectedStore(null),this.storeStore.setSelectedStores([])}static \u0275fac=function(f){return new(f||o)};static \u0275cmp=M({type:o,selectors:[["login"]],decls:106,vars:12,consts:[[1,"min-h-screen","w-full","flex","flex-col","lg:flex-row"],[1,"w-full","lg:w-1/2","flex","flex-col","justify-center","px-6","py-12","lg:px-16","xl:px-24","bg-white"],[1,"mb-8"],[1,"text-2xl","font-bold","text-gray-900"],[1,"text-gray-500","mt-1"],[1,"max-w-md"],[1,"text-2xl","font-semibold","text-gray-800","mb-2"],[1,"text-gray-500","mb-8"],[1,"flex","flex-col","gap-4",3,"ngSubmit","formGroup"],["appearance","outline",1,"w-full"],["matInput","","formControlName","storeNumber","placeholder","Enter 4-digit store number","maxlength","4"],["matSuffix","","fontSet","material-icons-outlined"],["matInput","","formControlName","email","type","email","placeholder","you@example.com"],["matInput","","formControlName","password","placeholder","\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022",3,"type"],["mat-icon-button","","matSuffix","","type","button",3,"click"],["fontSet","material-icons-outlined"],[1,"flex","items-center","justify-between"],[1,"flex","items-center","gap-2","cursor-pointer"],["type","checkbox",1,"w-4","h-4","rounded","border-gray-300","text-blue-600","focus:ring-blue-500"],[1,"text-sm","text-gray-600"],["routerLink","/auth/forgot-password",1,"text-sm","text-blue-600","hover:text-blue-800","font-medium"],["mat-flat-button","","color","primary","type","submit",1,"w-full","h-12","text-base","mt-2",3,"disabled"],[1,"flex","items-center","justify-center","gap-2"],[1,"text-center","mt-6"],["routerLink","/auth/signup",1,"text-sm","font-medium","text-blue-600","hover:text-blue-800","ml-1"],[1,"hidden","lg:flex","lg:w-1/2","bg-gradient-to-br","from-blue-600","via-blue-700","to-indigo-800","relative","overflow-hidden"],[1,"absolute","inset-0","opacity-10"],[1,"absolute","top-0","left-0","w-96","h-96","bg-white","rounded-full","-translate-x-1/2","-translate-y-1/2"],[1,"absolute","bottom-0","right-0","w-80","h-80","bg-white","rounded-full","translate-x-1/3","translate-y-1/3"],[1,"absolute","top-1/2","left-1/2","w-64","h-64","bg-white","rounded-full","-translate-x-1/2","-translate-y-1/2"],[1,"relative","z-10","flex","flex-col","justify-center","px-12","xl:px-16","text-white"],[1,"mb-10"],[1,"text-3xl","xl:text-4xl","font-bold","leading-tight","mb-4"],[1,"text-blue-200","text-lg"],[1,"grid","grid-cols-2","gap-6"],[1,"bg-white/10","backdrop-blur-sm","rounded-xl","p-5"],["fontSet","material-icons-outlined",1,"text-blue-300","text-3xl","mb-3"],[1,"font-semibold","text-white","mb-1"],[1,"text-blue-200","text-sm"],[1,"mt-12","pt-8","border-t","border-white/20"],[1,"flex","items-center","gap-4"],[1,"flex","-space-x-2"],[1,"w-10","h-10","rounded-full","bg-blue-400","border-2","border-white","flex","items-center","justify-center","text-sm","font-medium"],[1,"w-10","h-10","rounded-full","bg-indigo-400","border-2","border-white","flex","items-center","justify-center","text-sm","font-medium"],[1,"w-10","h-10","rounded-full","bg-purple-400","border-2","border-white","flex","items-center","justify-center","text-sm","font-medium"],[1,"text-white","font-medium"],["diameter","20"]],template:function(f,n){if(f&1&&(e(0,"div",0)(1,"div",1)(2,"div",2)(3,"h1",3),i(4,"ShopBot"),t(),e(5,"p",4),i(6,"Welcome back"),t()(),e(7,"div",5)(8,"h2",6),i(9,"Sign in to your account"),t(),e(10,"p",7),i(11,"Enter your credentials to access your dashboard"),t(),e(12,"form",8),y("ngSubmit",function(){return n.onSubmit()}),e(13,"mat-form-field",9)(14,"mat-label"),i(15,"Store Number"),t(),c(16,"input",10),e(17,"mat-icon",11),i(18,"store"),t(),u(19,me,2,0,"mat-error"),u(20,se,2,0,"mat-error"),t(),e(21,"mat-form-field",9)(22,"mat-label"),i(23,"Email"),t(),c(24,"input",12),e(25,"mat-icon",11),i(26,"email"),t(),u(27,de,2,0,"mat-error"),u(28,ue,2,0,"mat-error"),t(),e(29,"mat-form-field",9)(30,"mat-label"),i(31,"Password"),t(),c(32,"input",13),e(33,"button",14),y("click",function(m){return n.clickEvent(m)}),e(34,"mat-icon",15),i(35),t()(),u(36,pe,2,0,"mat-error"),t(),e(37,"div",16)(38,"label",17),c(39,"input",18),e(40,"span",19),i(41,"Remember me"),t()(),e(42,"a",20),i(43," Forgot password? "),t()(),e(44,"button",21),u(45,ce,3,0,"span",22)(46,fe,1,0),t(),e(47,"div",23)(48,"span",19),i(49,"Don't have an account?"),t(),e(50,"a",24),i(51," Create account "),t()()()()(),e(52,"div",25)(53,"div",26),c(54,"div",27)(55,"div",28)(56,"div",29),t(),e(57,"div",30)(58,"div",31)(59,"h2",32),i(60," Manage your business with ease. "),t(),e(61,"p",33),i(62," Access your dashboard to monitor sales, manage inventory, and grow your business. "),t()(),e(63,"div",34)(64,"div",35)(65,"mat-icon",36),i(66,"trending_up"),t(),e(67,"h4",37),i(68,"Real-time Analytics"),t(),e(69,"p",38),i(70,"Track your sales and performance in real-time"),t()(),e(71,"div",35)(72,"mat-icon",36),i(73,"inventory_2"),t(),e(74,"h4",37),i(75,"Inventory Control"),t(),e(76,"p",38),i(77,"Manage stock levels effortlessly"),t()(),e(78,"div",35)(79,"mat-icon",36),i(80,"people"),t(),e(81,"h4",37),i(82,"Staff Management"),t(),e(83,"p",38),i(84,"Organize your team with ease"),t()(),e(85,"div",35)(86,"mat-icon",36),i(87,"hotel"),t(),e(88,"h4",37),i(89,"Hotel Management"),t(),e(90,"p",38),i(91,"Complete property management system"),t()()(),e(92,"div",39)(93,"div",40)(94,"div",41)(95,"div",42),i(96,"JD"),t(),e(97,"div",43),i(98,"KL"),t(),e(99,"div",44),i(100,"MN"),t()(),e(101,"div")(102,"p",45),i(103,"Trusted by 1,000+ businesses"),t(),e(104,"p",38),i(105,"Join our growing community"),t()()()()()()()),f&2){let a,m,g,x,b;l(12),S("formGroup",n.loginForm),l(7),p((a=n.loginForm.get("storeNumber"))!=null&&a.hasError("required")?19:-1),l(),p((m=n.loginForm.get("storeNumber"))!=null&&m.hasError("pattern")||(m=n.loginForm.get("storeNumber"))!=null&&m.hasError("minlength")?20:-1),l(7),p((g=n.loginForm.get("email"))!=null&&g.hasError("required")?27:-1),l(),p((x=n.loginForm.get("email"))!=null&&x.hasError("email")?28:-1),l(4),S("type",n.hide()?"password":"text"),l(),L("aria-label","Hide password")("aria-pressed",n.hide()),l(2),N(n.hide()?"visibility_off":"visibility"),l(),p((b=n.loginForm.get("password"))!=null&&b.hasError("required")?36:-1),l(8),S("disabled",!n.loginForm.valid||n.loading()),l(),p(n.loading()?45:46)}},dependencies:[$,P,I,T,te,ee,Z,Q,U,X,Y,J,z,G,V,O,K,H,ne,ie,re,oe,F],encapsulation:2})};export{le as LoginComponent};
