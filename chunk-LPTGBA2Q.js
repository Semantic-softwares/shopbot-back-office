import{a as Be}from"./chunk-5R46FPLR.js";import{a as Fe}from"./chunk-E4DU7SZS.js";import{a as b,b as Re,c as Ve}from"./chunk-VL5A6MKX.js";import{a as Pe}from"./chunk-Q2TL7UZ2.js";import{a as y,b as De}from"./chunk-A233OVEX.js";import{a as Ce,b as ge,c as he,d as xe,e as Me,f as ve,g as we,h as ye,i as be,j as Ee,k as Te,l as Le}from"./chunk-BWWYPHKT.js";import"./chunk-YVYCFWPM.js";import"./chunk-3RK6DDJD.js";import{a as Ie,b as ke}from"./chunk-LIUA42FM.js";import"./chunk-XQNDMVIO.js";import{b as ie,c as ne,d as oe}from"./chunk-3632TDEK.js";import{a as j,b as W}from"./chunk-I24LUS2H.js";import{a as fe,c as Se}from"./chunk-DSRTAZMJ.js";import{c as ce,g as _e}from"./chunk-H55FNLX4.js";import{a as pe,c as se,d as me,e as de}from"./chunk-5XJCC6NP.js";import"./chunk-LPJWQZ4I.js";import"./chunk-EEQKDLYL.js";import{d as ue}from"./chunk-NGGCDKIH.js";import"./chunk-JTD73F4Y.js";import{a as Z,d as ee,h as te}from"./chunk-JGZ2V5AL.js";import{C as J,b as q,g as U,l as G}from"./chunk-CXVWFC6J.js";import"./chunk-JTLCVARK.js";import{a as K,c as X,g as Y}from"./chunk-HA7VDR7W.js";import{a as re,b as ae}from"./chunk-7C3RSL2D.js";import"./chunk-OHZSVTBE.js";import"./chunk-VIOSJ367.js";import"./chunk-TEL7Y7UN.js";import{o as z,p as O,q as Q}from"./chunk-FSA22CPB.js";import{b as le}from"./chunk-JTAKXPWP.js";import"./chunk-M2YK6UF7.js";import"./chunk-BVQK7CK4.js";import"./chunk-LJSEVW7O.js";import{c as A,g as N}from"./chunk-7EKHSXIM.js";import"./chunk-TQDHD3WD.js";import{t as H}from"./chunk-DWCYWQVU.js";import{$b as L,Db as M,Eb as v,Jb as c,Kb as n,Lb as o,Mb as _,Nb as C,Ob as g,Qb as P,Ub as f,Vb as m,Z as I,Zb as E,_a as p,_b as T,dc as R,fa as S,ic as a,jc as d,kb as k,kc as w,la as h,ma as x,n as D,nc as V,oc as F,pc as B,qb as u,wc as $}from"./chunk-5AECHVKR.js";import"./chunk-EQDQRRRY.js";var Ae=()=>[5,10,25,100];function Ne(e,i){e&1&&(n(0,"div",10),_(1,"mat-spinner",14),o())}function ze(e,i){e&1&&_(0,"app-no-record",11)}function Oe(e,i){e&1&&_(0,"app-no-record",12)}function Qe(e,i){e&1&&(n(0,"th",27),a(1,"Supplier"),o())}function je(e,i){if(e&1&&(n(0,"div",35),a(1),o()),e&2){let t=m().$implicit;p(),d(t.description)}}function We(e,i){if(e&1&&(n(0,"td",28)(1,"div",29)(2,"div",30)(3,"div",31)(4,"span",32),a(5),o()()(),n(6,"div",33)(7,"div",34),a(8),o(),M(9,je,2,1,"div",35),o()()()),e&2){let t=i.$implicit;p(5),w(" ",t.name.charAt(0).toUpperCase()," "),p(3),d(t.name),p(),v(t.description?9:-1)}}function qe(e,i){e&1&&(n(0,"th",36),a(1,"Contact Info"),o())}function Ue(e,i){if(e&1&&(n(0,"div",35),a(1),o()),e&2){let t=m().$implicit;p(),d(t.phone)}}function Ge(e,i){if(e&1&&(n(0,"div",35),a(1),o()),e&2){let t=m().$implicit;p(),w("Contact: ",t.contactPerson)}}function Je(e,i){if(e&1&&(n(0,"td",28)(1,"div",37),a(2),o(),M(3,Ue,2,1,"div",35),M(4,Ge,2,1,"div",35),o()),e&2){let t=i.$implicit;p(2),d(t.email),p(),v(t.phone?3:-1),p(),v(t.contactPerson?4:-1)}}function Ke(e,i){e&1&&(n(0,"th",27),a(1,"Status"),o())}function Xe(e,i){if(e&1&&(n(0,"td",28)(1,"mat-chip",38),a(2),o()()),e&2){let t=i.$implicit;p(),c("color",t.active?"primary":"warn"),p(),w(" ",t.active?"Active":"Inactive"," ")}}function Ye(e,i){e&1&&(n(0,"th",27),a(1,"Payment Terms"),o())}function Ze(e,i){if(e&1&&(n(0,"td",28),a(1),o()),e&2){let t=i.$implicit;p(),d(t.paymentTerms||"N/A")}}function et(e,i){e&1&&(n(0,"th",36),a(1,"Actions"),o())}function tt(e,i){if(e&1){let t=P();n(0,"td",28)(1,"button",39)(2,"mat-icon"),a(3,"more_vert"),o()(),n(4,"mat-menu",null,0)(6,"button",40),f("click",function(){let l=h(t).$implicit,s=m(2);return x(s.viewSupplier(l._id))}),n(7,"mat-icon"),a(8,"visibility"),o(),n(9,"span"),a(10,"View Details"),o()(),n(11,"button",40),f("click",function(){let l=h(t).$implicit,s=m(2);return x(s.editSupplier(l._id))}),n(12,"mat-icon"),a(13,"edit"),o(),n(14,"span"),a(15,"Edit"),o()(),n(16,"button",40),f("click",function(){let l=h(t).$implicit,s=m(2);return x(s.toggleSupplierStatus(l))}),n(17,"mat-icon"),a(18),o(),n(19,"span"),a(20),o()(),n(21,"button",40),f("click",function(){let l=h(t).$implicit,s=m(2);return x(s.deleteSupplier(l))}),n(22,"mat-icon"),a(23,"delete"),o(),n(24,"span"),a(25,"Delete"),o()()()()}if(e&2){let t=i.$implicit,r=R(5);p(),c("matMenuTriggerFor",r),p(17),d(t.active?"toggle_off":"toggle_on"),p(2),d(t.active?"Deactivate":"Activate")}}function it(e,i){e&1&&_(0,"tr",41)}function nt(e,i){e&1&&_(0,"tr",42)}function ot(e,i){if(e&1&&(n(0,"div",13)(1,"table",15),C(2,16),u(3,Qe,2,0,"th",17)(4,We,10,3,"td",18),g(),C(5,19),u(6,qe,2,0,"th",20)(7,Je,5,3,"td",18),g(),C(8,21),u(9,Ke,2,0,"th",17)(10,Xe,3,2,"td",18),g(),C(11,22),u(12,Ye,2,0,"th",17)(13,Ze,2,1,"td",18),g(),C(14,23),u(15,et,2,0,"th",20)(16,tt,26,3,"td",18),g(),u(17,it,1,0,"tr",24)(18,nt,1,0,"tr",25),o(),_(19,"mat-paginator",26),o()),e&2){let t=m();p(),c("dataSource",t.dataSource),p(16),c("matHeaderRowDef",t.displayedColumns),p(),c("matRowDefColumns",t.displayedColumns),p(),c("pageSizeOptions",$(4,Ae))}}var $e=class e{suppliersService=S(Be);router=S(A);dialog=S(ce);snackBar=S(j);storeStore=S(le);displayedColumns=["name","contactInfo","status","paymentTerms","actions"];dataSource;searchText="";paginator;sort;suppliers=ue({params:()=>({storeId:this.storeStore.selectedStore()?._id}),stream:({params:i})=>i.storeId?this.suppliersService.getSuppliers(i.storeId,1,1e3).pipe(I(t=>{let r=t.suppliers||[];this.dataSource=new Le(r),this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort})):D({suppliers:[],page:1,totalPages:1,total:0})});constructor(){}ngOnInit(){}applyFilter(i){let t=i.target.value;this.dataSource.filter=t.trim().toLowerCase()}openDialog(){this.createSupplier()}editSupplier(i){this.router.navigate(["/dashboard/inventory/suppliers/edit",i])}viewSupplier(i){this.router.navigate(["/dashboard/inventory/suppliers/details",i])}toggleSupplierStatus(i){if(!i._id)return;let t=this.storeStore.selectedStore()?._id;t&&this.suppliersService.toggleSupplierStatus(i._id,t).subscribe({next:r=>{let l=this.dataSource.data,s=l.findIndex(He=>He._id===i._id);s!==-1&&(l[s]=r,this.dataSource.data=[...l]),this.snackBar.open("Supplier status updated successfully","Close",{duration:3e3,horizontalPosition:"end",verticalPosition:"top"})},error:r=>{console.error("Error toggling supplier status:",r),this.snackBar.open("Failed to update supplier status","Close",{duration:3e3,horizontalPosition:"end",verticalPosition:"top"})}})}deleteSupplier(i){if(!i._id)return;this.dialog.open(Fe,{width:"350px",data:{message:`Are you sure you want to delete supplier "${i.name}"?`}}).afterClosed().subscribe(r=>{if(r&&i._id){let l=this.storeStore.selectedStore()?._id;if(!l)return;this.suppliersService.deleteSupplier(i._id,l).subscribe({next:()=>{this.suppliers.reload(),this.snackBar.open("Supplier deleted successfully","Close",{duration:3e3,horizontalPosition:"end",verticalPosition:"top"})},error:s=>{console.error("Error deleting supplier:",s),this.snackBar.open("Failed to delete supplier","Close",{duration:3e3,horizontalPosition:"end",verticalPosition:"top"})}})}})}createSupplier(){this.router.navigate(["/dashboard/inventory/suppliers/create"])}static \u0275fac=function(t){return new(t||e)};static \u0275cmp=k({type:e,selectors:[["app-list-suppliers"]],viewQuery:function(t,r){if(t&1&&(E(y,5),E(b,5)),t&2){let l;T(l=L())&&(r.paginator=l.first),T(l=L())&&(r.sort=l.first)}},decls:19,vars:2,consts:[["menu","matMenu"],[1,"suppliers-container","!bg-white"],[1,"!bg-white"],[1,"flex","flex-col","md:flex-row","justify-between","gap-4","p-4"],[1,"flex","flex-col","sm:flex-row","gap-4","flex-grow"],["appearance","outline",1,"w-full","sm:w-48","md:w-72","lg:w-96"],["matPrefix",""],["matInput","","placeholder","Search suppliers by name, contact, or email",3,"keyup","ngModelChange","ngModel"],[1,"flex","gap-3","justify-end"],["mat-raised-button","","color","primary",3,"click"],[1,"flex","items-center","justify-center","min-h-[300px]"],["icon","warehouse","title","No Suppliers","message","No suppliers found matching your criteria."],["icon","error","title","Error","message","An error occurred while fetching suppliers. Please try again later."],[1,"table-container","!bg-white"],["diameter","40"],["mat-table","","matSort","",1,"!bg-white",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","contactInfo"],["mat-header-cell","",4,"matHeaderCellDef"],["matColumnDef","status"],["matColumnDef","paymentTerms"],["matColumnDef","actions"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["aria-label","Select page of suppliers",1,"!bg-white",3,"pageSizeOptions"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],[1,"flex","items-center"],[1,"flex-shrink-0","h-10","w-10"],[1,"h-10","w-10","rounded-full","bg-blue-100","flex","items-center","justify-center"],[1,"text-blue-600","font-medium","text-sm"],[1,"ml-4"],[1,"text-sm","font-medium","text-gray-900"],[1,"text-sm","text-gray-500"],["mat-header-cell",""],[1,"text-sm","text-gray-900"],[3,"color"],["mat-icon-button","","aria-label","Supplier actions",3,"matMenuTriggerFor"],["mat-menu-item","",3,"click"],["mat-header-row",""],["mat-row",""]],template:function(t,r){t&1&&(n(0,"mat-card",1)(1,"mat-card-content",2)(2,"div",3)(3,"div",4)(4,"mat-form-field",5)(5,"mat-label"),a(6,"Search"),o(),n(7,"mat-icon",6),a(8,"search"),o(),n(9,"input",7),f("keyup",function(s){return r.applyFilter(s)}),B("ngModelChange",function(s){return F(r.searchText,s)||(r.searchText=s),s}),o()()(),n(10,"div",8)(11,"button",9),f("click",function(){return r.openDialog()}),n(12,"mat-icon"),a(13,"add"),o(),a(14," ADD Supplier "),o()()(),M(15,Ne,2,0,"div",10)(16,ze,1,0,"app-no-record",11)(17,Oe,1,0,"app-no-record",12)(18,ot,20,5,"div",13),o()()),t&2&&(p(9),V("ngModel",r.searchText),p(6),v(r.suppliers.isLoading()?15:r.suppliers.hasValue()&&r.dataSource&&r.dataSource.data.length===0?16:r.suppliers.error()?17:r.suppliers.hasValue()&&r.dataSource?18:-1))},dependencies:[H,J,q,U,G,N,Te,Ce,he,we,xe,ge,ye,Me,ve,be,Ee,De,y,Ve,b,Re,Y,K,X,ie,te,Z,ee,oe,ne,Q,O,z,ae,re,ke,Ie,de,se,pe,me,W,_e,Se,fe,Pe],styles:["[_nghost-%COMP%]{display:block}"]})};export{$e as ListSuppliersComponent};
