import{b as pe}from"./chunk-24SFQJLQ.js";import"./chunk-MS4AQ6UA.js";import{a as le,b as me}from"./chunk-YVYCFWPM.js";import"./chunk-3RK6DDJD.js";import{a as se,b as ce}from"./chunk-LIUA42FM.js";import"./chunk-JQGESV5S.js";import{d as G}from"./chunk-XQNDMVIO.js";import{b as ee,c as te,d as ie}from"./chunk-3632TDEK.js";import{a as A}from"./chunk-I24LUS2H.js";import"./chunk-EEQKDLYL.js";import{c as N,d as k}from"./chunk-NGGCDKIH.js";import"./chunk-JTD73F4Y.js";import{a as X,h as Y}from"./chunk-JGZ2V5AL.js";import{B as Q,D as W,b as Z,d as S,g as $,h as j,m as z,n as H,p as O,q as J,s as K}from"./chunk-CXVWFC6J.js";import"./chunk-JTLCVARK.js";import{a as ne,b as oe}from"./chunk-7C3RSL2D.js";import"./chunk-OHZSVTBE.js";import"./chunk-VIOSJ367.js";import"./chunk-TEL7Y7UN.js";import{o as q,p as R,q as U}from"./chunk-FSA22CPB.js";import{a as re,b as ae}from"./chunk-6U4I4OYM.js";import"./chunk-M2YK6UF7.js";import"./chunk-BVQK7CK4.js";import"./chunk-AGZJ637K.js";import"./chunk-TQDHD3WD.js";import{t as L}from"./chunk-DWCYWQVU.js";import{Db as b,Eb as C,Fb as T,Gb as D,Hb as h,Ib as x,Jb as c,Kb as o,Lb as n,Mb as s,Qb as g,Ub as u,Vb as f,Xa as M,_a as l,dc as V,fa as v,ic as a,jc as y,kb as B,la as p,ma as d,r as w,s as E}from"./chunk-5AECHVKR.js";import{a as P,f as I}from"./chunk-EQDQRRRY.js";var ue=(r,t)=>t._id;function fe(r,t){if(r&1){let e=g();o(0,"div",33),u("click",function(){p(e),f();let m=V(10);return d(m.click())}),o(1,"mat-icon",34),a(2,"add_photo_alternate"),n(),o(3,"p",35),a(4,"Click to upload store logo"),n()()}}function ge(r,t){if(r&1){let e=g();o(0,"div",12),s(1,"img",36),o(2,"a",37),u("click",function(){p(e);let m=f();return d(m.removeLogo())}),o(3,"mat-icon"),a(4,"delete"),n()()()}if(r&2){let e,i=f();l(),c("src",i.logoPreview||((e=i.storeForm.get("logo"))==null?null:e.value),M)}}function Se(r,t){if(r&1){let e=g();o(0,"div",33),u("click",function(){p(e),f();let m=V(15);return d(m.click())}),o(1,"mat-icon",34),a(2,"add_photo_alternate"),n(),o(3,"p",35),a(4,"Click to upload store banner"),n()()}}function _e(r,t){if(r&1){let e=g();o(0,"div",12),s(1,"img",36),o(2,"a",37),u("click",function(){p(e);let m=f();return d(m.removeBanner())}),o(3,"mat-icon"),a(4,"delete"),n()()()}if(r&2){let e,i=f();l(),c("src",i.bannerPreview||((e=i.storeForm.get("bannerImage"))==null?null:e.value),M)}}function ve(r,t){if(r&1&&(o(0,"mat-option",25),a(1),n()),r&2){let e=t.$implicit;c("value",e._id),l(),y(e.name)}}function be(r,t){if(r&1&&h(0,ve,2,2,"mat-option",25,ue),r&2){let e=f();x(e.categories.value())}}function Ce(r,t){if(r&1&&(o(0,"mat-option",25),a(1),n()),r&2){let e=t.$implicit;c("value",e.country),l(),y(e.country)}}function he(r,t){if(r&1&&(o(0,"mat-option",25),a(1),n()),r&2){let e=t.$implicit;c("value",e.name),l(),y(e.name)}}function xe(r,t){if(r&1&&(o(0,"mat-option",25),a(1),n()),r&2){let e=t.$implicit;c("value",e.name),l(),y(e.name)}}function ye(r,t){r&1&&(s(0,"mat-spinner",38),a(1," Updating... "))}function we(r,t){r&1&&a(0," Update Store ")}var de=class r{fb=v(Q);storeService=v(re);snackBar=v(A);storeStore=v(ae);isSubmitting=!1;logoPreview=null;bannerPreview=null;logoFile=null;bannerFile=null;onLogoSelected(t){let e=t.target.files?.[0];if(e){this.logoFile=e;let i=new FileReader;i.onload=()=>{this.logoPreview=i.result},i.readAsDataURL(e)}}onBannerSelected(t){let e=t.target.files?.[0];if(e){this.bannerFile=e;let i=new FileReader;i.onload=()=>{this.bannerPreview=i.result},i.readAsDataURL(e)}}removeLogo(){this.logoFile=null,this.logoPreview=null,this.storeForm.patchValue({logo:""});let t=document.querySelector("#logoInput");t&&(t.value="")}removeBanner(){this.bannerFile=null,this.bannerPreview=null,this.storeForm.patchValue({bannerImage:""});let t=document.querySelector("#bannerInput");t&&(t.value="")}storeForm=this.fb.group({name:["",S.required],description:[""],currency:[{value:"",disabled:!0},S.required],currencyCode:[{value:"",disabled:!0},S.required],tax:[0],category:[{value:"",disabled:!0},S.required],logo:[""],bannerImage:[""],contactInfo:this.fb.group({email:["",[S.email]],phone:[""],placeName:[""],city:[""],state:[""],country:[""]})});categories=k({stream:()=>this.storeService.getStoreCategories()});deliveryZones=k({stream:()=>this.storeService.deliveryZones()});states=N(this.storeForm.get("contactInfo.country").valueChanges.pipe(E(t=>{let e=this.deliveryZones.value()?.find(i=>i.country===t);return e?(this.storeForm.get("contactInfo.state")?.enable(),e.states||[]):(this.storeForm.get("contactInfo.state")?.disable(),[])})));localities=N(this.storeForm.get("contactInfo.state").valueChanges.pipe(E(t=>{let e=this.states()?.find(i=>i.name===t);return e?(this.storeForm.get("contactInfo.city")?.enable(),e.localities||[]):(this.storeForm.get("contactInfo.city")?.disable(),[])})));ngOnInit(){let t=this.storeStore.selectedStore();console.log("Selected Store:",t),t&&this.storeForm.patchValue(t)}uploadImages(t){return I(this,null,function*(){if(this.logoFile){let e=new FormData;e.append("file",this.logoFile);try{yield w(this.storeService.uploadLogo(e,t)),yield new Promise(i=>setTimeout(i,1e3))}catch(i){throw console.error("Error uploading logo:",i),i}}if(this.bannerFile){let e=new FormData;e.append("file",this.bannerFile);try{yield w(this.storeService.uploadBanner(e,t))}catch(i){throw console.error("Error uploading banner:",i),i}}})}onSubmit(){return I(this,null,function*(){if(this.storeForm.valid){this.isSubmitting=!0;try{let t=this.storeStore.selectedStore()?._id;if(!t)return;let e=P({},this.storeForm.value);delete e.logo,delete e.bannerImage,yield w(this.storeService.updateStore(t,e)),yield this.uploadImages(t),this.snackBar.open("Store updated successfully","Close",{duration:3e3,horizontalPosition:"end",verticalPosition:"top"})}catch(t){console.error("Error updating store:",t),this.snackBar.open("Failed to update store","Close",{duration:3e3,horizontalPosition:"end",verticalPosition:"top"})}finally{this.isSubmitting=!1}}})}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=B({type:r,selectors:[["app-store-settings"]],decls:81,vars:6,consts:[["logoInput",""],["bannerInput",""],[1,"p-4","bg-gray-50","min-h-screen"],[1,"bg-white","rounded-lg","shadow-sm"],[1,"p-4","sm:p-6"],[1,"text-xl","sm:text-2xl","font-bold","mb-4","sm:mb-6"],[1,"w-full","max-w-4xl","mx-auto",3,"ngSubmit","formGroup"],[1,"grid","grid-cols-1","lg:grid-cols-2","gap-4","sm:gap-6"],[1,"col-span-full","grid","grid-cols-1","sm:grid-cols-2","gap-4","sm:gap-6"],[1,"border-2","border-dashed","border-gray-300","rounded-lg","p-4","relative","min-h-[200px]","flex","items-center","justify-center"],["type","file","accept","image/*","id","logoInput",1,"hidden",3,"change"],[1,"text-center","cursor-pointer","transition-all","hover:opacity-75"],[1,"relative","w-full","h-full"],["type","file","accept","image/*","id","bannerInput",1,"hidden",3,"change"],["appearance","outline",1,"w-full"],["matInput","","formControlName","name"],["matInput","","formControlName","description","rows","3"],["matInput","","formControlName","currency"],["matInput","","formControlName","currencyCode"],["matInput","","type","number","formControlName","tax"],["formControlName","category"],[1,"col-span-full","mt-6"],[1,"text-lg","font-semibold","mb-4"],["formGroupName","contactInfo",1,"grid","grid-cols-1","sm:grid-cols-2","gap-4","sm:gap-6"],["formControlName","country"],[3,"value"],["formControlName","state"],["formControlName","city"],["matInput","","formControlName","placeName"],["matInput","","formControlName","email","type","email"],["matInput","","formControlName","phone"],[1,"flex","justify-end","mt-6","sm:mt-8"],["mat-flat-button","","color","primary","type","submit",1,"w-full","sm:w-auto","px-6",3,"disabled"],[1,"text-center","cursor-pointer","transition-all","hover:opacity-75",3,"click"],[1,"text-4xl","sm:text-5xl","text-gray-400"],[1,"mt-2","text-sm","sm:text-base","text-gray-600"],[1,"w-full","h-40","sm:h-48","object-cover","rounded",3,"src"],["mat-icon-button","","color","warn",1,"absolute","top-2","right-2",3,"click"],["diameter","20",1,"mr-2"]],template:function(e,i){if(e&1){let m=g();o(0,"div",2)(1,"div",3)(2,"div",4)(3,"h1",5),a(4,"Store Settings"),n(),o(5,"form",6),u("ngSubmit",function(){return p(m),d(i.onSubmit())}),o(6,"div",7)(7,"div",8)(8,"div",9)(9,"input",10,0),u("change",function(F){return p(m),d(i.onLogoSelected(F))}),n(),b(11,fe,5,0,"div",11)(12,ge,5,1,"div",12),n(),o(13,"div",9)(14,"input",13,1),u("change",function(F){return p(m),d(i.onBannerSelected(F))}),n(),b(16,Se,5,0,"div",11)(17,_e,5,1,"div",12),n()(),o(18,"mat-form-field",14)(19,"mat-label"),a(20,"Store Name"),n(),s(21,"input",15),n(),o(22,"mat-form-field",14)(23,"mat-label"),a(24,"Description"),n(),s(25,"textarea",16),n(),o(26,"mat-form-field",14)(27,"mat-label"),a(28,"Currency"),n(),s(29,"input",17),n(),o(30,"mat-form-field",14)(31,"mat-label"),a(32,"Currency Code"),n(),s(33,"input",18),n(),o(34,"mat-form-field",14)(35,"mat-label"),a(36,"Tax (%)"),n(),s(37,"input",19),n(),o(38,"mat-form-field",14)(39,"mat-label"),a(40,"Category"),n(),o(41,"mat-select",20),b(42,be,2,0),n()(),o(43,"div",21)(44,"h3",22),a(45,"Contact Information"),n(),o(46,"div",23)(47,"mat-form-field",14)(48,"mat-label"),a(49,"Country"),n(),o(50,"mat-select",24),h(51,Ce,2,2,"mat-option",25,T),n()(),o(53,"mat-form-field",14)(54,"mat-label"),a(55,"State"),n(),o(56,"mat-select",26),h(57,he,2,2,"mat-option",25,D),n()(),o(59,"mat-form-field",14)(60,"mat-label"),a(61,"City"),n(),o(62,"mat-select",27),h(63,xe,2,2,"mat-option",25,T),n()(),o(65,"mat-form-field",14)(66,"mat-label"),a(67,"Address"),n(),s(68,"input",28),n(),o(69,"mat-form-field",14)(70,"mat-label"),a(71,"Email"),n(),s(72,"input",29),n(),o(73,"mat-form-field",14)(74,"mat-label"),a(75,"Phone"),n(),s(76,"input",30),n()()()(),o(77,"div",31)(78,"button",32),b(79,ye,2,0)(80,we,1,0),n()()()()()()}if(e&2){let m,_;l(5),c("formGroup",i.storeForm),l(6),C(!i.logoPreview&&!((m=i.storeForm.get("logo"))!=null&&m.value)?11:12),l(5),C(!i.bannerPreview&&!((_=i.storeForm.get("bannerImage"))!=null&&_.value)?16:17),l(26),C(i.categories.hasValue()?42:-1),l(9),x(i.deliveryZones.value()),l(6),x(i.states()),l(6),x(i.localities()),l(15),c("disabled",i.storeForm.invalid||i.isSubmitting),l(),C(i.isSubmitting?79:80)}},dependencies:[L,W,z,Z,H,$,j,O,K,J,ee,Y,X,ie,te,U,R,q,me,le,G,pe,oe,ne,ce,se],encapsulation:2})};export{de as StoreSettingsComponent};
