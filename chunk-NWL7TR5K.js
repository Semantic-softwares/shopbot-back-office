import{a as W}from"./chunk-IVYVRN74.js";import{a as nt}from"./chunk-R3ZJJYBP.js";import{a as U,b as at,c as ot}from"./chunk-6ZHKYW4R.js";import{a as J,b as K}from"./chunk-IZLAM7NT.js";import{a as it}from"./chunk-43L7VVFN.js";import"./chunk-MS4AQ6UA.js";import{a as Q,b as Ze}from"./chunk-BDBUP5RW.js";import{a as H,b as He,c as je,d as ze,e as Qe,f as Ue,g as Je,h as Ke,i as We,j as Xe,k as Ye}from"./chunk-LGKRDPY2.js";import{a as j,b as z}from"./chunk-5W5E6AGV.js";import"./chunk-3RK6DDJD.js";import{a as et,b as tt}from"./chunk-57GZGP3R.js";import"./chunk-JQGESV5S.js";import{d as F}from"./chunk-FNFXBZOZ.js";import{b as G,c as V,d as A}from"./chunk-AQ3KQLE6.js";import{a as N}from"./chunk-4WFQ5GOX.js";import{a as Ne,b as $e,c as Be,d as Ge,e as Ve,f as Ae,g as qe}from"./chunk-DGYQUDOC.js";import"./chunk-KLIJEHXY.js";import"./chunk-ETOXAU7Y.js";import{a as De,c as Fe,d as ke,e as Re}from"./chunk-OTA24DIU.js";import{d as v}from"./chunk-NGGCDKIH.js";import"./chunk-5LES5XKI.js";import{a as $,b as Pe,d as Ie,h as B}from"./chunk-QMUPRLKR.js";import{B as Me,D as ye,b as ge,d as C,g as _e,h as Ce,m as he,n as Te,p as ve,s as Se}from"./chunk-CXVWFC6J.js";import"./chunk-JTLCVARK.js";import{a as xe,c as Ee,g as we}from"./chunk-UOL4Y3DN.js";import{a as Oe,b as Le}from"./chunk-MCIFQNRK.js";import"./chunk-OHZSVTBE.js";import{a as q}from"./chunk-P7SQXTVL.js";import"./chunk-IKGBOHBU.js";import"./chunk-SIHSJGX2.js";import{W as be,X as k,Y as R}from"./chunk-BPRDVRQX.js";import"./chunk-KP7TGH7C.js";import"./chunk-M2YK6UF7.js";import{a as fe}from"./chunk-AGZJ637K.js";import{c as ue}from"./chunk-WTFDJO4H.js";import"./chunk-TQDHD3WD.js";import{B as pe,k as ce,t as D}from"./chunk-DWCYWQVU.js";import{$b as O,Db as Y,Eb as Z,Fb as le,Hb as E,Ib as w,Jb as s,Kb as o,Lb as a,Mb as u,Mc as de,Nb as g,Ob as _,Qb as ee,Ub as b,Vb as h,Zb as P,_a as l,_b as I,aa as re,dc as me,fa as d,ic as r,jc as L,kb as x,kc as f,la as M,ma as y,qb as p,va as X,wc as se}from"./chunk-5AECHVKR.js";import"./chunk-EQDQRRRY.js";var T=class t{http=d(pe);baseUrl=fe.apiUrl;getStoreTables(e){return this.http.get(`${this.baseUrl}/tables/store/${e}`)}createTable(e){return this.http.post(`${this.baseUrl}/tables`,e)}updateTable(e,i){return this.http.put(`${this.baseUrl}/tables/${e}`,i)}deleteTable(e){return this.http.delete(`${this.baseUrl}/tables/${e}`)}getTableById(e){return this.http.get(`${this.baseUrl}/tables/${e}`)}static \u0275fac=function(i){return new(i||t)};static \u0275prov=re({token:t,factory:t.\u0275fac,providedIn:"root"})};var ut=(t,e)=>e._id;function bt(t,e){t&1&&(o(0,"mat-error"),r(1," Table name is required "),a())}function ft(t,e){t&1&&(o(0,"mat-error"),r(1," Table name must be at least 2 characters "),a())}function gt(t,e){if(t&1&&(o(0,"mat-option",8),r(1),a()),t&2){let i=e.$implicit;s("value",i._id),l(),f(" ",i.name," ")}}function _t(t,e){t&1&&(o(0,"mat-error"),r(1," Category is required "),a())}function Ct(t,e){t&1&&(o(0,"mat-error"),r(1," Number of guests is required "),a())}function ht(t,e){t&1&&(o(0,"mat-error"),r(1," Minimum 1 guest required "),a())}function Tt(t,e){t&1&&(o(0,"mat-error"),r(1," Maximum 20 guests allowed "),a())}var S=class t{fb=d(Me);tableService=d(T);tableCategoryService=d(W);storeStore=d(q);snackBar=d(N);dialogRef=d(Ne);data=d($e);tableForm;isEdit=!1;isLoading=!1;categories=v({params:()=>({storeId:this.storeStore.selectedStore()?._id}),stream:({params:e})=>this.tableCategoryService.getStoreTableCategories(e.storeId)});ngOnInit(){this.isEdit=this.data?.mode==="edit",this.initForm(),this.isEdit&&this.data.table&&this.populateForm(this.data.table)}initForm(){this.tableForm=this.fb.group({name:["",[C.required,C.minLength(2)]],category:["",C.required],numberOfGuest:[1,[C.required,C.min(1),C.max(20)]],active:[!0],store:[this.storeStore.selectedStore()?._id]})}populateForm(e){this.tableForm.patchValue({name:e.name,category:typeof e.category=="object"?e.category._id:e.category,numberOfGuest:e.numberOfGuest,active:e.active,storeId:e.storeId})}onSubmit(){if(this.tableForm.valid){this.isLoading=!0;let e=this.tableForm.value;this.isEdit?this.tableService.updateTable(this.data.table._id,e).subscribe({next:()=>{this.snackBar.open("Table updated successfully","Close",{duration:3e3,horizontalPosition:"end",verticalPosition:"top"}),this.dialogRef.close(!0)},error:i=>{console.error("Error updating table:",i),this.snackBar.open("Error updating table","Close",{duration:3e3,horizontalPosition:"end",verticalPosition:"top"}),this.isLoading=!1}}):this.tableService.createTable(e).subscribe({next:()=>{this.snackBar.open("Table created successfully","Close",{duration:3e3,horizontalPosition:"end",verticalPosition:"top"}),this.dialogRef.close(!0)},error:i=>{console.error("Error creating table:",i),this.snackBar.open("Error creating table","Close",{duration:3e3,horizontalPosition:"end",verticalPosition:"top"}),this.isLoading=!1}})}}onCancel(){this.dialogRef.close(!1)}static \u0275fac=function(i){return new(i||t)};static \u0275cmp=x({type:t,selectors:[["app-create-table"]],decls:35,vars:12,consts:[[1,"dialog-container"],["mat-dialog-title","",1,"text-xl","font-semibold","text-gray-900","mb-4"],[1,"space-y-4",3,"ngSubmit","formGroup"],[1,"space-y-4"],["appearance","outline",1,"w-full"],["matInput","","formControlName","name","placeholder","Enter table name"],[4,"ngIf"],["formControlName","category"],[3,"value"],["matInput","","type","number","formControlName","numberOfGuest","placeholder","Maximum number of guests"],[1,"flex","items-center","gap-3"],["formControlName","active","color","primary"],[1,"text-sm","text-gray-600"],[1,"flex","justify-end","gap-3","pt-4"],["mat-button","","type","button",3,"click","disabled"],["mat-raised-button","","color","primary","type","submit",3,"disabled"]],template:function(i,n){if(i&1&&(o(0,"div",0)(1,"h2",1),r(2),a(),o(3,"form",2),b("ngSubmit",function(){return n.onSubmit()}),o(4,"mat-dialog-content",3)(5,"mat-form-field",4)(6,"mat-label"),r(7,"Table Name"),a(),u(8,"input",5),p(9,bt,2,0,"mat-error",6)(10,ft,2,0,"mat-error",6),a(),o(11,"mat-form-field",4)(12,"mat-label"),r(13,"Category"),a(),o(14,"mat-select",7),E(15,gt,2,2,"mat-option",8,ut),a(),p(17,_t,2,0,"mat-error",6),a(),o(18,"mat-form-field",4)(19,"mat-label"),r(20,"Number of Guests"),a(),u(21,"input",9),p(22,Ct,2,0,"mat-error",6)(23,ht,2,0,"mat-error",6)(24,Tt,2,0,"mat-error",6),a(),o(25,"div",10)(26,"mat-slide-toggle",11),r(27," Active "),a(),o(28,"span",12),r(29),a()()(),o(30,"mat-dialog-actions",13)(31,"button",14),b("click",function(){return n.onCancel()}),r(32," Cancel "),a(),o(33,"button",15),r(34),a()()()()),i&2){let m,c,te,ie,ae,oe,ne;l(2),f(" ",n.isEdit?"Edit Table":"Create New Table"," "),l(),s("formGroup",n.tableForm),l(6),s("ngIf",(m=n.tableForm.get("name"))==null?null:m.hasError("required")),l(),s("ngIf",(c=n.tableForm.get("name"))==null?null:c.hasError("minlength")),l(5),w(n.categories.value()),l(2),s("ngIf",(te=n.tableForm.get("category"))==null?null:te.hasError("required")),l(5),s("ngIf",(ie=n.tableForm.get("numberOfGuest"))==null?null:ie.hasError("required")),l(),s("ngIf",(ae=n.tableForm.get("numberOfGuest"))==null?null:ae.hasError("min")),l(),s("ngIf",(oe=n.tableForm.get("numberOfGuest"))==null?null:oe.hasError("max")),l(5),f(" ",(ne=n.tableForm.get("active"))!=null&&ne.value?"Table is active and available":"Table is inactive"," "),l(2),s("disabled",n.isLoading),l(2),s("disabled",n.tableForm.invalid||n.isLoading),l(),f(" ",n.isLoading?"Saving...":n.isEdit?"Update Table":"Create Table"," ")}},dependencies:[D,ce,ye,he,ge,Te,_e,Ce,ve,Se,qe,Ge,Ae,Ve,G,B,$,Pe,A,V,z,j,F,R,k,K,J],styles:[".dialog-container[_ngcontent-%COMP%]{min-width:400px}.dialog-container[_ngcontent-%COMP%]   .mat-mdc-form-field[_ngcontent-%COMP%]   .mat-mdc-form-field-subscript-wrapper[_ngcontent-%COMP%]{display:none}.dialog-container[_ngcontent-%COMP%]   .mat-mdc-dialog-content[_ngcontent-%COMP%]{max-height:60vh;overflow-y:auto}.dialog-container[_ngcontent-%COMP%]   .mat-mdc-slide-toggle[_ngcontent-%COMP%]{--mdc-switch-selected-track-color: #1976d2;--mdc-switch-selected-handle-color: #1976d2}"]})};var vt=()=>[5,10,25,100];function St(t,e){if(t&1&&(o(0,"mat-option",8),r(1),a()),t&2){let i=e.$implicit;s("value",i._id),l(),f(" ",i.name," ")}}function Mt(t,e){t&1&&(o(0,"div",14),u(1,"mat-spinner",18),a())}function yt(t,e){t&1&&u(0,"app-no-record",15)}function xt(t,e){t&1&&(o(0,"th",33),r(1,"Table Name"),a())}function Et(t,e){if(t&1&&(o(0,"td",34),r(1),a()),t&2){let i=e.$implicit;l(),L(i.name)}}function wt(t,e){t&1&&(o(0,"th",33),r(1,"Category"),a())}function Pt(t,e){if(t&1&&(o(0,"td",35),r(1),a()),t&2){let i=e.$implicit;l(),L((i==null||i.category==null?null:i.category.name)||"No Category")}}function It(t,e){t&1&&(o(0,"th",33),r(1,"Max Guests"),a())}function Ot(t,e){if(t&1&&(o(0,"td",35),r(1),a()),t&2){let i=e.$implicit;l(),L(i.numberOfGuest)}}function Lt(t,e){t&1&&(o(0,"th",36),r(1,"Current Order"),a())}function Dt(t,e){if(t&1&&(o(0,"span",37),r(1),a()),t&2){let i=h().$implicit;l(),f(" Order #",i.order._id==null?null:i.order._id.slice(-6)," ")}}function Ft(t,e){t&1&&(o(0,"span",38),r(1," Available "),a())}function kt(t,e){if(t&1&&(o(0,"td",35),Y(1,Dt,2,1,"span",37)(2,Ft,2,0,"span",38),a()),t&2){let i=e.$implicit;l(),Z(i.order?1:2)}}function Rt(t,e){t&1&&(o(0,"th",36),r(1,"Status"),a())}function Nt(t,e){if(t&1){let i=ee();o(0,"td",35)(1,"mat-slide-toggle",39),b("change",function(){let m=M(i).$implicit,c=h(2);return y(c.toggleTableStatus(m))}),a()()}if(t&2){let i=e.$implicit;l(),s("checked",i.active)}}function $t(t,e){t&1&&(o(0,"th",36),r(1,"Actions"),a())}function Bt(t,e){if(t&1){let i=ee();o(0,"td",35)(1,"button",40)(2,"mat-icon"),r(3,"more_vert"),a()(),o(4,"mat-menu",null,0)(6,"button",41),b("click",function(){let m=M(i).$implicit,c=h(2);return y(c.editTable(m))}),o(7,"mat-icon"),r(8,"edit"),a(),o(9,"span"),r(10,"Edit"),a()(),o(11,"button",41),b("click",function(){let m=M(i).$implicit,c=h(2);return y(c.deleteTable(m))}),o(12,"mat-icon"),r(13,"delete"),a(),o(14,"span"),r(15,"Delete"),a()()()()}if(t&2){let i=me(5);l(),s("matMenuTriggerFor",i)}}function Gt(t,e){t&1&&u(0,"tr",42)}function Vt(t,e){t&1&&u(0,"tr",43)}function At(t,e){if(t&1&&(o(0,"div",16)(1,"table",19),g(2,20),p(3,xt,2,0,"th",21)(4,Et,2,1,"td",22),_(),g(5,23),p(6,wt,2,0,"th",21)(7,Pt,2,1,"td",24),_(),g(8,25),p(9,It,2,0,"th",21)(10,Ot,2,1,"td",24),_(),g(11,26),p(12,Lt,2,0,"th",27)(13,kt,3,1,"td",24),_(),g(14,28),p(15,Rt,2,0,"th",27)(16,Nt,2,1,"td",24),_(),g(17,29),p(18,$t,2,0,"th",27)(19,Bt,16,1,"td",24),_(),p(20,Gt,1,0,"tr",30)(21,Vt,1,0,"tr",31),a(),u(22,"mat-paginator",32),a()),t&2){let i=h();l(),s("dataSource",i.filteredTables()),l(19),s("matHeaderRowDef",i.displayedColumns),l(),s("matRowDefColumns",i.displayedColumns),l(),s("pageSizeOptions",se(4,vt))}}function qt(t,e){t&1&&u(0,"app-no-record",17)}var lt=class t{tableService=d(T);tableCategoryService=d(W);storeStore=d(q);router=d(ue);dialog=d(Be);snackBar=d(N);searchTerm=X("");selectedCategory=X("all");displayedColumns=["name","category","numberOfGuest","order","active","actions"];dataSource=v({params:()=>({storeId:this.storeStore.selectedStore()?._id}),stream:({params:e})=>this.tableService.getStoreTables(e.storeId)});categories=v({params:()=>({storeId:this.storeStore.selectedStore()?._id}),stream:({params:e})=>this.tableCategoryService.getStoreTableCategories(e.storeId)});filteredTables=de(()=>{let e=this.searchTerm().toLowerCase(),i=this.selectedCategory();return this.dataSource.value()?.filter(n=>{let m=n.name.toLowerCase().includes(e),c=i==="all"||n?.category?._id===i;return m&&c})??[]});paginator;sort;table;onSearch(e){let i=e.target;this.searchTerm.set(i.value)}onCategoryChange(e){this.selectedCategory.set(e)}addTable(){this.dialog.open(S,{width:"500px",data:{mode:"create"}}).afterClosed().subscribe(i=>{i&&this.dataSource.reload()})}editTable(e){this.dialog.open(S,{width:"500px",data:{mode:"edit",table:e}}).afterClosed().subscribe(n=>{n&&this.dataSource.reload()})}deleteTable(e){this.dialog.open(nt,{width:"400px",data:{message:`Are you sure you want to delete ${e.name}?`}}).afterClosed().subscribe(n=>{n&&this.tableService.deleteTable(e._id).subscribe({next:()=>{this.snackBar.open("Table deleted successfully","Close",{duration:3e3,horizontalPosition:"end",verticalPosition:"top"}),this.dataSource.reload()},error:m=>{console.error("Error deleting table:",m),this.snackBar.open("Error deleting table","Close",{duration:3e3,horizontalPosition:"end",verticalPosition:"top"})}})})}toggleTableStatus(e){let i={active:!e.active};this.tableService.updateTable(e._id,i).subscribe({next:()=>{this.snackBar.open("Table status updated successfully","Close",{duration:3e3,horizontalPosition:"end",verticalPosition:"top"}),this.dataSource.reload()},error:()=>{this.snackBar.open("Error updating table status","Close",{duration:3e3,horizontalPosition:"end",verticalPosition:"top"})}})}static \u0275fac=function(i){return new(i||t)};static \u0275cmp=x({type:t,selectors:[["app-list-tables"]],viewQuery:function(i,n){if(i&1&&(P(Q,5),P(U,5),P(H,5)),i&2){let m;I(m=O())&&(n.paginator=m.first),I(m=O())&&(n.sort=m.first),I(m=O())&&(n.table=m.first)}},decls:27,vars:1,consts:[["menu","matMenu"],[1,"tables-container","!bg-white","!rounded-xl","!shadow-lg","border","border-gray-100"],[1,"!bg-white"],[1,"flex","flex-col","md:flex-row","justify-between","gap-4","p-4","border-b"],[1,"flex","flex-col","sm:flex-row","gap-4","flex-grow"],["appearance","outline",1,"w-full","sm:w-48"],[3,"selectionChange"],["value","all"],[3,"value"],["appearance","outline",1,"w-full","sm:w-48","md:w-72","lg:w-96"],["matPrefix",""],["matInput","","placeholder","Search tables",3,"input"],[1,"flex","gap-3","justify-end"],["mat-raised-button","","color","primary",3,"click"],[1,"flex","items-center","justify-center","min-h-[300px]"],["icon","table_restaurant","title","No Tables","message","No tables found matching your criteria."],[1,"table-container","rounded-lg","overflow-x-auto","mt-4"],["icon","error","title","Error","message","An error occurred while fetching the data. Please try again later."],["diameter","40"],["mat-table","","matSort","",1,"!bg-white","min-w-full","rounded-lg",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","","mat-sort-header","","class","bg-gray-50",4,"matHeaderCellDef"],["mat-cell","","class","font-semibold",4,"matCellDef"],["matColumnDef","category"],["mat-cell","",4,"matCellDef"],["matColumnDef","numberOfGuest"],["matColumnDef","order"],["mat-header-cell","","class","bg-gray-50",4,"matHeaderCellDef"],["matColumnDef","active"],["matColumnDef","actions"],["mat-header-row","","class","bg-gray-50",4,"matHeaderRowDef"],["mat-row","","class","hover:bg-gray-50 transition",4,"matRowDef","matRowDefColumns"],["aria-label","Select page of tables",1,"!bg-white",3,"pageSizeOptions"],["mat-header-cell","","mat-sort-header","",1,"bg-gray-50"],["mat-cell","",1,"font-semibold"],["mat-cell",""],["mat-header-cell","",1,"bg-gray-50"],[1,"px-2","py-1","bg-orange-100","text-orange-800","rounded-full","text-xs"],[1,"px-2","py-1","bg-green-100","text-green-800","rounded-full","text-xs"],["color","primary",3,"change","checked"],["mat-icon-button","","aria-label","Table actions",3,"matMenuTriggerFor"],["mat-menu-item","",3,"click"],["mat-header-row","",1,"bg-gray-50"],["mat-row","",1,"hover:bg-gray-50","transition"]],template:function(i,n){i&1&&(o(0,"mat-card",1)(1,"mat-card-content",2)(2,"div",3)(3,"div",4)(4,"mat-form-field",5)(5,"mat-label"),r(6,"Category"),a(),o(7,"mat-select",6),b("selectionChange",function(c){return n.onCategoryChange(c.value)}),o(8,"mat-option",7),r(9,"All Categories"),a(),E(10,St,2,2,"mat-option",8,le),a()(),o(12,"mat-form-field",9)(13,"mat-label"),r(14,"Search"),a(),o(15,"mat-icon",10),r(16,"search"),a(),o(17,"input",11),b("input",function(c){return n.onSearch(c)}),a()()(),o(18,"div",12)(19,"button",13),b("click",function(){return n.addTable()}),o(20,"mat-icon"),r(21,"add"),a(),r(22," ADD TABLE "),a()()(),Y(23,Mt,2,0,"div",14)(24,yt,1,0,"app-no-record",15)(25,At,23,5,"div",16)(26,qt,1,0,"app-no-record",17),a()()),i&2&&(l(10),w(n.categories.value()),l(13),Z(n.dataSource.isLoading()?23:n.dataSource.hasValue()&&n.filteredTables().length===0?24:n.dataSource.hasValue()?25:n.dataSource.error()?26:-1))},dependencies:[D,Ye,H,je,Je,ze,He,Ke,Qe,Ue,We,Xe,Ze,Q,ot,U,at,G,B,$,Ie,A,V,z,j,F,R,k,be,we,xe,Ee,Re,Fe,De,ke,Le,Oe,tt,et,K,J,it],styles:[".tables-container[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   .mat-mdc-table[_ngcontent-%COMP%]{border-radius:8px}.tables-container[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   .mat-mdc-table[_ngcontent-%COMP%]   .mat-mdc-header-cell[_ngcontent-%COMP%]{font-weight:600;color:#374151;background-color:#f9fafb}.tables-container[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   .mat-mdc-table[_ngcontent-%COMP%]   .mat-mdc-row[_ngcontent-%COMP%]:hover{background-color:#f9fafb}.mat-mdc-form-field[_ngcontent-%COMP%]   .mat-mdc-form-field-subscript-wrapper[_ngcontent-%COMP%]{display:none}.mat-mdc-card[_ngcontent-%COMP%]{box-shadow:0 1px 3px #0000001a,0 1px 2px #0000000f}"]})};export{lt as ListTablesComponent};
