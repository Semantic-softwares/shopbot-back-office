import{a as $,b as ee}from"./chunk-TLN5MM36.js";import{c as W,d as X}from"./chunk-3BP5U2AG.js";import{a as E}from"./chunk-BF5Y3WJN.js";import{a as O,b as z,c as A,d as L,f as j,g as H}from"./chunk-L2IRRR6J.js";import{a as J,b as K,e as Q,h as U}from"./chunk-27T6VRU4.js";import{B,C as q,E as G,b as F,d as v,g as w,h as I,m as N,s as P,t as D}from"./chunk-LM7FYRY4.js";import"./chunk-ZENMOCFL.js";import{a as Y,b as Z}from"./chunk-EDESGICS.js";import{a as R}from"./chunk-6UI2KQ7N.js";import"./chunk-7KAGHLPR.js";import"./chunk-JRF7K3G5.js";import"./chunk-HRGWPEEQ.js";import{Y as S,Z as V}from"./chunk-BVLPFG4Z.js";import"./chunk-LYY57WCE.js";import"./chunk-5CST2L2O.js";import{a as T,c as M}from"./chunk-QJAAU2EQ.js";import"./chunk-S3JL7UCS.js";import{r as h}from"./chunk-ETP2OZKZ.js";import{Db as d,Eb as f,Jb as u,Kb as e,Lb as t,Mb as c,Tb as y,Xb as b,Ya as m,Zb as x,ca as l,ha as g,ia as C,lb as k,mc as i,nc as _,ta as p}from"./chunk-KGWH6IHP.js";import"./chunk-EQDQRRRY.js";function ie(n,o){n&1&&(e(0,"mat-error"),i(1,"Token is required"),t())}function ne(n,o){n&1&&(e(0,"mat-error"),i(1,"Token must be 6 digits"),t())}function oe(n,o){n&1&&(c(0,"mat-spinner",16),i(1," Verifying... "))}function re(n,o){n&1&&i(0," Verify Token ")}function ae(n,o){if(n&1){let r=y();e(0,"form",5),b("ngSubmit",function(){g(r);let a=x();return C(a.onSubmit())}),e(1,"div",6)(2,"p",7),i(3," Token sent to: "),e(4,"span",8),i(5),t()()(),e(6,"mat-form-field",9)(7,"mat-label"),i(8,"Reset Token"),t(),c(9,"input",10),e(10,"mat-icon",11),i(11,"vpn_key"),t(),d(12,ie,2,0,"mat-error"),d(13,ne,2,0,"mat-error"),t(),e(14,"button",12),d(15,oe,2,0)(16,re,1,0),t(),e(17,"div",13)(18,"p",14),i(19,"Didn't receive the token?"),t(),e(20,"a",15),i(21," Request a new one "),t()()()}if(n&2){let r,s,a=x();u("formGroup",a.verifyTokenForm),m(5),_(a.email()),m(7),f((r=a.verifyTokenForm.get("token"))!=null&&r.hasError("required")?12:-1),m(),f((s=a.verifyTokenForm.get("token"))!=null&&s.hasError("minlength")?13:-1),m(),u("disabled",!a.verifyTokenForm.valid||a.loading()),m(),f(a.loading()?15:16)}}function me(n,o){n&1&&(e(0,"div",4)(1,"mat-icon",17),i(2,"verified_user"),t(),e(3,"h3",18),i(4,"Token Verified!"),t(),e(5,"p",19),i(6," Redirecting to reset your password... "),t()())}var te=class n{fb=l(q);authService=l(R);snackBar=l(E);router=l(M);route=l(T);loading=p(!1);verified=p(!1);email=p("");verifyTokenForm=this.fb.group({token:["",[v.required,v.minLength(6)]]});ngOnInit(){this.route.queryParams.subscribe(o=>{o.email&&this.email.set(o.email)})}onSubmit(){if(this.verifyTokenForm.valid&&this.email()){this.loading.set(!0);let{token:o}=this.verifyTokenForm.value;this.authService.verifyResetToken(this.email(),o).subscribe({next:r=>{this.loading.set(!1),this.verified.set(!0),this.snackBar.open("Token verified successfully!","Close",{duration:5e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["success-snackbar"]}),setTimeout(()=>{this.router.navigate(["/auth/reset-password"],{queryParams:{email:this.email(),token:o}})},2e3)},error:r=>{this.loading.set(!1),this.verified.set(!1),this.snackBar.open(r.error?.msg||r.message||"Invalid token. Please try again.","Close",{duration:5e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["error-snackbar"]})}})}}static \u0275fac=function(r){return new(r||n)};static \u0275cmp=k({type:n,selectors:[["app-verify-reset-token"]],decls:10,vars:1,consts:[[1,"min-h-screen","w-full","flex","items-center","justify-center"],["appearance","outlined",1,"w-full","max-w-sm"],[1,"mb-6"],[1,"flex","flex-col","gap-4",3,"formGroup"],[1,"text-center"],[1,"flex","flex-col","gap-4",3,"ngSubmit","formGroup"],[1,"text-center","mb-4"],[1,"text-sm","text-gray-600"],[1,"font-semibold"],["appearance","outline",1,"w-full"],["matInput","","formControlName","token","placeholder","Enter 6-digit token","type","text","maxlength","6"],["matSuffix","","fontSet","material-icons-outlined"],["mat-raised-button","","color","primary","type","submit",3,"disabled"],[1,"text-center","mt-4"],[1,"text-xs","text-gray-600","mb-2"],["href","/auth/forgot-password",1,"text-sm","text-blue-600","hover:text-blue-800"],["diameter","20"],[1,"text-green-600","text-5xl","mb-4"],[1,"text-lg","font-semibold","mb-2"],[1,"text-gray-600","text-sm","mb-4"]],template:function(r,s){r&1&&(e(0,"div",0)(1,"mat-card",1)(2,"mat-card-header",2)(3,"mat-card-title"),i(4,"Verify Reset Token "),t(),e(5,"mat-card-subtitle"),i(6,"Enter the 6-digit token sent to your email."),t()(),e(7,"mat-card-content"),d(8,ae,22,6,"form",3)(9,me,7,0,"div",4),t()()()),r&2&&(m(8),f(s.verified()?9:8))},dependencies:[h,H,O,A,j,L,z,V,S,X,W,U,J,K,Q,G,N,F,w,I,B,D,P,Z,Y,ee,$],styles:[".token-input[_ngcontent-%COMP%]{text-align:center;font-size:1.5rem;letter-spacing:.5rem;font-weight:700}"]})};export{te as VerifyResetTokenComponent};
