import{a as Ne}from"./chunk-UAP6KZ37.js";import{a as ye}from"./chunk-Z32AMKXI.js";import{a as be,b as _e}from"./chunk-B276YSOB.js";import"./chunk-XRIZFGOF.js";import{a as Se,b as xe,c as he,h as Ce}from"./chunk-OVVKV2U3.js";import"./chunk-P5H3RIJ7.js";import{a as L}from"./chunk-W6MIZINO.js";import"./chunk-JN5X2IYW.js";import"./chunk-DSVTILZD.js";import"./chunk-IW6IJ3IN.js";import{i as U}from"./chunk-I4XKOMFF.js";import{a as ve,b as Ee}from"./chunk-T3N63WKP.js";import{d as O}from"./chunk-WAEUNFFU.js";import"./chunk-JOC3JCWJ.js";import"./chunk-AXVKE7YV.js";import"./chunk-UDXHODBD.js";import"./chunk-XBTGTIDL.js";import{c as pe,d as ue}from"./chunk-3JUXLSAM.js";import{a as me,b as le,d as de,e as se,h as ce}from"./chunk-TKNXELSU.js";import"./chunk-JT5P23LW.js";import{a as fe,b as ge}from"./chunk-4CSV6WDD.js";import{B as oe,b as Z,d as c,g as W,h as Y,i as ee,m as te,q as ie,s as ne,t as ae,z as re}from"./chunk-APGJ2ZCU.js";import"./chunk-KLDQLPSD.js";import{a as $}from"./chunk-6XJLFJNL.js";import"./chunk-R35DVJIH.js";import"./chunk-BFT2MTJY.js";import{a as V,b as H,c as J,f as z,g as Q,h as X}from"./chunk-SV3V3KFF.js";import"./chunk-FTUKKUPK.js";import"./chunk-J6S3CU5H.js";import"./chunk-SBJI2VOL.js";import{b as K,c as j}from"./chunk-A5WKFY2Q.js";import{Z as R,aa as q}from"./chunk-PD333HOR.js";import{e as B,g as A}from"./chunk-JWHH2AW2.js";import{s as w}from"./chunk-T7PMTSVA.js";import{$b as C,Hb as p,Ib as u,Lb as x,Mb as h,Nb as s,Ob as t,Pb as e,Qb as m,Ub as G,Uc as S,V as F,Vb as I,Xb as P,ab as o,bc as v,ea as g,f as N,ja as k,ka as M,lc as b,pb as D,qc as n,rc as f,sc as T,va as E}from"./chunk-ZCSDIQ3M.js";import{g as y}from"./chunk-GAL4ENT6.js";var _=(r,i)=>i.code;function ke(r,i){r&1&&m(0,"mat-spinner",6)}function Me(r,i){r&1&&(t(0,"mat-icon"),n(1,"save"),e())}function De(r,i){r&1&&(t(0,"div",7),m(1,"mat-spinner",9),e())}function Ge(r,i){if(r&1&&(t(0,"mat-error"),n(1),e()),r&2){let a=v(2);o(),f(a.getFieldError("firstName"))}}function Ie(r,i){if(r&1&&(t(0,"mat-error"),n(1),e()),r&2){let a=v(2);o(),f(a.getFieldError("lastName"))}}function Pe(r,i){if(r&1&&(t(0,"mat-error"),n(1),e()),r&2){let a=v(2);o(),f(a.getFieldError("email"))}}function Te(r,i){if(r&1&&(t(0,"mat-error"),n(1),e()),r&2){let a=v(2);o(),f(a.getFieldError("phone"))}}function we(r,i){if(r&1&&(t(0,"mat-option",25),n(1),e()),r&2){let a=i.$implicit;s("value",a.code),o(),f(a.name)}}function Be(r,i){if(r&1&&(t(0,"mat-option",25),n(1),e()),r&2){let a=i.$implicit;s("value",a.code),o(),f(a.name)}}function Ae(r,i){if(r&1&&(t(0,"mat-option",25),n(1),e()),r&2){let a=i.$implicit;s("value",a.code),o(),f(a.name)}}function Oe(r,i){if(r&1){let a=P();t(0,"div",8)(1,"form",10),C("ngSubmit",function(){k(a);let d=v();return M(d.onSubmit())}),t(2,"mat-card",11)(3,"mat-card-header")(4,"mat-icon",12),n(5,"person"),e(),t(6,"mat-card-title"),n(7,"Personal Information"),e()(),t(8,"mat-card-content",13)(9,"div",14)(10,"div")(11,"mat-form-field",15)(12,"mat-label"),n(13,"First Name *"),e(),m(14,"input",16),p(15,Ge,2,1,"mat-error"),e()(),t(16,"div")(17,"mat-form-field",15)(18,"mat-label"),n(19,"Last Name *"),e(),m(20,"input",17),p(21,Ie,2,1,"mat-error"),e()()(),t(22,"div",14)(23,"div")(24,"mat-form-field",15)(25,"mat-label"),n(26,"Email Address *"),e(),m(27,"input",18),t(28,"mat-icon",19),n(29,"email"),e(),p(30,Pe,2,1,"mat-error"),e()(),t(31,"div")(32,"mat-form-field",15)(33,"mat-label"),n(34,"Phone Number *"),e(),m(35,"input",20),t(36,"mat-icon",19),n(37,"phone"),e(),p(38,Te,2,1,"mat-error"),e()()(),t(39,"div",14)(40,"div")(41,"mat-form-field",15)(42,"mat-label"),n(43,"Date of Birth"),e(),m(44,"input",21)(45,"mat-datepicker-toggle",22)(46,"mat-datepicker",null,0),e()(),t(48,"div")(49,"mat-form-field",15)(50,"mat-label"),n(51,"Nationality"),e(),t(52,"mat-select",23)(53,"mat-option",24),n(54,"Select Nationality"),e(),x(55,we,2,2,"mat-option",25,_),e()()()()()(),t(57,"mat-card",26)(58,"mat-card-header")(59,"mat-icon",12),n(60,"badge"),e(),t(61,"mat-card-title"),n(62,"Identification Document"),e()(),t(63,"mat-card-content",13)(64,"div",14)(65,"div")(66,"mat-form-field",15)(67,"mat-label"),n(68,"Document Type"),e(),t(69,"mat-select",27)(70,"mat-option",28),n(71,"Passport"),e(),t(72,"mat-option",29),n(73,"National ID"),e(),t(74,"mat-option",30),n(75,"Driver's License"),e(),t(76,"mat-option",31),n(77,"Other"),e()()()(),t(78,"div")(79,"mat-form-field",15)(80,"mat-label"),n(81,"Document Number"),e(),m(82,"input",32),e()()(),t(83,"div",14)(84,"div")(85,"mat-form-field",15)(86,"mat-label"),n(87,"Expiry Date"),e(),m(88,"input",33)(89,"mat-datepicker-toggle",22)(90,"mat-datepicker",null,1),e()(),t(92,"div")(93,"mat-form-field",15)(94,"mat-label"),n(95,"Issuing Country"),e(),t(96,"mat-select",34)(97,"mat-option",24),n(98,"Select Country"),e(),x(99,Be,2,2,"mat-option",25,_),e()()()()()(),t(101,"mat-card",35)(102,"mat-card-header")(103,"mat-icon",12),n(104,"location_on"),e(),t(105,"mat-card-title"),n(106,"Address Information"),e()(),t(107,"mat-card-content",13)(108,"div")(109,"mat-form-field",15)(110,"mat-label"),n(111,"Street Address"),e(),m(112,"input",36),e()(),t(113,"div",37)(114,"div")(115,"mat-form-field",15)(116,"mat-label"),n(117,"City"),e(),m(118,"input",38),e()(),t(119,"div")(120,"mat-form-field",15)(121,"mat-label"),n(122,"State/Province"),e(),m(123,"input",39),e()(),t(124,"div")(125,"mat-form-field",15)(126,"mat-label"),n(127,"Postal Code"),e(),m(128,"input",40),e()()(),t(129,"div")(130,"mat-form-field",15)(131,"mat-label"),n(132,"Country"),e(),t(133,"mat-select",41)(134,"mat-option",24),n(135,"Select Country"),e(),x(136,Ae,2,2,"mat-option",25,_),e()()()()(),t(138,"mat-card",42)(139,"mat-card-header")(140,"mat-icon",12),n(141,"tune"),e(),t(142,"mat-card-title"),n(143,"Preferences"),e()(),t(144,"mat-card-content",13)(145,"div",37)(146,"div")(147,"mat-form-field",15)(148,"mat-label"),n(149,"Room Type"),e(),t(150,"mat-select",43)(151,"mat-option",24),n(152,"No Preference"),e(),t(153,"mat-option",44),n(154,"Standard"),e(),t(155,"mat-option",45),n(156,"Deluxe"),e(),t(157,"mat-option",46),n(158,"Suite"),e(),t(159,"mat-option",47),n(160,"Executive"),e()()()(),t(161,"div")(162,"mat-form-field",15)(163,"mat-label"),n(164,"Smoking Preference"),e(),t(165,"mat-select",48)(166,"mat-option",49),n(167,"Non-Smoking"),e(),t(168,"mat-option",50),n(169,"Smoking"),e(),t(170,"mat-option",51),n(171,"No Preference"),e()()()(),t(172,"div")(173,"mat-form-field",15)(174,"mat-label"),n(175,"Bed Preference"),e(),t(176,"mat-select",52)(177,"mat-option",51),n(178,"No Preference"),e(),t(179,"mat-option",53),n(180,"Single"),e(),t(181,"mat-option",54),n(182,"Double"),e(),t(183,"mat-option",55),n(184,"Queen"),e(),t(185,"mat-option",56),n(186,"King"),e(),t(187,"mat-option",57),n(188,"Twin"),e()()()()(),t(189,"div")(190,"mat-form-field",15)(191,"mat-label"),n(192,"Floor Preference"),e(),t(193,"mat-select",58)(194,"mat-option",51),n(195,"No Preference"),e(),t(196,"mat-option",59),n(197,"Low Floor"),e(),t(198,"mat-option",60),n(199,"Middle Floor"),e(),t(200,"mat-option",61),n(201,"High Floor"),e()()()()()(),t(202,"mat-card",62)(203,"mat-card-header")(204,"mat-icon",12),n(205,"contact_emergency"),e(),t(206,"mat-card-title"),n(207,"Emergency Contact"),e()(),t(208,"mat-card-content",13)(209,"div",14)(210,"div")(211,"mat-form-field",15)(212,"mat-label"),n(213,"Contact Name"),e(),m(214,"input",63),e()(),t(215,"div")(216,"mat-form-field",15)(217,"mat-label"),n(218,"Relationship"),e(),m(219,"input",64),e()()(),t(220,"div",14)(221,"div")(222,"mat-form-field",15)(223,"mat-label"),n(224,"Phone Number"),e(),m(225,"input",20),t(226,"mat-icon",19),n(227,"phone"),e()()(),t(228,"div")(229,"mat-form-field",15)(230,"mat-label"),n(231,"Email Address"),e(),m(232,"input",18),t(233,"mat-icon",19),n(234,"email"),e()()()()()(),t(235,"mat-card",11)(236,"mat-card-header")(237,"mat-icon",12),n(238,"notes"),e(),t(239,"mat-card-title"),n(240,"Status & Additional Information"),e()(),t(241,"mat-card-content",13)(242,"div",14)(243,"div",65)(244,"div")(245,"mat-checkbox",66),n(246," VIP Guest "),e(),t(247,"p",67),n(248,"Mark as VIP for special treatment and privileges"),e()(),t(249,"div")(250,"mat-checkbox",68),n(251," Blacklisted "),e(),t(252,"p",67),n(253,"Restrict future bookings and services"),e()()()(),t(254,"div")(255,"mat-form-field",15)(256,"mat-label"),n(257,"Notes"),e(),t(258,"textarea",69),n(259,"              "),e()()()()()()()}if(r&2){let a=b(47),l=b(91),d=v();o(),s("formGroup",d.guestForm),o(14),u(d.getFieldError("firstName")?15:-1),o(6),u(d.getFieldError("lastName")?21:-1),o(9),u(d.getFieldError("email")?30:-1),o(8),u(d.getFieldError("phone")?38:-1),o(6),s("matDatepicker",a),o(),s("for",a),o(10),h(d.countryOptions),o(33),s("matDatepicker",l),o(),s("for",l),o(10),h(d.countryOptions),o(37),h(d.countryOptions)}}var Fe=class r{router=g(A);route=g(B);fb=g(re);snackBar=g($);guestService=g(Ne);storeStore=g(U);destroy$=new N;guest=E(null);isLoading=E(!1);isSaving=E(!1);guestId=E(null);guestForm;isEditMode=S(()=>!!this.guestId());pageTitle=S(()=>this.isEditMode()?"Edit Guest":"Create Guest");submitButtonText=S(()=>this.isEditMode()?"Update Guest":"Create Guest");selectedStore=S(()=>this.storeStore.selectedStore());countryOptions=[{code:"US",name:"United States"},{code:"UK",name:"United Kingdom"},{code:"CA",name:"Canada"},{code:"DE",name:"Germany"},{code:"FR",name:"France"},{code:"IT",name:"Italy"},{code:"ES",name:"Spain"},{code:"AU",name:"Australia"},{code:"JP",name:"Japan"},{code:"KR",name:"South Korea"},{code:"CN",name:"China"},{code:"IN",name:"India"},{code:"BR",name:"Brazil"},{code:"MX",name:"Mexico"},{code:"AR",name:"Argentina"},{code:"NG",name:"Nigeria"},{code:"ZA",name:"South Africa"},{code:"EG",name:"Egypt"},{code:"AE",name:"United Arab Emirates"},{code:"SA",name:"Saudi Arabia"}];constructor(){this.guestForm=this.createForm()}ngOnInit(){this.route.params.pipe(F(this.destroy$)).subscribe(i=>{let a=i.id;this.guestId.set(a||null),this.isEditMode()&&this.loadGuest(a)})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}createForm(){return this.fb.group({firstName:["",[c.required,c.minLength(2)]],lastName:["",[c.required,c.minLength(2)]],email:["",[c.required,c.email]],phone:["",[c.required,c.pattern(/^\+?[\d\s\-\(\)]+$/)]],dateOfBirth:[""],nationality:[""],idDocument:this.fb.group({type:["passport"],number:[""],expiryDate:[""],issuingCountry:[""]}),address:this.fb.group({street:[""],city:[""],state:[""],postalCode:[""],country:[""]}),preferences:this.fb.group({roomType:[""],smokingPreference:["non_smoking"],bedPreference:["no_preference"],floorPreference:["no_preference"],specialRequests:[[]]}),emergencyContact:this.fb.group({name:[""],relationship:[""],phone:[""],email:[""]}),isVip:[!1],blacklisted:[!1],notes:[""]})}loadGuest(i){return y(this,null,function*(){this.isLoading.set(!0);try{let a=yield this.guestService.getGuestById(i).toPromise();if(a)this.guest.set(a),this.populateForm(a);else throw new Error("Guest not found")}catch(a){console.error("Error loading guest:",a),this.showError("Failed to load guest information"),this.router.navigate(["/menu/hms/front-desk/guests/list"])}finally{this.isLoading.set(!1)}})}populateForm(i){this.guestForm.patchValue({firstName:i.firstName,lastName:i.lastName,email:i.email,phone:i.phone,dateOfBirth:i.dateOfBirth?new Date(i.dateOfBirth):null,nationality:i.nationality,idDocument:{type:i.idDocument?.type||"passport",number:i.idDocument?.number||"",expiryDate:i.idDocument?.expiryDate?new Date(i.idDocument.expiryDate):null,issuingCountry:i.idDocument?.issuingCountry||""},address:{street:i.address?.street||"",city:i.address?.city||"",state:i.address?.state||"",postalCode:i.address?.postalCode||"",country:i.address?.country||""},preferences:{roomType:i.preferences?.roomType||"",smokingPreference:i.preferences?.smokingPreference||"non_smoking",bedPreference:i.preferences?.bedPreference||"no_preference",floorPreference:i.preferences?.floorPreference||"no_preference",specialRequests:i.preferences?.specialRequests||[]},emergencyContact:{name:i.emergencyContact?.name||"",relationship:i.emergencyContact?.relationship||"",phone:i.emergencyContact?.phone||"",email:i.emergencyContact?.email||""},isVip:i.isVip||!1,blacklisted:i.blacklisted||!1,notes:i.notes||""})}onSubmit(){return y(this,null,function*(){if(this.guestForm.invalid){this.markFormGroupTouched(this.guestForm),this.showError("Please fill in all required fields correctly");return}this.isSaving.set(!0);try{let i=this.guestForm.value,a=this.prepareGuestData(i);this.isEditMode()?(yield this.guestService.updateGuest(this.guestId(),a).toPromise(),this.showSuccess("Guest updated successfully")):(yield this.guestService.createGuest(a).toPromise(),this.showSuccess("Guest created successfully")),this.router.navigate(["/menu/hms/front-desk/guests/list"])}catch(i){console.error("Error saving guest:",i),this.showError("Failed to save guest information")}finally{this.isSaving.set(!1)}})}prepareGuestData(i){let a=this.storeStore.selectedStore()?._id;return{firstName:i.firstName,lastName:i.lastName,email:i.email,phone:i.phone,dateOfBirth:i.dateOfBirth,nationality:i.nationality,idDocument:i.idDocument,address:i.address,preferences:i.preferences,emergencyContact:i.emergencyContact,isVip:i.isVip,blacklisted:i.blacklisted,notes:i.notes,stores:a?[a]:[]}}onCancel(){this.router.navigate(["/menu/hms/front-desk/guests/list"])}getFieldError(i){let a=this.guestForm.get(i);if(a&&a.errors&&a.touched){if(a.errors.required)return`${this.getFieldLabel(i)} is required`;if(a.errors.email)return"Please enter a valid email address";if(a.errors.minlength)return`${this.getFieldLabel(i)} must be at least ${a.errors.minlength.requiredLength} characters`;if(a.errors.pattern)return"Please enter a valid phone number"}return""}getFieldLabel(i){return{firstName:"First Name",lastName:"Last Name",email:"Email",phone:"Phone Number"}[i]||i}markFormGroupTouched(i){Object.keys(i.controls).forEach(a=>{let l=i.get(a);l?.markAsTouched({onlySelf:!0}),l instanceof ee&&this.markFormGroupTouched(l)})}showSuccess(i){this.snackBar.open(i,"Close",{duration:3e3,panelClass:["success-snackbar"]})}showError(i){this.snackBar.open(i,"Close",{duration:5e3,panelClass:["error-snackbar"]})}static \u0275fac=function(a){return new(a||r)};static \u0275cmp=D({type:r,selectors:[["app-guest-form"]],decls:12,vars:6,consts:[["dobPicker",""],["expiryPicker",""],["subtitle","Fill in the guest information below",3,"title"],["actions",""],["matButton","outlined",3,"click"],["matButton","filled",3,"click","disabled"],["diameter","20"],[1,"flex","justify-center","items-center","py-16"],[1,"max-w-4xl","mx-auto","py-8"],["diameter","40"],[1,"space-y-6",3,"ngSubmit","formGroup"],["appearance","outlined"],["mat-card-avatar","",1,"text-purple-600"],[1,"p-6!","space-y-6"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-6"],["appearance","outline",1,"w-full"],["matInput","","formControlName","firstName","placeholder","Enter first name"],["matInput","","formControlName","lastName","placeholder","Enter last name"],["matInput","","type","email","formControlName","email","placeholder","Enter email address"],["matPrefix","",1,"text-gray-400"],["matInput","","formControlName","phone","placeholder","Enter phone number"],["matInput","","formControlName","dateOfBirth",3,"matDatepicker"],["matIconSuffix","",3,"for"],["formControlName","nationality"],["value",""],[3,"value"],["appearance","outlined","formGroupName","idDocument"],["formControlName","type"],["value","passport"],["value","national_id"],["value","drivers_license"],["value","other"],["matInput","","formControlName","number","placeholder","Enter document number"],["matInput","","formControlName","expiryDate",3,"matDatepicker"],["formControlName","issuingCountry"],["appearance","outlined","formGroupName","address"],["matInput","","formControlName","street","placeholder","Enter street address"],[1,"grid","grid-cols-1","md:grid-cols-3","gap-6"],["matInput","","formControlName","city","placeholder","Enter city"],["matInput","","formControlName","state","placeholder","Enter state/province"],["matInput","","formControlName","postalCode","placeholder","Enter postal code"],["formControlName","country"],["appearance","outlined","formGroupName","preferences"],["formControlName","roomType"],["value","standard"],["value","deluxe"],["value","suite"],["value","executive"],["formControlName","smokingPreference"],["value","non_smoking"],["value","smoking"],["value","no_preference"],["formControlName","bedPreference"],["value","single"],["value","double"],["value","queen"],["value","king"],["value","twin"],["formControlName","floorPreference"],["value","low"],["value","middle"],["value","high"],["appearance","outlined","formGroupName","emergencyContact"],["matInput","","formControlName","name","placeholder","Enter contact name"],["matInput","","formControlName","relationship","placeholder","e.g., Parent, Spouse, Friend"],[1,"space-y-4"],["formControlName","isVip",1,"text-purple-600"],[1,"text-sm","text-gray-500","mt-1"],["formControlName","blacklisted",1,"text-red-600"],["matInput","","formControlName","notes","rows","4","placeholder","Add any additional notes about the guest..."]],template:function(a,l){a&1&&(t(0,"app-page-header",2),G(1,3),t(2,"button",4),C("click",function(){return l.onCancel()}),t(3,"mat-icon"),n(4,"close"),e(),n(5," Cancel "),e(),t(6,"button",5),C("click",function(){return l.onSubmit()}),p(7,ke,1,0,"mat-spinner",6)(8,Me,2,0,"mat-icon"),n(9),e(),I(),e(),p(10,De,2,0,"div",7),p(11,Oe,260,9,"div",8)),a&2&&(s("title",l.pageTitle()),o(6),s("disabled",l.guestForm.invalid||l.isSaving()),o(),u(l.isSaving()?7:8),o(2),T(" ",l.submitButtonText()," "),o(),u(l.isLoading()?10:-1),o(),u(l.isLoading()?-1:11))},dependencies:[w,oe,te,Z,W,Y,ae,ne,ie,ue,pe,ce,me,le,de,se,Ee,ve,O,q,R,j,K,X,V,Q,J,z,H,Ce,Se,xe,he,L,_e,be,ge,fe,ye],encapsulation:2})};export{Fe as GuestFormComponent};
