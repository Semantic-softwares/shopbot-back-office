import{a as bi}from"./chunk-TYH3Z7BF.js";import{a as fi,b as je}from"./chunk-B2CEIZS7.js";import{a as qe}from"./chunk-WUDFCJBP.js";import"./chunk-Z73K3IEL.js";import{a as ue}from"./chunk-BADSAPV5.js";import{a as xi}from"./chunk-VHL4W3XE.js";import{a as vi,b as _i}from"./chunk-LJBXM47V.js";import{g as ci}from"./chunk-7QS7GU74.js";import"./chunk-JEAWRT3X.js";import{a as mi,b as ui,c as pi,h as gi}from"./chunk-LLLAI5OH.js";import{k as di}from"./chunk-XKLFH3FF.js";import{a as Ge,b as ke}from"./chunk-46P5YEBT.js";import{a as Ht}from"./chunk-A2P3GH4G.js";import"./chunk-J7O4JBGR.js";import{a as Bt}from"./chunk-HFTRPIKU.js";import"./chunk-SDXYS6W7.js";import{d as Fe,g as Lt}from"./chunk-6KQFCX5X.js";import{a as Ue,b as Ce}from"./chunk-KVX2H4A7.js";import{b as j,c as le,d as se}from"./chunk-GYNGZAKB.js";import{a as ve}from"./chunk-GI4SSOPO.js";import{c as si}from"./chunk-DX5KEI4P.js";import{a as ce,b as me,c as li,e as Ee,f as Se,g as Re,h as L}from"./chunk-BTSYCNWJ.js";import{a as ye,b as de}from"./chunk-WRXDGLET.js";import{a as ri}from"./chunk-QGGN4OMJ.js";import{a as ai}from"./chunk-IG3JOGNL.js";import{a as ti,b as ii,c as ni,d as oi}from"./chunk-BPPWALS2.js";import{a as ei}from"./chunk-JXNS4S7R.js";import"./chunk-2WBLSBPP.js";import"./chunk-XVOW2NM6.js";import{a as he}from"./chunk-GIZLGNET.js";import{a as Xt}from"./chunk-NXTZK4C5.js";import{a as Jt,c as Yt,g as fe}from"./chunk-J3TXHOEY.js";import{a as ae,b as Ae,c as be,d as Be,e as Ve,h as re}from"./chunk-YLKT6R4Z.js";import{C as ne,D as Kt,E as oe,a as Qt,b as J,d as w,g as Y,h as X,m as ee,n as _e,q as Zt,s as te,t as ie,x as Ne,y as xe}from"./chunk-2UT4NYMV.js";import"./chunk-S2P5547C.js";import{a as $,b as z}from"./chunk-J5JAEWDO.js";import"./chunk-RE5VYPI4.js";import"./chunk-AGG277FR.js";import"./chunk-7KULNFHZ.js";import"./chunk-5M2ITBTB.js";import{H as st,U as $t,V as zt,X as Wt,Y as K,Z as q,f as Vt,g as Ut,i as Gt,w as qt,y as jt}from"./chunk-D3B3XJ53.js";import"./chunk-RDMIWI4X.js";import"./chunk-AGZJ637K.js";import{a as Nt,c as At}from"./chunk-LTDPQFG4.js";import"./chunk-VYX7HJYX.js";import{g as Ot,i as Tt,m as Te,n as Ft,q as Z,r as G}from"./chunk-FORATDN3.js";import{$b as St,Ac as wt,Ba as tt,Cb as it,Eb as m,Ec as at,Fb as u,Gb as ge,Hb as Et,Hc as x,Ib as F,Ic as V,Jb as N,Jc as R,Kb as h,Kc as A,Lb as o,Mb as n,Nb as k,Pc as I,Sc as It,Ub as M,Y as pt,Yb as C,Za as l,_ as gt,_b as c,a as ut,aa as Xe,ac as Rt,ad as rt,bc as kt,ca as b,cb as ft,cc as nt,dc as Ie,ec as Oe,ed as W,fb as bt,fd as lt,gb as ht,ha as y,ia as E,ic as Q,ja as vt,jc as De,kc as T,la as _t,mb as B,mc as H,nb as Ct,nc as a,ob as yt,oc as p,pa as et,pc as v,qa as xt,qc as U,rc as Dt,ta as P,vc as Pt,wc as Mt,xc as ot}from"./chunk-53XJD7JZ.js";import{a as Me,b as we,f as S}from"./chunk-EQDQRRRY.js";function Di(r,t){r&1&&a(0," Should equal the full extension cost ")}function Pi(r,t){r&1&&a(0," Enter the amount paid so far ")}function Mi(r,t){r&1&&a(0," Enter 0 for pending payment ")}function wi(r,t){r&1&&(o(0,"mat-icon",31),a(1,"refresh"),n())}var $e=class r{dialogRef=b(ce);fb=b(ne);data=b(me);submitting=P(!1);paymentForm=this.fb.group({paymentStatus:["paid",[w.required]],paymentMethod:["",[w.required]],paymentAmount:[0,[w.required,w.min(0)]],transactionReference:[""],notes:[""]});ngOnInit(){this.paymentForm.patchValue({paymentAmount:this.data.extensionCost}),this.paymentForm.get("paymentStatus")?.valueChanges.subscribe(t=>{let e=this.paymentForm.get("paymentAmount");t==="paid"?(e?.setValue(this.data.extensionCost),e?.setValidators([w.required,w.min(this.data.extensionCost)])):t==="pending"?(e?.setValue(0),e?.setValidators([w.required,w.min(0),w.max(0)])):e?.setValidators([w.required,w.min(.01),w.max(this.data.extensionCost-.01)]),e?.updateValueAndValidity()})}onSubmit(){if(this.paymentForm.valid){this.submitting.set(!0);let t={paymentStatus:this.paymentForm.value.paymentStatus,paymentMethod:this.paymentForm.value.paymentMethod,paymentAmount:this.paymentForm.value.paymentAmount,transactionReference:this.paymentForm.value.transactionReference||void 0,notes:this.paymentForm.value.notes||void 0};this.dialogRef.close(t)}}onCancel(){this.dialogRef.close(null)}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=B({type:r,selectors:[["app-extension-payment-dialog"]],decls:81,vars:11,consts:[[1,"max-w-md"],[1,"flex","items-center","gap-3","p-6","border-b","border-gray-200"],[1,"text-green-600"],[1,"text-xl","font-semibold","text-gray-900"],[1,"text-sm","text-gray-600"],[1,"p-6","space-y-4",3,"ngSubmit","formGroup"],[1,"bg-gray-50","rounded-lg","p-4","space-y-2"],[1,"font-medium","text-gray-900"],[1,"grid","grid-cols-2","gap-4","text-sm"],[1,"text-gray-600"],[1,"font-medium","ml-2"],["appearance","outline",1,"w-full"],["formControlName","paymentStatus"],["value","paid"],["value","partial"],["value","pending"],["formControlName","paymentMethod"],["value","cash"],["value","credit_card"],["value","debit_card"],["value","bank_transfer"],["value","mobile_payment"],["value","check"],["value","other"],["matInput","","type","number","step","0.01","min","0","formControlName","paymentAmount","placeholder","0.00",3,"max"],["matSuffix",""],["matInput","","formControlName","transactionReference","placeholder","Optional transaction ID or reference"],["matInput","","rows","3","formControlName","notes","placeholder","Optional notes about the payment..."],[1,"flex","justify-end","gap-3","pt-4","border-t","border-gray-200"],["type","button","mat-button","",1,"px-6",3,"click"],["type","submit","mat-flat-button","","color","primary",1,"px-6",3,"disabled"],[1,"animate-spin","mr-2"]],template:function(e,i){if(e&1&&(o(0,"div",0)(1,"div",1)(2,"mat-icon",2),a(3,"payment"),n(),o(4,"div")(5,"h2",3),a(6,"Extension Payment"),n(),o(7,"p",4),a(8,"Update payment information for extension approval"),n()()(),o(9,"form",5),C("ngSubmit",function(){return i.onSubmit()}),o(10,"div",6)(11,"h3",7),a(12,"Extension Details"),n(),o(13,"div",8)(14,"div")(15,"span",9),a(16,"Additional Nights:"),n(),o(17,"span",10),a(18),n()(),o(19,"div")(20,"span",9),a(21,"Extension Cost:"),n(),o(22,"span",10),a(23),x(24,"currency"),n()()()(),o(25,"mat-form-field",11)(26,"mat-label"),a(27,"Payment Status"),n(),o(28,"mat-select",12)(29,"mat-option",13),a(30,"Paid (Full Amount)"),n(),o(31,"mat-option",14),a(32,"Partial Payment"),n(),o(33,"mat-option",15),a(34,"Pending Payment"),n()(),o(35,"mat-hint"),a(36,"Select the current payment status for this extension"),n()(),o(37,"mat-form-field",11)(38,"mat-label"),a(39,"Payment Method"),n(),o(40,"mat-select",16)(41,"mat-option",17),a(42,"Cash"),n(),o(43,"mat-option",18),a(44,"Credit Card"),n(),o(45,"mat-option",19),a(46,"Debit Card"),n(),o(47,"mat-option",20),a(48,"Bank Transfer"),n(),o(49,"mat-option",21),a(50,"Mobile Payment"),n(),o(51,"mat-option",22),a(52,"Check"),n(),o(53,"mat-option",23),a(54,"Other"),n()()(),o(55,"mat-form-field",11)(56,"mat-label"),a(57,"Payment Amount"),n(),k(58,"input",24),o(59,"span",25),a(60),n(),o(61,"mat-hint"),m(62,Di,1,0)(63,Pi,1,0)(64,Mi,1,0),n()(),o(65,"mat-form-field",11)(66,"mat-label"),a(67,"Transaction Reference"),n(),k(68,"input",26),o(69,"mat-hint"),a(70,"Payment confirmation number, receipt ID, etc."),n()(),o(71,"mat-form-field",11)(72,"mat-label"),a(73,"Payment Notes"),n(),k(74,"textarea",27),n(),o(75,"div",28)(76,"button",29),C("click",function(){return i.onCancel()}),a(77," Cancel "),n(),o(78,"button",30),m(79,wi,2,0,"mat-icon",31),a(80," Approve Extension "),n()()()()),e&2){let s;l(9),h("formGroup",i.paymentForm),l(9),p(i.data.additionalNights),l(5),p(R(24,8,i.data.extensionCost,i.data.currency)),l(35),h("max",i.data.extensionCost),l(2),p(i.data.currency),l(2),u(((s=i.paymentForm.get("paymentStatus"))==null?null:s.value)==="paid"?62:((s=i.paymentForm.get("paymentStatus"))==null?null:s.value)==="partial"?63:64),l(16),h("disabled",i.paymentForm.invalid||i.submitting()),l(),u(i.submitting()?79:-1)}},dependencies:[G,oe,ee,J,_e,Y,X,xe,Ne,ie,te,L,j,re,ae,be,Ve,se,le,ke,Ge,Fe,q,K,z,$,Z],encapsulation:2})};var Ii=["input"],Oi=["formField"],Ti=["*"],Qe=class{source;value;constructor(t,e){this.source=t,this.value=e}},Fi={provide:Qt,useExisting:pt(()=>mt),multi:!0},hi=new Xe("MatRadioGroup"),Ni=new Xe("mat-radio-default-options",{providedIn:"root",factory:()=>({color:"accent",disabledInteractive:!1})}),mt=(()=>{class r{_changeDetector=b(rt);_value=null;_name=b(st).getId("mat-radio-group-");_selected=null;_isInitialized=!1;_labelPosition="after";_disabled=!1;_required=!1;_buttonChanges;_controlValueAccessorChangeFn=()=>{};onTouched=()=>{};change=new et;_radios;color;get name(){return this._name}set name(e){this._name=e,this._updateRadioButtonNames()}get labelPosition(){return this._labelPosition}set labelPosition(e){this._labelPosition=e==="before"?"before":"after",this._markRadiosForCheck()}get value(){return this._value}set value(e){this._value!==e&&(this._value=e,this._updateSelectedRadioFromValue(),this._checkSelectedRadioButton())}_checkSelectedRadioButton(){this._selected&&!this._selected.checked&&(this._selected.checked=!0)}get selected(){return this._selected}set selected(e){this._selected=e,this.value=e?e.value:null,this._checkSelectedRadioButton()}get disabled(){return this._disabled}set disabled(e){this._disabled=e,this._markRadiosForCheck()}get required(){return this._required}set required(e){this._required=e,this._markRadiosForCheck()}get disabledInteractive(){return this._disabledInteractive}set disabledInteractive(e){this._disabledInteractive=e,this._markRadiosForCheck()}_disabledInteractive=!1;constructor(){}ngAfterContentInit(){this._isInitialized=!0,this._buttonChanges=this._radios.changes.subscribe(()=>{this.selected&&!this._radios.find(e=>e===this.selected)&&(this._selected=null)})}ngOnDestroy(){this._buttonChanges?.unsubscribe()}_touch(){this.onTouched&&this.onTouched()}_updateRadioButtonNames(){this._radios&&this._radios.forEach(e=>{e.name=this.name,e._markForCheck()})}_updateSelectedRadioFromValue(){let e=this._selected!==null&&this._selected.value===this._value;this._radios&&!e&&(this._selected=null,this._radios.forEach(i=>{i.checked=this.value===i.value,i.checked&&(this._selected=i)}))}_emitChangeEvent(){this._isInitialized&&this.change.emit(new Qe(this._selected,this._value))}_markRadiosForCheck(){this._radios&&this._radios.forEach(e=>e._markForCheck())}writeValue(e){this.value=e,this._changeDetector.markForCheck()}registerOnChange(e){this._controlValueAccessorChangeFn=e}registerOnTouched(e){this.onTouched=e}setDisabledState(e){this.disabled=e,this._changeDetector.markForCheck()}static \u0275fac=function(i){return new(i||r)};static \u0275dir=yt({type:r,selectors:[["mat-radio-group"]],contentQueries:function(i,s,d){if(i&1&&kt(d,Ze,5),i&2){let g;Ie(g=Oe())&&(s._radios=g)}},hostAttrs:["role","radiogroup",1,"mat-mdc-radio-group"],inputs:{color:"color",name:"name",labelPosition:"labelPosition",value:"value",selected:"selected",disabled:[2,"disabled","disabled",W],required:[2,"required","required",W],disabledInteractive:[2,"disabledInteractive","disabledInteractive",W]},outputs:{change:"change"},exportAs:["matRadioGroup"],features:[wt([Fi,{provide:hi,useExisting:r}])]})}return r})(),Ze=(()=>{class r{_elementRef=b(tt);_changeDetector=b(rt);_focusMonitor=b(qt);_radioDispatcher=b(ei);_defaultOptions=b(Ni,{optional:!0});_ngZone=b(xt);_renderer=b(bt);_uniqueId=b(st).getId("mat-radio-");_cleanupClick;id=this._uniqueId;name;ariaLabel;ariaLabelledby;ariaDescribedby;disableRipple=!1;tabIndex=0;get checked(){return this._checked}set checked(e){this._checked!==e&&(this._checked=e,e&&this.radioGroup&&this.radioGroup.value!==this.value?this.radioGroup.selected=this:!e&&this.radioGroup&&this.radioGroup.value===this.value&&(this.radioGroup.selected=null),e&&this._radioDispatcher.notify(this.id,this.name),this._changeDetector.markForCheck())}get value(){return this._value}set value(e){this._value!==e&&(this._value=e,this.radioGroup!==null&&(this.checked||(this.checked=this.radioGroup.value===e),this.checked&&(this.radioGroup.selected=this)))}get labelPosition(){return this._labelPosition||this.radioGroup&&this.radioGroup.labelPosition||"after"}set labelPosition(e){this._labelPosition=e}_labelPosition;get disabled(){return this._disabled||this.radioGroup!==null&&this.radioGroup.disabled}set disabled(e){this._setDisabled(e)}get required(){return this._required||this.radioGroup&&this.radioGroup.required}set required(e){e!==this._required&&this._changeDetector.markForCheck(),this._required=e}get color(){return this._color||this.radioGroup&&this.radioGroup.color||this._defaultOptions&&this._defaultOptions.color||"accent"}set color(e){this._color=e}_color;get disabledInteractive(){return this._disabledInteractive||this.radioGroup!==null&&this.radioGroup.disabledInteractive}set disabledInteractive(e){this._disabledInteractive=e}_disabledInteractive;change=new et;radioGroup;get inputId(){return`${this.id||this._uniqueId}-input`}_checked=!1;_disabled;_required;_value=null;_removeUniqueSelectionListener=()=>{};_previousTabIndex;_inputElement;_rippleTrigger;_noopAnimations=Vt();_injector=b(_t);constructor(){b(jt).load(Ut);let e=b(hi,{optional:!0}),i=b(new It("tabindex"),{optional:!0});this.radioGroup=e,this._disabledInteractive=this._defaultOptions?.disabledInteractive??!1,i&&(this.tabIndex=lt(i,0))}focus(e,i){i?this._focusMonitor.focusVia(this._inputElement,i,e):this._inputElement.nativeElement.focus(e)}_markForCheck(){this._changeDetector.markForCheck()}ngOnInit(){this.radioGroup&&(this.checked=this.radioGroup.value===this._value,this.checked&&(this.radioGroup.selected=this),this.name=this.radioGroup.name),this._removeUniqueSelectionListener=this._radioDispatcher.listen((e,i)=>{e!==this.id&&i===this.name&&(this.checked=!1)})}ngDoCheck(){this._updateTabIndex()}ngAfterViewInit(){this._updateTabIndex(),this._focusMonitor.monitor(this._elementRef,!0).subscribe(e=>{!e&&this.radioGroup&&this.radioGroup._touch()}),this._ngZone.runOutsideAngular(()=>{this._cleanupClick=this._renderer.listen(this._inputElement.nativeElement,"click",this._onInputClick)})}ngOnDestroy(){this._cleanupClick?.(),this._focusMonitor.stopMonitoring(this._elementRef),this._removeUniqueSelectionListener()}_emitChangeEvent(){this.change.emit(new Qe(this,this._value))}_isRippleDisabled(){return this.disableRipple||this.disabled}_onInputInteraction(e){if(e.stopPropagation(),!this.checked&&!this.disabled){let i=this.radioGroup&&this.value!==this.radioGroup.value;this.checked=!0,this._emitChangeEvent(),this.radioGroup&&(this.radioGroup._controlValueAccessorChangeFn(this.value),i&&this.radioGroup._emitChangeEvent())}}_onTouchTargetClick(e){this._onInputInteraction(e),(!this.disabled||this.disabledInteractive)&&this._inputElement?.nativeElement.focus()}_setDisabled(e){this._disabled!==e&&(this._disabled=e,this._changeDetector.markForCheck())}_onInputClick=e=>{this.disabled&&this.disabledInteractive&&e.preventDefault()};_updateTabIndex(){let e=this.radioGroup,i;if(!e||!e.selected||this.disabled?i=this.tabIndex:i=e.selected===this?this.tabIndex:-1,i!==this._previousTabIndex){let s=this._inputElement?.nativeElement;s&&(s.setAttribute("tabindex",i+""),this._previousTabIndex=i,ft(()=>{queueMicrotask(()=>{e&&e.selected&&e.selected!==this&&document.activeElement===s&&(e.selected?._inputElement.nativeElement.focus(),document.activeElement===s&&this._inputElement.nativeElement.blur())})},{injector:this._injector}))}}static \u0275fac=function(i){return new(i||r)};static \u0275cmp=B({type:r,selectors:[["mat-radio-button"]],viewQuery:function(i,s){if(i&1&&(nt(Ii,5),nt(Oi,7,tt)),i&2){let d;Ie(d=Oe())&&(s._inputElement=d.first),Ie(d=Oe())&&(s._rippleTrigger=d.first)}},hostAttrs:[1,"mat-mdc-radio-button"],hostVars:19,hostBindings:function(i,s){i&1&&C("focus",function(){return s._inputElement.nativeElement.focus()}),i&2&&(it("id",s.id)("tabindex",null)("aria-label",null)("aria-labelledby",null)("aria-describedby",null),T("mat-primary",s.color==="primary")("mat-accent",s.color==="accent")("mat-warn",s.color==="warn")("mat-mdc-radio-checked",s.checked)("mat-mdc-radio-disabled",s.disabled)("mat-mdc-radio-disabled-interactive",s.disabledInteractive)("_mat-animation-noopable",s._noopAnimations))},inputs:{id:"id",name:"name",ariaLabel:[0,"aria-label","ariaLabel"],ariaLabelledby:[0,"aria-labelledby","ariaLabelledby"],ariaDescribedby:[0,"aria-describedby","ariaDescribedby"],disableRipple:[2,"disableRipple","disableRipple",W],tabIndex:[2,"tabIndex","tabIndex",e=>e==null?0:lt(e)],checked:[2,"checked","checked",W],value:"value",labelPosition:"labelPosition",disabled:[2,"disabled","disabled",W],required:[2,"required","required",W],color:"color",disabledInteractive:[2,"disabledInteractive","disabledInteractive",W]},outputs:{change:"change"},exportAs:["matRadioButton"],ngContentSelectors:Ti,decls:13,vars:17,consts:[["formField",""],["input",""],["mat-internal-form-field","",3,"labelPosition"],[1,"mdc-radio"],[1,"mat-mdc-radio-touch-target",3,"click"],["type","radio","aria-invalid","false",1,"mdc-radio__native-control",3,"change","id","checked","disabled","required"],[1,"mdc-radio__background"],[1,"mdc-radio__outer-circle"],[1,"mdc-radio__inner-circle"],["mat-ripple","",1,"mat-radio-ripple","mat-focus-indicator",3,"matRippleTrigger","matRippleDisabled","matRippleCentered"],[1,"mat-ripple-element","mat-radio-persistent-ripple"],[1,"mdc-label",3,"for"]],template:function(i,s){if(i&1){let d=M();St(),o(0,"div",2,0)(2,"div",3)(3,"div",4),C("click",function(f){return y(d),E(s._onTouchTargetClick(f))}),n(),o(4,"input",5,1),C("change",function(f){return y(d),E(s._onInputInteraction(f))}),n(),o(6,"div",6),k(7,"div",7)(8,"div",8),n(),o(9,"div",9),k(10,"div",10),n()(),o(11,"label",11),Rt(12),n()()}i&2&&(h("labelPosition",s.labelPosition),l(2),T("mdc-radio--disabled",s.disabled),l(2),h("id",s.inputId)("checked",s.checked)("disabled",s.disabled&&!s.disabledInteractive)("required",s.required),it("name",s.name)("value",s.value)("aria-label",s.ariaLabel)("aria-labelledby",s.ariaLabelledby)("aria-describedby",s.ariaDescribedby)("aria-disabled",s.disabled&&s.disabledInteractive?"true":null),l(5),h("matRippleTrigger",s._rippleTrigger.nativeElement)("matRippleDisabled",s._isRippleDisabled())("matRippleCentered",!0),l(2),h("for",s.inputId))},dependencies:[$t,Bt],styles:[`.mat-mdc-radio-button{-webkit-tap-highlight-color:rgba(0,0,0,0)}.mat-mdc-radio-button .mdc-radio{display:inline-block;position:relative;flex:0 0 auto;box-sizing:content-box;width:20px;height:20px;cursor:pointer;will-change:opacity,transform,border-color,color;padding:calc((var(--mat-radio-state-layer-size, 40px) - 20px)/2)}.mat-mdc-radio-button .mdc-radio:hover>.mdc-radio__native-control:not([disabled]):not(:focus)~.mdc-radio__background::before{opacity:.04;transform:scale(1)}.mat-mdc-radio-button .mdc-radio:hover>.mdc-radio__native-control:not([disabled])~.mdc-radio__background>.mdc-radio__outer-circle{border-color:var(--mat-radio-unselected-hover-icon-color, var(--mat-sys-on-surface))}.mat-mdc-radio-button .mdc-radio:hover>.mdc-radio__native-control:enabled:checked+.mdc-radio__background>.mdc-radio__outer-circle{border-color:var(--mat-radio-selected-hover-icon-color, var(--mat-sys-primary))}.mat-mdc-radio-button .mdc-radio:hover>.mdc-radio__native-control:enabled:checked+.mdc-radio__background>.mdc-radio__inner-circle{background-color:var(--mat-radio-selected-hover-icon-color, var(--mat-sys-primary, currentColor))}.mat-mdc-radio-button .mdc-radio:active>.mdc-radio__native-control:enabled:not(:checked)+.mdc-radio__background>.mdc-radio__outer-circle{border-color:var(--mat-radio-unselected-pressed-icon-color, var(--mat-sys-on-surface))}.mat-mdc-radio-button .mdc-radio:active>.mdc-radio__native-control:enabled:checked+.mdc-radio__background>.mdc-radio__outer-circle{border-color:var(--mat-radio-selected-pressed-icon-color, var(--mat-sys-primary))}.mat-mdc-radio-button .mdc-radio:active>.mdc-radio__native-control:enabled:checked+.mdc-radio__background>.mdc-radio__inner-circle{background-color:var(--mat-radio-selected-pressed-icon-color, var(--mat-sys-primary, currentColor))}.mat-mdc-radio-button .mdc-radio__background{display:inline-block;position:relative;box-sizing:border-box;width:20px;height:20px}.mat-mdc-radio-button .mdc-radio__background::before{position:absolute;transform:scale(0, 0);border-radius:50%;opacity:0;pointer-events:none;content:"";transition:opacity 90ms cubic-bezier(0.4, 0, 0.6, 1),transform 90ms cubic-bezier(0.4, 0, 0.6, 1);width:var(--mat-radio-state-layer-size, 40px);height:var(--mat-radio-state-layer-size, 40px);top:calc(-1*(var(--mat-radio-state-layer-size, 40px) - 20px)/2);left:calc(-1*(var(--mat-radio-state-layer-size, 40px) - 20px)/2)}.mat-mdc-radio-button .mdc-radio__outer-circle{position:absolute;top:0;left:0;box-sizing:border-box;width:100%;height:100%;border-width:2px;border-style:solid;border-radius:50%;transition:border-color 90ms cubic-bezier(0.4, 0, 0.6, 1)}.mat-mdc-radio-button .mdc-radio__inner-circle{position:absolute;top:0;left:0;box-sizing:border-box;width:100%;height:100%;transform:scale(0);border-radius:50%;transition:transform 90ms cubic-bezier(0.4, 0, 0.6, 1),background-color 90ms cubic-bezier(0.4, 0, 0.6, 1)}@media(forced-colors: active){.mat-mdc-radio-button .mdc-radio__inner-circle{background-color:CanvasText !important}}.mat-mdc-radio-button .mdc-radio__native-control{position:absolute;margin:0;padding:0;opacity:0;top:0;right:0;left:0;cursor:inherit;z-index:1;width:var(--mat-radio-state-layer-size, 40px);height:var(--mat-radio-state-layer-size, 40px)}.mat-mdc-radio-button .mdc-radio__native-control:checked+.mdc-radio__background,.mat-mdc-radio-button .mdc-radio__native-control:disabled+.mdc-radio__background{transition:opacity 90ms cubic-bezier(0, 0, 0.2, 1),transform 90ms cubic-bezier(0, 0, 0.2, 1)}.mat-mdc-radio-button .mdc-radio__native-control:checked+.mdc-radio__background>.mdc-radio__outer-circle,.mat-mdc-radio-button .mdc-radio__native-control:disabled+.mdc-radio__background>.mdc-radio__outer-circle{transition:border-color 90ms cubic-bezier(0, 0, 0.2, 1)}.mat-mdc-radio-button .mdc-radio__native-control:checked+.mdc-radio__background>.mdc-radio__inner-circle,.mat-mdc-radio-button .mdc-radio__native-control:disabled+.mdc-radio__background>.mdc-radio__inner-circle{transition:transform 90ms cubic-bezier(0, 0, 0.2, 1),background-color 90ms cubic-bezier(0, 0, 0.2, 1)}.mat-mdc-radio-button .mdc-radio__native-control:focus+.mdc-radio__background::before{transform:scale(1);opacity:.12;transition:opacity 90ms cubic-bezier(0, 0, 0.2, 1),transform 90ms cubic-bezier(0, 0, 0.2, 1)}.mat-mdc-radio-button .mdc-radio__native-control:disabled:not(:checked)+.mdc-radio__background>.mdc-radio__outer-circle{border-color:var(--mat-radio-disabled-unselected-icon-color, var(--mat-sys-on-surface));opacity:var(--mat-radio-disabled-unselected-icon-opacity, 0.38)}.mat-mdc-radio-button .mdc-radio__native-control:disabled+.mdc-radio__background{cursor:default}.mat-mdc-radio-button .mdc-radio__native-control:disabled+.mdc-radio__background>.mdc-radio__outer-circle{border-color:var(--mat-radio-disabled-selected-icon-color, var(--mat-sys-on-surface));opacity:var(--mat-radio-disabled-selected-icon-opacity, 0.38)}.mat-mdc-radio-button .mdc-radio__native-control:disabled+.mdc-radio__background>.mdc-radio__inner-circle{background-color:var(--mat-radio-disabled-selected-icon-color, var(--mat-sys-on-surface, currentColor));opacity:var(--mat-radio-disabled-selected-icon-opacity, 0.38)}.mat-mdc-radio-button .mdc-radio__native-control:enabled:not(:checked)+.mdc-radio__background>.mdc-radio__outer-circle{border-color:var(--mat-radio-unselected-icon-color, var(--mat-sys-on-surface-variant))}.mat-mdc-radio-button .mdc-radio__native-control:enabled:checked+.mdc-radio__background>.mdc-radio__outer-circle{border-color:var(--mat-radio-selected-icon-color, var(--mat-sys-primary))}.mat-mdc-radio-button .mdc-radio__native-control:enabled:checked+.mdc-radio__background>.mdc-radio__inner-circle{background-color:var(--mat-radio-selected-icon-color, var(--mat-sys-primary, currentColor))}.mat-mdc-radio-button .mdc-radio__native-control:enabled:focus:checked+.mdc-radio__background>.mdc-radio__outer-circle{border-color:var(--mat-radio-selected-focus-icon-color, var(--mat-sys-primary))}.mat-mdc-radio-button .mdc-radio__native-control:enabled:focus:checked+.mdc-radio__background>.mdc-radio__inner-circle{background-color:var(--mat-radio-selected-focus-icon-color, var(--mat-sys-primary, currentColor))}.mat-mdc-radio-button .mdc-radio__native-control:checked+.mdc-radio__background>.mdc-radio__inner-circle{transform:scale(0.5);transition:transform 90ms cubic-bezier(0, 0, 0.2, 1),background-color 90ms cubic-bezier(0, 0, 0.2, 1)}.mat-mdc-radio-button.mat-mdc-radio-disabled-interactive .mdc-radio--disabled{pointer-events:auto}.mat-mdc-radio-button.mat-mdc-radio-disabled-interactive .mdc-radio--disabled .mdc-radio__native-control:not(:checked)+.mdc-radio__background>.mdc-radio__outer-circle{border-color:var(--mat-radio-disabled-unselected-icon-color, var(--mat-sys-on-surface));opacity:var(--mat-radio-disabled-unselected-icon-opacity, 0.38)}.mat-mdc-radio-button.mat-mdc-radio-disabled-interactive .mdc-radio--disabled:hover .mdc-radio__native-control:checked+.mdc-radio__background>.mdc-radio__outer-circle,.mat-mdc-radio-button.mat-mdc-radio-disabled-interactive .mdc-radio--disabled .mdc-radio__native-control:checked:focus+.mdc-radio__background>.mdc-radio__outer-circle,.mat-mdc-radio-button.mat-mdc-radio-disabled-interactive .mdc-radio--disabled .mdc-radio__native-control+.mdc-radio__background>.mdc-radio__outer-circle{border-color:var(--mat-radio-disabled-selected-icon-color, var(--mat-sys-on-surface));opacity:var(--mat-radio-disabled-selected-icon-opacity, 0.38)}.mat-mdc-radio-button.mat-mdc-radio-disabled-interactive .mdc-radio--disabled:hover .mdc-radio__native-control:checked+.mdc-radio__background>.mdc-radio__inner-circle,.mat-mdc-radio-button.mat-mdc-radio-disabled-interactive .mdc-radio--disabled .mdc-radio__native-control:checked:focus+.mdc-radio__background>.mdc-radio__inner-circle,.mat-mdc-radio-button.mat-mdc-radio-disabled-interactive .mdc-radio--disabled .mdc-radio__native-control+.mdc-radio__background>.mdc-radio__inner-circle{background-color:var(--mat-radio-disabled-selected-icon-color, var(--mat-sys-on-surface, currentColor));opacity:var(--mat-radio-disabled-selected-icon-opacity, 0.38)}.mat-mdc-radio-button._mat-animation-noopable .mdc-radio__background::before,.mat-mdc-radio-button._mat-animation-noopable .mdc-radio__outer-circle,.mat-mdc-radio-button._mat-animation-noopable .mdc-radio__inner-circle{transition:none !important}.mat-mdc-radio-button label{cursor:pointer}.mat-mdc-radio-button .mdc-radio__background::before{background-color:var(--mat-radio-ripple-color, var(--mat-sys-on-surface))}.mat-mdc-radio-button.mat-mdc-radio-checked .mat-ripple-element,.mat-mdc-radio-button.mat-mdc-radio-checked .mdc-radio__background::before{background-color:var(--mat-radio-checked-ripple-color, var(--mat-sys-primary))}.mat-mdc-radio-button.mat-mdc-radio-disabled-interactive .mdc-radio--disabled .mat-ripple-element,.mat-mdc-radio-button.mat-mdc-radio-disabled-interactive .mdc-radio--disabled .mdc-radio__background::before{background-color:var(--mat-radio-ripple-color, var(--mat-sys-on-surface))}.mat-mdc-radio-button .mat-internal-form-field{color:var(--mat-radio-label-text-color, var(--mat-sys-on-surface));font-family:var(--mat-radio-label-text-font, var(--mat-sys-body-medium-font));line-height:var(--mat-radio-label-text-line-height, var(--mat-sys-body-medium-line-height));font-size:var(--mat-radio-label-text-size, var(--mat-sys-body-medium-size));letter-spacing:var(--mat-radio-label-text-tracking, var(--mat-sys-body-medium-tracking));font-weight:var(--mat-radio-label-text-weight, var(--mat-sys-body-medium-weight))}.mat-mdc-radio-button .mdc-radio--disabled+label{color:var(--mat-radio-disabled-label-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent))}.mat-mdc-radio-button .mat-radio-ripple{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;border-radius:50%}.mat-mdc-radio-button .mat-radio-ripple>.mat-ripple-element{opacity:.14}.mat-mdc-radio-button .mat-radio-ripple::before{border-radius:50%}.mat-mdc-radio-button .mdc-radio>.mdc-radio__native-control:focus:enabled:not(:checked)~.mdc-radio__background>.mdc-radio__outer-circle{border-color:var(--mat-radio-unselected-focus-icon-color, var(--mat-sys-on-surface))}.mat-mdc-radio-button.cdk-focused .mat-focus-indicator::before{content:""}.mat-mdc-radio-disabled{cursor:default;pointer-events:none}.mat-mdc-radio-disabled.mat-mdc-radio-disabled-interactive{pointer-events:auto}.mat-mdc-radio-touch-target{position:absolute;top:50%;left:50%;height:var(--mat-radio-touch-target-size, 48px);width:var(--mat-radio-touch-target-size, 48px);transform:translate(-50%, -50%);display:var(--mat-radio-touch-target-display, block)}[dir=rtl] .mat-mdc-radio-touch-target{left:auto;right:50%;transform:translate(50%, -50%)}
`],encapsulation:2,changeDetection:0})}return r})(),Ci=(()=>{class r{static \u0275fac=function(i){return new(i||r)};static \u0275mod=Ct({type:r});static \u0275inj=gt({imports:[zt,Ze,Gt]})}return r})();function Vi(r,t){r&1&&(o(0,"mat-error"),a(1," New check-out date is required "),n())}function Ui(r,t){r&1&&(o(0,"div",26),k(1,"mat-spinner",28),o(2,"span",29),a(3,"Checking availability..."),n()())}function Gi(r,t){if(r&1&&(o(0,"div",53)(1,"mat-icon",60),a(2,"savings"),n(),a(3),n()),r&2){let e=c(5);l(3),v(" Save ",e.formatCurrency(e.getDiscountAmount())," per night ")}}function qi(r,t){r&1&&(o(0,"mat-error"),a(1," Discounted rate is required "),n())}function ji(r,t){r&1&&(o(0,"mat-error"),a(1," Rate must be greater than 0 "),n())}function $i(r,t){r&1&&(o(0,"mat-error"),a(1," Rate cannot be higher than the original rate "),n())}function zi(r,t){if(r&1&&(o(0,"div",55)(1,"mat-form-field",15)(2,"mat-label"),a(3,"Discounted Rate per Night"),n(),k(4,"input",61),o(5,"span",62),a(6),n(),o(7,"mat-hint"),a(8),n(),m(9,qi,2,0,"mat-error"),m(10,ji,2,0,"mat-error"),m(11,$i,2,0,"mat-error"),n()()),r&2){let e,i,s,d,g,f=c(5);l(4),h("max",(e=f.availability())==null||e.pricingBreakdown==null?null:e.pricingBreakdown.originalRate),l(2),v("",((i=f.storeStore.selectedStore())==null?null:i.currency)||"$","\xA0"),l(2),v("Rate must be less than or equal to ",f.formatCurrency(((s=f.availability())==null||s.pricingBreakdown==null?null:s.pricingBreakdown.originalRate)||0)),l(),u((d=f.extensionForm.get("discountedRate"))!=null&&d.hasError("required")?9:-1),l(),u((g=f.extensionForm.get("discountedRate"))!=null&&g.hasError("min")?10:-1),l(),u(f.validateDiscountedRate()?-1:11)}}function Li(r,t){if(r&1&&(o(0,"div",58),a(1),n()),r&2){let e,i=c(5);l(),v(" Total Savings: ",i.formatCurrency(i.getDiscountAmount()*(((e=i.availability())==null?null:e.extensionDays)||0))," ")}}function Hi(r,t){if(r&1&&(o(0,"div",36)(1,"div",38)(2,"label",14),a(3,"Choose Rate Option:"),n(),o(4,"div",39),a(5,"2 options available"),n()(),o(6,"mat-radio-group",40)(7,"div",41)(8,"mat-radio-button",42)(9,"div",43),a(10," ORIGINAL "),n(),o(11,"div",44)(12,"div",45)(13,"div",46),a(14,"Same Rate"),n(),o(15,"div",47),a(16,"Continue with the original room rate"),n()(),o(17,"div",48)(18,"div",49),a(19),n(),o(20,"div",39),a(21,"per night"),n()()()()(),o(22,"div",41)(23,"mat-radio-button",50)(24,"div",44)(25,"div",45)(26,"div",51),a(27,"Discounted Rate"),n(),o(28,"div",52),a(29,"Apply a custom discount to the original rate"),n(),m(30,Gi,4,1,"div",53),n(),o(31,"div",48)(32,"div",54),a(33),n(),o(34,"div",39),a(35,"per night"),n()()()()()(),m(36,zi,12,6,"div",55),o(37,"div",56)(38,"div",57)(39,"div")(40,"div",14),a(41,"Total Extension Cost"),n(),o(42,"div",39),a(43),n(),m(44,Li,2,1,"div",58),n(),o(45,"div",59),a(46),n()()()()),r&2){let e,i,s,d=c(4);l(19),v(" ",d.formatCurrency(((e=d.availability())==null||e.pricingBreakdown==null?null:e.pricingBreakdown.originalRate)||0)," "),l(11),u(d.getDiscountAmount()>0?30:-1),l(3),v(" ",d.formatCurrency(d.getSelectedRate())," "),l(3),u(((i=d.extensionForm.get("selectedPricingStrategy"))==null?null:i.value)==="discounted_rate"?36:-1),l(7),U(" ",(s=d.availability())==null?null:s.extensionDays," nights \xD7 ",d.formatCurrency(d.getSelectedRate())," "),l(),u(d.getDiscountAmount()>0?44:-1),l(2),v(" ",d.formatCurrency(d.getTotalCost())," ")}}function Wi(r,t){if(r&1&&(o(0,"div",76)(1,"span",67),a(2),n(),o(3,"span",68),a(4),n()()),r&2){let e=t.$implicit,i=c(6);l(2),v("",i.getModifierDisplayName(e),":"),l(),H(i.getModifierValueClass(e)),l(),v(" ",i.getModifierValueDisplay(e)," ")}}function Qi(r,t){if(r&1&&(o(0,"div",9)(1,"div",75),a(2,"ADJUSTMENTS:"),n(),F(3,Wi,5,4,"div",76,Et),n()),r&2){let e,i=c(5);l(3),N((e=i.availability())==null||e.pricingBreakdown==null?null:e.pricingBreakdown.appliedModifiers)}}function Zi(r,t){if(r&1&&(o(0,"div",37)(1,"h5",63)(2,"mat-icon",64),a(3,"receipt"),n(),a(4," Pricing Breakdown "),n(),o(5,"div",65)(6,"div",66)(7,"span",67),a(8,"Base Rate per Night:"),n(),o(9,"span",68),a(10),n()(),m(11,Qi,5,0,"div",9),o(12,"div",69)(13,"div",70)(14,"span"),a(15,"Final Rate per Night:"),n(),o(16,"span",71),a(17),n()()(),o(18,"div",72)(19,"div",57)(20,"span",73),a(21,"Total Extension Cost:"),n(),o(22,"span",74),a(23),n()()()()()),r&2){let e,i,s,d,g=c(4);l(10),p(g.formatCurrency(((e=g.availability())==null||e.pricingBreakdown==null?null:e.pricingBreakdown.baseRatePerNight)||0)),l(),u(!((i=g.availability())==null||i.pricingBreakdown==null||i.pricingBreakdown.appliedModifiers==null)&&i.pricingBreakdown.appliedModifiers.length?11:-1),l(6),p(g.formatCurrency(((s=g.availability())==null||s.pricingBreakdown==null?null:s.pricingBreakdown.finalRatePerNight)||0)),l(6),p(g.formatCurrency(((d=g.availability())==null?null:d.estimatedCost)||0))}}function Ki(r,t){if(r&1&&(o(0,"div",18)(1,"div",34)(2,"div",9)(3,"div",10),a(4,"Additional Nights"),n(),o(5,"div",35),a(6),n()(),o(7,"div",9)(8,"div",10),a(9,"Extension Days"),n(),o(10,"div",35),a(11),n()()(),m(12,Hi,47,8,"div",36),m(13,Zi,24,4,"div",37),n()),r&2){let e,i,s,d,g=c(3);l(6),p((e=g.availability())==null?null:e.maxExtensionNights),l(5),p((i=g.availability())==null?null:i.extensionDays),l(),u(!((s=g.availability())==null||s.pricingBreakdown==null)&&s.pricingBreakdown.originalRate?12:-1),l(),u((d=g.availability())!=null&&d.pricingBreakdown?13:-1)}}function Ji(r,t){r&1&&(o(0,"div",33)(1,"mat-icon",77),a(2,"warning"),n(),o(3,"div",78)(4,"div",68),a(5,"Room conflicts prevent extension beyond this date"),n(),o(6,"div",79),a(7,"Please choose an earlier date or check with front desk for alternative options."),n()()())}function Yi(r,t){if(r&1&&(o(0,"div",30)(1,"div",31)(2,"mat-icon"),a(3),n(),o(4,"h4",32),a(5),n()(),m(6,Ki,14,4,"div",18),m(7,Ji,8,0,"div",33),n()),r&2){let e,i,s,d,g,f,D,O=c(2);H((e=O.availability())!=null&&e.isAvailable?"border-green-200 bg-green-50":"border-red-200 bg-red-50"),l(2),H((i=O.availability())!=null&&i.isAvailable?"text-green-600":"text-red-600"),l(),v(" ",(s=O.availability())!=null&&s.isAvailable?"check_circle":"cancel"," "),l(),H((d=O.availability())!=null&&d.isAvailable?"text-green-800":"text-red-800"),l(),v(" ",(g=O.availability())!=null&&g.isAvailable?"Extension Available":"Extension Unavailable"," "),l(),u((f=O.availability())!=null&&f.isAvailable?6:-1),l(),u(!((D=O.availability())!=null&&D.isAvailable)&&(!((D=O.availability())==null||D.conflictingReservations==null)&&D.conflictingReservations.length)?7:-1)}}function Xi(r,t){if(r&1&&(o(0,"div",18),m(1,Ui,4,0,"div",26),m(2,Yi,8,10,"div",27),n()),r&2){let e=c();l(),u(e.availabilityChecking()?1:-1),l(),u(e.availability()&&!e.availabilityChecking()?2:-1)}}function en(r,t){if(r&1&&(o(0,"div",20)(1,"mat-icon",80),a(2,"error"),n(),o(3,"div",81)(4,"div",68),a(5,"Extension Request Failed"),n(),o(6,"div"),a(7),n()()()),r&2){let e=c();l(7),p(e.errorMessage())}}function tn(r,t){r&1&&k(0,"mat-spinner",25)}function nn(r,t){r&1&&(o(0,"span"),a(1,"Request Extension"),n())}function on(r,t){r&1&&(o(0,"span"),a(1,"Processing..."),n())}var Ke=class r{dialogRef=b(ce);data=b(me);fb=b(ne);reservationService=b(ue);storeStore=b(he);extensionForm;isLoading=P(!1);availabilityChecking=P(!1);availability=P(null);errorMessage=P("");constructor(){let t=new Date(this.data.currentCheckOutDate);t.setDate(t.getDate()+1),this.extensionForm=this.fb.group({newCheckOutDate:["",[w.required]],selectedPricingStrategy:["same_rate",w.required],discountedRate:[{value:"",disabled:!0}],notes:[""]}),this.minExtensionDate=t,this.extensionForm.get("selectedPricingStrategy")?.valueChanges.subscribe(e=>{this.onPricingStrategyChange(e)})}minExtensionDate;get reservation(){return this.data.reservation}get currentCheckOutDate(){return this.data.currentCheckOutDate}get selectedStore(){return this.storeStore.selectedStore}formatCurrency(t){let i=this.selectedStore()?.currency||"USD";return`${{USD:"$",EUR:"\u20AC",GBP:"\xA3",NGN:"\u20A6",GHS:"\u20B5",KES:"KSh",ZAR:"R",CAD:"C$",AUD:"A$"}[i]||i+" "}${t.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}`}getPricingStrategyDisplayName(t){return{same_rate:"Original Booking Rate",current_rate:"Current Room Rate",extension_rate:"Extension Rate",dynamic_rate:"Dynamic Pricing",loyalty_rate:"Loyalty Rate"}[t]||t}getModifierDisplayName(t){if(t.type==="percentage"){let e=((t.value-1)*100).toFixed(0);return e>="0"?`+${e}%`:`${e}%`}else return`${t.value>0?"+":""}${this.formatCurrency(t.value)}`}onDateChange(){return S(this,null,function*(){let t=this.extensionForm.get("newCheckOutDate")?.value;yield this.checkAvailability()})}checkAvailability(){return S(this,null,function*(){let t=this.extensionForm.get("newCheckOutDate")?.value;if(t){this.availabilityChecking.set(!0),this.errorMessage.set("");try{let e=yield this.reservationService.checkExtensionAvailability(this.reservation._id,t.toISOString()).toPromise();this.availability.set(e)}catch(e){this.errorMessage.set(e.message||"Failed to check availability"),this.availability.set(null)}finally{this.availabilityChecking.set(!1)}}})}calculateEstimatedCost(t){return this.calculateNights(t)*100}calculateNights(t){let e=t.getTime()-this.currentCheckOutDate.getTime();return Math.ceil(e/(1e3*3600*24))}submitExtension(){return S(this,null,function*(){if(!this.extensionForm.valid){this.markFormGroupTouched();return}if(!this.availability()?.isAvailable){this.errorMessage.set("Extension is not available for the selected dates");return}this.isLoading.set(!0),this.errorMessage.set("");try{let e=this.extensionForm.value,i=this.calculateNights(e.newCheckOutDate),s={newCheckOutDate:e.newCheckOutDate.toISOString(),additionalNights:i,selectedPricingStrategy:e.selectedPricingStrategy,selectedRate:this.getSelectedRate(),discountedRate:e.selectedPricingStrategy==="discounted_rate"?this.getDiscountedRateValue():null,totalCost:this.getTotalCost(),notes:e.notes||""},d=yield this.reservationService.requestExtension(this.reservation._id,s).toPromise();this.dialogRef.close({success:!0,extension:d?.extension})}catch(e){this.errorMessage.set(e.message||"Failed to request extension")}finally{this.isLoading.set(!1)}})}markFormGroupTouched(){Object.keys(this.extensionForm.controls).forEach(t=>{this.extensionForm.get(t)?.markAsTouched()})}getModifierValueDisplay(t){return t.type==="percentage"?`${t.value>0?"+":""}${t.value}%`:`${t.value>0?"+":""}${this.formatCurrency(t.value)}`}getModifierValueClass(t){return t.value>0?"text-red-600 font-medium":"text-green-600 font-medium"}getModifierDescription(t){let e={seasonal:"Applied based on current season",loyalty:"Discount for loyalty program members",length_of_stay:"Discount for extended stays",last_minute:"Discount for booking within 24 hours",occupancy:"Rate adjusted based on current occupancy levels",weekend:"Additional charge for weekend stays",holiday:"Premium rate during holiday periods"};return t.description||e[t.type]||""}get rateOptions(){let t=this.availability()?.pricingBreakdown;return!t||!t.originalRate?[]:[{id:"same_rate",name:"Same Rate",description:"Continue with the original room rate",rate:t.originalRate,isRecommended:!0,badge:"ORIGINAL",savings:0},{id:"discounted_rate",name:"Discounted Rate",description:"Apply a custom discount to the original rate",rate:this.getDiscountedRateValue()||t.originalRate,isRecommended:!1,badge:null,savings:this.getDiscountAmount()}]}getDiscountedRateValue(){let t=this.extensionForm.get("discountedRate")?.value;return t?parseFloat(t):0}getDiscountAmount(){let t=this.availability()?.pricingBreakdown?.originalRate||0,e=this.getDiscountedRateValue();return e>0?Math.max(0,t-e):0}getSelectedRate(){let t=this.extensionForm.get("selectedPricingStrategy")?.value;if(t==="same_rate")return this.availability()?.pricingBreakdown?.originalRate||0;if(t==="discounted_rate"){let e=this.getDiscountedRateValue();return e>0?e:this.availability()?.pricingBreakdown?.originalRate||0}return 0}getTotalCost(){let t=this.availability()?.extensionDays||0,e=this.getSelectedRate();return t*e}getSavings(t){return t.savings||0}hasSavings(t){return(t.savings||0)>0}onPricingStrategyChange(t){let e=this.extensionForm.get("discountedRate");if(t==="discounted_rate"){e?.enable(),e?.setValidators([w.required,w.min(1)]);let i=this.availability()?.pricingBreakdown?.originalRate||0;e?.setValue(i)}else e?.disable(),e?.clearValidators(),e?.setValue("");e?.updateValueAndValidity()}validateDiscountedRate(){if(this.extensionForm.get("selectedPricingStrategy")?.value==="discounted_rate"){let e=this.availability()?.pricingBreakdown?.originalRate||0,i=this.getDiscountedRateValue();return i>0&&i<=e}return!0}onCancel(){this.dialogRef.close({success:!1})}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=B({type:r,selectors:[["app-extension-dialog"]],decls:59,vars:19,consts:[["picker",""],["mat-dialog-title","",1,"flex","items-center","gap-3","border-b","border-gray-200"],[1,"text-xl","font-semibold","text-gray-800","m-0"],[1,"text-sm","text-gray-600","m-0","mt-1"],[1,"py-6"],[1,"bg-gray-50","rounded-lg","p-4","mb-6"],[1,"text-sm","font-medium","text-gray-700","mb-3","flex","items-center","gap-2"],[1,"text-gray-600","!text-base"],[1,"grid","grid-cols-1","md:grid-cols-3","gap-4"],[1,"space-y-1"],[1,"text-xs","font-medium","text-gray-500","uppercase","tracking-wider"],[1,"text-sm","text-gray-900"],[1,"space-y-6",3,"formGroup"],[1,"space-y-2"],[1,"text-sm","font-medium","text-gray-700"],["appearance","outline",1,"w-full"],["matInput","","formControlName","newCheckOutDate","placeholder","Choose date",3,"dateChange","matDatepicker"],["matIconSuffix","",3,"for"],[1,"space-y-4"],["matInput","","formControlName","notes","rows","3","placeholder","Add any special requests or notes for the extension"],[1,"flex","items-start","gap-3","p-4","bg-red-50","border","border-red-200","rounded-md"],[1,"flex","justify-end","gap-3","pt-6","border-t","border-gray-200","mt-6"],["mat-button","","type","button",1,"px-4","py-2",3,"click","disabled"],["mat-raised-button","","color","primary","type","button",1,"px-6","py-2","min-w-[140px]",3,"click","disabled"],[1,"flex","items-center","justify-center","gap-2"],["diameter","16"],[1,"flex","items-center","justify-center","gap-3","py-8"],[1,"border","rounded-lg","p-4",3,"class"],["diameter","24"],[1,"text-sm","text-gray-600"],[1,"border","rounded-lg","p-4"],[1,"flex","items-center","gap-3","mb-4"],[1,"text-base","font-medium"],[1,"flex","items-start","gap-3","p-3","bg-amber-50","border","border-amber-200","rounded-md"],[1,"grid","grid-cols-2","gap-4","text-sm"],[1,"text-gray-900","font-semibold"],[1,"space-y-4","border-t","pt-4"],[1,"bg-white","rounded-md","p-4","border","border-gray-200"],[1,"flex","items-center","justify-between"],[1,"text-xs","text-gray-500"],["formControlName","selectedPricingStrategy",1,"space-y-3"],[1,"relative"],["value","same_rate",1,"w-full","block","p-4","border","border-blue-200","bg-blue-50","rounded-lg","hover:bg-blue-100","transition-colors"],[1,"absolute","top-2","right-2","px-2","py-1","text-xs","font-bold","rounded-full","bg-blue-100","text-blue-800"],[1,"flex","items-start","justify-between","mt-1"],[1,"flex-1","min-w-0","pr-4"],[1,"text-sm","font-semibold","text-blue-900"],[1,"text-xs","mt-1","text-blue-700"],[1,"text-right"],[1,"text-lg","font-bold","text-blue-600"],["value","discounted_rate",1,"w-full","block","p-4","border","border-green-200","bg-green-50","rounded-lg","hover:bg-green-100","transition-colors"],[1,"text-sm","font-semibold","text-green-900"],[1,"text-xs","mt-1","text-green-700"],[1,"inline-flex","items-center","mt-2","px-2","py-1","bg-green-100","text-green-800","text-xs","font-medium","rounded-full"],[1,"text-lg","font-bold","text-green-600"],[1,"mt-4"],[1,"bg-gray-100","rounded-lg","p-4","mt-4"],[1,"flex","justify-between","items-center"],[1,"text-xs","text-green-600","font-medium","mt-1"],[1,"text-xl","font-bold","text-blue-600"],[1,"!text-xs","mr-1"],["matInput","","type","number","min","1","step","0.01","formControlName","discountedRate","placeholder","Enter discounted rate",3,"max"],["matTextPrefix",""],[1,"text-sm","font-medium","text-gray-900","mb-3","flex","items-center","gap-2"],[1,"!text-base","text-blue-600"],[1,"space-y-2","text-sm"],[1,"flex","justify-between"],[1,"text-gray-600"],[1,"font-medium"],[1,"border-t","pt-2","mt-3"],[1,"flex","justify-between","font-semibold"],[1,"text-blue-600"],[1,"bg-blue-50","rounded","p-2","mt-3"],[1,"font-semibold","text-blue-900"],[1,"text-lg","font-bold","text-blue-700"],[1,"text-xs","font-medium","text-gray-500","mt-2","mb-1"],[1,"flex","justify-between","text-xs"],[1,"text-amber-600","!text-base","mt-0.5"],[1,"text-sm","text-amber-800"],[1,"text-xs","mt-1"],[1,"text-red-600","!text-base","mt-0.5"],[1,"text-sm","text-red-800"]],template:function(e,i){if(e&1){let s=M();o(0,"div",1)(1,"div")(2,"span",2),a(3,"Extend Reservation"),n(),o(4,"p",3),a(5),n()()(),o(6,"mat-dialog-content",4)(7,"div",5)(8,"h3",6)(9,"mat-icon",7),a(10,"info"),n(),a(11," Current Reservation Details "),n(),o(12,"div",8)(13,"div",9)(14,"div",10),a(15,"Check-out Date"),n(),o(16,"div",11),a(17),x(18,"date"),n()(),o(19,"div",9)(20,"div",10),a(21,"Room(s)"),n(),o(22,"div",11),a(23),n()(),o(24,"div",9)(25,"div",10),a(26,"Confirmation"),n(),o(27,"div",11),a(28),n()()()(),o(29,"form",12)(30,"div",13)(31,"label",14),a(32,"New Check-out Date"),n(),o(33,"mat-form-field",15)(34,"mat-label"),a(35,"Select new check-out date"),n(),o(36,"input",16),C("dateChange",function(){return y(s),E(i.onDateChange())}),n(),k(37,"mat-datepicker-toggle",17)(38,"mat-datepicker",null,0),m(40,Vi,2,0,"mat-error"),n()(),m(41,Xi,3,2,"div",18),o(42,"div",13)(43,"label",14),a(44,"Notes (Optional)"),n(),o(45,"mat-form-field",15)(46,"mat-label"),a(47,"Special requests or notes"),n(),o(48,"textarea",19),a(49,"        "),n()()(),m(50,en,8,1,"div",20),n()(),o(51,"mat-dialog-actions",21)(52,"button",22),C("click",function(){return y(s),E(i.onCancel())}),a(53," Cancel "),n(),o(54,"button",23),C("click",function(){return y(s),E(i.submitExtension())}),o(55,"div",24),m(56,tn,1,0,"mat-spinner",25),m(57,nn,2,0,"span"),m(58,on,2,0,"span"),n()()()}if(e&2){let s,d,g,f=Q(39);l(5),U(" Request extension for ",i.reservation==null||i.reservation.guestDetails==null||i.reservation.guestDetails.primaryGuest==null?null:i.reservation.guestDetails.primaryGuest.firstName," ",i.reservation==null||i.reservation.guestDetails==null||i.reservation.guestDetails.primaryGuest==null?null:i.reservation.guestDetails.primaryGuest.lastName," "),l(12),p(R(18,16,i.currentCheckOutDate,"mediumDate")),l(6),v("",i.reservation==null||i.reservation.rooms==null?null:i.reservation.rooms.length," room(s)"),l(5),p(i.reservation==null?null:i.reservation.confirmationNumber),l(),h("formGroup",i.extensionForm),l(7),h("matDatepicker",f),l(),h("for",f),l(3),u((s=i.extensionForm.get("newCheckOutDate"))!=null&&s.hasError("required")?40:-1),l(),u((d=i.extensionForm.get("newCheckOutDate"))!=null&&d.value?41:-1),l(9),u(i.errorMessage()?50:-1),l(2),h("disabled",i.isLoading()),l(2),h("disabled",!i.extensionForm.valid||!((g=i.availability())!=null&&g.isAvailable)||i.isLoading()),l(2),u(i.isLoading()?56:-1),l(),u(i.isLoading()?-1:57),l(),u(i.isLoading()?58:-1)}},dependencies:[G,Kt,ee,J,_e,Y,X,xe,Ne,oe,ie,te,L,Ee,Re,Se,j,re,ae,be,Ae,Be,Ve,se,le,q,K,gi,mi,ui,pi,Ht,Ce,Ue,z,$,fe,de,Ci,mt,Ze,Ft],styles:[".mat-mdc-dialog-container[_ngcontent-%COMP%]{--mdc-dialog-container-color: white;--mdc-dialog-supporting-text-color: #374151}.mat-mdc-radio-button.mat-mdc-radio-checked[_ngcontent-%COMP%]   .mdc-radio__native-control[_ngcontent-%COMP%]:enabled:checked + .mdc-radio__background[_ngcontent-%COMP%]   .mdc-radio__outer-circle[_ngcontent-%COMP%]{border-color:#2563eb}.mat-mdc-radio-button.mat-mdc-radio-checked[_ngcontent-%COMP%]   .mdc-radio__background[_ngcontent-%COMP%]   .mdc-radio__inner-circle[_ngcontent-%COMP%]{border-color:#2563eb;background-color:#2563eb}.mat-mdc-radio-button[_ngcontent-%COMP%]:hover   .mdc-radio__native-control[_ngcontent-%COMP%]:enabled:not(:checked) + .mdc-radio__background[_ngcontent-%COMP%]   .mdc-radio__outer-circle[_ngcontent-%COMP%]{border-color:#3b82f6}.mat-mdc-form-field.mat-form-field-appearance-outline[_ngcontent-%COMP%]   .mat-mdc-text-field-wrapper[_ngcontent-%COMP%]   .mat-mdc-form-field-flex[_ngcontent-%COMP%]   .mat-mdc-form-field-infix[_ngcontent-%COMP%]{padding:12px 0}@media(max-width:640px){.mat-mdc-dialog-container[_ngcontent-%COMP%]{margin:16px;width:calc(100vw - 32px);max-width:none}}"]})};function an(r,t){if(r&1&&(o(0,"mat-form-field",7)(1,"mat-label"),a(2,"Service Fee"),n(),k(3,"input",46),o(4,"span",9),a(5),n()()),r&2){let e=c(2);l(5),v("",e.currency,"\xA0")}}function rn(r,t){if(r&1&&(o(0,"mat-form-field",7)(1,"mat-label"),a(2,"Cleaning Fee"),n(),k(3,"input",47),o(4,"span",9),a(5),n()()),r&2){let e=c(2);l(5),v("",e.currency,"\xA0")}}function ln(r,t){if(r&1&&(o(0,"mat-form-field",7)(1,"mat-label"),a(2,"Resort Fee"),n(),k(3,"input",48),o(4,"span",9),a(5),n()()),r&2){let e=c(2);l(5),v("",e.currency,"\xA0")}}function sn(r,t){if(r&1&&(o(0,"mat-form-field",7)(1,"mat-label"),a(2,"Other Fees"),n(),k(3,"input",49),o(4,"span",9),a(5),n()()),r&2){let e=c(2);l(5),v("",e.currency,"\xA0")}}function dn(r,t){if(r&1&&(o(0,"div",11)(1,"h4",4)(2,"mat-icon",5),a(3,"lock"),n(),a(4," Additional Fees (Read-only) "),n(),o(5,"div",6),m(6,an,6,1,"mat-form-field",7),m(7,rn,6,1,"mat-form-field",7),m(8,ln,6,1,"mat-form-field",7),m(9,sn,6,1,"mat-form-field",7),n()()),r&2){let e=c();l(6),u(e.data.reservation.pricing.fees.serviceFee?6:-1),l(),u(e.data.reservation.pricing.fees.cleaningFee?7:-1),l(),u(e.data.reservation.pricing.fees.resortFee?8:-1),l(),u(e.data.reservation.pricing.fees.other?9:-1)}}function cn(r,t){if(r&1&&(o(0,"div",12)(1,"h4",50)(2,"mat-icon",51),a(3,"lock"),n(),a(4," Extension Charges (Read-only) "),n(),o(5,"div",6)(6,"mat-form-field",7)(7,"mat-label"),a(8,"Extension Cost"),n(),k(9,"input",52),o(10,"span",9),a(11),n(),o(12,"mat-hint"),a(13),n()(),o(14,"div",25)(15,"div",53),a(16,"Extension Status"),n(),o(17,"div",45)(18,"mat-icon",54),a(19,"check_circle"),n(),o(20,"span",55),a(21,"Approved & Included"),n()(),o(22,"div",56),a(23," Cannot be modified in pricing dialog "),n()()(),o(24,"div",57)(25,"div",45)(26,"mat-icon",58),a(27,"info"),n(),o(28,"span")(29,"strong"),a(30),n(),a(31," totaling "),o(32,"strong"),a(33),x(34,"currency"),n(),a(35," have been approved and are automatically included in the total. "),n()()()()),r&2){let e=c();l(9),h("value",e.getApprovedExtensionCost()),l(2),v("",e.currency,"\xA0"),l(2),v("",e.getApprovedExtensionNights()," additional nights"),l(17),v("",e.getApprovedExtensionNights()," extension night(s)"),l(3),p(A(34,5,e.getApprovedExtensionCost(),e.currency,"symbol","1.2-2"))}}function mn(r,t){if(r&1&&(o(0,"div",32)(1,"span",33),a(2),n(),o(3,"span",59),a(4),x(5,"currency"),n()()),r&2){let e=c();l(2),v("Extensions (",e.getApprovedExtensionNights()," nights):"),l(2),v("+",A(5,2,e.getApprovedExtensionCost(),e.currency,"symbol","1.2-2"))}}function un(r,t){r&1&&(o(0,"span",45),vt(),o(1,"svg",60),k(2,"circle",61)(3,"path",62),n(),a(4," Updating... "),n())}function pn(r,t){r&1&&(o(0,"span",45)(1,"mat-icon"),a(2,"save"),n(),a(3," Update Pricing "),n())}var Je=class r{constructor(t){this.data=t;if(this.data.reservation.status==="checked_out"){this.pricingForm=this.fb.group({}),setTimeout(()=>{this.dialogRef.close({confirmed:!1,error:"Cannot edit pricing for checked-out reservations"})});return}let e=this.data.reservation.pricing;this.pricingForm=this.fb.group({subtotal:[{value:e.subtotal||0,disabled:!0}],taxes:[{value:e.taxes||0,disabled:!0}],fees:this.fb.group({serviceFee:[{value:e.fees?.serviceFee||0,disabled:!0}],cleaningFee:[{value:e.fees?.cleaningFee||0,disabled:!0}],resortFee:[{value:e.fees?.resortFee||0,disabled:!0}],other:[{value:e.fees?.other||0,disabled:!0}]}),paid:[e.paid||0,[w.min(0)]]}),this.pricingForm.valueChanges.subscribe(()=>{this.calculateTotal()})}fb=b(ne);dialogRef=b(ce);reservationService=b(ue);storeStore=b(he);snackBar=b(ve);pricingForm;loading=P(!1);get currency(){return this.storeStore.selectedStore()?.currency||this.storeStore.selectedStore()?.currencyCode||"USD"}getApprovedExtensionCost(){return this.data.reservation.extensions?this.data.reservation.extensions.filter(e=>e.status==="approved").reduce((e,i)=>e+(i.additionalCost||0),0):0}getApprovedExtensionNights(){return this.data.reservation.extensions?this.data.reservation.extensions.filter(e=>e.status==="approved").reduce((e,i)=>e+(i.additionalNights||0),0):0}hasApprovedExtensions(){return this.getApprovedExtensionCost()>0}get currentTotal(){let t=this.data.reservation.pricing,e=this.pricingForm.value,i=t.subtotal||0,s=t.taxes||0,d=t.fees?.serviceFee||0,g=t.fees?.cleaningFee||0,f=t.fees?.resortFee||0,D=t.fees?.other||0,O=this.getApprovedExtensionCost(),pe=e.discounts?.amount||0,_=d+g+f+D;return i+s+_+O-pe}get currentBalance(){let t=this.pricingForm.get("paid")?.value||0;return this.currentTotal-t}calculateTotal(){}onCancel(){this.dialogRef.close({success:!1})}onSave(){if(this.pricingForm.invalid){this.snackBar.open("Please fill in all required fields correctly","Close",{duration:3e3,panelClass:["error-snackbar"]});return}this.loading.set(!0);let t=this.pricingForm.value,e=this.data.reservation.pricing,i={subtotal:e.subtotal,taxes:e.taxes,fees:{serviceFee:e.fees?.serviceFee||0,cleaningFee:e.fees?.cleaningFee||0,resortFee:e.fees?.resortFee||0,other:e.fees?.other||0},discounts:{amount:t.discounts.amount,reason:t.discounts.reason,code:t.discounts.code},total:this.currentTotal,paid:t.paid||0,balance:this.currentBalance}}static \u0275fac=function(e){return new(e||r)(ht(me))};static \u0275cmp=B({type:r,selectors:[["app-pricing-update-dialog"]],decls:149,vars:86,consts:[["mat-dialog-title",""],["mat-dialog-content","",1,"!p-6","!max-h-[70vh]","overflow-y-auto"],[1,"space-y-6",3,"formGroup"],[1,"bg-gray-50","rounded-lg","p-4","border","border-gray-200","mb-6","shadow-sm"],[1,"text-sm","font-semibold","text-gray-700","mb-3","flex","items-center","gap-2","uppercase","tracking-wide"],[1,"text-gray-500","text-lg"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4"],["appearance","outline",1,"w-full"],["matInput","","type","number","formControlName","subtotal","readonly","",1,"!bg-gray-100","!text-gray-600"],["matPrefix",""],["matInput","","type","number","formControlName","taxes","readonly","",1,"!bg-gray-100","!text-gray-600"],["formGroupName","fees",1,"bg-gray-50","rounded-lg","p-4","border","border-gray-200","mb-6","shadow-sm"],[1,"bg-orange-50","rounded-lg","p-4","border","border-orange-200","mb-6","shadow-sm"],[1,"space-y-6"],["formGroupName","discounts",1,"bg-green-50","rounded-lg","p-4","border","border-green-200","shadow-sm","hover:shadow-md","transition-shadow","duration-200"],[1,"text-lg","font-semibold","text-green-900","mb-3","flex","items-center","gap-2","uppercase","tracking-wide"],[1,"text-green-600"],[1,"grid","grid-cols-1","md:grid-cols-3","gap-4"],["matInput","","type","number","formControlName","amount","min","0","step","0.01","placeholder","0.00"],["matInput","","formControlName","reason","placeholder","e.g., Staff discount"],["matInput","","formControlName","code","placeholder","e.g., STAFF10"],[1,"bg-blue-50","rounded-lg","p-4","border","border-blue-200","shadow-sm","hover:shadow-md","transition-shadow","duration-200"],[1,"text-lg","font-semibold","text-blue-900","mb-3","flex","items-center","gap-2","uppercase","tracking-wide"],[1,"text-blue-600"],["matInput","","type","number","formControlName","paid","min","0","step","0.01","placeholder","0.00"],[1,"flex","flex-col","justify-center"],[1,"text-sm","text-gray-600","mb-1"],[1,"text-lg","font-medium"],[1,"bg-gradient-to-br","from-purple-50","to-indigo-50","rounded-lg","p-4","border","border-purple-200","shadow-sm"],[1,"text-lg","font-semibold","text-purple-900","mb-3","flex","items-center","gap-2","uppercase","tracking-wide"],[1,"text-purple-600"],[1,"space-y-2","text-sm"],[1,"flex","justify-between"],[1,"text-gray-600"],[1,"font-medium"],[1,"font-medium","text-green-600"],[1,"my-2"],[1,"flex","justify-between","text-lg","font-semibold"],[1,"text-gray-900"],[1,"bg-gradient-to-br","from-blue-50","to-cyan-50","rounded-lg","p-4","border","border-blue-200","shadow-sm"],[1,"text-sm","font-semibold","text-blue-900","mb-2","uppercase","tracking-wide"],[1,"text-xs","text-blue-800","space-y-1"],["mat-dialog-actions","",1,"flex","items-center","justify-end","gap-3","!p-6","!m-0","border-t","border-gray-200","bg-gray-50"],["mat-button","",1,"!text-gray-600","hover:!bg-gray-100","!px-6","!py-2","!font-medium","!rounded-lg","transition-colors","duration-200",3,"click","disabled"],["mat-raised-button","","color","primary",1,"!bg-gradient-to-r","!from-purple-600","!to-purple-700","hover:!from-purple-700","hover:!to-purple-800","!text-white","!shadow-lg","hover:!shadow-xl","!px-6","!py-2","!font-semibold","!rounded-lg","transition-all","duration-200","transform","hover:!scale-105","disabled:!opacity-50","disabled:!cursor-not-allowed","disabled:hover:!scale-100",3,"click","disabled"],[1,"flex","items-center","gap-2"],["matInput","","type","number","formControlName","serviceFee","readonly","",1,"!bg-gray-100","!text-gray-600"],["matInput","","type","number","formControlName","cleaningFee","readonly","",1,"!bg-gray-100","!text-gray-600"],["matInput","","type","number","formControlName","resortFee","readonly","",1,"!bg-gray-100","!text-gray-600"],["matInput","","type","number","formControlName","other","readonly","",1,"!bg-gray-100","!text-gray-600"],[1,"text-sm","font-semibold","text-orange-700","mb-3","flex","items-center","gap-2","uppercase","tracking-wide"],[1,"text-orange-500","text-lg"],["matInput","","type","number","readonly","",1,"!bg-gray-100","!text-gray-600",3,"value"],[1,"text-sm","text-orange-600","mb-1"],[1,"text-green-600","text-sm"],[1,"text-sm","font-medium","text-green-600"],[1,"text-xs","text-gray-500","mt-1"],[1,"mt-3","p-2","bg-orange-100","border","border-orange-200","rounded","text-xs","text-orange-800"],[1,"text-orange-600","text-sm"],[1,"font-medium","text-orange-600"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24",1,"animate-spin","-ml-1","mr-3","h-4","w-4","text-white"],["cx","12","cy","12","r","10","stroke","currentColor","stroke-width","4",1,"opacity-25"],["fill","currentColor","d","M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z",1,"opacity-75"]],template:function(e,i){if(e&1&&(o(0,"div",0),a(1,` Update Pricing
`),n(),o(2,"div",1)(3,"form",2)(4,"div",3)(5,"h4",4)(6,"mat-icon",5),a(7,"lock"),n(),a(8," Base Pricing (Read-only) "),n(),o(9,"div",6)(10,"mat-form-field",7)(11,"mat-label"),a(12,"Subtotal"),n(),k(13,"input",8),o(14,"span",9),a(15),n(),o(16,"mat-hint"),a(17,"Based on room rates and duration"),n()(),o(18,"mat-form-field",7)(19,"mat-label"),a(20,"Taxes"),n(),k(21,"input",10),o(22,"span",9),a(23),n(),o(24,"mat-hint"),a(25,"Calculated from store tax rate"),n()()()(),m(26,dn,10,4,"div",11),m(27,cn,36,10,"div",12),o(28,"div",13)(29,"div",14)(30,"h4",15)(31,"mat-icon",16),a(32,"local_offer"),n(),a(33," Discounts (Editable) "),n(),o(34,"div",17)(35,"mat-form-field",7)(36,"mat-label"),a(37,"Discount Amount"),n(),k(38,"input",18),o(39,"span",9),a(40),n(),o(41,"mat-hint"),a(42,"Reduce total amount"),n()(),o(43,"mat-form-field",7)(44,"mat-label"),a(45,"Discount Reason"),n(),k(46,"input",19),n(),o(47,"mat-form-field",7)(48,"mat-label"),a(49,"Discount Code"),n(),k(50,"input",20),n()()(),o(51,"div",21)(52,"h4",22)(53,"mat-icon",23),a(54,"payment"),n(),a(55," Payment Amount (Editable) "),n(),o(56,"div",6)(57,"mat-form-field",7)(58,"mat-label"),a(59,"Amount Paid"),n(),k(60,"input",24),o(61,"span",9),a(62),n(),o(63,"mat-hint"),a(64,"Total amount received from guest"),n()(),o(65,"div",25)(66,"div",26),a(67,"Current Status"),n(),o(68,"div",27),a(69),x(70,"titlecase"),n()()()()(),o(71,"div",28)(72,"h4",29)(73,"mat-icon",30),a(74,"calculate"),n(),a(75," Updated Summary "),n(),o(76,"div",31)(77,"div",32)(78,"span",33),a(79,"Subtotal:"),n(),o(80,"span",34),a(81),x(82,"currency"),n()(),o(83,"div",32)(84,"span",33),a(85,"Taxes:"),n(),o(86,"span",34),a(87),x(88,"currency"),n()(),o(89,"div",32)(90,"span",33),a(91,"Total Fees:"),n(),o(92,"span",34),a(93),x(94,"currency"),n()(),m(95,mn,6,7,"div",32),o(96,"div",32)(97,"span",33),a(98,"Discount:"),n(),o(99,"span",35),a(100),x(101,"currency"),n()(),k(102,"mat-divider",36),o(103,"div",37)(104,"span",38),a(105,"New Total:"),n(),o(106,"span",38),a(107),x(108,"currency"),n()(),o(109,"div",32)(110,"span",33),a(111,"Amount Paid:"),n(),o(112,"span",35),a(113),x(114,"currency"),n()(),o(115,"div",37)(116,"span"),a(117,"New Balance:"),n(),o(118,"span"),a(119),x(120,"currency"),n()()()(),o(121,"div",39)(122,"h4",40),a(123,"Original Pricing (for reference)"),n(),o(124,"div",41)(125,"div",32)(126,"span"),a(127,"Original Total:"),n(),o(128,"span"),a(129),x(130,"currency"),n()(),o(131,"div",32)(132,"span"),a(133,"Original Balance:"),n(),o(134,"span"),a(135),x(136,"currency"),n()(),o(137,"div",32)(138,"span"),a(139,"Original Amount Paid:"),n(),o(140,"span"),a(141),x(142,"currency"),n()()()()()(),o(143,"div",42)(144,"button",43),C("click",function(){return i.onCancel()}),a(145," Cancel "),n(),o(146,"button",44),C("click",function(){return i.onSave()}),m(147,un,5,0,"span",45)(148,pn,4,0,"span",45),n()()),e&2){let s,d,g,f,D;l(3),h("formGroup",i.pricingForm),l(12),v("",i.currency,"\xA0"),l(8),v("",i.currency,"\xA0"),l(3),u(i.data.reservation.pricing.fees&&(i.data.reservation.pricing.fees.serviceFee||i.data.reservation.pricing.fees.cleaningFee||i.data.reservation.pricing.fees.resortFee||i.data.reservation.pricing.fees.other)?26:-1),l(),u(i.hasApprovedExtensions()?27:-1),l(13),v("",i.currency,"\xA0"),l(22),v("",i.currency,"\xA0"),l(6),T("text-green-600",(i.data.reservation.paymentInfo==null?null:i.data.reservation.paymentInfo.status)==="paid")("text-orange-600",(i.data.reservation.paymentInfo==null?null:i.data.reservation.paymentInfo.status)==="partial")("text-gray-600",(i.data.reservation.paymentInfo==null?null:i.data.reservation.paymentInfo.status)==="pending"),l(),v(" ",V(70,34,(i.data.reservation.paymentInfo==null?null:i.data.reservation.paymentInfo.status)||"pending")," "),l(12),p(A(82,36,(s=i.pricingForm.get("subtotal"))==null?null:s.value,i.currency,"symbol","1.2-2")),l(6),p(A(88,41,(d=i.pricingForm.get("taxes"))==null?null:d.value,i.currency,"symbol","1.2-2")),l(6),p(A(94,46,(((g=i.pricingForm.get("fees.serviceFee"))==null?null:g.value)||0)+(((g=i.pricingForm.get("fees.cleaningFee"))==null?null:g.value)||0)+(((g=i.pricingForm.get("fees.resortFee"))==null?null:g.value)||0)+(((g=i.pricingForm.get("fees.other"))==null?null:g.value)||0),i.currency,"symbol","1.2-2")),l(2),u(i.hasApprovedExtensions()?95:-1),l(5),v("-",A(101,51,(f=i.pricingForm.get("discounts.amount"))==null?null:f.value,i.currency,"symbol","1.2-2")),l(7),p(A(108,56,i.currentTotal,i.currency,"symbol","1.2-2")),l(6),p(A(114,61,(D=i.pricingForm.get("paid"))==null?null:D.value,i.currency,"symbol","1.2-2")),l(2),T("text-red-600",i.currentBalance>0)("text-green-600",i.currentBalance<0)("text-gray-900",i.currentBalance===0),l(4),p(A(120,66,i.currentBalance,i.currency,"symbol","1.2-2")),l(10),p(A(130,71,i.data.reservation.pricing.total,i.currency,"symbol","1.2-2")),l(6),p(A(136,76,i.data.reservation.pricing.balance,i.currency,"symbol","1.2-2")),l(6),p(A(142,81,i.data.reservation.pricing.paid,i.currency,"symbol","1.2-2")),l(3),h("disabled",i.loading()),l(2),h("disabled",i.loading()||i.pricingForm.invalid),l(),u(i.loading()?147:148)}},dependencies:[G,oe,ee,J,_e,Y,X,xe,ie,te,Zt,L,Ee,Re,Se,q,K,se,le,re,ae,be,Be,j,z,$,de,ye,Te,Z],styles:["[_nghost-%COMP%]{display:block}.mat-mdc-dialog-container[_ngcontent-%COMP%]{max-width:90vw;max-height:90vh;overflow:visible}.mat-mdc-dialog-title[_ngcontent-%COMP%]{border-bottom:1px solid #e5e7eb;background-color:#f9fafb}.mat-mdc-dialog-content[_ngcontent-%COMP%]{background-color:#fff}.mat-mdc-dialog-actions[_ngcontent-%COMP%]{border-top:1px solid #e5e7eb;background-color:#f9fafb}.mat-mdc-form-field[_ngcontent-%COMP%]{width:100%}.mat-mdc-form-field[_ngcontent-%COMP%]   .mat-mdc-form-field-wrapper[_ngcontent-%COMP%]{padding-bottom:0}.pricing-summary[_ngcontent-%COMP%]{background-color:#f8fafc;border:1px solid #e2e8f0;border-radius:.5rem;padding:1rem}.pricing-summary[_ngcontent-%COMP%]   .summary-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:.5rem}.pricing-summary[_ngcontent-%COMP%]   .summary-row[_ngcontent-%COMP%]:last-child{margin-bottom:0}.pricing-summary[_ngcontent-%COMP%]   .summary-row.total-row[_ngcontent-%COMP%]{font-weight:600;font-size:1.125rem;border-top:2px solid #cbd5e1;padding-top:.75rem;margin-top:.75rem}.reference-pricing[_ngcontent-%COMP%]{background-color:#f0f9ff;border:1px solid #bae6fd;border-radius:.5rem;padding:1rem;font-size:.875rem}.loading-spinner[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:.5rem}.loading-spinner[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:1rem;height:1rem}.mat-mdc-raised-button.mat-primary[_ngcontent-%COMP%]{background-color:#7c3aed!important}.mat-mdc-raised-button.mat-primary[_ngcontent-%COMP%]:hover{background-color:#6d28d9!important}.mat-mdc-raised-button.mat-primary[_ngcontent-%COMP%]:disabled{background-color:#9ca3af!important;color:#6b7280!important}.mat-mdc-form-field.mat-form-field-invalid[_ngcontent-%COMP%]   .mat-mdc-text-field-wrapper[_ngcontent-%COMP%]{border-color:#ef4444}@media(max-width:768px){.grid-cols-2[_ngcontent-%COMP%], .grid-cols-3[_ngcontent-%COMP%]{grid-template-columns:1fr}.mat-mdc-dialog-container[_ngcontent-%COMP%]{margin:1rem;max-width:calc(100vw - 2rem)}}"]})};var gn=(r,t)=>t.room._id,vn=(r,t)=>t._id;function _n(r,t){if(r&1){let e=M();o(0,"mat-card",20),C("click",function(){let s=y(e).$implicit,d=c();return E(d.toggleCurrentRoomForSwap(s.room,!d.isCurrentRoomSelected(s.room._id)))}),o(1,"mat-card-content",21)(2,"div",22)(3,"div",23)(4,"div",24)(5,"mat-checkbox",25),C("change",function(s){let d=y(e).$implicit,g=c();return E(g.toggleCurrentRoomForSwap(d.room,s.checked))})("click",function(s){return y(e),E(s.stopPropagation())}),n(),o(6,"div")(7,"div",26),a(8),n(),o(9,"div",27),a(10),n()()(),o(11,"div",28)(12,"div"),a(13),n(),o(14,"div",29),a(15),x(16,"currency"),n(),o(17,"div",30),a(18),x(19,"currency"),n()()()()()()}if(r&2){let e=t.$implicit,i=c();T("!border-2",i.isCurrentRoomSelected(e.room._id))("!border-blue-500",i.isCurrentRoomSelected(e.room._id))("!bg-blue-50",i.isCurrentRoomSelected(e.room._id)),l(5),h("checked",i.isCurrentRoomSelected(e.room._id)),l(3),v("Room ",e.room.roomNumber),l(2),p(e.room.name),l(3),p((e.room.roomType==null?null:e.room.roomType.name)||"Standard"),l(2),v(" ",R(16,12,i.getRoomRate(e),i.data.currency),"/night "),l(3),v(" Total: ",R(19,15,i.getRoomTotalCost(e),i.data.currency)," ")}}function xn(r,t){r&1&&(o(0,"div",11)(1,"mat-icon",31),a(2,"info"),n(),o(3,"span"),a(4,"Select rooms you want to swap out"),n()())}function fn(r,t){if(r&1&&(o(0,"mat-option",65)(1,"div",68)(2,"div",69)(3,"span",70),a(4),n(),o(5,"span",71),a(6,"\u2022"),n(),o(7,"span",72),a(8),n()(),o(9,"div",73)(10,"span",74),a(11),n(),o(12,"span",75),a(13),x(14,"currency"),n()()()()),r&2){let e=t.$implicit,i=c(3);h("value",e),l(4),v("Room ",e.roomNumber),l(4),p(e.name),l(3),v(" ",e.roomType==null?null:e.roomType.name," "),l(2),v(" ",R(14,5,i.getRoomRate(e),i.data.currency),"/night ")}}function bn(r,t){r&1&&(o(0,"mat-icon",85),a(1,"arrow_downward"),n())}function hn(r,t){r&1&&(o(0,"mat-icon",85),a(1,"arrow_upward"),n())}function Cn(r,t){r&1&&(o(0,"mat-icon",85),a(1,"drag_handle"),n())}function yn(r,t){if(r&1&&(o(0,"div",66)(1,"div",76)(2,"div",23)(3,"div",24)(4,"mat-icon",77),a(5,"check_circle"),n(),o(6,"span",78),a(7,"New Room"),n()(),o(8,"div",79)(9,"div",51)(10,"span",80),a(11),n(),o(12,"span",27),a(13),n()(),o(14,"div",81),a(15),n(),o(16,"div",82),a(17),x(18,"currency"),n()()(),o(19,"div",83)(20,"div",55),a(21,"Price Difference"),n(),o(22,"div",84),m(23,bn,2,0,"mat-icon",85)(24,hn,2,0,"mat-icon",85)(25,Cn,2,0,"mat-icon",85),o(26,"span"),a(27),x(28,"currency"),n()()()()()),r&2){let e=c().$implicit,i=c(2);l(11),p(e.replacementRoom.roomNumber),l(2),p(e.replacementRoom.name),l(2),v(" ",e.replacementRoom.roomType==null?null:e.replacementRoom.roomType.name," "),l(2),v(" ",R(18,19,i.getRoomRate(e.replacementRoom),i.data.currency),"/night "),l(5),T("bg-green-100",e.priceDifference<0)("text-green-700",e.priceDifference<0)("bg-red-100",e.priceDifference>0)("text-red-700",e.priceDifference>0)("bg-gray-100",e.priceDifference===0)("text-gray-700",e.priceDifference===0),l(),u(e.priceDifference<0?23:e.priceDifference>0?24:25),l(4),U("",e.priceDifference>=0?"+":"","",R(28,22,e.priceDifference,i.data.currency))}}function En(r,t){r&1&&(o(0,"div",67)(1,"mat-icon",86),a(2,"room_preferences"),n(),o(3,"p",87),a(4,"Select a replacement room from the dropdown above"),n()())}function Sn(r,t){if(r&1){let e=M();Pt(0),o(1,"div",38)(2,"div",39)(3,"div",40)(4,"div",41)(5,"div",42),a(6),n()(),o(7,"button",43),C("click",function(){y(e);let s=ot(0),d=c(2);return E(d.removeSwapPair(s))}),o(8,"mat-icon",34),a(9,"close"),n()()(),o(10,"div",44)(11,"div",45)(12,"div",46)(13,"div",47)(14,"mat-icon",48),a(15,"meeting_room"),n(),o(16,"span",49),a(17,"Current Room"),n()(),o(18,"div",50)(19,"div",51)(20,"span",52),a(21),n(),o(22,"span",27),a(23),n()(),o(24,"div",41)(25,"div",53),a(26),n()(),o(27,"div",54)(28,"div",55),a(29,"Rate per Night"),n(),o(30,"div",56),a(31),x(32,"currency"),n()()()()(),o(33,"div",57)(34,"div",58)(35,"mat-icon",59),a(36,"arrow_forward"),n()()(),o(37,"div",60)(38,"div",61)(39,"div")(40,"label",62)(41,"mat-icon",63),a(42,"add_business"),n(),a(43," Select Replacement Room "),n(),o(44,"mat-form-field",13)(45,"mat-label"),a(46,"Choose a room"),n(),o(47,"mat-select",64),C("selectionChange",function(s){y(e);let d=ot(0),g=c(2);return E(g.assignReplacementRoom(d,s.value))}),F(48,fn,15,8,"mat-option",65,vn),n()()(),m(50,yn,29,25,"div",66)(51,En,5,0,"div",67),n()()()()()}if(r&2){let e=t.$implicit,i=t.$index,s=c(2),d=e.currentRoom.room||e.currentRoom,g=Mt(d._id);l(6),v(" Swap #",i+1," "),l(15),p(d.roomNumber),l(2),p(d.name),l(3),v(" ",(d.roomType==null?null:d.roomType.name)||"Standard"," "),l(5),v(" ",R(32,9,s.getRoomRate(e.currentRoom),s.data.currency)," "),l(16),h("value",e.replacementRoom)("compareWith",s.compareRooms),l(),N(s.getAvailableRoomsForSpecificSwap(g)),l(2),u(e.replacementRoom?50:51)}}function Rn(r,t){if(r&1&&(o(0,"div",12)(1,"div",32)(2,"div",33)(3,"mat-icon",34),a(4,"swap_horiz"),n()(),o(5,"div")(6,"h3",35),a(7,"Step 2: Assign Replacement Rooms"),n(),o(8,"p",36),a(9,"Choose new rooms for the selected reservations"),n()()(),o(10,"div",37),F(11,Sn,52,12,"div",38,ge),n()()),r&2){let e=c();l(11),N(e.swapPairs())}}function kn(r,t){r&1&&(o(0,"mat-error"),a(1,"Reason is required"),n())}function Dn(r,t){r&1&&(o(0,"mat-error"),a(1,"Reason must be at least 10 characters"),n())}function Pn(r,t){r&1&&(o(0,"div",95)(1,"mat-icon",97),a(2,"info"),n(),a(3," Additional payment required "),n())}function Mn(r,t){if(r&1&&(o(0,"div",96)(1,"mat-icon",98),a(2,"info"),n(),a(3),x(4,"currency"),n()),r&2){let e=c(2);l(3),v(" Refund of ",R(4,1,e.Math.abs(e.priceDifference()),e.data.currency)," will be processed ")}}function wn(r,t){if(r&1&&(o(0,"div",15)(1,"h4",88)(2,"mat-icon",89),a(3,"receipt"),n(),a(4," Pricing Summary "),n(),o(5,"div",50)(6,"div",90)(7,"span",89),a(8,"Current Total:"),n(),o(9,"span",91),a(10),x(11,"currency"),n()(),o(12,"div",90)(13,"span",89),a(14,"New Total:"),n(),o(15,"span",91),a(16),x(17,"currency"),n()(),k(18,"mat-divider",92),o(19,"div",93)(20,"span",94),a(21,"Difference:"),n(),o(22,"span"),a(23),x(24,"currency"),n()(),m(25,Pn,4,0,"div",95),m(26,Mn,5,4,"div",96),n()()),r&2){let e=c();l(10),p(R(11,12,e.currentTotal(),e.data.currency)),l(6),p(R(17,15,e.newTotal(),e.data.currency)),l(6),T("text-green-600",e.priceDifference()<0)("text-red-600",e.priceDifference()>0)("text-gray-600",e.priceDifference()===0),l(),U(" ",e.priceDifference()>=0?"+":"","",R(24,18,e.priceDifference(),e.data.currency)," "),l(2),u(e.priceDifference()>0?25:-1),l(),u(e.priceDifference()<0?26:-1)}}function In(r,t){r&1&&(o(0,"mat-icon",19),a(1,"refresh"),n())}var Ye=class r{dialogRef=b(ce);fb=b(ne);roomsService=b(xi);reservationService=b(ue);storeService=b(Xt);snackBar=b(ve);data=b(me);subscriptions=new ut;roomChangeForm=this.fb.group({reason:["",[w.required,w.minLength(10)]]});availableRooms=P([]);loadingRooms=P(!0);submitting=P(!1);formValid=P(!1);swapPairs=P([]);selectedCurrentRooms=P([]);currentTotal=I(()=>{let t=this.data.currentRooms.reduce((e,i)=>{let s=this.getRoomTotalCost(i);return console.log("Current room cost calculation:",{room:i,roomRate:this.getRoomRate(i),nights:this.data.numberOfNights,totalCost:s}),e+s},0);return console.log("Current total calculated:",t),t});newTotal=I(()=>{let t=this.currentTotal(),e=this.swapPairs().reduce((i,s)=>i+s.priceDifference,0);return t+e});priceDifference=I(()=>this.swapPairs().reduce((t,e)=>t+e.priceDifference,0));hasValidSelections=I(()=>this.swapPairs().some(t=>t.replacementRoom!==null));canSubmit=I(()=>{let t=this.formValid(),e=this.submitting(),i=this.swapPairs();return console.log("canSubmit check:",{formValid:t,isSubmitting:e,swapPairsCount:i.length,swapPairs:i,allHaveReplacements:i.every(d=>d.replacementRoom!==null)}),!t||e||i.length===0?!1:i.every(d=>d.replacementRoom!==null)});Math=Math;compareRooms(t,e){return t&&e&&t._id===e._id}findOriginalReservationRoom(t){return this.data.currentRooms.find(e=>e.room._id===t)}ngOnInit(){console.log("Current rooms data structure:",this.data.currentRooms),this.loadAvailableRooms(),this.subscriptions.add(this.roomChangeForm.valueChanges.subscribe(()=>{this.formValid.set(this.roomChangeForm.valid),console.log("Form value changed:",{valid:this.roomChangeForm.valid,value:this.roomChangeForm.value})})),this.subscriptions.add(this.roomChangeForm.statusChanges.subscribe(()=>{this.formValid.set(this.roomChangeForm.valid),console.log("Form status changed:",{valid:this.roomChangeForm.valid,status:this.roomChangeForm.status})})),this.formValid.set(this.roomChangeForm.valid)}ngOnDestroy(){this.subscriptions.unsubscribe()}loadAvailableRooms(){return S(this,null,function*(){try{this.loadingRooms.set(!0);let t=this.storeService.getStoreLocally;if(!t)throw new Error("No store selected");let e=yield this.roomsService.getAvailableRooms({storeId:t._id,checkInDate:this.data.checkInDate,checkOutDate:this.data.checkOutDate,excludeReservationId:this.data.reservationId}).toPromise(),i=this.data.currentRooms.map(g=>g.room),d=[...e||[],...i].filter((g,f,D)=>f===D.findIndex(O=>O._id===g._id));this.availableRooms.set(d)}catch(t){console.error("Error loading available rooms:",t),this.snackBar.open("Failed to load available rooms","Close",{duration:3e3})}finally{this.loadingRooms.set(!1)}})}getRoomTotalCost(t){return this.getRoomRate(t)*this.data.numberOfNights}getRoomRate(t){let e=0,i="";return t.priceOverride!==null&&t.priceOverride!==void 0&&typeof t.priceOverride=="number"?(e=t.priceOverride,i="room.priceOverride"):t.rate&&typeof t.rate=="number"?(e=t.rate,i="room.rate"):t.room&&typeof t.room=="object"?t.room.priceOverride!==null&&t.room.priceOverride!==void 0&&typeof t.room.priceOverride=="number"?(e=t.room.priceOverride,i="room.room.priceOverride"):t.room.roomType?.basePrice?(e=t.room.roomType.basePrice,i="room.room.roomType.basePrice"):t.room.roomType?.baseRate&&(e=t.room.roomType.baseRate,i="room.room.roomType.baseRate"):t.roomType?.basePrice?(e=t.roomType.basePrice,i="room.roomType.basePrice"):t.roomType?.baseRate&&(e=t.roomType.baseRate,i="room.roomType.baseRate"),console.log("Room rate lookup:",{roomNumber:t.roomNumber||t.room?.roomNumber,roomId:t._id||t.room?._id,rate:e,source:i,roomStructure:{hasRate:!!t.rate,priceOverride:t.priceOverride,priceOverrideType:typeof t.priceOverride,priceOverrideIsNull:t.priceOverride===null,hasNestedRoom:!!t.room,nestedPriceOverride:t.room?.priceOverride,nestedPriceOverrideType:typeof t.room?.priceOverride,roomTypeBasePrice:t.roomType?.basePrice||t.room?.roomType?.basePrice}}),e===0&&console.warn("No room rate found for room:",t),e}isRoomSelected(t){return this.swapPairs().some(e=>(e.currentRoom.room?._id||e.currentRoom._id)===t)}isCurrentRoomSelected(t){return this.selectedCurrentRooms().some(e=>e._id===t)}toggleCurrentRoomForSwap(t,e){console.log("Toggle room swap - Room:",t._id,"Selected:",e);let i=this.selectedCurrentRooms();if(e){if(!i.some(s=>s._id===t._id)&&(this.selectedCurrentRooms.set([...i,t]),!this.swapPairs().find(d=>(d.currentRoom.room?._id||d.currentRoom._id)===t._id))){let g={currentRoom:this.data.currentRooms.find(f=>f.room._id===t._id)||{room:t},replacementRoom:null,priceDifference:0};this.swapPairs.set([...this.swapPairs(),g]),console.log("Created new swap pair for room:",t._id)}}else{this.selectedCurrentRooms.set(i.filter(d=>d._id!==t._id));let s=this.swapPairs().filter(d=>(d.currentRoom.room?._id||d.currentRoom._id)!==t._id);this.swapPairs.set(s),console.log("Removed swap pair for room:",t._id)}this.roomChangeForm.updateValueAndValidity()}assignReplacementRoom(t,e){console.log("=== ASSIGNING REPLACEMENT ROOM ==="),console.log("Current Room ID:",t),console.log("Replacement Room Object:",e);let i=this.swapPairs().map(s=>{let d=s.currentRoom.room?._id||s.currentRoom._id;if(d===t){let g=this.getRoomRate(s.currentRoom),f=this.getRoomRate(e),D=g*this.data.numberOfNights,pe=f*this.data.numberOfNights-D;return console.log("\u2705 Swap calculation:",{currentRoomId:d,oldRate:g,newRate:f,difference:pe,nights:this.data.numberOfNights}),we(Me({},s),{replacementRoom:e,priceDifference:pe})}return s});this.swapPairs.set(i),this.roomChangeForm.updateValueAndValidity()}removeSwapPair(t){this.swapPairs.set(this.swapPairs().filter(e=>(e.currentRoom.room?._id||e.currentRoom._id)!==t)),this.selectedCurrentRooms.set(this.selectedCurrentRooms().filter(e=>e._id!==t))}getSwapPairForCurrentRoom(t){return this.swapPairs().find(e=>e.currentRoom._id===t)}isReplacementRoomUsed(t){return this.swapPairs().some(e=>e.replacementRoom?._id===t)}getAvailableRoomsForSwap(){let t=this.swapPairs().map(e=>e.replacementRoom?._id).filter(Boolean);return this.availableRooms().filter(e=>!t.includes(e._id))}getAvailableRoomsForSpecificSwap(t){let e=this.selectedCurrentRooms().find(s=>s._id===t),i=this.swapPairs().filter(s=>(s.currentRoom.room?._id||s.currentRoom._id)!==t).map(s=>s.replacementRoom?._id).filter(Boolean);return this.availableRooms().filter(s=>!i.includes(s._id)&&s._id!==t)}onSubmit(){return S(this,null,function*(){if(this.canSubmit())try{if(this.submitting.set(!0),this.swapPairs().filter(g=>{let f=g.currentRoom.room?._id||g.currentRoom._id,D=g.replacementRoom?._id;return f===D}).length>0){this.snackBar.open("Cannot swap a room with itself. Please select different rooms.","Close",{duration:5e3});return}console.log("=== SWAP PAIRS DEBUG ==="),console.log("Original swap pairs:",this.swapPairs());let e=this.swapPairs().map(g=>{let f=g.currentRoom.room||g.currentRoom,D=g.replacementRoom;return{currentRoomId:g.currentRoom._id||f._id,room:D._id,guests:g.currentRoom.guests||{adults:1,children:0},currentRoomDetails:{roomNumber:f.roomNumber,name:f.name,rate:this.getRoomRate(g.currentRoom)},newRoomDetails:{roomNumber:D.roomNumber,name:D.name,rate:this.getRoomRate(D),priceOverride:D.priceOverride},priceDifference:g.priceDifference}});console.log("New rooms array for swap mode:",e);let i=this.swapPairs().map(g=>{let f=g.currentRoom.room||g.currentRoom,D=g.replacementRoom,O=this.data.currency;return`Room ${f.roomNumber} (${f.name}) \u2192 Room ${D.roomNumber} (${D.name}). Price difference: ${O}${g.priceDifference.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}`}).join("; "),s=`Room swap completed. ${i}. Reason: ${this.roomChangeForm.get("reason")?.value}`;console.log("Generated internal note:",s),console.log("Swap summary details:",i);let d={mode:"swap",newRooms:e,swapPairs:this.swapPairs(),pricingAdjustment:{oldTotal:this.currentTotal(),newTotal:this.newTotal(),difference:this.priceDifference(),requiresPayment:this.priceDifference()>0,refundAmount:this.priceDifference()<0?Math.abs(this.priceDifference()):void 0},reason:this.roomChangeForm.get("reason")?.value,suggestedInternalNote:s,roomMapping:this.swapPairs().map(g=>{let f=g.currentRoom.room||g.currentRoom,D=g.replacementRoom;return{fromRoomId:g.currentRoom._id||f._id,fromRoomNumber:f.roomNumber,fromRoomName:f.name,toRoomId:D._id,toRoomNumber:D.roomNumber,toRoomName:D.name,priceDifference:g.priceDifference}})};console.log("Final swap mode payload:",d),this.dialogRef.close(d)}catch(t){console.error("Error submitting room change:",t),this.snackBar.open("Failed to process room change","Close",{duration:3e3})}finally{this.submitting.set(!1)}})}onCancel(){this.dialogRef.close()}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=B({type:r,selectors:[["app-room-change-dialog"]],decls:31,vars:10,consts:[[1,"room-change-dialog"],["mat-dialog-title","",1,"text-2xl","font-bold","text-gray-900","mb-2"],[1,"text-sm","text-gray-600","mb-6"],[1,"!max-h-[70vh]","!overflow-y-auto"],[1,"space-y-6",3,"formGroup"],[1,"space-y-6"],[1,"bg-blue-50","border","border-blue-200","rounded-lg","p-4"],[1,"text-lg","font-semibold","text-blue-900","mb-3","flex","items-center","gap-2"],[1,"text-blue-600"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-3"],[1,"cursor-pointer","transition-all","duration-200","hover:shadow-md",3,"!border-2","!border-blue-500","!bg-blue-50"],[1,"mt-3","text-sm","text-blue-600","flex","items-center","gap-2"],[1,"bg-gradient-to-br","from-green-50","to-emerald-50","border-2","border-green-300","rounded-xl","p-6","shadow-sm"],["appearance","outline",1,"w-full"],["matInput","","formControlName","reason","rows","3","placeholder","Enter the reason for changing rooms (minimum 10 characters)"],[1,"bg-gray-50","border","border-gray-200","rounded-lg","p-4"],["align","end",1,"!p-6","!border-t","!border-gray-200"],["type","button","mat-stroked-button","",3,"click","disabled"],["type","button","mat-raised-button","","color","primary",3,"click","disabled"],[1,"animate-spin","mr-2"],[1,"cursor-pointer","transition-all","duration-200","hover:shadow-md",3,"click"],[1,"!p-4"],[1,"flex","items-start","justify-between"],[1,"flex-1"],[1,"flex","items-center","gap-2","mb-2"],["color","primary",3,"change","click","checked"],[1,"font-semibold","text-gray-900"],[1,"text-sm","text-gray-600"],[1,"text-sm","text-gray-600","ml-8"],[1,"font-medium","text-gray-900","mt-1"],[1,"text-xs","text-gray-500"],[1,"text-sm"],[1,"flex","items-center","gap-3","mb-5"],[1,"bg-green-500","text-white","rounded-full","p-2"],[1,"!text-xl"],[1,"text-xl","font-bold","text-green-900"],[1,"text-sm","text-green-700"],[1,"space-y-4"],[1,"bg-white","rounded-lg","shadow-md","border","border-gray-200","overflow-hidden","transition-all","duration-200","hover:shadow-lg"],[1,"p-5"],[1,"flex","items-center","justify-between","mb-4","pb-3","border-b","border-gray-200"],[1,"flex","items-center","gap-2"],[1,"bg-blue-100","text-blue-700","rounded-full","px-3","py-1","text-xs","font-semibold"],["type","button","title","Remove this swap",1,"text-red-500","hover:text-red-700","hover:bg-red-50","rounded-full","p-2","transition-colors","duration-200",3,"click"],[1,"grid","grid-cols-1","lg:grid-cols-12","gap-4","items-center"],[1,"lg:col-span-4"],[1,"bg-gradient-to-br","from-gray-50","to-gray-100","rounded-lg","p-4","border-2","border-gray-300"],[1,"flex","items-center","gap-2","mb-3"],[1,"text-gray-500","!text-lg"],[1,"text-xs","font-semibold","text-gray-500","uppercase","tracking-wide"],[1,"space-y-2"],[1,"flex","items-baseline","gap-2"],[1,"text-2xl","font-bold","text-gray-900"],[1,"bg-white","px-2","py-1","rounded","text-xs","font-medium","text-gray-700","border","border-gray-300"],[1,"pt-2","border-t","border-gray-300"],[1,"text-xs","text-gray-500","mb-1"],[1,"text-lg","font-bold","text-gray-900"],[1,"lg:col-span-1","flex","justify-center","items-center"],[1,"bg-green-500","text-white","rounded-full","p-3","shadow-md"],[1,"!text-2xl"],[1,"lg:col-span-7"],[1,"space-y-3"],[1,"block","text-sm","font-semibold","text-gray-700","mb-2","flex","items-center","gap-2"],[1,"!text-lg","text-green-600"],[1,"!text-base",3,"selectionChange","value","compareWith"],[3,"value"],[1,"bg-gradient-to-br","from-green-50","to-emerald-50","rounded-lg","p-4","border-2","border-green-300"],[1,"bg-gray-50","border-2","border-dashed","border-gray-300","rounded-lg","p-4","text-center"],[1,"flex","flex-col","py-2"],[1,"flex","items-center","gap-2","mb-1"],[1,"font-bold","text-gray-900"],[1,"text-gray-500"],[1,"text-gray-700"],[1,"flex","items-center","gap-3"],[1,"text-xs","bg-blue-100","text-blue-700","px-2","py-0.5","rounded","font-medium"],[1,"text-sm","font-bold","text-green-600"],[1,"flex","items-start","justify-between","gap-4"],[1,"text-green-600","!text-lg"],[1,"text-xs","font-semibold","text-green-700","uppercase","tracking-wide"],[1,"space-y-1"],[1,"text-xl","font-bold","text-gray-900"],[1,"text-sm","text-gray-700"],[1,"text-base","font-bold","text-gray-900"],[1,"text-right"],[1,"inline-flex","items-center","gap-1","px-3","py-2","rounded-lg","font-bold","text-lg"],[1,"!text-lg"],[1,"text-gray-400","!text-3xl","mb-2"],[1,"text-sm","text-gray-500","font-medium"],[1,"font-semibold","text-gray-900","mb-3","flex","items-center","gap-2"],[1,"text-gray-600"],[1,"flex","justify-between","text-sm"],[1,"font-medium","text-gray-900"],[1,"!my-2"],[1,"flex","justify-between","text-base","font-semibold"],[1,"text-gray-900"],[1,"mt-3","p-3","bg-red-50","border","border-red-200","rounded","text-sm","text-red-700"],[1,"mt-3","p-3","bg-green-50","border","border-green-200","rounded","text-sm","text-green-700"],[1,"text-red-600","text-sm","mr-1","align-middle"],[1,"text-green-600","text-sm","mr-1","align-middle"]],template:function(e,i){if(e&1&&(o(0,"div",0)(1,"h2",1),a(2,"Swap Rooms"),n(),o(3,"p",2),a(4,"Select rooms to swap and assign their replacements"),n(),o(5,"mat-dialog-content",3)(6,"form",4)(7,"div",5)(8,"div",6)(9,"h3",7)(10,"mat-icon",8),a(11,"check_circle"),n(),a(12," Step 1: Select Rooms to Swap "),n(),o(13,"div",9),F(14,_n,20,18,"mat-card",10,gn),n(),m(16,xn,5,0,"div",11),n(),m(17,Rn,13,0,"div",12),o(18,"mat-form-field",13)(19,"mat-label"),a(20,"Reason for Room Change"),n(),k(21,"textarea",14),m(22,kn,2,0,"mat-error"),m(23,Dn,2,0,"mat-error"),n(),m(24,wn,27,21,"div",15),n()()(),o(25,"mat-dialog-actions",16)(26,"button",17),C("click",function(){return i.onCancel()}),a(27," Cancel "),n(),o(28,"button",18),C("click",function(){return i.onSubmit()}),m(29,In,2,0,"mat-icon",19),a(30),n()()()),e&2){let s,d;l(6),h("formGroup",i.roomChangeForm),l(8),N(i.data.currentRooms),l(2),u(i.selectedCurrentRooms().length===0?16:-1),l(),u(i.swapPairs().length>0?17:-1),l(5),u((s=i.roomChangeForm.get("reason"))!=null&&s.hasError("required")?22:-1),l(),u((d=i.roomChangeForm.get("reason"))!=null&&d.hasError("minlength")?23:-1),l(),u(i.swapPairs().length>0?24:-1),l(2),h("disabled",i.submitting()),l(2),h("disabled",!i.canSubmit()),l(),u(i.submitting()?29:-1),l(),v(" ",i.submitting()?"Processing...":"Change Rooms"," ")}},dependencies:[G,oe,ee,J,Y,X,ie,te,L,Ee,Re,Se,j,re,ae,Ae,ke,Ge,Fe,se,le,q,K,z,$,fe,Jt,Yt,_i,vi,de,ye,Ce,Lt,Z],encapsulation:2})};var On=(r,t,e)=>({"bg-yellow-100 text-yellow-700 border-yellow-200":r,"bg-green-100 text-green-700 border-green-200":t,"bg-red-100 text-red-700 border-red-200":e}),Tn=(r,t,e)=>({"bg-green-100 text-green-800":r,"bg-yellow-100 text-yellow-800":t,"bg-red-100 text-red-800":e}),Ri=(r,t)=>t.value,Fn=(r,t)=>t._id||r;function Nn(r,t){if(r&1&&(o(0,"h1",40),a(1," Reservation Details "),n(),o(2,"p",41),a(3),n()),r&2){let e=c();l(3),v("Confirmation: ",e.reservation().confirmationNumber)}}function An(r,t){r&1&&(o(0,"h1",40),a(1,"Reservation Details"),n(),o(2,"p",41),a(3,"Loading reservation information..."),n())}function Bn(r,t){r&1&&(o(0,"mat-icon",44),a(1,"refresh"),n())}function Vn(r,t){if(r&1&&(o(0,"mat-icon",53),a(1),n()),r&2){let e=c(2);De("color",e.getStatusColor(e.reservation().status)),l(),p(e.getStatusIcon(e.reservation().status))}}function Un(r,t){r&1&&(o(0,"div",24),a(1," No status changes available "),n())}function Gn(r,t){if(r&1){let e=M();o(0,"button",54),C("click",function(){let s=y(e).$implicit,d=c(2);return E(d.updateReservationStatus(s.value))}),o(1,"mat-icon",55),a(2),n(),o(3,"span"),a(4),n()()}if(r&2){let e=t.$implicit;l(),De("color",e.color),l(),p(e.icon),l(2),p(e.label)}}function qn(r,t){r&1&&(o(0,"div",48),a(1," \u{1F4A1} Confirm reservation before check-in "),n())}function jn(r,t){r&1&&(o(0,"div",49),a(1," \u{1F4A1} Ready for check-in "),n())}function $n(r,t){if(r&1){let e=M();o(0,"button",56),C("click",function(){y(e);let s=c(2);return E(s.editReservation())}),o(1,"mat-icon",57),a(2,"edit"),n(),a(3," Edit Reservation "),n()}}function zn(r,t){if(r&1){let e=M();o(0,"button",58),C("click",function(){y(e);let s=c(2);return E(s.requestExtension())}),o(1,"mat-icon",57),a(2,"schedule"),n(),a(3," Extend Stay "),n()}if(r&2){let e=c(2);h("disabled",e.statusUpdating())}}function Ln(r,t){if(r&1&&(o(0,"div",10)(1,"div",42)(2,"button",43),m(3,Bn,2,0,"mat-icon",44)(4,Vn,2,3,"mat-icon",45),a(5),x(6,"titlecase"),o(7,"mat-icon",46),a(8,"expand_more"),n()(),o(9,"mat-menu",13,4)(11,"div",22),a(12," Change Status "),n(),m(13,Un,2,0,"div",24),F(14,Gn,5,4,"button",47,Ri),m(16,qn,2,0,"div",48),m(17,jn,2,0,"div",49),n()(),m(18,$n,4,0,"button",50),m(19,zn,4,1,"button",51),o(20,"button",52)(21,"mat-icon"),a(22,"more_vert"),n()()()),r&2){let e=Q(10),i=c(),s=Q(15);l(2),De("background-color",i.getStatusColor(i.reservation().status)+"20")("color",i.getStatusColor(i.reservation().status))("border-color",i.getStatusColor(i.reservation().status)+"40"),h("matMenuTriggerFor",e)("disabled",i.statusUpdating()),l(),u(i.statusUpdating()?3:4),l(2),v(" ",V(6,16,i.reservation().status)," "),l(8),u(i.getAvailableStatusOptions().length===0?13:-1),l(),N(i.getAvailableStatusOptions()),l(2),u(i.reservation()&&i.reservation().status==="pending"?16:-1),l(),u(i.reservation()&&i.reservation().status==="confirmed"?17:-1),l(),u(i.canEdit()?18:-1),l(),u(i.canRequestExtension()?19:-1),l(),h("matMenuTriggerFor",s)}}function Hn(r,t){r&1&&(o(0,"div",11),k(1,"mat-spinner",59),o(2,"span",60),a(3,"Loading reservation details..."),n()())}function Wn(r,t){if(r&1){let e=M();o(0,"div",12)(1,"div",61)(2,"div",62)(3,"mat-icon",63),a(4,"error_outline"),n()(),o(5,"h3",64),a(6,"Failed to Load Reservation"),n(),o(7,"p",65),a(8),n(),o(9,"button",66),C("click",function(){y(e);let s=c();return E(s.goBack())}),a(10," Back to Reservations "),n()()()}if(r&2){let e=c();l(8),p(e.error())}}function Qn(r,t){if(r&1&&(o(0,"div"),a(1),n()),r&2){let e=t.$implicit,i=c(3);l(),Dt("",i.getGuestName(e.guest),": ",e.totalAdults," Adults, ",e.totalChildren," Children")}}function Zn(r,t){if(r&1&&F(0,Qn,2,3,"div",null,ge),r&2){let e=c(2);N(e.reservation().additionalGuests)}}function Kn(r,t){r&1&&(o(0,"div"),a(1,"No additional guests"),n())}function Jn(r,t){if(r&1&&(o(0,"div",41),a(1),n()),r&2){let e=c(2);l(),v("Expected: ",e.reservation().expectedCheckInTime)}}function Yn(r,t){if(r&1&&(o(0,"div",41),a(1),n()),r&2){let e=c(2);l(),v("Expected: ",e.reservation().expectedCheckOutTime)}}function Xn(r,t){if(r&1&&(o(0,"div",117)(1,"label",75),a(2,"Notes"),n(),o(3,"div",120),a(4),n()()),r&2){let e=c().$implicit;l(4),p(e.notes)}}function eo(r,t){r&1&&(o(0,"mat-icon",44),a(1,"refresh"),n())}function to(r,t){r&1&&(o(0,"mat-icon",53),a(1,"check_circle"),n())}function io(r,t){r&1&&(o(0,"mat-icon",44),a(1,"refresh"),n())}function no(r,t){r&1&&(o(0,"mat-icon",53),a(1,"cancel"),n())}function oo(r,t){if(r&1){let e=M();o(0,"div",118)(1,"button",121),C("click",function(){y(e);let s=c().$implicit,d=c(3);return E(d.approveExtension(s._id))}),m(2,eo,2,0,"mat-icon",44)(3,to,2,0,"mat-icon",53),a(4," Approve Extension "),n(),o(5,"button",122),C("click",function(){y(e);let s=c().$implicit,d=c(3);return E(d.rejectExtension(s._id))}),m(6,io,2,0,"mat-icon",44)(7,no,2,0,"mat-icon",53),a(8," Reject Extension "),n()()}if(r&2){let e=c().$implicit,i=c(3);l(),h("disabled",i.processingExtension()===e._id),l(),u(i.processingExtension()===e._id&&i.processingAction()==="approve"?2:3),l(3),h("disabled",i.processingExtension()===e._id),l(),u(i.processingExtension()===e._id&&i.processingAction()==="reject"?6:7)}}function ao(r,t){if(r&1&&(o(0,"div")(1,"span",93),a(2,"Reference:"),n(),o(3,"span",130),a(4),n()()),r&2){let e=c(3).$implicit;l(4),p(e.paymentInfo.transactionReference)}}function ro(r,t){if(r&1&&(o(0,"div",129)(1,"span",131),a(2,"Payment Notes:"),n(),o(3,"div",132),a(4),n()()),r&2){let e=c(3).$implicit;l(4),p(e.paymentInfo.notes)}}function lo(r,t){if(r&1&&(o(0,"div",124)(1,"div",125)(2,"mat-icon",53),a(3,"payment"),n(),o(4,"span",99),a(5,"Payment Information"),n()(),o(6,"div",126)(7,"div")(8,"span",93),a(9,"Status:"),n(),o(10,"span",127),a(11),x(12,"titlecase"),n()(),o(13,"div")(14,"span",93),a(15,"Method:"),n(),o(16,"span",128),a(17),x(18,"titlecase"),n()(),o(19,"div")(20,"span",93),a(21,"Amount:"),n(),o(22,"span",128),a(23),x(24,"currency"),n()(),m(25,ao,5,1,"div"),n(),m(26,ro,5,1,"div",129),n()),r&2){let e,i=c(2).$implicit,s=c(3);l(10),h("ngClass",at(13,Tn,i.paymentInfo.status==="paid",i.paymentInfo.status==="partial",i.paymentInfo.status==="pending")),l(),v(" ",V(12,6,i.paymentInfo.status)," "),l(6),p(V(18,8,i.paymentInfo.method)),l(6),p(R(24,10,i.paymentInfo.amount,(e=s.storeStore.selectedStore())==null?null:e.currency)),l(2),u(i.paymentInfo.transactionReference?25:-1),l(),u(i.paymentInfo.notes?26:-1)}}function so(r,t){if(r&1&&(o(0,"div",123)(1,"mat-icon",53),a(2,"check_circle"),n(),a(3),n(),m(4,lo,27,17,"div",124)),r&2){let e=c().$implicit,i=c(3);l(3),v(" Approved on ",i.formatExtensionDate(e.approvedAt)," "),l(),u(e.paymentInfo?4:-1)}}function co(r,t){if(r&1&&(o(0,"div",135),a(1),n()),r&2){let e=c(2).$implicit,i=c(3);l(),v("Rejected on ",i.formatExtensionDate(e.rejectedAt))}}function mo(r,t){if(r&1&&(o(0,"div",119)(1,"div",133)(2,"mat-icon",53),a(3,"cancel"),n(),a(4," Rejection Reason "),n(),o(5,"div",134),a(6),n(),m(7,co,2,1,"div",135),n()),r&2){let e=c().$implicit;l(6),p(e.rejectionReason),l(),u(e.rejectedAt?7:-1)}}function uo(r,t){if(r&1&&(o(0,"div",107)(1,"div",109)(2,"div",10)(3,"div",110)(4,"mat-icon",111),a(5,"hotel_class"),n()(),o(6,"div")(7,"h4",94),a(8,"Extension Request"),n(),o(9,"p",41),a(10),n()()(),o(11,"span",112),a(12),x(13,"titlecase"),n()(),o(14,"div",113)(15,"div")(16,"label",75),a(17,"Original Check-out"),n(),o(18,"div",114),a(19),n()(),o(20,"div")(21,"label",75),a(22,"Extended Check-out"),n(),o(23,"div",115),a(24),n()(),o(25,"div")(26,"label",75),a(27,"Additional Nights"),n(),o(28,"div",114),a(29),n()(),o(30,"div")(31,"label",75),a(32,"Extension Cost"),n(),o(33,"div",116),a(34),x(35,"currency"),n()()(),m(36,Xn,5,1,"div",117),m(37,oo,9,4,"div",118),m(38,so,5,2),m(39,mo,8,2,"div",119),n()),r&2){let e,i=t.$implicit,s=c(3);l(10),p(s.formatExtensionDate(i.requestedAt)),l(),h("ngClass",at(17,On,i.status==="pending",i.status==="approved",i.status==="rejected")),l(),v(" ",V(13,12,i.status)," "),l(7),p(s.formatExtensionDate(i.originalCheckOutDate)),l(5),p(s.formatExtensionDate(i.newCheckOutDate)),l(5),U("",i.additionalNights," night",i.additionalNights>1?"s":""),l(5),p(R(35,14,i.additionalCost,(e=s.storeStore.selectedStore())==null?null:e.currency)),l(2),u(i.notes?36:-1),l(),u(i.status==="pending"?37:-1),l(),u(i.status==="approved"&&i.approvedAt?38:-1),l(),u(i.status==="rejected"&&i.rejectionReason?39:-1)}}function po(r,t){if(r&1&&(o(0,"div",108)(1,"div",136)(2,"mat-icon",77),a(3,"check_circle"),n(),o(4,"span",137),a(5,"Active Extension"),n()(),o(6,"div",138)(7,"p"),a(8,"Total extension cost: "),o(9,"strong"),a(10),x(11,"currency"),n()(),o(12,"p"),a(13,"Total additional nights: "),o(14,"strong"),a(15),n()()()()),r&2){let e,i=c(3);l(10),p(R(11,2,i.getTotalExtensionCost(),(e=i.storeStore.selectedStore())==null?null:e.currency)),l(5),p(i.getTotalExtensionNights())}}function go(r,t){if(r&1&&(o(0,"div",69)(1,"div",103)(2,"h3",71)(3,"mat-icon",104),a(4,"schedule"),n(),a(5," Stay Extensions "),o(6,"span",105),a(7),n()()(),o(8,"div",73)(9,"div",106),F(10,uo,40,21,"div",107,Fn),n(),m(12,po,16,5,"div",108),n()()),r&2){let e=c(2);l(7),U(" ",e.getExtensions().length," Extension",e.getExtensions().length>1?"s":""," "),l(3),N(e.getExtensions()),l(2),u(e.hasActiveExtension()?12:-1)}}function vo(r,t){if(r&1){let e=M();o(0,"button",139),C("click",function(){y(e);let s=c(2);return E(s.openRoomChangeDialog())}),o(1,"mat-icon"),a(2,"swap_horiz"),n()()}}function _o(r,t){if(r&1&&(o(0,"tr",85)(1,"td",140),a(2),n(),o(3,"td",141),a(4),n(),o(5,"td",141),a(6),n(),o(7,"td",141),a(8),n(),o(9,"td",140),a(10),x(11,"currency"),n()()),r&2){let e,i=t.$implicit,s=c(2);l(2),p(i.roomNumber+" ("+i.name+")"),l(2),p(i.roomType),l(2),p(i.adults),l(2),p(i.children),l(2),p(R(11,5,i.rate,(e=s.storeStore.selectedStore())==null?null:e.currency))}}function xo(r,t){r&1&&(o(0,"span",89),a(1,"(Locked)"),n())}function fo(r,t){if(r&1&&(o(0,"div",92)(1,"span",93),a(2,"Service Fee"),n(),o(3,"span",94),a(4),x(5,"currency"),n()()),r&2){let e,i=c(2);l(4),p(R(5,1,(e=i.reservation().pricing.fees)==null?null:e.serviceFee,(e=i.storeStore.selectedStore())==null?null:e.currency))}}function bo(r,t){if(r&1&&(o(0,"div",92)(1,"span",93),a(2,"Cleaning Fee"),n(),o(3,"span",94),a(4),x(5,"currency"),n()()),r&2){let e,i=c(2);l(4),p(R(5,1,(e=i.reservation().pricing.fees)==null?null:e.cleaningFee,(e=i.storeStore.selectedStore())==null?null:e.currency))}}function ho(r,t){if(r&1&&(o(0,"div",92)(1,"span",93),a(2,"Resort Fee"),n(),o(3,"span",94),a(4),x(5,"currency"),n()()),r&2){let e,i=c(2);l(4),p(R(5,1,(e=i.reservation().pricing.fees)==null?null:e.resortFee,(e=i.storeStore.selectedStore())==null?null:e.currency))}}function Co(r,t){if(r&1&&(o(0,"div",92)(1,"span",93),a(2,"Discount"),n(),o(3,"span",98),a(4),x(5,"currency"),n()()),r&2){let e,i=c(2);l(4),v("-",R(5,1,i.reservation().pricing.discounts,(e=i.storeStore.selectedStore())==null?null:e.currency))}}function yo(r,t){if(r&1&&(o(0,"div",92)(1,"span",93),a(2),n(),o(3,"span",142),a(4),x(5,"currency"),n()()),r&2){let e,i=c(2);l(2),v("Extensions (",i.getTotalExtensionNights()," nights)"),l(2),v("+",R(5,2,i.getTotalExtensionCost(),(e=i.storeStore.selectedStore())==null?null:e.currency))}}function Eo(r,t){r&1&&(o(0,"span",89),a(1,"(Locked)"),n())}function So(r,t){if(r&1&&(o(0,"button",143)(1,"mat-icon"),a(2,"more_vert"),n()()),r&2){c(3);let e=Q(39);h("matMenuTriggerFor",e)}}function Ro(r,t){r&1&&(o(0,"div",144)(1,"mat-icon"),a(2,"lock"),n()())}function ko(r,t){r&1&&(o(0,"mat-icon",146),a(1,"refresh"),n())}function Do(r,t){if(r&1&&(o(0,"div")(1,"label",75),a(2,"Last Transaction"),n(),o(3,"div",114),a(4),x(5,"currency"),n()()),r&2){let e,i=c(3);l(4),U(" ",R(5,2,i.transactionHistory()[i.transactionHistory().length-1].amount,(e=i.storeStore.selectedStore())==null?null:e.currency)," on ",i.formatDateTime(i.transactionHistory()[i.transactionHistory().length-1].date)," ")}}function Po(r,t){if(r&1&&(o(0,"div",69)(1,"div",70)(2,"div",88)(3,"h3",71)(4,"mat-icon"),a(5),n(),a(6," Payment Information "),m(7,Eo,2,0,"span",89),n(),m(8,So,3,1,"button",143)(9,Ro,3,0,"div",144),n()(),o(10,"div",73)(11,"div",91)(12,"div")(13,"label",75),a(14,"Payment Method"),n(),o(15,"div",114),a(16),x(17,"titlecase"),n()(),o(18,"div")(19,"label",75),a(20,"Payment Status"),n(),o(21,"div",145),m(22,ko,2,0,"mat-icon",146),o(23,"span",147),a(24),x(25,"titlecase"),n()()(),m(26,Do,6,5,"div"),n()()()),r&2){let e,i,s,d=c(2);l(4),T("text-indigo-600",!d.isCheckedOut())("text-gray-400",d.isCheckedOut()),l(),v(" ",d.isCheckedOut()?"lock":"credit_card"," "),l(2),u(d.isCheckedOut()?7:-1),l(),u(d.canEditPaymentInfo()?8:d.isCheckedOut()?9:-1),l(8),p(V(17,13,(e=d.reservation().paymentInfo)==null?null:e.method)),l(6),u(d.statusUpdating()?22:-1),l(),H(((i=d.reservation().paymentInfo)==null?null:i.status)==="paid"?"bg-green-100 text-green-800":((i=d.reservation().paymentInfo)==null?null:i.status)==="refunded"?"bg-gray-100 text-gray-800":"bg-yellow-100 text-yellow-800"),l(),v(" ",V(25,15,(s=d.reservation().paymentInfo)==null?null:s.status)," "),l(2),u(d.transactionHistory().length>0?26:-1)}}function Mo(r,t){if(r&1&&(o(0,"tr",85)(1,"td",141),a(2),n(),o(3,"td",140),a(4),x(5,"currency"),n(),o(6,"td",141),a(7),x(8,"titlecase"),n(),o(9,"td",141),a(10),n(),o(11,"td",148)(12,"span",147),a(13),x(14,"titlecase"),n()()()),r&2){let e,i=t.$implicit,s=c(3);l(2),p(s.formatDateTime(i.date)),l(2),p(R(5,7,i.amount,(e=s.storeStore.selectedStore())==null?null:e.currency)),l(3),p(V(8,10,i.method)),l(3),p(i.reference),l(2),H(i.status==="completed"?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"),l(),v(" ",V(14,12,i.status)," ")}}function wo(r,t){if(r&1&&(o(0,"div",69)(1,"div",70)(2,"h3",71)(3,"mat-icon",77),a(4,"receipt"),n(),a(5," Transaction History "),n()(),o(6,"div",73)(7,"div",81)(8,"table",82)(9,"thead")(10,"tr",83)(11,"th",84),a(12,"Date"),n(),o(13,"th",84),a(14,"Amount"),n(),o(15,"th",84),a(16,"Method"),n(),o(17,"th",84),a(18,"Reference"),n(),o(19,"th",84),a(20,"Status"),n()()(),o(21,"tbody"),F(22,Mo,15,14,"tr",85,ge),n()()()()()),r&2){let e=c(2);l(22),N(e.transactionHistory())}}function Io(r,t){if(r&1&&(o(0,"div",69)(1,"div",70)(2,"h3",71)(3,"mat-icon",72),a(4,"message"),n(),a(5," Special Requests "),n()(),o(6,"div",73)(7,"p",149),a(8),n()()()),r&2){let e=c(3);l(8),p(e.reservation().specialRequests)}}function Oo(r,t){if(r&1&&(o(0,"div",69)(1,"div",70)(2,"h3",71)(3,"mat-icon",104),a(4,"note"),n(),a(5," Internal Notes "),n()(),o(6,"div",73)(7,"p",149),a(8),n()()()),r&2){let e=c(3);l(8),p(e.reservation().internalNotes)}}function To(r,t){if(r&1&&(o(0,"div",101),m(1,Io,9,1,"div",69),m(2,Oo,9,1,"div",69),n()),r&2){let e=c(2);l(),u(e.reservation().specialRequests?1:-1),l(),u(e.reservation().internalNotes?2:-1)}}function Fo(r,t){if(r&1&&(o(0,"div",41),a(1),n()),r&2){let e=c(2).$implicit;l(),v("Adults: ",e.totalAdults)}}function No(r,t){if(r&1&&(o(0,"div",41),a(1),n()),r&2){let e=c(2).$implicit;l(),v("Children: ",e.totalChildren)}}function Ao(r,t){if(r&1&&(o(0,"div",94),a(1),n(),m(2,Fo,2,1,"div",41),m(3,No,2,1,"div",41)),r&2){let e=c().$implicit,i=c(3);l(),p(i.getGuestName(e.guest)),l(),u(e.totalAdults?2:-1),l(),u(e.totalChildren?3:-1)}}function Bo(r,t){r&1&&(o(0,"div",41),a(1,"Unknown Guest"),n())}function Vo(r,t){if(r&1&&(o(0,"div",151),m(1,Ao,4,3)(2,Bo,2,0,"div",41),n()),r&2){let e=t.$implicit;l(),u(e.guest?1:2)}}function Uo(r,t){if(r&1&&(o(0,"div",69)(1,"div",70)(2,"h3",71)(3,"mat-icon",77),a(4,"group"),n(),a(5," Additional Guests "),n()(),o(6,"div",73)(7,"div",150),F(8,Vo,3,1,"div",151,ge),n()()()),r&2){let e=c(2);l(8),N(e.reservation().additionalGuests)}}function Go(r,t){if(r&1&&(o(0,"div")(1,"label",75),a(2,"Last Updated"),n(),o(3,"div",41),a(4),n()()),r&2){let e=c(2);l(4),p(e.formatDateTime(e.reservation().updatedAt))}}function qo(r,t){if(r&1&&(o(0,"div")(1,"label",75),a(2,"Actual Check-in"),n(),o(3,"div",41),a(4),n()()),r&2){let e=c(2);l(4),p(e.formatDateTime(e.reservation().actualCheckInDate))}}function jo(r,t){if(r&1&&(o(0,"div")(1,"label",75),a(2,"Actual Check-out"),n(),o(3,"div",41),a(4),n()()),r&2){let e=c(2);l(4),p(e.formatDateTime(e.reservation().actualCheckOutDate))}}function $o(r,t){if(r&1&&(o(0,"div")(1,"label",155),a(2,"Refund Amount"),n(),o(3,"div",156),a(4),x(5,"currency"),n()()),r&2){let e,i=c(3);l(4),p(R(5,1,i.getRefundAmount(),(e=i.storeStore.selectedStore())==null?null:e.currency))}}function zo(r,t){if(r&1&&(o(0,"div")(1,"label",155),a(2,"Cancellation Fee"),n(),o(3,"div",156),a(4),x(5,"currency"),n()()),r&2){let e,i=c(3);l(4),p(R(5,1,i.getCancellationFee(),(e=i.storeStore.selectedStore())==null?null:e.currency))}}function Lo(r,t){if(r&1&&(o(0,"div",102)(1,"div",152)(2,"h3",153)(3,"mat-icon",154),a(4,"cancel"),n(),a(5," Cancellation Information "),n()(),o(6,"div",73)(7,"div",74)(8,"div")(9,"label",155),a(10,"Cancelled"),n(),o(11,"div",156),a(12),n()(),o(13,"div")(14,"label",155),a(15,"Reason"),n(),o(16,"div",156),a(17),n()(),m(18,$o,6,4,"div"),m(19,zo,6,4,"div"),n()()()),r&2){let e=c(2);l(12),p(e.formatDateTime(e.reservation().cancellation.cancelledAt)),l(5),p(e.reservation().cancellation.reason),l(),u(e.hasRefundAmount()?18:-1),l(),u(e.hasCancellationFee()?19:-1)}}function Ho(r,t){if(r&1){let e=M();o(0,"div",12)(1,"div",67)(2,"div",68)(3,"div",69)(4,"div",70)(5,"h3",71)(6,"mat-icon",72),a(7,"person"),n(),a(8," Guest Information "),n()(),o(9,"div",73)(10,"div",74)(11,"div")(12,"label",75),a(13,"Guest Name"),n(),o(14,"div",76),a(15),n()(),o(16,"div")(17,"label",75),a(18,"Email"),n(),o(19,"div",41),a(20),n()(),o(21,"div")(22,"label",75),a(23,"Phone"),n(),o(24,"div",41),a(25),n()(),o(26,"div")(27,"label",75),a(28,"Occupancy"),n(),o(29,"div",41),m(30,Zn,2,0)(31,Kn,2,0,"div"),n()()()()(),o(32,"div",69)(33,"div",70)(34,"h3",71)(35,"mat-icon",77),a(36,"calendar_today"),n(),a(37," Stay Information "),n()(),o(38,"div",73)(39,"div",74)(40,"div")(41,"label",75),a(42,"Check-in Date"),n(),o(43,"div",76),a(44),n(),m(45,Jn,2,1,"div",41),n(),o(46,"div")(47,"label",75),a(48,"Check-out Date"),n(),o(49,"div",76),a(50),n(),m(51,Yn,2,1,"div",41),n(),o(52,"div")(53,"label",75),a(54,"Number of Nights"),n(),o(55,"div",76),a(56),n()(),o(57,"div")(58,"label",75),a(59,"Booking Source"),n(),o(60,"div",41),a(61),x(62,"titlecase"),n()()()()(),m(63,go,13,3,"div",69),o(64,"div",69)(65,"div",70)(66,"div",78)(67,"h3",71)(68,"mat-icon",79),a(69,"hotel"),n(),a(70," Room Details "),n(),m(71,vo,3,0,"button",80),n()(),o(72,"div",73)(73,"div",81)(74,"table",82)(75,"thead")(76,"tr",83)(77,"th",84),a(78,"Room Number"),n(),o(79,"th",84),a(80,"Room Type"),n(),o(81,"th",84),a(82,"Adults"),n(),o(83,"th",84),a(84,"Children"),n(),o(85,"th",84),a(86,"Rate per Night"),n()()(),o(87,"tbody"),F(88,_o,12,8,"tr",85,ge),n()()()()()(),o(90,"div",86)(91,"div",69)(92,"div",87)(93,"div",88)(94,"h3",71)(95,"mat-icon"),a(96),n(),a(97," Pricing Summary "),m(98,xo,2,0,"span",89),n(),o(99,"button",90),C("click",function(){y(e);let s=c();return E(s.openPricingUpdateDialog())}),o(100,"mat-icon"),a(101),n()()()(),o(102,"div",73)(103,"div",91)(104,"div",92)(105,"span",93),a(106,"Subtotal"),n(),o(107,"span",94),a(108),x(109,"currency"),n()(),o(110,"div",92)(111,"span",93),a(112,"Taxes"),n(),o(113,"span",94),a(114),x(115,"currency"),n()(),m(116,fo,6,4,"div",92),m(117,bo,6,4,"div",92),m(118,ho,6,4,"div",92),m(119,Co,6,4,"div",92),m(120,yo,6,5,"div",92),k(121,"hr",95),o(122,"div",96)(123,"span",97),a(124,"Total"),n(),o(125,"span",97),a(126),x(127,"currency"),n()(),o(128,"div",92)(129,"span",93),a(130,"Paid"),n(),o(131,"span",98),a(132),x(133,"currency"),n()(),o(134,"div",92)(135,"span",93),a(136,"Balance"),n(),o(137,"span",99),a(138),x(139,"currency"),n()()()()(),m(140,Po,27,17,"div",69),n()(),o(141,"div",100),m(142,wo,24,0,"div",69),m(143,To,3,2,"div",101),m(144,Uo,10,0,"div",69),o(145,"div",69)(146,"div",70)(147,"h3",71)(148,"mat-icon",79),a(149,"info"),n(),a(150," Booking Information "),n()(),o(151,"div",73)(152,"div",74)(153,"div")(154,"label",75),a(155,"Created"),n(),o(156,"div",41),a(157),n()(),m(158,Go,5,1,"div"),m(159,qo,5,1,"div"),m(160,jo,5,1,"div"),n()()(),m(161,Lo,20,4,"div",102),n()()}if(r&2){let e,i,s,d,g,f,D,O,pe,_=c();l(15),p(_.guestName()),l(5),p(_.guestEmail()),l(5),p(_.guestPhone()),l(5),u(_.hasAdditionalGuests()?30:31),l(14),p(_.formatDate(_.reservation().checkInDate)),l(),u(_.reservation().expectedCheckInTime?45:-1),l(5),p(_.formatDate(_.reservation().checkOutDate)),l(),u(_.reservation().expectedCheckOutTime?51:-1),l(5),p(_.reservation().numberOfNights),l(5),p(V(62,52,_.reservation().bookingSource)),l(2),u(_.hasExtensions()?63:-1),l(8),u(!_.isCheckedOut()&&((e=_.reservation())==null?null:e.status)!=="cancelled"?71:-1),l(17),N(_.roomDetails()),l(4),T("from-gray-50",_.isCheckedOut())("to-gray-100",_.isCheckedOut())("border-gray-200",_.isCheckedOut()),l(3),T("text-purple-600",!_.isCheckedOut())("text-gray-400",_.isCheckedOut()),l(),v(" ",_.isCheckedOut()?"lock":"account_balance_wallet"," "),l(2),u(_.isCheckedOut()?98:-1),l(),T("text-gray-400",!_.canEditPricing())("cursor-not-allowed",!_.canEditPricing()),h("matTooltip",_.canEditPricing()?"Update Pricing (Owner Authorization Required)":"Cannot edit pricing for checked-out reservations")("disabled",!_.canEditPricing()),l(2),p(_.canEditPricing()?"edit":"lock"),l(7),p(R(109,54,_.reservation().pricing.subtotal,(i=_.storeStore.selectedStore())==null?null:i.currency)),l(6),p(R(115,57,_.reservation().pricing.taxes,(s=_.storeStore.selectedStore())==null?null:s.currency)),l(2),u((d=_.reservation().pricing.fees)!=null&&d.serviceFee?116:-1),l(),u((g=_.reservation().pricing.fees)!=null&&g.cleaningFee?117:-1),l(),u((f=_.reservation().pricing.fees)!=null&&f.resortFee?118:-1),l(),u(_.reservation().pricing.discounts?119:-1),l(),u(_.getTotalExtensionCost()>0?120:-1),l(6),p(R(127,60,_.getFinalTotal(),(D=_.storeStore.selectedStore())==null?null:D.currency)),l(6),p(R(133,63,_.reservation().pricing.paid,(O=_.storeStore.selectedStore())==null?null:O.currency)),l(5),H(_.reservation().pricing.balance>0?"text-red-600":"text-green-600"),l(),v(" ",R(139,66,_.reservation().pricing.balance,(pe=_.storeStore.selectedStore())==null?null:pe.currency)," "),l(2),u(_.reservation().paymentInfo?140:-1),l(2),u(_.transactionHistory().length>0?142:-1),l(),u(_.reservation().specialRequests||_.reservation().internalNotes?143:-1),l(),u(_.hasAdditionalGuests()?144:-1),l(13),p(_.formatDateTime(_.reservation().createdAt)),l(),u(_.reservation().updatedAt!==_.reservation().createdAt?158:-1),l(),u(_.reservation().actualCheckInDate?159:-1),l(),u(_.reservation().actualCheckOutDate?160:-1),l(),u(_.hasCancellation()?161:-1)}}function Wo(r,t){if(r&1){let e=M();o(0,"button",25),C("click",function(){y(e);let s=c();return E(s.editReservation())}),o(1,"mat-icon",26),a(2,"edit"),n(),o(3,"span"),a(4,"Edit Reservation"),n()()}}function Qo(r,t){if(r&1){let e=M();o(0,"button",35),C("click",function(){y(e);let s=c();return E(s.requestExtension())}),o(1,"mat-icon",36),a(2,"schedule"),n(),o(3,"span"),a(4,"Request Stay Extension"),n()()}if(r&2){let e=c();h("disabled",e.statusUpdating())}}function Zo(r,t){r&1&&(o(0,"mat-icon",20),a(1,"download"),n())}function Ko(r,t){r&1&&(o(0,"mat-icon",21),a(1,"picture_as_pdf"),n())}function Jo(r,t){if(r&1){let e=M();k(0,"mat-divider",157),o(1,"button",158),C("click",function(){y(e);let s=c();return E(s.deleteReservation())}),o(2,"mat-icon",21),a(3,"delete"),n(),o(4,"span"),a(5,"Delete Reservation"),n()()}}function Yo(r,t){r&1&&(o(0,"div",23)(1,"mat-icon",159),a(2,"lock"),n(),o(3,"span"),a(4,"Payment information is locked for checked-out reservations"),n()())}function Xo(r,t){r&1&&(o(0,"div",24),a(1," No status changes available "),n())}function ea(r,t){if(r&1){let e=M();o(0,"button",162),C("click",function(){let s=y(e).$implicit,d=c(2);return E(d.updatePaymentStatus(s.value))}),o(1,"mat-icon",163),a(2),n(),o(3,"span"),a(4),n()()}if(r&2){let e=t.$implicit;l(),De("color",e.color),l(),p(e.icon),l(2),p(e.label)}}function ta(r,t){if(r&1){let e=M();F(0,ea,5,4,"button",160,Ri),o(2,"button",25),C("click",function(){y(e);let s=c();return E(s.showPaymentDialog(s.reservation()))}),o(3,"mat-icon",161),a(4,"edit"),n(),o(5,"span"),a(6,"Edit Payment Information"),n()(),o(7,"div",49),a(8,' \u{1F4A1} Use "Edit Payment Information" to update method and status details '),n()}if(r&2){let e=c();N(e.getAvailablePaymentStatusOptions())}}function ia(r,t){if(r&1){let e=M();o(0,"button",164),C("click",function(){y(e);let s=c();return E(s.sendReservationEmail("confirmation"))}),o(1,"mat-icon",36),a(2,"check_circle"),n(),o(3,"span"),a(4,"Send Confirmation Email"),n()()}}function na(r,t){if(r&1){let e=M();o(0,"button",165),C("click",function(){y(e);let s=c();return E(s.sendReservationEmail("checkin"))}),o(1,"mat-icon",166),a(2,"login"),n(),o(3,"span"),a(4,"Send Check-in Notification"),n()()}}function oa(r,t){r&1&&(o(0,"div",31)(1,"mat-icon",53),a(2,"bluetooth_connected"),n(),o(3,"span"),a(4,"Printer Connected"),n()())}function aa(r,t){r&1&&(o(0,"div",32)(1,"mat-icon",53),a(2,"bluetooth_disabled"),n(),o(3,"span"),a(4,"Printer Not Connected"),n()())}function ra(r,t){r&1&&(o(0,"mat-icon",34),a(1,"print"),n())}function la(r,t){r&1&&(o(0,"mat-icon",26),a(1,"print"),n())}function sa(r,t){if(r&1){let e=M();o(0,"button",167),C("click",function(){y(e);let s=c();return E(s.disconnectFromPrinter())}),o(1,"mat-icon",21),a(2,"bluetooth_disabled"),n(),o(3,"span"),a(4,"Disconnect Printer"),n()()}if(r&2){let e=c();h("disabled",e.printing()||e.statusUpdating())}}function da(r,t){if(r&1){let e=M();o(0,"button",168),C("click",function(){y(e);let s=c();return E(s.connectToPrinter())}),o(1,"mat-icon",26),a(2,"bluetooth"),n(),o(3,"span"),a(4,"Connect to Printer"),n()()}if(r&2){let e=c();h("disabled",e.printing()||e.statusUpdating())}}var Si=class r{router=b(At);route=b(Nt);location=b(Ot);reservationService=b(ue);bluetoothPrinterService=b(bi);storeStore=b(he);snackBar=b(ve);dialog=b(li);reservation=P(null);loading=P(!1);error=P(null);statusUpdating=P(!1);printerConnected=P(!1);printing=P(!1);exportingPDF=P(!1);statusOptions=[{value:"pending",label:"Pending",icon:"schedule",color:"#f59e0b"},{value:"confirmed",label:"Confirmed",icon:"check_circle",color:"#10b981"},{value:"checked_in",label:"Checked In",icon:"login",color:"#3b82f6"},{value:"checked_out",label:"Checked Out",icon:"logout",color:"#6b7280"},{value:"cancelled",label:"Cancelled",icon:"cancel",color:"#ef4444"},{value:"no_show",label:"No Show",icon:"person_off",color:"#f97316"}];roomDetails=I(()=>{let t=this.reservation();return!t||!t.rooms?[]:t.rooms.map(e=>{let i=typeof e.room=="string"?{roomNumber:e.room,roomType:"Unknown"}:e.room;return{name:i.name||"N/A",roomNumber:i.roomNumber||"Unknown",roomType:typeof i.roomType=="object"&&i.roomType?.name||"Unknown",adults:e.guests?.adults||0,children:e.guests?.children||0,rate:i.priceOverride||0}})});transactionHistory=I(()=>{let t=this.reservation();return!t||!t.paymentInfo?.transactions?[]:t.paymentInfo.transactions});guestName=I(()=>{let t=this.reservation();if(!t||!t.guest)return"Unknown Guest";let e=t.guest;return`${e.firstName||""} ${e.lastName||""}`.trim()||"Unknown Guest"});guestEmail=I(()=>this.reservation()?.guest?.email||"No email provided");guestPhone=I(()=>this.reservation()?.guest?.phone||"No phone provided");hasAdditionalGuests=I(()=>{let t=this.reservation();return t?.additionalGuests&&t.additionalGuests.length>0});getGuestName(t){return t&&`${t.firstName||""} ${t.lastName||""}`.trim()||"Unknown Guest"}hasCancellation=I(()=>this.reservation()?.cancellation?.isCancelled);hasRefundAmount=I(()=>{let t=this.reservation();return t?.cancellation?.refundAmount&&t.cancellation.refundAmount>0});hasCancellationFee=I(()=>{let t=this.reservation();return t?.cancellation?.cancellationFee&&t.cancellation.cancellationFee>0});getRefundAmount=I(()=>this.reservation()?.cancellation?.refundAmount||0);getCancellationFee=I(()=>this.reservation()?.cancellation?.cancellationFee||0);paymentStatusOptions=[{value:"pending",label:"Pending",icon:"schedule",color:"#f59e0b"},{value:"paid",label:"Paid",icon:"check_circle",color:"#10b981"},{value:"partial",label:"Partial",icon:"donut_small",color:"#3b82f6"},{value:"refunded",label:"Refunded",icon:"undo",color:"#6b7280"}];getAvailablePaymentStatusOptions=I(()=>{let t=this.reservation();if(!t)return[];let e=t.paymentInfo?.status||"pending";return this.paymentStatusOptions.filter(i=>i.value!==e)});ngOnInit(){let t=this.route.snapshot.paramMap.get("id");t?this.loadReservation(t):this.error.set("No reservation ID provided"),this.printerConnected.set(this.bluetoothPrinterService.isConnected())}loadReservation(t){return S(this,null,function*(){this.loading.set(!0),this.error.set(null);try{if(!this.storeStore.selectedStore()?._id)throw new Error("No store selected");this.reservationService.getReservationById(t).subscribe({next:i=>{this.reservation.set(i),this.loading.set(!1)},error:i=>{console.error("Error loading reservation:",i),this.error.set("Failed to load reservation details"),this.loading.set(!1)}})}catch(e){console.error("Error loading reservation:",e),this.error.set("Failed to load reservation details"),this.loading.set(!1)}})}goBack(){this.location.back()}editReservation(){this.reservation()&&this.router.navigate(["/menu/hms/front-desk/reservations/edit",this.reservation()._id])}canEdit(){let t=this.reservation();return t?.status!=="cancelled"&&t?.status!=="checked_out"&&t?.status!=="no_show"&&t?.status!=="checked_in"&&!t?.actualCheckInDate}canDelete(){let t=this.reservation();return t?["pending","cancelled","no_show"].includes(t.status):!1}deleteReservation(){let t=this.reservation();if(!t)return;let e=this.storeStore.selectedStore();if(!e?._id){this.snackBar.open("No store selected","Close",{duration:3e3});return}let i={storeId:e._id,actionDescription:`delete reservation ${t.confirmationNumber}`,reservationId:t._id};this.dialog.open(qe,{data:i,width:"500px",maxWidth:"90vw",disableClose:!0}).afterClosed().subscribe(d=>{d?.authorized&&d.pin&&this.performReservationDeletion(t,d.pin)})}performReservationDeletion(t,e){this.statusUpdating.set(!0),this.reservationService.deleteReservationWithPin(t._id,e).subscribe({next:i=>{this.snackBar.open(`Reservation ${t.confirmationNumber} deleted successfully`,"Close",{duration:5e3}),this.router.navigate(["/dashboard/hms/front-desk/reservations"])},error:i=>{console.error("Error deleting reservation:",i),this.snackBar.open(i.message||"Failed to delete reservation","Close",{duration:5e3,panelClass:["error-snackbar"]})},complete:()=>{this.statusUpdating.set(!1)}})}canCheckIn(){return this.reservation()?.status==="confirmed"}canCheckOut(){return this.reservation()?.status==="checked_in"}canCancel(){let t=this.reservation();return t?.status!=="cancelled"&&t?.status!=="checked_out"&&t?.status!=="no_show"}canRequestExtension(){return this.reservation()?.status==="checked_in"}isCheckedOut(){return this.reservation()?.status==="checked_out"}canEditPricing(){return!this.isCheckedOut()&&!this.loading()}canEditPaymentInfo(){return!this.isCheckedOut()&&!this.statusUpdating()}checkInReservation(){return S(this,null,function*(){if(this.reservation()){if(!this.canCheckIn()){this.snackBar.open('Guests can only be checked in when reservation status is "Confirmed"',"Close",{duration:5e3,panelClass:["error-snackbar"]});return}try{yield this.updateReservationStatus("checked_in")}catch(e){console.error("Error checking in reservation:",e),this.snackBar.open("Failed to check in reservation","Close",{duration:3e3})}}})}checkOutReservation(){return S(this,null,function*(){if(this.reservation()){if(!this.canCheckOut()){this.snackBar.open('Guests can only be checked out when reservation status is "Checked In"',"Close",{duration:5e3,panelClass:["error-snackbar"]});return}try{yield this.updateReservationStatus("checked_out")}catch(e){console.error("Error checking out reservation:",e),this.snackBar.open("Failed to check out reservation","Close",{duration:3e3})}}})}cancelReservation(){return S(this,null,function*(){if(!(!this.reservation()||!this.canCancel()))try{this.snackBar.open("Cancellation functionality coming soon","Close",{duration:3e3})}catch(e){console.error("Error cancelling reservation:",e),this.snackBar.open("Failed to cancel reservation","Close",{duration:3e3})}})}requestExtension(){return S(this,null,function*(){let t=this.reservation();if(!t||!this.canRequestExtension()){this.snackBar.open("Extensions can only be requested for checked-in guests","Close",{duration:5e3,panelClass:["error-snackbar"]});return}let e={reservation:t,currentCheckOutDate:new Date(t.checkOutDate)};this.dialog.open(Ke,{width:"600px",maxWidth:"90vw",data:e,disableClose:!0}).afterClosed().subscribe(s=>S(this,null,function*(){if(s?.success&&s.extension)try{yield this.loadReservation(t._id),this.snackBar.open("Extension request submitted successfully. Awaiting approval.","Close",{duration:5e3})}catch(d){console.error("Error reloading reservation after extension request:",d),this.snackBar.open("Extension request submitted, but failed to refresh data. Please refresh the page.","Close",{duration:5e3})}}))})}updateReservationStatus(t){return S(this,null,function*(){let e=this.reservation();if(!(!e||e.status===t)){if(t==="reopen"){this.reopenReservation();return}if(t==="checked_in"){this.showCheckInDialog(e);return}if(t==="checked_out"){this.performCheckOut();return}if(!this.isValidStatusTransition(e.status,t)){this.snackBar.open(this.getStatusTransitionError(e.status,t),"Close",{duration:5e3,panelClass:["error-snackbar"]});return}(t==="cancelled"||t==="no_show")&&!confirm(`Are you sure you want to change the status to ${t}?`)||(yield this.performStatusUpdate(t))}})}updatePaymentStatus(t){let e=this.reservation();if(e){if(this.isCheckedOut()){this.snackBar.open("Cannot update payment status for checked-out reservations","Close",{duration:3e3,panelClass:["error-snackbar"]});return}t==="paid"?this.showPaymentDialog(e):this.performPaymentStatusUpdate(t)}}showPaymentDialog(t){if(this.isCheckedOut()){this.snackBar.open("Cannot edit payment information for checked-out reservations","Close",{duration:3e3,panelClass:["error-snackbar"]});return}let e={reservation:t,isCheckoutFlow:!1};this.dialog.open(je,{data:e,width:"600px",maxWidth:"90vw",disableClose:!0}).afterClosed().subscribe(s=>{s?.confirmed&&this.loadReservation(t._id)})}processPayment(t){return S(this,null,function*(){let e=this.reservation();if(e){this.statusUpdating.set(!0);try{yield this.reservationService.updatePaymentInfo(e._id,t).toPromise();let i=yield this.reservationService.getReservationById(e._id).toPromise();i&&this.reservation.set(i),this.snackBar.open("Payment information updated successfully","Close",{duration:5e3})}catch(i){console.error("Error updating payment info:",i);let s="Failed to update payment information";i?.error?.error?s=i.error.error:i instanceof Error&&(s=i.message),this.snackBar.open(s,"Close",{duration:5e3,panelClass:["error-snackbar"]})}finally{this.statusUpdating.set(!1)}}})}performPaymentStatusUpdate(t){return S(this,null,function*(){let e=this.reservation();if(e){this.statusUpdating.set(!0);try{let i=yield this.reservationService.updateReservation(e._id,{paymentInfo:we(Me({},e.paymentInfo),{status:t})}).toPromise();i&&(this.reservation.set(i),this.snackBar.open(`Payment status updated to ${t}`,"Close",{duration:3e3}))}catch(i){console.error("Error updating payment status:",i);let s=i instanceof Error?i.message:"Failed to update payment status";this.snackBar.open(s,"Close",{duration:5e3,panelClass:["error-snackbar"]})}finally{this.statusUpdating.set(!1)}}})}showCheckInDialog(t){let e={reservation:t};this.dialog.open(fi,{data:e,width:"600px",maxWidth:"90vw",disableClose:!0}).afterClosed().subscribe(s=>{s?.confirmed&&this.performCheckIn(s)})}performCheckIn(t){return S(this,null,function*(){let e=this.reservation();if(e){this.statusUpdating.set(!0);try{let i=yield this.reservationService.checkInReservationWithRooms(e._id).toPromise();i&&(this.reservation.set(i),this.snackBar.open("Guest checked in successfully! Room status updated to occupied.","Close",{duration:5e3}))}catch(i){console.error("Error during check-in:",i);let s=i instanceof Error?i.message:"Failed to check in guest";this.snackBar.open(s,"Close",{duration:5e3,panelClass:["error-snackbar"]})}finally{this.statusUpdating.set(!1)}}})}performCheckOut(){return S(this,null,function*(){let t=this.reservation();if(t){if(this.requiresPaymentBeforeCheckout(t)){this.showPaymentRequiredDialog(t);return}this.statusUpdating.set(!0);try{let e=yield this.reservationService.checkOutReservationWithRooms(t._id).toPromise();e&&(this.reservation.set(e),this.snackBar.open("Guest checked out successfully! Room status updated to cleaning.","Close",{duration:5e3}))}catch(e){console.error("Error during check-out:",e);let i=e instanceof Error?e.message:"Failed to check out guest";this.snackBar.open(i,"Close",{duration:5e3,panelClass:["error-snackbar"]})}finally{this.statusUpdating.set(!1)}}})}requiresPaymentBeforeCheckout(t){let e=t.pricing.balance>0,i=t.paymentInfo?.status!=="paid";return e&&i}showPaymentRequiredDialog(t){let e={reservation:t,isCheckoutFlow:!0};this.dialog.open(je,{data:e,width:"600px",maxWidth:"90vw",disableClose:!0}).afterClosed().subscribe(s=>{s?.confirmed&&s.paymentData&&(s.paymentData.amount!==void 0?this.processPaymentAndCheckout(s.paymentData):console.error("Expected amount-based payment data for checkout flow"))})}processPaymentAndCheckout(t){return S(this,null,function*(){let e=this.reservation();if(e){this.statusUpdating.set(!0);try{yield this.reservationService.processPayment(e._id,{amount:t.amount,method:t.method,reference:t.reference||`PAY-${Date.now()}`}).toPromise();let i=yield this.reservationService.getReservationById(e._id).toPromise();i&&(this.reservation.set(i),this.snackBar.open(`Payment of ${this.formatCurrency(t.amount)} recorded successfully`,"Close",{duration:3e3}),i.pricing.balance<=0||i.paymentInfo?.status==="paid"?setTimeout(()=>{this.proceedWithCheckout()},1500):this.snackBar.open("Payment recorded, but outstanding balance remains. Please complete payment before checkout.","Close",{duration:5e3,panelClass:["warning-snackbar"]}))}catch(i){console.error("Error processing payment for checkout:",i);let s=i instanceof Error?i.message:"Failed to process payment";this.snackBar.open(s,"Close",{duration:5e3,panelClass:["error-snackbar"]})}finally{this.statusUpdating.set(!1)}}})}proceedWithCheckout(){return S(this,null,function*(){let t=this.reservation();if(t){this.statusUpdating.set(!0);try{let e=yield this.reservationService.checkOutReservationWithRooms(t._id).toPromise();e&&(this.reservation.set(e),this.snackBar.open("Guest checked out successfully! Room status updated to cleaning.","Close",{duration:5e3}))}catch(e){console.error("Error during checkout after payment:",e);let i=e instanceof Error?e.message:"Failed to complete checkout";this.snackBar.open(i,"Close",{duration:5e3,panelClass:["error-snackbar"]})}finally{this.statusUpdating.set(!1)}}})}performStatusUpdate(t){return S(this,null,function*(){let e=this.reservation();if(e){this.statusUpdating.set(!0);try{let i=yield this.reservationService.updateReservationStatus(e._id,t).toPromise();i&&(this.reservation.set(i),this.snackBar.open(`Status updated to ${t}`,"Close",{duration:3e3}))}catch(i){console.error("Error updating reservation status:",i);let s=i instanceof Error?i.message:"Failed to update status";this.snackBar.open(s,"Close",{duration:5e3,panelClass:["error-snackbar"]})}finally{this.statusUpdating.set(!1)}}})}reopenReservation(){return S(this,null,function*(){let t=this.reservation();if(!t)return;if(t.status!=="cancelled"&&t.status!=="checked_out"){this.snackBar.open("Only cancelled reservations can be reopened","Close",{duration:5e3,panelClass:["error-snackbar"]});return}let e=this.storeStore.selectedStore()?._id;if(!e){this.snackBar.open("Store information not available","Close",{duration:5e3,panelClass:["error-snackbar"]});return}this.dialog.open(qe,{width:"400px",disableClose:!0,data:{storeId:e,actionDescription:"reopen this cancelled reservation",reservationId:t._id}}).afterClosed().subscribe(s=>S(this,null,function*(){if(s&&s.authorized&&s.pin){this.statusUpdating.set(!0);try{let d=yield this.reservationService.reopenReservation(t._id,s.pin).toPromise();d&&(this.reservation.set(d),this.snackBar.open("Reservation reopened successfully","Close",{duration:3e3,panelClass:["success-snackbar"]}))}catch(d){console.error("Error reopening reservation:",d);let g="Failed to reopen reservation";(d instanceof Error&&d.message||d&&typeof d=="object"&&d.message)&&(g=d.message),this.snackBar.open(g,"Close",{duration:5e3,panelClass:["error-snackbar"]})}finally{this.statusUpdating.set(!1)}}}))})}getAvailableStatusOptions(){let t=this.reservation()?.status,e=this.statusOptions.filter(i=>i.value!==t&&this.isValidStatusTransition(t||"",i.value));return t==="cancelled"&&e.push({value:"reopen",label:"Reopen Reservation",color:"#10b981",icon:"refresh"}),e}isValidStatusTransition(t,e){return{pending:["confirmed","cancelled","no_show"],confirmed:["checked_in","cancelled","no_show"],checked_in:["checked_out"],checked_out:[],cancelled:[],no_show:[]}[t]?.includes(e)||!1}getStatusTransitionError(t,e){switch(e){case"checked_in":return'Guests can only be checked in when reservation status is "Confirmed"';case"checked_out":return'Guests can only be checked out when reservation status is "Checked In"';case"confirmed":return t==="checked_in"?"Cannot change back to confirmed after check-in":t==="checked_out"?"Cannot change back to confirmed after check-out":"Invalid status transition";default:return`Cannot change status from "${t}" to "${e}"`}}getStatusColor(t){return{pending:"#f59e0b",confirmed:"#10b981",checked_in:"#3b82f6",checked_out:"#6b7280",cancelled:"#ef4444",no_show:"#f97316"}[t]||"#6b7280"}getStatusIcon(t){return{pending:"schedule",confirmed:"check_circle",checked_in:"login",checked_out:"logout",cancelled:"cancel",no_show:"person_off"}[t]||"help"}formatDate(t){return t?new Date(t).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"}):"N/A"}formatDateTime(t){return t?new Date(t).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"N/A"}sendReservationEmail(t="details"){return S(this,null,function*(){let e=this.reservation();if(!e)return;let i=this.guestEmail();if(!i||i==="No email provided"){this.snackBar.open("No email address available for this guest","Close",{duration:5e3,panelClass:["error-snackbar"]});return}this.statusUpdating.set(!0);try{let s=yield this.reservationService.sendReservationEmail(e._id,{emailType:t}).toPromise();if(s?.success)this.snackBar.open(s.message||`${t.charAt(0).toUpperCase()+t.slice(1)} email sent successfully to ${i}`,"Close",{duration:5e3});else throw new Error("Email sending failed")}catch(s){console.error("Error sending reservation email:",s);let d=s instanceof Error?s.message:"Failed to send reservation email";this.snackBar.open(d,"Close",{duration:5e3,panelClass:["error-snackbar"]})}finally{this.statusUpdating.set(!1)}})}connectToPrinter(){return S(this,null,function*(){if(!this.bluetoothPrinterService.isBluetoothSupported()){this.snackBar.open("Web Bluetooth is not supported in this browser","Close",{duration:5e3,panelClass:["error-snackbar"]});return}try{this.statusUpdating.set(!0),yield this.bluetoothPrinterService.connectToPrinter(),this.printerConnected.set(!0);let t=this.bluetoothPrinterService.getConnectedDeviceInfo();this.snackBar.open(`Connected to printer: ${t?.name||"Unknown Printer"}`,"Close",{duration:3e3})}catch(t){console.error("Error connecting to printer:",t),this.printerConnected.set(!1);let e=t instanceof Error?t.message:"Failed to connect to printer";this.snackBar.open(e,"Close",{duration:5e3,panelClass:["error-snackbar"]})}finally{this.statusUpdating.set(!1)}})}disconnectFromPrinter(){return S(this,null,function*(){try{yield this.bluetoothPrinterService.disconnectPrinter(),this.printerConnected.set(!1),this.snackBar.open("Disconnected from printer","Close",{duration:3e3})}catch(t){console.error("Error disconnecting from printer:",t),this.snackBar.open("Failed to disconnect from printer","Close",{duration:3e3,panelClass:["error-snackbar"]})}})}printReservation(){return S(this,null,function*(){let t=this.reservation();if(t){if(!this.bluetoothPrinterService.isConnected())if(confirm("Printer not connected. Would you like to connect to a printer first?"))try{if(yield this.connectToPrinter(),!this.bluetoothPrinterService.isConnected())return}catch{return}else return;this.printing.set(!0);try{let e=this.storeStore.selectedStore();yield this.bluetoothPrinterService.printReservation(t,e),this.snackBar.open("Reservation printed successfully","Close",{duration:3e3})}catch(e){console.error("Error printing reservation:",e);let i=e instanceof Error?e.message:"Failed to print reservation";this.snackBar.open(i,"Close",{duration:5e3,panelClass:["error-snackbar"]}),i.includes("not connected")&&this.printerConnected.set(!1)}finally{this.printing.set(!1)}}})}testPrint(){return S(this,null,function*(){if(!this.bluetoothPrinterService.isConnected()){this.snackBar.open("Please connect to a printer first","Close",{duration:3e3,panelClass:["error-snackbar"]});return}this.printing.set(!0);try{yield this.bluetoothPrinterService.testPrint(),this.snackBar.open("Test print completed successfully","Close",{duration:3e3})}catch(t){console.error("Error during test print:",t);let e=t instanceof Error?t.message:"Test print failed";this.snackBar.open(e,"Close",{duration:5e3,panelClass:["error-snackbar"]})}finally{this.printing.set(!1)}})}exportReservationToPDF(){return S(this,null,function*(){let t=this.reservation();if(t){this.exportingPDF.set(!0);try{let e=yield this.reservationService.exportReservationToPDF(t._id).toPromise();if(e){let i=window.URL.createObjectURL(e),s=document.createElement("a");s.href=i,s.download=`reservation-${t.confirmationNumber}.pdf`,document.body.appendChild(s),s.click(),document.body.removeChild(s),window.URL.revokeObjectURL(i),this.snackBar.open("Reservation details exported to PDF successfully!","Close",{duration:3e3})}}catch(e){console.error("Error exporting reservation to PDF:",e);let i=e instanceof Error?e.message:"Failed to export reservation to PDF";this.snackBar.open(i,"Close",{duration:5e3,panelClass:["error-snackbar"]})}finally{this.exportingPDF.set(!1)}}})}openPricingUpdateDialog(){let t=this.reservation();if(!t)return;if(this.isCheckedOut()){this.snackBar.open("Cannot edit pricing for checked-out reservations","Close",{duration:3e3,panelClass:["error-snackbar"]});return}let e=this.storeStore.selectedStore();if(!e?._id){this.snackBar.open("No store selected","Close",{duration:3e3});return}let i={storeId:e._id,actionDescription:`update pricing for reservation ${t.confirmationNumber}`,reservationId:t._id};this.dialog.open(qe,{data:i,width:"500px",maxWidth:"90vw",disableClose:!0}).afterClosed().subscribe(d=>{d?.authorized&&d.pin&&this.proceedWithPricingUpdate(t)})}proceedWithPricingUpdate(t){let e={reservation:t};this.dialog.open(Je,{data:e,width:"800px",maxWidth:"90vw",maxHeight:"90vh",disableClose:!1,autoFocus:!1,panelClass:"pricing-update-dialog"}).afterClosed().subscribe(s=>{s?.success&&s.updatedReservation&&(this.reservation.set(s.updatedReservation),this.snackBar.open("Pricing updated successfully!","Close",{duration:3e3,panelClass:["success-snackbar"]}))})}formatCurrency(t){if(!t&&t!==0)return"N/A";let e=this.storeStore.selectedStore(),i=e?.currencyCode||e?.currency||"USD";try{return new Intl.NumberFormat("en-US",{style:"currency",currency:i}).format(t)}catch{return console.warn(`Invalid currency code: ${i}, falling back to USD`),new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(t)}}hasExtensions(){let t=this.reservation();return!!(t?.extensions&&t.extensions.length>0)}getExtensions(){return this.reservation()?.extensions||[]}hasActiveExtension(){return!!this.reservation()?.currentExtension?.isActive}getTotalExtensionCost(){let t=this.reservation();return t?.currentExtension?.isActive&&t.currentExtension?.totalExtensionCost?t.currentExtension.totalExtensionCost:this.getExtensions().filter(i=>i.status==="approved").reduce((i,s)=>i+(s.additionalCost||0),0)}getTotalExtensionNights(){let t=this.reservation();return t?.currentExtension?.isActive&&t.currentExtension?.totalExtensionNights?t.currentExtension.totalExtensionNights:this.getExtensions().filter(i=>i.status==="approved").reduce((i,s)=>i+(s.additionalNights||0),0)}getFinalTotal(){return this.reservation()?.pricing?.total||0}formatExtensionDate(t){if(!t)return"N/A";try{return(typeof t=="string"?new Date(t):t).toLocaleDateString("en-US",{weekday:"short",year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}catch{return console.warn("Invalid date format:",t),"Invalid Date"}}processingExtension=P(null);processingAction=P(null);approveExtension(t){return S(this,null,function*(){let e=this.reservation();if(!e)return;let i=e.extensions?.find(f=>f._id===t);if(!i){this.snackBar.open("Extension not found","Close",{duration:3e3});return}let s={extensionId:t,reservationId:e._id,extensionCost:i.additionalCost,currency:this.storeStore.selectedStore()?.currency||"USD",additionalNights:i.additionalNights},g=yield this.dialog.open($e,{data:s,width:"500px",disableClose:!0}).afterClosed().toPromise();if(g){this.processingExtension.set(t),this.processingAction.set("approve");try{let f=yield this.reservationService.approveExtension(e._id,t,"Extension approved from reservation details",g).toPromise();f?.reservation&&(this.reservation.set(f.reservation),this.snackBar.open("Extension approved successfully with payment information!","Close",{duration:3e3,panelClass:["success-snackbar"]}))}catch(f){console.error("Error approving extension:",f),this.snackBar.open(f.message||"Failed to approve extension","Close",{duration:5e3,panelClass:["error-snackbar"]})}finally{this.processingExtension.set(null),this.processingAction.set(null)}}})}rejectExtension(t){return S(this,null,function*(){let e=this.reservation();if(!e)return;let i=prompt("Please provide a reason for rejection:");if(i){this.processingExtension.set(t),this.processingAction.set("reject");try{let s=yield this.reservationService.rejectExtension(e._id,t,i,"Extension rejected from reservation details").toPromise();s?.reservation&&(this.reservation.set(s.reservation),this.snackBar.open("Extension rejected successfully!","Close",{duration:3e3,panelClass:["success-snackbar"]}))}catch(s){console.error("Error rejecting extension:",s),this.snackBar.open(s.message||"Failed to reject extension","Close",{duration:5e3,panelClass:["error-snackbar"]})}finally{this.processingExtension.set(null),this.processingAction.set(null)}}})}openRoomChangeDialog(){return S(this,null,function*(){let t=this.reservation();if(!t||this.isCheckedOut()){this.snackBar.open("Cannot change rooms for checked-out reservations","Close",{duration:3e3});return}this.dialog.open(Ye,{width:"1000px",maxWidth:"95vw",maxHeight:"90vh",disableClose:!0,data:{reservationId:t._id,currentRooms:t.rooms,checkInDate:new Date(t.checkInDate).toISOString(),checkOutDate:new Date(t.checkOutDate).toISOString(),numberOfNights:t.numberOfNights,currency:this.storeStore.selectedStore()?.currency||"USD"}}).afterClosed().subscribe(i=>S(this,null,function*(){i&&(yield this.processRoomChange(i))}))})}processRoomChange(t){return S(this,null,function*(){let e=this.reservation();if(e)try{if(this.loading.set(!0),t.pricingAdjustment.requiresPayment){let s=this.storeStore.selectedStore()?.currency||"USD";if(!(yield this.dialog.open(je,{width:"500px",disableClose:!0,data:{reservation:e,amount:t.pricingAdjustment.difference,title:"Room Change - Additional Payment Required",description:`Additional payment of ${s}${t.pricingAdjustment.difference.toLocaleString()} required for room upgrade`,isCheckoutFlow:!1}}).afterClosed().toPromise())){this.snackBar.open("Room change cancelled - payment not processed","Close",{duration:3e3});return}}let i=yield this.reservationService.changeRooms(e._id,t).toPromise();i.success&&(this.reservation.set(i.data),this.snackBar.open("Rooms changed successfully","Close",{duration:3e3}),yield this.loadReservation(e._id))}catch(i){console.error("Error processing room change:",i),this.snackBar.open("Failed to change rooms","Close",{duration:3e3})}finally{this.loading.set(!1)}})}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=B({type:r,selectors:[["app-reservation-details"]],decls:80,vars:23,consts:[["actionsMenu","matMenu"],["paymentMenu","matMenu"],["emailMenu","matMenu"],["printMenu","matMenu"],["statusMenu","matMenu"],[1,"bg-gradient-to-r","from-blue-50","to-indigo-50","border-b","border-blue-100"],[1,"max-w-7xl","mx-auto","px-4","sm:px-6","lg:px-8"],[1,"flex","justify-between","items-center","py-6"],[1,"flex","items-center","gap-4"],["type","button",1,"p-2","text-gray-600","hover:text-gray-900","hover:bg-white/60","rounded-lg","transition-all","duration-200",3,"click"],[1,"flex","items-center","gap-3"],[1,"flex","justify-center","items-center","py-12","bg-white"],[1,"max-w-7xl","mx-auto","px-4","sm:px-6","lg:px-8","py-8"],[1,"!shadow-xl","!border","!border-gray-200","!rounded-lg"],["mat-menu-item","",1,"!text-gray-700","hover:!bg-blue-50","hover:!text-blue-700","!transition-colors"],["mat-menu-item","",1,"!text-gray-700","hover:!bg-gray-50","!transition-colors",3,"matMenuTriggerFor"],[1,"mr-3","!text-gray-600"],[1,"ml-auto","!text-gray-400"],["mat-menu-item","",1,"!text-gray-700","hover:!bg-green-50","hover:!text-green-700","!transition-colors",3,"disabled"],["mat-menu-item","",1,"!text-gray-700","hover:!bg-red-50","hover:!text-red-700","!transition-colors",3,"click","disabled"],[1,"mr-3","!text-red-600","animate-spin"],[1,"mr-3","!text-red-600"],[1,"px-3","py-2","text-xs","font-medium","text-gray-500","border-b","border-gray-100"],[1,"px-3","py-2","text-xs","text-gray-400","italic","flex","items-center","gap-2"],[1,"px-3","py-2","text-xs","text-gray-400","italic"],["mat-menu-item","",1,"!text-gray-700","hover:!bg-blue-50","hover:!text-blue-700","!transition-colors",3,"click"],[1,"mr-3","!text-blue-600"],["mat-menu-item","",1,"!text-gray-700","hover:!bg-green-50","hover:!text-green-700","!transition-colors"],["mat-menu-item","",1,"!text-gray-700","hover:!bg-purple-50","hover:!text-purple-700","!transition-colors"],[1,"px-3","py-2","text-xs","text-gray-600","bg-gray-50","border-t","border-gray-100","mt-1"],[1,"px-3","py-2","text-xs","border-b","border-gray-100"],[1,"flex","items-center","gap-2","text-green-600"],[1,"flex","items-center","gap-2","text-gray-500"],["mat-menu-item","",1,"!text-gray-700","hover:!bg-blue-50","hover:!text-blue-700","!transition-colors",3,"click","disabled"],[1,"mr-3","!text-blue-600","animate-spin"],["mat-menu-item","",1,"!text-gray-700","hover:!bg-green-50","hover:!text-green-700","!transition-colors",3,"click","disabled"],[1,"mr-3","!text-green-600"],[1,"px-3","py-2","border-t","border-gray-100","mt-1"],["mat-menu-item","",1,"!text-gray-700","hover:!bg-red-50","hover:!text-red-700","!transition-colors","w-full",3,"disabled"],["mat-menu-item","",1,"!text-gray-700","hover:!bg-blue-50","hover:!text-blue-700","!transition-colors","w-full",3,"disabled"],[1,"text-3xl","font-bold","text-gray-900","mb-1"],[1,"text-sm","text-gray-600"],[1,"relative"],[1,"px-3","py-1","rounded-full","text-sm","font-medium","border-2","flex","items-center","gap-2","hover:opacity-80","transition-all","duration-200","disabled:opacity-50",3,"matMenuTriggerFor","disabled"],[1,"text-sm","animate-spin"],[1,"text-sm",3,"color"],[1,"text-xs","opacity-60"],["mat-menu-item",""],[1,"px-3","py-2","text-xs","text-amber-600","bg-amber-50","border-t","border-amber-100","mt-1"],[1,"px-3","py-2","text-xs","text-blue-600","bg-blue-50","border-t","border-blue-100","mt-1"],["type","button",1,"px-4","py-2","text-sm","font-medium","text-blue-700","bg-blue-50","border","border-blue-200","rounded-lg","hover:bg-blue-100","hover:border-blue-300","transition-all","duration-200","flex","items-center","gap-2"],["type","button",1,"px-4","py-2","text-sm","font-medium","text-green-700","bg-green-50","border","border-green-200","rounded-lg","hover:bg-green-100","hover:border-green-300","transition-all","duration-200","flex","items-center","gap-2","disabled:opacity-50","disabled:cursor-not-allowed",3,"disabled"],[1,"p-2","text-gray-600","hover:text-gray-900","hover:bg-white/60","rounded-lg","transition-all","duration-200",3,"matMenuTriggerFor"],[1,"text-sm"],["mat-menu-item","",3,"click"],[1,"mr-3","text-base"],["type","button",1,"px-4","py-2","text-sm","font-medium","text-blue-700","bg-blue-50","border","border-blue-200","rounded-lg","hover:bg-blue-100","hover:border-blue-300","transition-all","duration-200","flex","items-center","gap-2",3,"click"],[1,"text-lg"],["type","button",1,"px-4","py-2","text-sm","font-medium","text-green-700","bg-green-50","border","border-green-200","rounded-lg","hover:bg-green-100","hover:border-green-300","transition-all","duration-200","flex","items-center","gap-2","disabled:opacity-50","disabled:cursor-not-allowed",3,"click","disabled"],["diameter","40",1,"!text-blue-600"],[1,"ml-3","text-gray-600"],[1,"bg-red-50","border","border-red-200","rounded-lg","p-6","text-center"],[1,"w-16","h-16","bg-red-200","rounded-full","flex","items-center","justify-center","mx-auto","mb-4"],[1,"text-4xl","text-red-500"],[1,"text-lg","font-semibold","text-red-900","mb-2"],[1,"text-red-700","mb-4"],["type","button",1,"bg-red-600","hover:bg-red-700","text-white","px-4","py-2","rounded-lg","font-medium","transition-colors","duration-200",3,"click"],[1,"grid","grid-cols-1","lg:grid-cols-3","gap-8"],[1,"lg:col-span-2","space-y-6"],[1,"bg-white","rounded-lg","shadow-sm","border","border-gray-200","overflow-hidden"],[1,"bg-gradient-to-r","from-gray-50","to-gray-100","px-6","py-4","border-b","border-gray-200"],[1,"text-lg","font-semibold","text-gray-900","flex","items-center","gap-2"],[1,"text-blue-600"],[1,"p-6"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-6"],[1,"block","text-sm","font-medium","text-gray-700","mb-1"],[1,"text-lg","font-semibold","text-gray-900"],[1,"text-green-600"],[1,"flex","items-center","justify-between"],[1,"text-purple-600"],["mat-icon-button","","matTooltip","Change Rooms",1,"text-blue-600","hover:bg-blue-50","transition-colors","duration-200"],[1,"overflow-x-auto"],[1,"min-w-full"],[1,"border-b","border-gray-200"],[1,"text-left","py-3","px-4","font-semibold","text-gray-700"],[1,"border-b","border-gray-100","hover:bg-gray-50"],[1,"space-y-6"],[1,"bg-gradient-to-r","from-purple-50","to-purple-100","px-6","py-4","border-b","border-purple-200"],[1,"flex","justify-between","items-center"],[1,"text-xs","text-gray-500","font-normal"],["mat-icon-button","",1,"text-gray-600","hover:text-purple-600","hover:bg-purple-50","transition-colors","duration-200",3,"click","matTooltip","disabled"],[1,"space-y-3"],[1,"flex","justify-between"],[1,"text-gray-600"],[1,"font-medium","text-gray-900"],[1,"border-gray-200"],[1,"flex","justify-between","text-lg","font-semibold"],[1,"text-gray-900"],[1,"font-medium","text-green-600"],[1,"font-medium"],[1,"mt-8","space-y-6"],[1,"grid","grid-cols-1","lg:grid-cols-2","gap-6"],[1,"bg-red-50","border","border-red-200","rounded-lg","overflow-hidden"],[1,"bg-gradient-to-r","from-orange-50","to-amber-50","px-6","py-4","border-b","border-orange-200"],[1,"text-orange-600"],[1,"ml-2","px-2","py-1","bg-orange-100","text-orange-700","text-xs","font-medium","rounded-full"],[1,"space-y-4"],[1,"bg-gray-50","rounded-lg","p-4","border","border-gray-200"],[1,"mt-6","p-4","bg-green-50","border","border-green-200","rounded-lg"],[1,"flex","items-start","justify-between","mb-3"],[1,"w-10","h-10","bg-orange-100","rounded-full","flex","items-center","justify-center"],[1,"text-orange-600","text-sm"],[1,"px-3","py-1","rounded-full","text-xs","font-medium","border",3,"ngClass"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4","mb-4"],[1,"text-sm","text-gray-900"],[1,"text-sm","text-gray-900","font-medium"],[1,"text-sm","font-medium","text-orange-600"],[1,"mb-3"],[1,"mt-3","flex","gap-2"],[1,"mt-3","p-3","bg-red-50","border","border-red-200","rounded"],[1,"text-sm","text-gray-600","bg-white","p-3","rounded","border"],["type","button",1,"px-4","py-2","text-sm","font-medium","text-white","bg-green-600","border","border-green-600","rounded-lg","hover:bg-green-700","transition-all","duration-200","flex","items-center","gap-2","disabled:opacity-50","disabled:cursor-not-allowed",3,"click","disabled"],["type","button",1,"px-4","py-2","text-sm","font-medium","text-red-600","bg-white","border","border-red-300","rounded-lg","hover:bg-red-50","hover:border-red-400","transition-all","duration-200","flex","items-center","gap-2","disabled:opacity-50","disabled:cursor-not-allowed",3,"click","disabled"],[1,"flex","items-center","gap-2","text-sm","text-green-600"],[1,"mt-3","p-3","bg-blue-50","border","border-blue-200","rounded"],[1,"flex","items-center","gap-2","text-sm","text-blue-600","mb-2"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-3","text-sm"],[1,"ml-2","px-2","py-1","rounded-full","text-xs","font-medium",3,"ngClass"],[1,"ml-2","font-medium","text-gray-900"],[1,"mt-2","pt-2","border-t","border-blue-200"],[1,"ml-2","font-mono","text-sm","text-gray-900"],[1,"text-gray-600","text-sm"],[1,"mt-1","text-sm","text-gray-700"],[1,"flex","items-center","gap-2","text-sm","text-red-600","mb-1"],[1,"text-sm","text-red-700"],[1,"text-xs","text-red-500","mt-1"],[1,"flex","items-center","gap-2","mb-2"],[1,"font-medium","text-green-800"],[1,"text-sm","text-green-700"],["mat-icon-button","","matTooltip","Change Rooms",1,"text-blue-600","hover:bg-blue-50","transition-colors","duration-200",3,"click"],[1,"py-3","px-4","font-medium","text-gray-900"],[1,"py-3","px-4","text-gray-600"],[1,"font-medium","text-orange-600"],["matTooltip","Payment options",1,"p-2","text-gray-600","hover:text-gray-900","hover:bg-white/60","rounded-lg","transition-all","duration-200",3,"matMenuTriggerFor"],["matTooltip","Cannot edit payment info for checked-out reservations",1,"p-2","text-gray-400"],[1,"flex","items-center","gap-2"],[1,"text-sm","animate-spin","text-blue-600"],[1,"inline-flex","px-2","py-1","text-xs","font-medium","rounded-full"],[1,"py-3","px-4"],[1,"text-gray-700"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4"],[1,"bg-gray-50","border","border-gray-200","rounded-lg","p-4"],[1,"bg-red-100","px-6","py-4","border-b","border-red-200"],[1,"text-lg","font-semibold","text-red-900","flex","items-center","gap-2"],[1,"text-red-600"],[1,"block","text-sm","font-medium","text-red-700","mb-1"],[1,"text-sm","text-red-600"],[1,"!border-gray-200","my-1"],["mat-menu-item","",1,"!text-gray-700","hover:!bg-red-50","hover:!text-red-700","!transition-colors",3,"click"],[1,"!text-sm"],["mat-menu-item","",1,"!text-gray-700","hover:!bg-gray-50","!transition-colors"],[1,"mr-3","!text-base","!text-blue-600"],["mat-menu-item","",1,"!text-gray-700","hover:!bg-gray-50","!transition-colors",3,"click"],[1,"mr-3","!text-base"],["mat-menu-item","",1,"!text-gray-700","hover:!bg-green-50","hover:!text-green-700","!transition-colors",3,"click"],["mat-menu-item","",1,"!text-gray-700","hover:!bg-purple-50","hover:!text-purple-700","!transition-colors",3,"click"],[1,"mr-3","!text-purple-600"],["mat-menu-item","",1,"!text-gray-700","hover:!bg-red-50","hover:!text-red-700","!transition-colors","w-full",3,"click","disabled"],["mat-menu-item","",1,"!text-gray-700","hover:!bg-blue-50","hover:!text-blue-700","!transition-colors","w-full",3,"click","disabled"]],template:function(e,i){if(e&1){let s=M();o(0,"div",5)(1,"div",6)(2,"div",7)(3,"div",8)(4,"button",9),C("click",function(){return y(s),E(i.goBack())}),o(5,"mat-icon"),a(6,"arrow_back"),n()(),o(7,"div"),m(8,Nn,4,1)(9,An,4,0),n()(),m(10,Ln,23,18,"div",10),n()()(),m(11,Hn,4,0,"div",11),m(12,Wn,11,1,"div",12),m(13,Ho,162,69,"div",12),o(14,"mat-menu",13,0),m(16,Wo,5,0,"button",14),o(17,"button",15)(18,"mat-icon",16),a(19,"print"),n(),o(20,"span"),a(21,"Print Details"),n(),o(22,"mat-icon",17),a(23,"chevron_right"),n()(),o(24,"button",15)(25,"mat-icon",16),a(26,"email"),n(),o(27,"span"),a(28,"Send Email"),n(),o(29,"mat-icon",17),a(30,"chevron_right"),n()(),m(31,Qo,5,1,"button",18),o(32,"button",19),C("click",function(){return y(s),E(i.exportReservationToPDF())}),m(33,Zo,2,0,"mat-icon",20)(34,Ko,2,0,"mat-icon",21),o(35,"span"),a(36),n()(),m(37,Jo,6,0),n(),o(38,"mat-menu",13,1)(40,"div",22),a(41," Update Payment Information "),n(),m(42,Yo,5,0,"div",23)(43,Xo,2,0,"div",24)(44,ta,9,0),n(),o(45,"mat-menu",13,2)(47,"div",22),a(48," Email Options "),n(),o(49,"button",25),C("click",function(){return y(s),E(i.sendReservationEmail("details"))}),o(50,"mat-icon",26),a(51,"description"),n(),o(52,"span"),a(53,"Send Reservation Details"),n()(),m(54,ia,5,0,"button",27),m(55,na,5,0,"button",28),o(56,"div",29),a(57),n()(),o(58,"mat-menu",13,3)(60,"div",22),a(61," Print Options "),n(),o(62,"div",30),m(63,oa,5,0,"div",31)(64,aa,5,0,"div",32),n(),o(65,"button",33),C("click",function(){return y(s),E(i.printReservation())}),m(66,ra,2,0,"mat-icon",34)(67,la,2,0,"mat-icon",26),o(68,"span"),a(69),n()(),o(70,"button",35),C("click",function(){return y(s),E(i.testPrint())}),o(71,"mat-icon",36),a(72,"check_circle"),n(),o(73,"span"),a(74,"Test Print"),n()(),o(75,"div",37),m(76,sa,5,1,"button",38)(77,da,5,1,"button",39),n(),o(78,"div",29),a(79," \u{1F5A8}\uFE0F Uses Bluetooth thermal printers with ESC/POS commands "),n()()}if(e&2){let s=Q(46),d=Q(59);l(8),u(i.reservation()?8:9),l(2),u(i.reservation()&&!i.loading()?10:-1),l(),u(i.loading()?11:-1),l(),u(i.error()&&!i.loading()?12:-1),l(),u(i.reservation()&&!i.loading()&&!i.error()?13:-1),l(3),u(i.canEdit()?16:-1),l(),h("matMenuTriggerFor",d),l(7),h("matMenuTriggerFor",s),l(7),u(i.canRequestExtension()?31:-1),l(),h("disabled",i.exportingPDF()||i.statusUpdating()),l(),u(i.exportingPDF()?33:34),l(3),p(i.exportingPDF()?"Exporting...":"Export to PDF"),l(),u(i.canDelete()?37:-1),l(5),u(i.isCheckedOut()?42:i.getAvailablePaymentStatusOptions().length===0?43:44),l(12),u(i.reservation()&&(i.reservation().status==="confirmed"||i.reservation().status==="checked_in"||i.reservation().status==="checked_out")?54:-1),l(),u(i.reservation()&&(i.reservation().status==="checked_in"||i.reservation().status==="checked_out")?55:-1),l(2),v(" \u{1F4E7} Email will be sent to: ",i.guestEmail()," "),l(6),u(i.printerConnected()?63:64),l(2),h("disabled",i.printing()||i.statusUpdating()),l(),u(i.printing()?66:67),l(3),p(i.printing()?"Printing...":"Print Reservation"),l(),h("disabled",i.printing()||i.statusUpdating()||!i.printerConnected()),l(6),u(i.printerConnected()?76:77)}},dependencies:[G,Tt,fe,q,Wt,z,$,si,ci,di,oi,ii,ti,ni,Ce,Ue,ke,j,L,de,ye,ri,ai,Te,Z],styles:[".reservation-details-container[_ngcontent-%COMP%]{padding:24px;max-width:1200px;margin:0 auto}.reservation-details-container[_ngcontent-%COMP%]   .error-card[_ngcontent-%COMP%]{margin:24px auto;max-width:400px}.reservation-details-container[_ngcontent-%COMP%]   .error-card[_ngcontent-%COMP%]   .error-icon[_ngcontent-%COMP%]{font-size:48px;width:48px;height:48px;color:#f44336}.reservation-details-container[_ngcontent-%COMP%]   .header-card[_ngcontent-%COMP%]{box-shadow:0 2px 8px #0000001a;border-radius:12px}.reservation-details-container[_ngcontent-%COMP%]   .header-card[_ngcontent-%COMP%]   mat-card-header[_ngcontent-%COMP%]{padding:24px 24px 0}.reservation-details-container[_ngcontent-%COMP%]   .header-card[_ngcontent-%COMP%]   mat-card-content[_ngcontent-%COMP%]{padding:16px 24px}.reservation-details-container[_ngcontent-%COMP%]   .header-card[_ngcontent-%COMP%]   mat-card-actions[_ngcontent-%COMP%]{background-color:#f8f9fa;border-top:1px solid #e9ecef;margin:0}.reservation-details-container[_ngcontent-%COMP%]   .header-card[_ngcontent-%COMP%]   .status-chip[_ngcontent-%COMP%]{font-weight:500;border-radius:20px;padding:8px 16px;font-size:12px;text-transform:uppercase;letter-spacing:.5px}.reservation-details-container[_ngcontent-%COMP%]   mat-card[_ngcontent-%COMP%]{border-radius:12px;box-shadow:0 2px 8px #00000014;border:1px solid #e5e7eb}.reservation-details-container[_ngcontent-%COMP%]   mat-card[_ngcontent-%COMP%]   mat-card-title[_ngcontent-%COMP%]{font-size:20px;font-weight:600;color:#1f2937}.reservation-details-container[_ngcontent-%COMP%]   mat-card[_ngcontent-%COMP%]   mat-card-subtitle[_ngcontent-%COMP%]{font-size:14px;color:#6b7280;margin-top:4px}.reservation-details-container[_ngcontent-%COMP%]     .mat-mdc-tab-group .mat-mdc-tab-header{border-bottom:1px solid #e5e7eb}.reservation-details-container[_ngcontent-%COMP%]     .mat-mdc-tab-group .mat-mdc-tab.mdc-tab--active .mdc-tab__text-label{color:#3b82f6;font-weight:600}.reservation-details-container[_ngcontent-%COMP%]     .mat-mdc-tab-group .mat-mdc-tab-body-content{padding:0}.reservation-details-container[_ngcontent-%COMP%]     .mat-mdc-table{box-shadow:none;border:1px solid #e5e7eb;border-radius:8px;overflow:hidden}.reservation-details-container[_ngcontent-%COMP%]     .mat-mdc-table .mat-mdc-header-row{background-color:#f8f9fa}.reservation-details-container[_ngcontent-%COMP%]     .mat-mdc-table .mat-mdc-header-cell{font-weight:600;color:#374151;border-bottom:1px solid #e5e7eb;font-size:14px}.reservation-details-container[_ngcontent-%COMP%]     .mat-mdc-table .mat-mdc-cell{color:#1f2937;border-bottom:1px solid #f3f4f6;font-size:14px}.reservation-details-container[_ngcontent-%COMP%]     .mat-mdc-table .mat-mdc-row:hover{background-color:#f9fafb}.reservation-details-container[_ngcontent-%COMP%]     .mat-mdc-table .mat-mdc-row:last-child .mat-mdc-cell{border-bottom:none}.reservation-details-container[_ngcontent-%COMP%]     .mat-mdc-chip{font-size:11px;font-weight:500;height:24px;border-radius:12px}.reservation-details-container[_ngcontent-%COMP%]     .mat-mdc-chip.status-chip{border:none}.reservation-details-container[_ngcontent-%COMP%]     .mat-mdc-raised-button{border-radius:8px;font-weight:500;text-transform:none}.reservation-details-container[_ngcontent-%COMP%]     .mat-mdc-raised-button.mat-primary{background-color:#3b82f6;color:#fff}.reservation-details-container[_ngcontent-%COMP%]     .mat-mdc-raised-button.mat-primary:hover{background-color:#2563eb}.reservation-details-container[_ngcontent-%COMP%]     .mat-mdc-button{border-radius:8px;font-weight:500;text-transform:none}.reservation-details-container[_ngcontent-%COMP%]     .mat-mdc-menu-panel{border-radius:8px;box-shadow:0 4px 16px #0000001f}.reservation-details-container[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]{display:grid}.reservation-details-container[_ngcontent-%COMP%]   .grid-cols-1[_ngcontent-%COMP%]{grid-template-columns:repeat(1,minmax(0,1fr))}.reservation-details-container[_ngcontent-%COMP%]   .grid-cols-2[_ngcontent-%COMP%]{grid-template-columns:repeat(2,minmax(0,1fr))}.reservation-details-container[_ngcontent-%COMP%]   .grid-cols-3[_ngcontent-%COMP%]{grid-template-columns:repeat(3,minmax(0,1fr))}.reservation-details-container[_ngcontent-%COMP%]   .gap-2[_ngcontent-%COMP%]{gap:.5rem}.reservation-details-container[_ngcontent-%COMP%]   .gap-4[_ngcontent-%COMP%]{gap:1rem}.reservation-details-container[_ngcontent-%COMP%]   .gap-6[_ngcontent-%COMP%]{gap:1.5rem}.reservation-details-container[_ngcontent-%COMP%]   .space-y-1[_ngcontent-%COMP%] > *[_ngcontent-%COMP%] + *[_ngcontent-%COMP%]{margin-top:.25rem}.reservation-details-container[_ngcontent-%COMP%]   .space-y-2[_ngcontent-%COMP%] > *[_ngcontent-%COMP%] + *[_ngcontent-%COMP%]{margin-top:.5rem}.reservation-details-container[_ngcontent-%COMP%]   .space-y-6[_ngcontent-%COMP%] > *[_ngcontent-%COMP%] + *[_ngcontent-%COMP%]{margin-top:1.5rem}@media(min-width:768px){.reservation-details-container[_ngcontent-%COMP%]   .md\\\\[_ngcontent-%COMP%]:grid-cols-2{grid-template-columns:repeat(2,minmax(0,1fr))}.reservation-details-container[_ngcontent-%COMP%]   .md\\\\[_ngcontent-%COMP%]:grid-cols-3{grid-template-columns:repeat(3,minmax(0,1fr))}}.reservation-details-container[_ngcontent-%COMP%]   .flex[_ngcontent-%COMP%]{display:flex}.reservation-details-container[_ngcontent-%COMP%]   .items-center[_ngcontent-%COMP%]{align-items:center}.reservation-details-container[_ngcontent-%COMP%]   .items-start[_ngcontent-%COMP%]{align-items:flex-start}.reservation-details-container[_ngcontent-%COMP%]   .justify-center[_ngcontent-%COMP%]{justify-content:center}.reservation-details-container[_ngcontent-%COMP%]   .justify-between[_ngcontent-%COMP%]{justify-content:space-between}.reservation-details-container[_ngcontent-%COMP%]   .w-full[_ngcontent-%COMP%]{width:100%}.reservation-details-container[_ngcontent-%COMP%]   .mb-2[_ngcontent-%COMP%]{margin-bottom:.5rem}.reservation-details-container[_ngcontent-%COMP%]   .mb-4[_ngcontent-%COMP%]{margin-bottom:1rem}.reservation-details-container[_ngcontent-%COMP%]   .mb-6[_ngcontent-%COMP%]{margin-bottom:1.5rem}.reservation-details-container[_ngcontent-%COMP%]   .ml-2[_ngcontent-%COMP%]{margin-left:.5rem}.reservation-details-container[_ngcontent-%COMP%]   .p-3[_ngcontent-%COMP%]{padding:.75rem}.reservation-details-container[_ngcontent-%COMP%]   .p-4[_ngcontent-%COMP%]{padding:1rem}.reservation-details-container[_ngcontent-%COMP%]   .py-8[_ngcontent-%COMP%]{padding-top:2rem;padding-bottom:2rem}.reservation-details-container[_ngcontent-%COMP%]   .pb-4[_ngcontent-%COMP%]{padding-bottom:1rem}.reservation-details-container[_ngcontent-%COMP%]   .text-center[_ngcontent-%COMP%]{text-align:center}.reservation-details-container[_ngcontent-%COMP%]   .text-sm[_ngcontent-%COMP%]{font-size:.875rem;line-height:1.25rem}.reservation-details-container[_ngcontent-%COMP%]   .text-lg[_ngcontent-%COMP%]{font-size:1.125rem;line-height:1.75rem}.reservation-details-container[_ngcontent-%COMP%]   .text-4xl[_ngcontent-%COMP%]{font-size:2.25rem;line-height:2.5rem}.reservation-details-container[_ngcontent-%COMP%]   .font-medium[_ngcontent-%COMP%]{font-weight:500}.reservation-details-container[_ngcontent-%COMP%]   .font-semibold[_ngcontent-%COMP%]{font-weight:600}.reservation-details-container[_ngcontent-%COMP%]   .rounded-lg[_ngcontent-%COMP%]{border-radius:.5rem}.reservation-details-container[_ngcontent-%COMP%]   .border[_ngcontent-%COMP%]{border-width:1px}.reservation-details-container[_ngcontent-%COMP%]   .border-t[_ngcontent-%COMP%]{border-top-width:1px}.reservation-details-container[_ngcontent-%COMP%]   .overflow-x-auto[_ngcontent-%COMP%]{overflow-x:auto}.reservation-details-container[_ngcontent-%COMP%]   .text-gray-500[_ngcontent-%COMP%]{color:#6b7280}.reservation-details-container[_ngcontent-%COMP%]   .text-gray-900[_ngcontent-%COMP%]{color:#111827}.reservation-details-container[_ngcontent-%COMP%]   .text-blue-600[_ngcontent-%COMP%]{color:#2563eb}.reservation-details-container[_ngcontent-%COMP%]   .text-green-600[_ngcontent-%COMP%]{color:#059669}.reservation-details-container[_ngcontent-%COMP%]   .text-purple-600[_ngcontent-%COMP%]{color:#9333ea}.reservation-details-container[_ngcontent-%COMP%]   .text-orange-600[_ngcontent-%COMP%]{color:#ea580c}.reservation-details-container[_ngcontent-%COMP%]   .text-red-600[_ngcontent-%COMP%]{color:#dc2626}.reservation-details-container[_ngcontent-%COMP%]   .bg-gray-50[_ngcontent-%COMP%]{background-color:#f9fafb}.reservation-details-container[_ngcontent-%COMP%]   .bg-red-50[_ngcontent-%COMP%]{background-color:#fef2f2}.reservation-details-container[_ngcontent-%COMP%]   .border-red-200[_ngcontent-%COMP%]{border-color:#fecaca}.reservation-details-container[_ngcontent-%COMP%]   .loading-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;min-height:200px}.reservation-details-container[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]{text-align:center;padding:2rem;color:#6b7280}.reservation-details-container[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{opacity:.5}.reservation-details-container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:focus{outline:2px solid #3b82f6;outline-offset:2px}@media print{.reservation-details-container[_ngcontent-%COMP%]   .header-card[_ngcontent-%COMP%]   mat-card-actions[_ngcontent-%COMP%], .reservation-details-container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%], .reservation-details-container[_ngcontent-%COMP%]   .mat-mdc-menu-trigger[_ngcontent-%COMP%]{display:none!important}.reservation-details-container[_ngcontent-%COMP%]   mat-card[_ngcontent-%COMP%]{box-shadow:none;border:1px solid #ccc}}@media(prefers-color-scheme:dark){.reservation-details-container[_ngcontent-%COMP%]   mat-card[_ngcontent-%COMP%]{background-color:#374151;color:#f9fafb}.reservation-details-container[_ngcontent-%COMP%]   .text-gray-900[_ngcontent-%COMP%]{color:#f9fafb}.reservation-details-container[_ngcontent-%COMP%]   .text-gray-500[_ngcontent-%COMP%]{color:#9ca3af}.reservation-details-container[_ngcontent-%COMP%]   .bg-gray-50[_ngcontent-%COMP%]{background-color:#4b5563}}"]})};export{Si as ReservationDetailsComponent};
