import{a as kt,b as Te}from"./chunk-NLKBFNRA.js";import{a as Ie}from"./chunk-GEG56NY7.js";import{a as Dt}from"./chunk-QGTJKOLV.js";import{a as ve}from"./chunk-AG55LGBW.js";import{a as yt,b as Et,c as St}from"./chunk-AVQGKMFO.js";import"./chunk-Y544GL6M.js";import"./chunk-MZF2CL32.js";import"./chunk-LQU32KS7.js";import{a as bt}from"./chunk-WHARIOSL.js";import"./chunk-NSSRZ2U3.js";import"./chunk-ZAOMQAJO.js";import{f as ht}from"./chunk-4L4VWXIM.js";import{d as ue,e as ge,f as Ct,h as Re,i as we,j as Oe,k as W}from"./chunk-XSZYAESL.js";import"./chunk-BS3ATKNX.js";import{a as gt,b as vt,c as xt,h as _t}from"./chunk-MSN3EE44.js";import{a as ft}from"./chunk-HOFFRLAS.js";import{a as ut}from"./chunk-OFQMF3WN.js";import{k as pt}from"./chunk-BAU4EBFS.js";import{g as mt}from"./chunk-GE7CTSB3.js";import"./chunk-T7LGKL43.js";import{a as Me,b as pe}from"./chunk-E4PTFC5Z.js";import{a as tt}from"./chunk-YHIOFNIN.js";import"./chunk-PYUUH7RE.js";import"./chunk-OKEXGVJ3.js";import"./chunk-O7SXWP4H.js";import{a as it,b as ot,c as at,d as rt}from"./chunk-4P4GBQE7.js";import{i as Y}from"./chunk-ZKQYDJ5W.js";import{a as ct,b as Pe}from"./chunk-LCF3SYDV.js";import{d as et}from"./chunk-ZLVLWRZH.js";import"./chunk-HJGFVW6K.js";import"./chunk-TVH27JLT.js";import"./chunk-G4CZ6LK2.js";import"./chunk-I564X6SI.js";import"./chunk-VTDH2LYT.js";import{b as z,c as ce,d as me}from"./chunk-63HT37SK.js";import{a as le,b as dt,c as se,d as Ee,e as Se,h as de}from"./chunk-YJCGHVXK.js";import"./chunk-UHBDKNKX.js";import{a as De,b as ke}from"./chunk-3ZLH5HUN.js";import{A as st,B as re,b as Z,d as M,g as Q,h as X,m as ee,n as te,q as lt,s as ne,t as ie,u as ye,v as oe,z as ae}from"./chunk-O5GCTPYR.js";import"./chunk-EGLRIU4H.js";import{a as he}from"./chunk-5TL46KBL.js";import"./chunk-EMG7PKSI.js";import"./chunk-MNYT3JO3.js";import"./chunk-53AK2UWQ.js";import"./chunk-BFT2MTJY.js";import{h as be}from"./chunk-JONI64R4.js";import"./chunk-H7INH462.js";import"./chunk-OOL2KACG.js";import"./chunk-KZJMNFJ3.js";import{b as q,c as L}from"./chunk-G6I3OKXX.js";import{Z as nt,_ as J,ba as $}from"./chunk-4Z2XUZY2.js";import{e as Qe,g as Xe}from"./chunk-F436VINI.js";import{e as Je,g as Ye,l as Ce,n as Ze,s as K,u as j}from"./chunk-H22US2IH.js";import{Ib as d,Jb as c,Jc as Ne,Kb as xe,Lb as He,Mb as A,Mc as x,Nb as B,Nc as F,Ob as f,Oc as k,Pb as o,Qb as t,Qc as I,Rb as S,Wc as T,Yb as P,ac as C,bb as l,cc as p,fa as D,ka as y,kb as We,la as E,ma as ze,mc as U,nc as _e,oc as G,qb as V,qc as N,rc as a,sc as u,tc as v,uc as H,vc as Ke,wa as R}from"./chunk-P5WOETP4.js";import{a as qe,b as Le,g as h}from"./chunk-GAL4ENT6.js";function Ot(r,n){r&1&&a(0," Should equal the full extension cost ")}function It(r,n){r&1&&a(0," Enter the amount paid so far ")}function Tt(r,n){r&1&&a(0," Enter 0 for pending payment ")}function Ft(r,n){r&1&&(o(0,"mat-icon",31),a(1,"refresh"),t())}var Fe=class r{dialogRef=D(ue);fb=D(ae);data=D(ge);submitting=R(!1);paymentForm=this.fb.group({paymentStatus:["paid",[M.required]],paymentMethod:["",[M.required]],paymentAmount:[0,[M.required,M.min(0)]],transactionReference:[""],notes:[""]});ngOnInit(){this.paymentForm.patchValue({paymentAmount:this.data.extensionCost}),this.paymentForm.get("paymentStatus")?.valueChanges.subscribe(n=>{let e=this.paymentForm.get("paymentAmount");n==="paid"?(e?.setValue(this.data.extensionCost),e?.setValidators([M.required,M.min(this.data.extensionCost)])):n==="pending"?(e?.setValue(0),e?.setValidators([M.required,M.min(0),M.max(0)])):e?.setValidators([M.required,M.min(.01),M.max(this.data.extensionCost-.01)]),e?.updateValueAndValidity()})}onSubmit(){if(this.paymentForm.valid){this.submitting.set(!0);let n={paymentStatus:this.paymentForm.value.paymentStatus,paymentMethod:this.paymentForm.value.paymentMethod,paymentAmount:this.paymentForm.value.paymentAmount,transactionReference:this.paymentForm.value.transactionReference||void 0,notes:this.paymentForm.value.notes||void 0};this.dialogRef.close(n)}}onCancel(){this.dialogRef.close(null)}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=V({type:r,selectors:[["app-extension-payment-dialog"]],decls:81,vars:11,consts:[[1,"max-w-md"],[1,"flex","items-center","gap-3","p-6","border-b","border-gray-200"],[1,"text-green-600"],[1,"text-xl","font-semibold","text-gray-900"],[1,"text-sm","text-gray-600"],[1,"p-6","space-y-4",3,"ngSubmit","formGroup"],[1,"bg-gray-50","rounded-lg","p-4","space-y-2"],[1,"font-medium","text-gray-900"],[1,"grid","grid-cols-2","gap-4","text-sm"],[1,"text-gray-600"],[1,"font-medium","ml-2"],["appearance","outline",1,"w-full"],["formControlName","paymentStatus"],["value","paid"],["value","partial"],["value","pending"],["formControlName","paymentMethod"],["value","cash"],["value","credit_card"],["value","debit_card"],["value","bank_transfer"],["value","mobile_payment"],["value","check"],["value","other"],["matInput","","type","number","step","0.01","min","0","formControlName","paymentAmount","placeholder","0.00",3,"max"],["matSuffix",""],["matInput","","formControlName","transactionReference","placeholder","Optional transaction ID or reference"],["matInput","","rows","3","formControlName","notes","placeholder","Optional notes about the payment..."],[1,"flex","justify-end","gap-3","pt-4","border-t","border-gray-200"],["type","button","mat-button","",1,"px-6",3,"click"],["type","submit","mat-flat-button","","color","primary",1,"px-6",3,"disabled"],[1,"animate-spin","mr-2"]],template:function(e,i){if(e&1&&(o(0,"div",0)(1,"div",1)(2,"mat-icon",2),a(3,"payment"),t(),o(4,"div")(5,"h2",3),a(6,"Extension Payment"),t(),o(7,"p",4),a(8,"Update payment information for extension approval"),t()()(),o(9,"form",5),C("ngSubmit",function(){return i.onSubmit()}),o(10,"div",6)(11,"h3",7),a(12,"Extension Details"),t(),o(13,"div",8)(14,"div")(15,"span",9),a(16,"Additional Nights:"),t(),o(17,"span",10),a(18),t()(),o(19,"div")(20,"span",9),a(21,"Extension Cost:"),t(),o(22,"span",10),a(23),x(24,"currency"),t()()()(),o(25,"mat-form-field",11)(26,"mat-label"),a(27,"Payment Status"),t(),o(28,"mat-select",12)(29,"mat-option",13),a(30,"Paid (Full Amount)"),t(),o(31,"mat-option",14),a(32,"Partial Payment"),t(),o(33,"mat-option",15),a(34,"Pending Payment"),t()(),o(35,"mat-hint"),a(36,"Select the current payment status for this extension"),t()(),o(37,"mat-form-field",11)(38,"mat-label"),a(39,"Payment Method"),t(),o(40,"mat-select",16)(41,"mat-option",17),a(42,"Cash"),t(),o(43,"mat-option",18),a(44,"Credit Card"),t(),o(45,"mat-option",19),a(46,"Debit Card"),t(),o(47,"mat-option",20),a(48,"Bank Transfer"),t(),o(49,"mat-option",21),a(50,"Mobile Payment"),t(),o(51,"mat-option",22),a(52,"Check"),t(),o(53,"mat-option",23),a(54,"Other"),t()()(),o(55,"mat-form-field",11)(56,"mat-label"),a(57,"Payment Amount"),t(),S(58,"input",24),o(59,"span",25),a(60),t(),o(61,"mat-hint"),d(62,Ot,1,0)(63,It,1,0)(64,Tt,1,0),t()(),o(65,"mat-form-field",11)(66,"mat-label"),a(67,"Transaction Reference"),t(),S(68,"input",26),o(69,"mat-hint"),a(70,"Payment confirmation number, receipt ID, etc."),t()(),o(71,"mat-form-field",11)(72,"mat-label"),a(73,"Payment Notes"),t(),S(74,"textarea",27),t(),o(75,"div",28)(76,"button",29),C("click",function(){return i.onCancel()}),a(77," Cancel "),t(),o(78,"button",30),d(79,Ft,2,0,"mat-icon",31),a(80," Approve Extension "),t()()()()),e&2){let s;l(9),f("formGroup",i.paymentForm),l(9),u(i.data.additionalNights),l(5),u(k(24,8,i.data.extensionCost,i.data.currency)),l(35),f("max",i.data.extensionCost),l(2),u(i.data.currency),l(2),c(((s=i.paymentForm.get("paymentStatus"))==null?null:s.value)==="paid"?62:((s=i.paymentForm.get("paymentStatus"))==null?null:s.value)==="partial"?63:64),l(16),f("disabled",i.paymentForm.invalid||i.submitting()),l(),c(i.submitting()?79:-1)}},dependencies:[j,re,ee,Z,te,Q,X,oe,ye,ie,ne,W,z,de,le,se,Se,me,ce,Pe,ct,et,$,J,L,q,K],encapsulation:2})};function Nt(r,n){r&1&&(o(0,"mat-error"),a(1," New check-out date is required "),t())}function Vt(r,n){r&1&&(o(0,"div",26),S(1,"mat-spinner",28),o(2,"span",29),a(3,"Checking availability..."),t()())}function Ut(r,n){if(r&1&&(o(0,"div",53)(1,"mat-icon",60),a(2,"savings"),t(),a(3),t()),r&2){let e=p(5);l(3),v(" Save ",e.formatCurrency(e.getDiscountAmount())," per night ")}}function Gt(r,n){r&1&&(o(0,"mat-error"),a(1," Discounted rate is required "),t())}function jt(r,n){r&1&&(o(0,"mat-error"),a(1," Rate must be greater than 0 "),t())}function $t(r,n){r&1&&(o(0,"mat-error"),a(1," Rate cannot be higher than the original rate "),t())}function qt(r,n){if(r&1&&(o(0,"div",55)(1,"mat-form-field",15)(2,"mat-label"),a(3,"Discounted Rate per Night"),t(),S(4,"input",61),o(5,"span",62),a(6),t(),o(7,"mat-hint"),a(8),t(),d(9,Gt,2,0,"mat-error"),d(10,jt,2,0,"mat-error"),d(11,$t,2,0,"mat-error"),t()()),r&2){let e,i,s,m,_,b=p(5);l(4),f("max",(e=b.availability())==null||e.pricingBreakdown==null?null:e.pricingBreakdown.originalRate),l(2),v("",((i=b.storeStore.selectedStore())==null?null:i.currency)||"$","\xA0"),l(2),v("Rate must be less than or equal to ",b.formatCurrency(((s=b.availability())==null||s.pricingBreakdown==null?null:s.pricingBreakdown.originalRate)||0)),l(),c((m=b.extensionForm.get("discountedRate"))!=null&&m.hasError("required")?9:-1),l(),c((_=b.extensionForm.get("discountedRate"))!=null&&_.hasError("min")?10:-1),l(),c(b.validateDiscountedRate()?-1:11)}}function Lt(r,n){if(r&1&&(o(0,"div",58),a(1),t()),r&2){let e,i=p(5);l(),v(" Total Savings: ",i.formatCurrency(i.getDiscountAmount()*(((e=i.availability())==null?null:e.extensionDays)||0))," ")}}function zt(r,n){if(r&1&&(o(0,"div",36)(1,"div",38)(2,"label",14),a(3,"Choose Rate Option:"),t(),o(4,"div",39),a(5,"2 options available"),t()(),o(6,"mat-radio-group",40)(7,"div",41)(8,"mat-radio-button",42)(9,"div",43),a(10," ORIGINAL "),t(),o(11,"div",44)(12,"div",45)(13,"div",46),a(14,"Same Rate"),t(),o(15,"div",47),a(16,"Continue with the original room rate"),t()(),o(17,"div",48)(18,"div",49),a(19),t(),o(20,"div",39),a(21,"per night"),t()()()()(),o(22,"div",41)(23,"mat-radio-button",50)(24,"div",44)(25,"div",45)(26,"div",51),a(27,"Discounted Rate"),t(),o(28,"div",52),a(29,"Apply a custom discount to the original rate"),t(),d(30,Ut,4,1,"div",53),t(),o(31,"div",48)(32,"div",54),a(33),t(),o(34,"div",39),a(35,"per night"),t()()()()()(),d(36,qt,12,6,"div",55),o(37,"div",56)(38,"div",57)(39,"div")(40,"div",14),a(41,"Total Extension Cost"),t(),o(42,"div",39),a(43),t(),d(44,Lt,2,1,"div",58),t(),o(45,"div",59),a(46),t()()()()),r&2){let e,i,s,m=p(4);l(19),v(" ",m.formatCurrency(((e=m.availability())==null||e.pricingBreakdown==null?null:e.pricingBreakdown.originalRate)||0)," "),l(11),c(m.getDiscountAmount()>0?30:-1),l(3),v(" ",m.formatCurrency(m.getSelectedRate())," "),l(3),c(((i=m.extensionForm.get("selectedPricingStrategy"))==null?null:i.value)==="discounted_rate"?36:-1),l(7),H(" ",(s=m.availability())==null?null:s.extensionDays," nights \xD7 ",m.formatCurrency(m.getSelectedRate())," "),l(),c(m.getDiscountAmount()>0?44:-1),l(2),v(" ",m.formatCurrency(m.getTotalCost())," ")}}function Wt(r,n){if(r&1&&(o(0,"div",76)(1,"span",67),a(2),t(),o(3,"span",68),a(4),t()()),r&2){let e=n.$implicit,i=p(6);l(2),v("",i.getModifierDisplayName(e),":"),l(),N(i.getModifierValueClass(e)),l(),v(" ",i.getModifierValueDisplay(e)," ")}}function Ht(r,n){if(r&1&&(o(0,"div",9)(1,"div",75),a(2,"ADJUSTMENTS:"),t(),A(3,Wt,5,4,"div",76,He),t()),r&2){let e,i=p(5);l(3),B((e=i.availability())==null||e.pricingBreakdown==null?null:e.pricingBreakdown.appliedModifiers)}}function Kt(r,n){if(r&1&&(o(0,"div",37)(1,"h5",63)(2,"mat-icon",64),a(3,"receipt"),t(),a(4," Pricing Breakdown "),t(),o(5,"div",65)(6,"div",66)(7,"span",67),a(8,"Base Rate per Night:"),t(),o(9,"span",68),a(10),t()(),d(11,Ht,5,0,"div",9),o(12,"div",69)(13,"div",70)(14,"span"),a(15,"Final Rate per Night:"),t(),o(16,"span",71),a(17),t()()(),o(18,"div",72)(19,"div",57)(20,"span",73),a(21,"Total Extension Cost:"),t(),o(22,"span",74),a(23),t()()()()()),r&2){let e,i,s,m,_=p(4);l(10),u(_.formatCurrency(((e=_.availability())==null||e.pricingBreakdown==null?null:e.pricingBreakdown.baseRatePerNight)||0)),l(),c(!((i=_.availability())==null||i.pricingBreakdown==null||i.pricingBreakdown.appliedModifiers==null)&&i.pricingBreakdown.appliedModifiers.length?11:-1),l(6),u(_.formatCurrency(((s=_.availability())==null||s.pricingBreakdown==null?null:s.pricingBreakdown.finalRatePerNight)||0)),l(6),u(_.formatCurrency(((m=_.availability())==null?null:m.estimatedCost)||0))}}function Jt(r,n){if(r&1&&(o(0,"div",18)(1,"div",34)(2,"div",9)(3,"div",10),a(4,"Additional Nights"),t(),o(5,"div",35),a(6),t()(),o(7,"div",9)(8,"div",10),a(9,"Extension Days"),t(),o(10,"div",35),a(11),t()()(),d(12,zt,47,8,"div",36),d(13,Kt,24,4,"div",37),t()),r&2){let e,i,s,m,_=p(3);l(6),u((e=_.availability())==null?null:e.maxExtensionNights),l(5),u((i=_.availability())==null?null:i.extensionDays),l(),c(!((s=_.availability())==null||s.pricingBreakdown==null)&&s.pricingBreakdown.originalRate?12:-1),l(),c((m=_.availability())!=null&&m.pricingBreakdown?13:-1)}}function Yt(r,n){r&1&&(o(0,"div",33)(1,"mat-icon",77),a(2,"warning"),t(),o(3,"div",78)(4,"div",68),a(5,"Room conflicts prevent extension beyond this date"),t(),o(6,"div",79),a(7,"Please choose an earlier date or check with front desk for alternative options."),t()()())}function Zt(r,n){if(r&1&&(o(0,"div",30)(1,"div",31)(2,"mat-icon"),a(3),t(),o(4,"h4",32),a(5),t()(),d(6,Jt,14,4,"div",18),d(7,Yt,8,0,"div",33),t()),r&2){let e,i,s,m,_,b,w,O=p(2);N((e=O.availability())!=null&&e.isAvailable?"border-green-200 bg-green-50":"border-red-200 bg-red-50"),l(2),N((i=O.availability())!=null&&i.isAvailable?"text-green-600":"text-red-600"),l(),v(" ",(s=O.availability())!=null&&s.isAvailable?"check_circle":"cancel"," "),l(),N((m=O.availability())!=null&&m.isAvailable?"text-green-800":"text-red-800"),l(),v(" ",(_=O.availability())!=null&&_.isAvailable?"Extension Available":"Extension Unavailable"," "),l(),c((b=O.availability())!=null&&b.isAvailable?6:-1),l(),c(!((w=O.availability())!=null&&w.isAvailable)&&(!((w=O.availability())==null||w.conflictingReservations==null)&&w.conflictingReservations.length)?7:-1)}}function Qt(r,n){if(r&1&&(o(0,"div",18),d(1,Vt,4,0,"div",26),d(2,Zt,8,10,"div",27),t()),r&2){let e=p();l(),c(e.availabilityChecking()?1:-1),l(),c(e.availability()&&!e.availabilityChecking()?2:-1)}}function Xt(r,n){if(r&1&&(o(0,"div",20)(1,"mat-icon",80),a(2,"error"),t(),o(3,"div",81)(4,"div",68),a(5,"Extension Request Failed"),t(),o(6,"div"),a(7),t()()()),r&2){let e=p();l(7),u(e.errorMessage())}}function en(r,n){r&1&&S(0,"mat-spinner",25)}function tn(r,n){r&1&&(o(0,"span"),a(1,"Request Extension"),t())}function nn(r,n){r&1&&(o(0,"span"),a(1,"Processing..."),t())}var Ae=class r{dialogRef=D(ue);data=D(ge);fb=D(ae);reservationService=D(ve);storeStore=D(Y);extensionForm;isLoading=R(!1);availabilityChecking=R(!1);availability=R(null);errorMessage=R("");constructor(){let n=new Date(this.data.currentCheckOutDate);n.setDate(n.getDate()+1),this.extensionForm=this.fb.group({newCheckOutDate:["",[M.required]],selectedPricingStrategy:["same_rate",M.required],discountedRate:[{value:"",disabled:!0}],notes:[""]}),this.minExtensionDate=n,this.extensionForm.get("selectedPricingStrategy")?.valueChanges.subscribe(e=>{this.onPricingStrategyChange(e)})}minExtensionDate;get reservation(){return this.data.reservation}get currentCheckOutDate(){return this.data.currentCheckOutDate}get selectedStore(){return this.storeStore.selectedStore}formatCurrency(n){let i=this.selectedStore()?.currency||"USD";return`${{USD:"$",EUR:"\u20AC",GBP:"\xA3",NGN:"\u20A6",GHS:"\u20B5",KES:"KSh",ZAR:"R",CAD:"C$",AUD:"A$"}[i]||i+" "}${n.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}`}getPricingStrategyDisplayName(n){return{same_rate:"Original Booking Rate",current_rate:"Current Room Rate",extension_rate:"Extension Rate",dynamic_rate:"Dynamic Pricing",loyalty_rate:"Loyalty Rate"}[n]||n}getModifierDisplayName(n){if(n.type==="percentage"){let e=((n.value-1)*100).toFixed(0);return e>="0"?`+${e}%`:`${e}%`}else return`${n.value>0?"+":""}${this.formatCurrency(n.value)}`}onDateChange(){return h(this,null,function*(){let n=this.extensionForm.get("newCheckOutDate")?.value;yield this.checkAvailability()})}checkAvailability(){return h(this,null,function*(){let n=this.extensionForm.get("newCheckOutDate")?.value;if(n){this.availabilityChecking.set(!0),this.errorMessage.set("");try{let e=yield this.reservationService.checkExtensionAvailability(this.reservation._id,n.toISOString()).toPromise();this.availability.set(e)}catch(e){this.errorMessage.set(e.message||"Failed to check availability"),this.availability.set(null)}finally{this.availabilityChecking.set(!1)}}})}calculateEstimatedCost(n){return this.calculateNights(n)*100}calculateNights(n){let e=n.getTime()-this.currentCheckOutDate.getTime();return Math.ceil(e/(1e3*3600*24))}submitExtension(){return h(this,null,function*(){if(!this.extensionForm.valid){this.markFormGroupTouched();return}if(!this.availability()?.isAvailable){this.errorMessage.set("Extension is not available for the selected dates");return}this.isLoading.set(!0),this.errorMessage.set("");try{let e=this.extensionForm.value,i=this.calculateNights(e.newCheckOutDate),s={newCheckOutDate:e.newCheckOutDate.toISOString(),additionalNights:i,selectedPricingStrategy:e.selectedPricingStrategy,selectedRate:this.getSelectedRate(),discountedRate:e.selectedPricingStrategy==="discounted_rate"?this.getDiscountedRateValue():null,totalCost:this.getTotalCost(),notes:e.notes||""},m=yield this.reservationService.requestExtension(this.reservation._id,s).toPromise();this.dialogRef.close({success:!0,extension:m?.extension})}catch(e){this.errorMessage.set(e.message||"Failed to request extension")}finally{this.isLoading.set(!1)}})}markFormGroupTouched(){Object.keys(this.extensionForm.controls).forEach(n=>{this.extensionForm.get(n)?.markAsTouched()})}getModifierValueDisplay(n){return n.type==="percentage"?`${n.value>0?"+":""}${n.value}%`:`${n.value>0?"+":""}${this.formatCurrency(n.value)}`}getModifierValueClass(n){return n.value>0?"text-red-600 font-medium":"text-green-600 font-medium"}getModifierDescription(n){let e={seasonal:"Applied based on current season",loyalty:"Discount for loyalty program members",length_of_stay:"Discount for extended stays",last_minute:"Discount for booking within 24 hours",occupancy:"Rate adjusted based on current occupancy levels",weekend:"Additional charge for weekend stays",holiday:"Premium rate during holiday periods"};return n.description||e[n.type]||""}get rateOptions(){let n=this.availability()?.pricingBreakdown;return!n||!n.originalRate?[]:[{id:"same_rate",name:"Same Rate",description:"Continue with the original room rate",rate:n.originalRate,isRecommended:!0,badge:"ORIGINAL",savings:0},{id:"discounted_rate",name:"Discounted Rate",description:"Apply a custom discount to the original rate",rate:this.getDiscountedRateValue()||n.originalRate,isRecommended:!1,badge:null,savings:this.getDiscountAmount()}]}getDiscountedRateValue(){let n=this.extensionForm.get("discountedRate")?.value;return n?parseFloat(n):0}getDiscountAmount(){let n=this.availability()?.pricingBreakdown?.originalRate||0,e=this.getDiscountedRateValue();return e>0?Math.max(0,n-e):0}getSelectedRate(){let n=this.extensionForm.get("selectedPricingStrategy")?.value;if(n==="same_rate")return this.availability()?.pricingBreakdown?.originalRate||0;if(n==="discounted_rate"){let e=this.getDiscountedRateValue();return e>0?e:this.availability()?.pricingBreakdown?.originalRate||0}return 0}getTotalCost(){let n=this.availability()?.extensionDays||0,e=this.getSelectedRate();return n*e}getSavings(n){return n.savings||0}hasSavings(n){return(n.savings||0)>0}onPricingStrategyChange(n){let e=this.extensionForm.get("discountedRate");if(n==="discounted_rate"){e?.enable(),e?.setValidators([M.required,M.min(1)]);let i=this.availability()?.pricingBreakdown?.originalRate||0;e?.setValue(i)}else e?.disable(),e?.clearValidators(),e?.setValue("");e?.updateValueAndValidity()}validateDiscountedRate(){if(this.extensionForm.get("selectedPricingStrategy")?.value==="discounted_rate"){let e=this.availability()?.pricingBreakdown?.originalRate||0,i=this.getDiscountedRateValue();return i>0&&i<=e}return!0}onCancel(){this.dialogRef.close({success:!1})}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=V({type:r,selectors:[["app-extension-dialog"]],decls:59,vars:19,consts:[["picker",""],["mat-dialog-title","",1,"flex","items-center","gap-3","border-b","border-gray-200"],[1,"text-xl","font-semibold","text-gray-800","m-0"],[1,"text-sm","text-gray-600","m-0","mt-1"],[1,"py-6"],[1,"bg-gray-50","rounded-lg","p-4","mb-6"],[1,"text-sm","font-medium","text-gray-700","mb-3","flex","items-center","gap-2"],[1,"text-gray-600","!text-base"],[1,"grid","grid-cols-1","md:grid-cols-3","gap-4"],[1,"space-y-1"],[1,"text-xs","font-medium","text-gray-500","uppercase","tracking-wider"],[1,"text-sm","text-gray-900"],[1,"space-y-6",3,"formGroup"],[1,"space-y-2"],[1,"text-sm","font-medium","text-gray-700"],["appearance","outline",1,"w-full"],["matInput","","formControlName","newCheckOutDate","placeholder","Choose date",3,"dateChange","matDatepicker"],["matIconSuffix","",3,"for"],[1,"space-y-4"],["matInput","","formControlName","notes","rows","3","placeholder","Add any special requests or notes for the extension"],[1,"flex","items-start","gap-3","p-4","bg-red-50","border","border-red-200","rounded-md"],[1,"flex","justify-end","gap-3","pt-6","border-t","border-gray-200","mt-6"],["mat-button","","type","button",1,"px-4","py-2",3,"click","disabled"],["mat-raised-button","","color","primary","type","button",1,"px-6","py-2","min-w-[140px]",3,"click","disabled"],[1,"flex","items-center","justify-center","gap-2"],["diameter","16"],[1,"flex","items-center","justify-center","gap-3","py-8"],[1,"border","rounded-lg","p-4",3,"class"],["diameter","24"],[1,"text-sm","text-gray-600"],[1,"border","rounded-lg","p-4"],[1,"flex","items-center","gap-3","mb-4"],[1,"text-base","font-medium"],[1,"flex","items-start","gap-3","p-3","bg-amber-50","border","border-amber-200","rounded-md"],[1,"grid","grid-cols-2","gap-4","text-sm"],[1,"text-gray-900","font-semibold"],[1,"space-y-4","border-t","pt-4"],[1,"bg-white","rounded-md","p-4","border","border-gray-200"],[1,"flex","items-center","justify-between"],[1,"text-xs","text-gray-500"],["formControlName","selectedPricingStrategy",1,"space-y-3"],[1,"relative"],["value","same_rate",1,"w-full","block","p-4","border","border-blue-200","bg-blue-50","rounded-lg","hover:bg-blue-100","transition-colors"],[1,"absolute","top-2","right-2","px-2","py-1","text-xs","font-bold","rounded-full","bg-blue-100","text-blue-800"],[1,"flex","items-start","justify-between","mt-1"],[1,"flex-1","min-w-0","pr-4"],[1,"text-sm","font-semibold","text-blue-900"],[1,"text-xs","mt-1","text-blue-700"],[1,"text-right"],[1,"text-lg","font-bold","text-blue-600"],["value","discounted_rate",1,"w-full","block","p-4","border","border-green-200","bg-green-50","rounded-lg","hover:bg-green-100","transition-colors"],[1,"text-sm","font-semibold","text-green-900"],[1,"text-xs","mt-1","text-green-700"],[1,"inline-flex","items-center","mt-2","px-2","py-1","bg-green-100","text-green-800","text-xs","font-medium","rounded-full"],[1,"text-lg","font-bold","text-green-600"],[1,"mt-4"],[1,"bg-gray-100","rounded-lg","p-4","mt-4"],[1,"flex","justify-between","items-center"],[1,"text-xs","text-green-600","font-medium","mt-1"],[1,"text-xl","font-bold","text-blue-600"],[1,"!text-xs","mr-1"],["matInput","","type","number","min","1","step","0.01","formControlName","discountedRate","placeholder","Enter discounted rate",3,"max"],["matTextPrefix",""],[1,"text-sm","font-medium","text-gray-900","mb-3","flex","items-center","gap-2"],[1,"!text-base","text-blue-600"],[1,"space-y-2","text-sm"],[1,"flex","justify-between"],[1,"text-gray-600"],[1,"font-medium"],[1,"border-t","pt-2","mt-3"],[1,"flex","justify-between","font-semibold"],[1,"text-blue-600"],[1,"bg-blue-50","rounded","p-2","mt-3"],[1,"font-semibold","text-blue-900"],[1,"text-lg","font-bold","text-blue-700"],[1,"text-xs","font-medium","text-gray-500","mt-2","mb-1"],[1,"flex","justify-between","text-xs"],[1,"text-amber-600","!text-base","mt-0.5"],[1,"text-sm","text-amber-800"],[1,"text-xs","mt-1"],[1,"text-red-600","!text-base","mt-0.5"],[1,"text-sm","text-red-800"]],template:function(e,i){if(e&1){let s=P();o(0,"div",1)(1,"div")(2,"span",2),a(3,"Extend Reservation"),t(),o(4,"p",3),a(5),t()()(),o(6,"mat-dialog-content",4)(7,"div",5)(8,"h3",6)(9,"mat-icon",7),a(10,"info"),t(),a(11," Current Reservation Details "),t(),o(12,"div",8)(13,"div",9)(14,"div",10),a(15,"Check-out Date"),t(),o(16,"div",11),a(17),x(18,"date"),t()(),o(19,"div",9)(20,"div",10),a(21,"Room(s)"),t(),o(22,"div",11),a(23),t()(),o(24,"div",9)(25,"div",10),a(26,"Confirmation"),t(),o(27,"div",11),a(28),t()()()(),o(29,"form",12)(30,"div",13)(31,"label",14),a(32,"New Check-out Date"),t(),o(33,"mat-form-field",15)(34,"mat-label"),a(35,"Select new check-out date"),t(),o(36,"input",16),C("dateChange",function(){return y(s),E(i.onDateChange())}),t(),S(37,"mat-datepicker-toggle",17)(38,"mat-datepicker",null,0),d(40,Nt,2,0,"mat-error"),t()(),d(41,Qt,3,2,"div",18),o(42,"div",13)(43,"label",14),a(44,"Notes (Optional)"),t(),o(45,"mat-form-field",15)(46,"mat-label"),a(47,"Special requests or notes"),t(),o(48,"textarea",19),a(49,"        "),t()()(),d(50,Xt,8,1,"div",20),t()(),o(51,"mat-dialog-actions",21)(52,"button",22),C("click",function(){return y(s),E(i.onCancel())}),a(53," Cancel "),t(),o(54,"button",23),C("click",function(){return y(s),E(i.submitExtension())}),o(55,"div",24),d(56,en,1,0,"mat-spinner",25),d(57,tn,2,0,"span"),d(58,nn,2,0,"span"),t()()()}if(e&2){let s,m,_,b=U(39);l(5),H(" Request extension for ",i.reservation==null||i.reservation.guestDetails==null||i.reservation.guestDetails.primaryGuest==null?null:i.reservation.guestDetails.primaryGuest.firstName," ",i.reservation==null||i.reservation.guestDetails==null||i.reservation.guestDetails.primaryGuest==null?null:i.reservation.guestDetails.primaryGuest.lastName," "),l(12),u(k(18,16,i.currentCheckOutDate,"mediumDate")),l(6),v("",i.reservation==null||i.reservation.rooms==null?null:i.reservation.rooms.length," room(s)"),l(5),u(i.reservation==null?null:i.reservation.confirmationNumber),l(),f("formGroup",i.extensionForm),l(7),f("matDatepicker",b),l(),f("for",b),l(3),c((s=i.extensionForm.get("newCheckOutDate"))!=null&&s.hasError("required")?40:-1),l(),c((m=i.extensionForm.get("newCheckOutDate"))!=null&&m.value?41:-1),l(9),c(i.errorMessage()?50:-1),l(2),f("disabled",i.isLoading()),l(2),f("disabled",!i.extensionForm.valid||!((_=i.availability())!=null&&_.isAvailable)||i.isLoading()),l(2),c(i.isLoading()?56:-1),l(),c(i.isLoading()?-1:57),l(),c(i.isLoading()?58:-1)}},dependencies:[j,st,ee,Z,te,Q,X,oe,ye,re,ie,ne,W,Re,Oe,we,z,de,le,se,dt,Ee,Se,me,ce,$,J,_t,gt,vt,xt,tt,ke,De,L,q,be,pe,St,yt,Et,Ze],styles:[".mat-mdc-dialog-container[_ngcontent-%COMP%]{--mdc-dialog-container-color: white;--mdc-dialog-supporting-text-color: #374151}.mat-mdc-radio-button.mat-mdc-radio-checked[_ngcontent-%COMP%]   .mdc-radio__native-control[_ngcontent-%COMP%]:enabled:checked + .mdc-radio__background[_ngcontent-%COMP%]   .mdc-radio__outer-circle[_ngcontent-%COMP%]{border-color:#2563eb}.mat-mdc-radio-button.mat-mdc-radio-checked[_ngcontent-%COMP%]   .mdc-radio__background[_ngcontent-%COMP%]   .mdc-radio__inner-circle[_ngcontent-%COMP%]{border-color:#2563eb;background-color:#2563eb}.mat-mdc-radio-button[_ngcontent-%COMP%]:hover   .mdc-radio__native-control[_ngcontent-%COMP%]:enabled:not(:checked) + .mdc-radio__background[_ngcontent-%COMP%]   .mdc-radio__outer-circle[_ngcontent-%COMP%]{border-color:#3b82f6}.mat-mdc-form-field.mat-form-field-appearance-outline[_ngcontent-%COMP%]   .mat-mdc-text-field-wrapper[_ngcontent-%COMP%]   .mat-mdc-form-field-flex[_ngcontent-%COMP%]   .mat-mdc-form-field-infix[_ngcontent-%COMP%]{padding:12px 0}@media(max-width:640px){.mat-mdc-dialog-container[_ngcontent-%COMP%]{margin:16px;width:calc(100vw - 32px);max-width:none}}"]})};function an(r,n){if(r&1&&(o(0,"mat-form-field",7)(1,"mat-label"),a(2,"Service Fee"),t(),S(3,"input",46),o(4,"span",9),a(5),t()()),r&2){let e=p(2);l(5),v("",e.currency,"\xA0")}}function rn(r,n){if(r&1&&(o(0,"mat-form-field",7)(1,"mat-label"),a(2,"Cleaning Fee"),t(),S(3,"input",47),o(4,"span",9),a(5),t()()),r&2){let e=p(2);l(5),v("",e.currency,"\xA0")}}function ln(r,n){if(r&1&&(o(0,"mat-form-field",7)(1,"mat-label"),a(2,"Resort Fee"),t(),S(3,"input",48),o(4,"span",9),a(5),t()()),r&2){let e=p(2);l(5),v("",e.currency,"\xA0")}}function sn(r,n){if(r&1&&(o(0,"mat-form-field",7)(1,"mat-label"),a(2,"Other Fees"),t(),S(3,"input",49),o(4,"span",9),a(5),t()()),r&2){let e=p(2);l(5),v("",e.currency,"\xA0")}}function dn(r,n){if(r&1&&(o(0,"div",11)(1,"h4",4)(2,"mat-icon",5),a(3,"lock"),t(),a(4," Additional Fees (Read-only) "),t(),o(5,"div",6),d(6,an,6,1,"mat-form-field",7),d(7,rn,6,1,"mat-form-field",7),d(8,ln,6,1,"mat-form-field",7),d(9,sn,6,1,"mat-form-field",7),t()()),r&2){let e=p();l(6),c(e.data.reservation.pricing.fees.serviceFee?6:-1),l(),c(e.data.reservation.pricing.fees.cleaningFee?7:-1),l(),c(e.data.reservation.pricing.fees.resortFee?8:-1),l(),c(e.data.reservation.pricing.fees.other?9:-1)}}function cn(r,n){if(r&1&&(o(0,"div",12)(1,"h4",50)(2,"mat-icon",51),a(3,"lock"),t(),a(4," Extension Charges (Read-only) "),t(),o(5,"div",6)(6,"mat-form-field",7)(7,"mat-label"),a(8,"Extension Cost"),t(),S(9,"input",52),o(10,"span",9),a(11),t(),o(12,"mat-hint"),a(13),t()(),o(14,"div",25)(15,"div",53),a(16,"Extension Status"),t(),o(17,"div",45)(18,"mat-icon",54),a(19,"check_circle"),t(),o(20,"span",55),a(21,"Approved & Included"),t()(),o(22,"div",56),a(23," Cannot be modified in pricing dialog "),t()()(),o(24,"div",57)(25,"div",45)(26,"mat-icon",58),a(27,"info"),t(),o(28,"span")(29,"strong"),a(30),t(),a(31," totaling "),o(32,"strong"),a(33),x(34,"currency"),t(),a(35," have been approved and are automatically included in the total. "),t()()()()),r&2){let e=p();l(9),f("value",e.getApprovedExtensionCost()),l(2),v("",e.currency,"\xA0"),l(2),v("",e.getApprovedExtensionNights()," additional nights"),l(17),v("",e.getApprovedExtensionNights()," extension night(s)"),l(3),u(I(34,5,e.getApprovedExtensionCost(),e.currency,"symbol","1.2-2"))}}function mn(r,n){if(r&1&&(o(0,"div",32)(1,"span",33),a(2),t(),o(3,"span",59),a(4),x(5,"currency"),t()()),r&2){let e=p();l(2),v("Extensions (",e.getApprovedExtensionNights()," nights):"),l(2),v("+",I(5,2,e.getApprovedExtensionCost(),e.currency,"symbol","1.2-2"))}}function pn(r,n){r&1&&(o(0,"span",45),ze(),o(1,"svg",60),S(2,"circle",61)(3,"path",62),t(),a(4," Updating... "),t())}function un(r,n){r&1&&(o(0,"span",45)(1,"mat-icon"),a(2,"save"),t(),a(3," Update Pricing "),t())}var Be=class r{constructor(n){this.data=n;if(this.data.reservation.status==="checked_out"){this.pricingForm=this.fb.group({}),setTimeout(()=>{this.dialogRef.close({confirmed:!1,error:"Cannot edit pricing for checked-out reservations"})});return}let e=this.data.reservation.pricing;this.pricingForm=this.fb.group({subtotal:[{value:e.subtotal||0,disabled:!0}],taxes:[{value:e.taxes||0,disabled:!0}],fees:this.fb.group({serviceFee:[{value:e.fees?.serviceFee||0,disabled:!0}],cleaningFee:[{value:e.fees?.cleaningFee||0,disabled:!0}],resortFee:[{value:e.fees?.resortFee||0,disabled:!0}],other:[{value:e.fees?.other||0,disabled:!0}]}),paid:[e.paid||0,[M.min(0)]]}),this.pricingForm.valueChanges.subscribe(()=>{this.calculateTotal()})}fb=D(ae);dialogRef=D(ue);reservationService=D(ve);storeStore=D(Y);snackBar=D(he);pricingForm;loading=R(!1);get currency(){return this.storeStore.selectedStore()?.currency||this.storeStore.selectedStore()?.currencyCode||"USD"}getApprovedExtensionCost(){return this.data.reservation.extensions?this.data.reservation.extensions.filter(e=>e.status==="approved").reduce((e,i)=>e+(i.additionalCost||0),0):0}getApprovedExtensionNights(){return this.data.reservation.extensions?this.data.reservation.extensions.filter(e=>e.status==="approved").reduce((e,i)=>e+(i.additionalNights||0),0):0}hasApprovedExtensions(){return this.getApprovedExtensionCost()>0}get currentTotal(){let n=this.data.reservation.pricing,e=this.pricingForm.value,i=n.subtotal||0,s=n.taxes||0,m=n.fees?.serviceFee||0,_=n.fees?.cleaningFee||0,b=n.fees?.resortFee||0,w=n.fees?.other||0,O=this.getApprovedExtensionCost(),fe=e.discounts?.amount||0,g=m+_+b+w;return i+s+g+O-fe}get currentBalance(){let n=this.pricingForm.get("paid")?.value||0;return this.currentTotal-n}calculateTotal(){}onCancel(){this.dialogRef.close({success:!1})}onSave(){if(this.pricingForm.invalid){this.snackBar.open("Please fill in all required fields correctly","Close",{duration:3e3,panelClass:["error-snackbar"]});return}this.loading.set(!0);let n=this.pricingForm.value,e=this.data.reservation.pricing,i={subtotal:e.subtotal,taxes:e.taxes,fees:{serviceFee:e.fees?.serviceFee||0,cleaningFee:e.fees?.cleaningFee||0,resortFee:e.fees?.resortFee||0,other:e.fees?.other||0},discounts:{amount:n.discounts.amount,reason:n.discounts.reason,code:n.discounts.code},total:this.currentTotal,paid:n.paid||0,balance:this.currentBalance}}static \u0275fac=function(e){return new(e||r)(We(ge))};static \u0275cmp=V({type:r,selectors:[["app-pricing-update-dialog"]],decls:149,vars:86,consts:[["mat-dialog-title",""],["mat-dialog-content","",1,"!p-6","!max-h-[70vh]","overflow-y-auto"],[1,"space-y-6",3,"formGroup"],[1,"bg-gray-50","rounded-lg","p-4","border","border-gray-200","mb-6","shadow-sm"],[1,"text-sm","font-semibold","text-gray-700","mb-3","flex","items-center","gap-2","uppercase","tracking-wide"],[1,"text-gray-500","text-lg"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4"],["appearance","outline",1,"w-full"],["matInput","","type","number","formControlName","subtotal","readonly","",1,"!bg-gray-100","!text-gray-600"],["matPrefix",""],["matInput","","type","number","formControlName","taxes","readonly","",1,"!bg-gray-100","!text-gray-600"],["formGroupName","fees",1,"bg-gray-50","rounded-lg","p-4","border","border-gray-200","mb-6","shadow-sm"],[1,"bg-orange-50","rounded-lg","p-4","border","border-orange-200","mb-6","shadow-sm"],[1,"space-y-6"],["formGroupName","discounts",1,"bg-green-50","rounded-lg","p-4","border","border-green-200","shadow-sm","hover:shadow-md","transition-shadow","duration-200"],[1,"text-lg","font-semibold","text-green-900","mb-3","flex","items-center","gap-2","uppercase","tracking-wide"],[1,"text-green-600"],[1,"grid","grid-cols-1","md:grid-cols-3","gap-4"],["matInput","","type","number","formControlName","amount","min","0","step","0.01","placeholder","0.00"],["matInput","","formControlName","reason","placeholder","e.g., Staff discount"],["matInput","","formControlName","code","placeholder","e.g., STAFF10"],[1,"bg-blue-50","rounded-lg","p-4","border","border-blue-200","shadow-sm","hover:shadow-md","transition-shadow","duration-200"],[1,"text-lg","font-semibold","text-blue-900","mb-3","flex","items-center","gap-2","uppercase","tracking-wide"],[1,"text-blue-600"],["matInput","","type","number","formControlName","paid","min","0","step","0.01","placeholder","0.00"],[1,"flex","flex-col","justify-center"],[1,"text-sm","text-gray-600","mb-1"],[1,"text-lg","font-medium"],[1,"bg-gradient-to-br","from-purple-50","to-indigo-50","rounded-lg","p-4","border","border-purple-200","shadow-sm"],[1,"text-lg","font-semibold","text-purple-900","mb-3","flex","items-center","gap-2","uppercase","tracking-wide"],[1,"text-purple-600"],[1,"space-y-2","text-sm"],[1,"flex","justify-between"],[1,"text-gray-600"],[1,"font-medium"],[1,"font-medium","text-green-600"],[1,"my-2"],[1,"flex","justify-between","text-lg","font-semibold"],[1,"text-gray-900"],[1,"bg-gradient-to-br","from-blue-50","to-cyan-50","rounded-lg","p-4","border","border-blue-200","shadow-sm"],[1,"text-sm","font-semibold","text-blue-900","mb-2","uppercase","tracking-wide"],[1,"text-xs","text-blue-800","space-y-1"],["mat-dialog-actions","",1,"flex","items-center","justify-end","gap-3","!p-6","!m-0","border-t","border-gray-200","bg-gray-50"],["mat-button","",1,"!text-gray-600","hover:!bg-gray-100","!px-6","!py-2","!font-medium","!rounded-lg","transition-colors","duration-200",3,"click","disabled"],["mat-raised-button","","color","primary",1,"!bg-gradient-to-r","!from-purple-600","!to-purple-700","hover:!from-purple-700","hover:!to-purple-800","!text-white","!shadow-lg","hover:!shadow-xl","!px-6","!py-2","!font-semibold","!rounded-lg","transition-all","duration-200","transform","hover:!scale-105","disabled:!opacity-50","disabled:!cursor-not-allowed","disabled:hover:!scale-100",3,"click","disabled"],[1,"flex","items-center","gap-2"],["matInput","","type","number","formControlName","serviceFee","readonly","",1,"!bg-gray-100","!text-gray-600"],["matInput","","type","number","formControlName","cleaningFee","readonly","",1,"!bg-gray-100","!text-gray-600"],["matInput","","type","number","formControlName","resortFee","readonly","",1,"!bg-gray-100","!text-gray-600"],["matInput","","type","number","formControlName","other","readonly","",1,"!bg-gray-100","!text-gray-600"],[1,"text-sm","font-semibold","text-orange-700","mb-3","flex","items-center","gap-2","uppercase","tracking-wide"],[1,"text-orange-500","text-lg"],["matInput","","type","number","readonly","",1,"!bg-gray-100","!text-gray-600",3,"value"],[1,"text-sm","text-orange-600","mb-1"],[1,"text-green-600","text-sm"],[1,"text-sm","font-medium","text-green-600"],[1,"text-xs","text-gray-500","mt-1"],[1,"mt-3","p-2","bg-orange-100","border","border-orange-200","rounded","text-xs","text-orange-800"],[1,"text-orange-600","text-sm"],[1,"font-medium","text-orange-600"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24",1,"animate-spin","-ml-1","mr-3","h-4","w-4","text-white"],["cx","12","cy","12","r","10","stroke","currentColor","stroke-width","4",1,"opacity-25"],["fill","currentColor","d","M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z",1,"opacity-75"]],template:function(e,i){if(e&1&&(o(0,"div",0),a(1,` Update Pricing
`),t(),o(2,"div",1)(3,"form",2)(4,"div",3)(5,"h4",4)(6,"mat-icon",5),a(7,"lock"),t(),a(8," Base Pricing (Read-only) "),t(),o(9,"div",6)(10,"mat-form-field",7)(11,"mat-label"),a(12,"Subtotal"),t(),S(13,"input",8),o(14,"span",9),a(15),t(),o(16,"mat-hint"),a(17,"Based on room rates and duration"),t()(),o(18,"mat-form-field",7)(19,"mat-label"),a(20,"Taxes"),t(),S(21,"input",10),o(22,"span",9),a(23),t(),o(24,"mat-hint"),a(25,"Calculated from store tax rate"),t()()()(),d(26,dn,10,4,"div",11),d(27,cn,36,10,"div",12),o(28,"div",13)(29,"div",14)(30,"h4",15)(31,"mat-icon",16),a(32,"local_offer"),t(),a(33," Discounts (Editable) "),t(),o(34,"div",17)(35,"mat-form-field",7)(36,"mat-label"),a(37,"Discount Amount"),t(),S(38,"input",18),o(39,"span",9),a(40),t(),o(41,"mat-hint"),a(42,"Reduce total amount"),t()(),o(43,"mat-form-field",7)(44,"mat-label"),a(45,"Discount Reason"),t(),S(46,"input",19),t(),o(47,"mat-form-field",7)(48,"mat-label"),a(49,"Discount Code"),t(),S(50,"input",20),t()()(),o(51,"div",21)(52,"h4",22)(53,"mat-icon",23),a(54,"payment"),t(),a(55," Payment Amount (Editable) "),t(),o(56,"div",6)(57,"mat-form-field",7)(58,"mat-label"),a(59,"Amount Paid"),t(),S(60,"input",24),o(61,"span",9),a(62),t(),o(63,"mat-hint"),a(64,"Total amount received from guest"),t()(),o(65,"div",25)(66,"div",26),a(67,"Current Status"),t(),o(68,"div",27),a(69),x(70,"titlecase"),t()()()()(),o(71,"div",28)(72,"h4",29)(73,"mat-icon",30),a(74,"calculate"),t(),a(75," Updated Summary "),t(),o(76,"div",31)(77,"div",32)(78,"span",33),a(79,"Subtotal:"),t(),o(80,"span",34),a(81),x(82,"currency"),t()(),o(83,"div",32)(84,"span",33),a(85,"Taxes:"),t(),o(86,"span",34),a(87),x(88,"currency"),t()(),o(89,"div",32)(90,"span",33),a(91,"Total Fees:"),t(),o(92,"span",34),a(93),x(94,"currency"),t()(),d(95,mn,6,7,"div",32),o(96,"div",32)(97,"span",33),a(98,"Discount:"),t(),o(99,"span",35),a(100),x(101,"currency"),t()(),S(102,"mat-divider",36),o(103,"div",37)(104,"span",38),a(105,"New Total:"),t(),o(106,"span",38),a(107),x(108,"currency"),t()(),o(109,"div",32)(110,"span",33),a(111,"Amount Paid:"),t(),o(112,"span",35),a(113),x(114,"currency"),t()(),o(115,"div",37)(116,"span"),a(117,"New Balance:"),t(),o(118,"span"),a(119),x(120,"currency"),t()()()(),o(121,"div",39)(122,"h4",40),a(123,"Original Pricing (for reference)"),t(),o(124,"div",41)(125,"div",32)(126,"span"),a(127,"Original Total:"),t(),o(128,"span"),a(129),x(130,"currency"),t()(),o(131,"div",32)(132,"span"),a(133,"Original Balance:"),t(),o(134,"span"),a(135),x(136,"currency"),t()(),o(137,"div",32)(138,"span"),a(139,"Original Amount Paid:"),t(),o(140,"span"),a(141),x(142,"currency"),t()()()()()(),o(143,"div",42)(144,"button",43),C("click",function(){return i.onCancel()}),a(145," Cancel "),t(),o(146,"button",44),C("click",function(){return i.onSave()}),d(147,pn,5,0,"span",45)(148,un,4,0,"span",45),t()()),e&2){let s,m,_,b,w;l(3),f("formGroup",i.pricingForm),l(12),v("",i.currency,"\xA0"),l(8),v("",i.currency,"\xA0"),l(3),c(i.data.reservation.pricing.fees&&(i.data.reservation.pricing.fees.serviceFee||i.data.reservation.pricing.fees.cleaningFee||i.data.reservation.pricing.fees.resortFee||i.data.reservation.pricing.fees.other)?26:-1),l(),c(i.hasApprovedExtensions()?27:-1),l(13),v("",i.currency,"\xA0"),l(22),v("",i.currency,"\xA0"),l(6),G("text-green-600",(i.data.reservation.paymentInfo==null?null:i.data.reservation.paymentInfo.status)==="paid")("text-orange-600",(i.data.reservation.paymentInfo==null?null:i.data.reservation.paymentInfo.status)==="partial")("text-gray-600",(i.data.reservation.paymentInfo==null?null:i.data.reservation.paymentInfo.status)==="pending"),l(),v(" ",F(70,34,(i.data.reservation.paymentInfo==null?null:i.data.reservation.paymentInfo.status)||"pending")," "),l(12),u(I(82,36,(s=i.pricingForm.get("subtotal"))==null?null:s.value,i.currency,"symbol","1.2-2")),l(6),u(I(88,41,(m=i.pricingForm.get("taxes"))==null?null:m.value,i.currency,"symbol","1.2-2")),l(6),u(I(94,46,(((_=i.pricingForm.get("fees.serviceFee"))==null?null:_.value)||0)+(((_=i.pricingForm.get("fees.cleaningFee"))==null?null:_.value)||0)+(((_=i.pricingForm.get("fees.resortFee"))==null?null:_.value)||0)+(((_=i.pricingForm.get("fees.other"))==null?null:_.value)||0),i.currency,"symbol","1.2-2")),l(2),c(i.hasApprovedExtensions()?95:-1),l(5),v("-",I(101,51,(b=i.pricingForm.get("discounts.amount"))==null?null:b.value,i.currency,"symbol","1.2-2")),l(7),u(I(108,56,i.currentTotal,i.currency,"symbol","1.2-2")),l(6),u(I(114,61,(w=i.pricingForm.get("paid"))==null?null:w.value,i.currency,"symbol","1.2-2")),l(2),G("text-red-600",i.currentBalance>0)("text-green-600",i.currentBalance<0)("text-gray-900",i.currentBalance===0),l(4),u(I(120,66,i.currentBalance,i.currency,"symbol","1.2-2")),l(10),u(I(130,71,i.data.reservation.pricing.total,i.currency,"symbol","1.2-2")),l(6),u(I(136,76,i.data.reservation.pricing.balance,i.currency,"symbol","1.2-2")),l(6),u(I(142,81,i.data.reservation.pricing.paid,i.currency,"symbol","1.2-2")),l(3),f("disabled",i.loading()),l(2),f("disabled",i.loading()||i.pricingForm.invalid),l(),c(i.loading()?147:148)}},dependencies:[j,re,ee,Z,te,Q,X,oe,ie,ne,lt,W,Re,Oe,we,$,J,me,ce,de,le,se,Ee,z,L,q,pe,Me,Ce,K],styles:["[_nghost-%COMP%]{display:block}.mat-mdc-dialog-container[_ngcontent-%COMP%]{max-width:90vw;max-height:90vh;overflow:visible}.mat-mdc-dialog-title[_ngcontent-%COMP%]{border-bottom:1px solid #e5e7eb;background-color:#f9fafb}.mat-mdc-dialog-content[_ngcontent-%COMP%]{background-color:#fff}.mat-mdc-dialog-actions[_ngcontent-%COMP%]{border-top:1px solid #e5e7eb;background-color:#f9fafb}.mat-mdc-form-field[_ngcontent-%COMP%]{width:100%}.mat-mdc-form-field[_ngcontent-%COMP%]   .mat-mdc-form-field-wrapper[_ngcontent-%COMP%]{padding-bottom:0}.pricing-summary[_ngcontent-%COMP%]{background-color:#f8fafc;border:1px solid #e2e8f0;border-radius:.5rem;padding:1rem}.pricing-summary[_ngcontent-%COMP%]   .summary-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:.5rem}.pricing-summary[_ngcontent-%COMP%]   .summary-row[_ngcontent-%COMP%]:last-child{margin-bottom:0}.pricing-summary[_ngcontent-%COMP%]   .summary-row.total-row[_ngcontent-%COMP%]{font-weight:600;font-size:1.125rem;border-top:2px solid #cbd5e1;padding-top:.75rem;margin-top:.75rem}.reference-pricing[_ngcontent-%COMP%]{background-color:#f0f9ff;border:1px solid #bae6fd;border-radius:.5rem;padding:1rem;font-size:.875rem}.loading-spinner[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:.5rem}.loading-spinner[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:1rem;height:1rem}.mat-mdc-raised-button.mat-primary[_ngcontent-%COMP%]{background-color:#7c3aed!important}.mat-mdc-raised-button.mat-primary[_ngcontent-%COMP%]:hover{background-color:#6d28d9!important}.mat-mdc-raised-button.mat-primary[_ngcontent-%COMP%]:disabled{background-color:#9ca3af!important;color:#6b7280!important}.mat-mdc-form-field.mat-form-field-invalid[_ngcontent-%COMP%]   .mat-mdc-text-field-wrapper[_ngcontent-%COMP%]{border-color:#ef4444}@media(max-width:768px){.grid-cols-2[_ngcontent-%COMP%], .grid-cols-3[_ngcontent-%COMP%]{grid-template-columns:1fr}.mat-mdc-dialog-container[_ngcontent-%COMP%]{margin:1rem;max-width:calc(100vw - 2rem)}}"]})};var gn=(r,n,e)=>({"bg-yellow-100 text-yellow-700 border-yellow-200":r,"bg-green-100 text-green-700 border-green-200":n,"bg-red-100 text-red-700 border-red-200":e}),vn=(r,n,e)=>({"bg-green-100 text-green-800":r,"bg-yellow-100 text-yellow-800":n,"bg-red-100 text-red-800":e}),wt=(r,n)=>n.value,xn=(r,n)=>n._id||r;function _n(r,n){if(r&1&&(o(0,"h1",40),a(1," Reservation Details "),t(),o(2,"p",41),a(3),t()),r&2){let e=p();l(3),v("Confirmation: ",e.reservation().confirmationNumber)}}function fn(r,n){r&1&&(o(0,"h1",40),a(1,"Reservation Details"),t(),o(2,"p",41),a(3,"Loading reservation information..."),t())}function Cn(r,n){r&1&&(o(0,"mat-icon",44),a(1,"refresh"),t())}function hn(r,n){if(r&1&&(o(0,"mat-icon",53),a(1),t()),r&2){let e=p(2);_e("color",e.getStatusColor(e.reservation().status)),l(),u(e.getStatusIcon(e.reservation().status))}}function bn(r,n){r&1&&(o(0,"div",24),a(1," No status changes available "),t())}function yn(r,n){if(r&1){let e=P();o(0,"button",54),C("click",function(){let s=y(e).$implicit,m=p(2);return E(m.updateReservationStatus(s.value))}),o(1,"mat-icon",55),a(2),t(),o(3,"span"),a(4),t()()}if(r&2){let e=n.$implicit;l(),_e("color",e.color),l(),u(e.icon),l(2),u(e.label)}}function En(r,n){r&1&&(o(0,"div",48),a(1," \u{1F4A1} Confirm reservation before check-in "),t())}function Sn(r,n){r&1&&(o(0,"div",49),a(1," \u{1F4A1} Ready for check-in "),t())}function Dn(r,n){if(r&1){let e=P();o(0,"button",56),C("click",function(){y(e);let s=p(2);return E(s.editReservation())}),o(1,"mat-icon",57),a(2,"edit"),t(),a(3," Edit Reservation "),t()}}function kn(r,n){if(r&1){let e=P();o(0,"button",58),C("click",function(){y(e);let s=p(2);return E(s.requestExtension())}),o(1,"mat-icon",57),a(2,"schedule"),t(),a(3," Extend Stay "),t()}if(r&2){let e=p(2);f("disabled",e.statusUpdating())}}function Pn(r,n){if(r&1&&(o(0,"div",10)(1,"div",42)(2,"button",43),d(3,Cn,2,0,"mat-icon",44)(4,hn,2,3,"mat-icon",45),a(5),x(6,"titlecase"),o(7,"mat-icon",46),a(8,"expand_more"),t()(),o(9,"mat-menu",13,4)(11,"div",22),a(12," Change Status "),t(),d(13,bn,2,0,"div",24),A(14,yn,5,4,"button",47,wt),d(16,En,2,0,"div",48),d(17,Sn,2,0,"div",49),t()(),d(18,Dn,4,0,"button",50),d(19,kn,4,1,"button",51),o(20,"button",52)(21,"mat-icon"),a(22,"more_vert"),t()()()),r&2){let e=U(10),i=p(),s=U(15);l(2),_e("background-color",i.getStatusColor(i.reservation().status)+"20")("color",i.getStatusColor(i.reservation().status))("border-color",i.getStatusColor(i.reservation().status)+"40"),f("matMenuTriggerFor",e)("disabled",i.statusUpdating()),l(),c(i.statusUpdating()?3:4),l(2),v(" ",F(6,16,i.reservation().status)," "),l(8),c(i.getAvailableStatusOptions().length===0?13:-1),l(),B(i.getAvailableStatusOptions()),l(2),c(i.reservation()&&i.reservation().status==="pending"?16:-1),l(),c(i.reservation()&&i.reservation().status==="confirmed"?17:-1),l(),c(i.canEdit()?18:-1),l(),c(i.canRequestExtension()?19:-1),l(),f("matMenuTriggerFor",s)}}function Mn(r,n){r&1&&(o(0,"div",11),S(1,"mat-spinner",59),o(2,"span",60),a(3,"Loading reservation details..."),t()())}function Rn(r,n){if(r&1){let e=P();o(0,"div",12)(1,"div",61)(2,"div",62)(3,"mat-icon",63),a(4,"error_outline"),t()(),o(5,"h3",64),a(6,"Failed to Load Reservation"),t(),o(7,"p",65),a(8),t(),o(9,"button",66),C("click",function(){y(e);let s=p();return E(s.goBack())}),a(10," Back to Reservations "),t()()()}if(r&2){let e=p();l(8),u(e.error())}}function wn(r,n){if(r&1&&(o(0,"div"),a(1),t()),r&2){let e=n.$implicit,i=p(3);l(),Ke("",i.getGuestName(e.guest),": ",e.totalAdults," Adults, ",e.totalChildren," Children")}}function On(r,n){if(r&1&&A(0,wn,2,3,"div",null,xe),r&2){let e=p(2);B(e.reservation().additionalGuests)}}function In(r,n){r&1&&(o(0,"div"),a(1,"No additional guests"),t())}function Tn(r,n){if(r&1&&(o(0,"div",41),a(1),t()),r&2){let e=p(2);l(),v("Expected: ",e.reservation().expectedCheckInTime)}}function Fn(r,n){if(r&1&&(o(0,"div",41),a(1),t()),r&2){let e=p(2);l(),v("Expected: ",e.reservation().expectedCheckOutTime)}}function An(r,n){if(r&1&&(o(0,"div",117)(1,"label",75),a(2,"Notes"),t(),o(3,"div",120),a(4),t()()),r&2){let e=p().$implicit;l(4),u(e.notes)}}function Bn(r,n){r&1&&(o(0,"mat-icon",44),a(1,"refresh"),t())}function Nn(r,n){r&1&&(o(0,"mat-icon",53),a(1,"check_circle"),t())}function Vn(r,n){r&1&&(o(0,"mat-icon",44),a(1,"refresh"),t())}function Un(r,n){r&1&&(o(0,"mat-icon",53),a(1,"cancel"),t())}function Gn(r,n){if(r&1){let e=P();o(0,"div",118)(1,"button",121),C("click",function(){y(e);let s=p().$implicit,m=p(3);return E(m.approveExtension(s._id))}),d(2,Bn,2,0,"mat-icon",44)(3,Nn,2,0,"mat-icon",53),a(4," Approve Extension "),t(),o(5,"button",122),C("click",function(){y(e);let s=p().$implicit,m=p(3);return E(m.rejectExtension(s._id))}),d(6,Vn,2,0,"mat-icon",44)(7,Un,2,0,"mat-icon",53),a(8," Reject Extension "),t()()}if(r&2){let e=p().$implicit,i=p(3);l(),f("disabled",i.processingExtension()===e._id),l(),c(i.processingExtension()===e._id&&i.processingAction()==="approve"?2:3),l(3),f("disabled",i.processingExtension()===e._id),l(),c(i.processingExtension()===e._id&&i.processingAction()==="reject"?6:7)}}function jn(r,n){if(r&1&&(o(0,"div")(1,"span",93),a(2,"Reference:"),t(),o(3,"span",130),a(4),t()()),r&2){let e=p(3).$implicit;l(4),u(e.paymentInfo.transactionReference)}}function $n(r,n){if(r&1&&(o(0,"div",129)(1,"span",131),a(2,"Payment Notes:"),t(),o(3,"div",132),a(4),t()()),r&2){let e=p(3).$implicit;l(4),u(e.paymentInfo.notes)}}function qn(r,n){if(r&1&&(o(0,"div",124)(1,"div",125)(2,"mat-icon",53),a(3,"payment"),t(),o(4,"span",99),a(5,"Payment Information"),t()(),o(6,"div",126)(7,"div")(8,"span",93),a(9,"Status:"),t(),o(10,"span",127),a(11),x(12,"titlecase"),t()(),o(13,"div")(14,"span",93),a(15,"Method:"),t(),o(16,"span",128),a(17),x(18,"titlecase"),t()(),o(19,"div")(20,"span",93),a(21,"Amount:"),t(),o(22,"span",128),a(23),x(24,"currency"),t()(),d(25,jn,5,1,"div"),t(),d(26,$n,5,1,"div",129),t()),r&2){let e,i=p(2).$implicit,s=p(3);l(10),f("ngClass",Ne(13,vn,i.paymentInfo.status==="paid",i.paymentInfo.status==="partial",i.paymentInfo.status==="pending")),l(),v(" ",F(12,6,i.paymentInfo.status)," "),l(6),u(F(18,8,i.paymentInfo.method)),l(6),u(k(24,10,i.paymentInfo.amount,(e=s.storeStore.selectedStore())==null?null:e.currency)),l(2),c(i.paymentInfo.transactionReference?25:-1),l(),c(i.paymentInfo.notes?26:-1)}}function Ln(r,n){if(r&1&&(o(0,"div",123)(1,"mat-icon",53),a(2,"check_circle"),t(),a(3),t(),d(4,qn,27,17,"div",124)),r&2){let e=p().$implicit,i=p(3);l(3),v(" Approved on ",i.formatExtensionDate(e.approvedAt)," "),l(),c(e.paymentInfo?4:-1)}}function zn(r,n){if(r&1&&(o(0,"div",135),a(1),t()),r&2){let e=p(2).$implicit,i=p(3);l(),v("Rejected on ",i.formatExtensionDate(e.rejectedAt))}}function Wn(r,n){if(r&1&&(o(0,"div",119)(1,"div",133)(2,"mat-icon",53),a(3,"cancel"),t(),a(4," Rejection Reason "),t(),o(5,"div",134),a(6),t(),d(7,zn,2,1,"div",135),t()),r&2){let e=p().$implicit;l(6),u(e.rejectionReason),l(),c(e.rejectedAt?7:-1)}}function Hn(r,n){if(r&1&&(o(0,"div",107)(1,"div",109)(2,"div",10)(3,"div",110)(4,"mat-icon",111),a(5,"hotel_class"),t()(),o(6,"div")(7,"h4",94),a(8,"Extension Request"),t(),o(9,"p",41),a(10),t()()(),o(11,"span",112),a(12),x(13,"titlecase"),t()(),o(14,"div",113)(15,"div")(16,"label",75),a(17,"Original Check-out"),t(),o(18,"div",114),a(19),t()(),o(20,"div")(21,"label",75),a(22,"Extended Check-out"),t(),o(23,"div",115),a(24),t()(),o(25,"div")(26,"label",75),a(27,"Additional Nights"),t(),o(28,"div",114),a(29),t()(),o(30,"div")(31,"label",75),a(32,"Extension Cost"),t(),o(33,"div",116),a(34),x(35,"currency"),t()()(),d(36,An,5,1,"div",117),d(37,Gn,9,4,"div",118),d(38,Ln,5,2),d(39,Wn,8,2,"div",119),t()),r&2){let e,i=n.$implicit,s=p(3);l(10),u(s.formatExtensionDate(i.requestedAt)),l(),f("ngClass",Ne(17,gn,i.status==="pending",i.status==="approved",i.status==="rejected")),l(),v(" ",F(13,12,i.status)," "),l(7),u(s.formatExtensionDate(i.originalCheckOutDate)),l(5),u(s.formatExtensionDate(i.newCheckOutDate)),l(5),H("",i.additionalNights," night",i.additionalNights>1?"s":""),l(5),u(k(35,14,i.additionalCost,(e=s.storeStore.selectedStore())==null?null:e.currency)),l(2),c(i.notes?36:-1),l(),c(i.status==="pending"?37:-1),l(),c(i.status==="approved"&&i.approvedAt?38:-1),l(),c(i.status==="rejected"&&i.rejectionReason?39:-1)}}function Kn(r,n){if(r&1&&(o(0,"div",108)(1,"div",136)(2,"mat-icon",77),a(3,"check_circle"),t(),o(4,"span",137),a(5,"Active Extension"),t()(),o(6,"div",138)(7,"p"),a(8,"Total extension cost: "),o(9,"strong"),a(10),x(11,"currency"),t()(),o(12,"p"),a(13,"Total additional nights: "),o(14,"strong"),a(15),t()()()()),r&2){let e,i=p(3);l(10),u(k(11,2,i.getTotalExtensionCost(),(e=i.storeStore.selectedStore())==null?null:e.currency)),l(5),u(i.getTotalExtensionNights())}}function Jn(r,n){if(r&1&&(o(0,"div",69)(1,"div",103)(2,"h3",71)(3,"mat-icon",104),a(4,"schedule"),t(),a(5," Stay Extensions "),o(6,"span",105),a(7),t()()(),o(8,"div",73)(9,"div",106),A(10,Hn,40,21,"div",107,xn),t(),d(12,Kn,16,5,"div",108),t()()),r&2){let e=p(2);l(7),H(" ",e.getExtensions().length," Extension",e.getExtensions().length>1?"s":""," "),l(3),B(e.getExtensions()),l(2),c(e.hasActiveExtension()?12:-1)}}function Yn(r,n){if(r&1){let e=P();o(0,"button",139),C("click",function(){y(e);let s=p(2);return E(s.openRoomChangeDialog())}),o(1,"mat-icon"),a(2,"swap_horiz"),t()()}}function Zn(r,n){if(r&1&&(o(0,"tr",85)(1,"td",140),a(2),t(),o(3,"td",141),a(4),t(),o(5,"td",141),a(6),t(),o(7,"td",141),a(8),t(),o(9,"td",140),a(10),x(11,"currency"),t()()),r&2){let e,i=n.$implicit,s=p(2);l(2),u(i.roomNumber+" ("+i.name+")"),l(2),u(i.roomType),l(2),u(i.adults),l(2),u(i.children),l(2),u(k(11,5,i.rate,(e=s.storeStore.selectedStore())==null?null:e.currency))}}function Qn(r,n){r&1&&(o(0,"span",89),a(1,"(Locked)"),t())}function Xn(r,n){if(r&1&&(o(0,"div",92)(1,"span",93),a(2,"Service Fee"),t(),o(3,"span",94),a(4),x(5,"currency"),t()()),r&2){let e,i=p(2);l(4),u(k(5,1,(e=i.reservation().pricing.fees)==null?null:e.serviceFee,(e=i.storeStore.selectedStore())==null?null:e.currency))}}function ei(r,n){if(r&1&&(o(0,"div",92)(1,"span",93),a(2,"Cleaning Fee"),t(),o(3,"span",94),a(4),x(5,"currency"),t()()),r&2){let e,i=p(2);l(4),u(k(5,1,(e=i.reservation().pricing.fees)==null?null:e.cleaningFee,(e=i.storeStore.selectedStore())==null?null:e.currency))}}function ti(r,n){if(r&1&&(o(0,"div",92)(1,"span",93),a(2,"Resort Fee"),t(),o(3,"span",94),a(4),x(5,"currency"),t()()),r&2){let e,i=p(2);l(4),u(k(5,1,(e=i.reservation().pricing.fees)==null?null:e.resortFee,(e=i.storeStore.selectedStore())==null?null:e.currency))}}function ni(r,n){if(r&1&&(o(0,"div",92)(1,"span",93),a(2,"Discount"),t(),o(3,"span",98),a(4),x(5,"currency"),t()()),r&2){let e,i=p(2);l(4),v("-",k(5,1,i.reservation().pricing.discounts,(e=i.storeStore.selectedStore())==null?null:e.currency))}}function ii(r,n){if(r&1&&(o(0,"div",92)(1,"span",93),a(2),t(),o(3,"span",142),a(4),x(5,"currency"),t()()),r&2){let e,i=p(2);l(2),v("Extensions (",i.getTotalExtensionNights()," nights)"),l(2),v("+",k(5,2,i.getTotalExtensionCost(),(e=i.storeStore.selectedStore())==null?null:e.currency))}}function oi(r,n){r&1&&(o(0,"span",89),a(1,"(Locked)"),t())}function ai(r,n){if(r&1&&(o(0,"button",143)(1,"mat-icon"),a(2,"more_vert"),t()()),r&2){p(3);let e=U(39);f("matMenuTriggerFor",e)}}function ri(r,n){r&1&&(o(0,"div",144)(1,"mat-icon"),a(2,"lock"),t()())}function li(r,n){r&1&&(o(0,"mat-icon",146),a(1,"refresh"),t())}function si(r,n){if(r&1&&(o(0,"div")(1,"label",75),a(2,"Last Transaction"),t(),o(3,"div",114),a(4),x(5,"currency"),t()()),r&2){let e,i=p(3);l(4),H(" ",k(5,2,i.transactionHistory()[i.transactionHistory().length-1].amount,(e=i.storeStore.selectedStore())==null?null:e.currency)," on ",i.formatDateTime(i.transactionHistory()[i.transactionHistory().length-1].date)," ")}}function di(r,n){if(r&1&&(o(0,"div",69)(1,"div",70)(2,"div",88)(3,"h3",71)(4,"mat-icon"),a(5),t(),a(6," Payment Information "),d(7,oi,2,0,"span",89),t(),d(8,ai,3,1,"button",143)(9,ri,3,0,"div",144),t()(),o(10,"div",73)(11,"div",91)(12,"div")(13,"label",75),a(14,"Payment Method"),t(),o(15,"div",114),a(16),x(17,"titlecase"),t()(),o(18,"div")(19,"label",75),a(20,"Payment Status"),t(),o(21,"div",145),d(22,li,2,0,"mat-icon",146),o(23,"span",147),a(24),x(25,"titlecase"),t()()(),d(26,si,6,5,"div"),t()()()),r&2){let e,i,s,m=p(2);l(4),G("text-indigo-600",!m.isCheckedOut())("text-gray-400",m.isCheckedOut()),l(),v(" ",m.isCheckedOut()?"lock":"credit_card"," "),l(2),c(m.isCheckedOut()?7:-1),l(),c(m.canEditPaymentInfo()?8:m.isCheckedOut()?9:-1),l(8),u(F(17,13,(e=m.reservation().paymentInfo)==null?null:e.method)),l(6),c(m.statusUpdating()?22:-1),l(),N(((i=m.reservation().paymentInfo)==null?null:i.status)==="paid"?"bg-green-100 text-green-800":((i=m.reservation().paymentInfo)==null?null:i.status)==="refunded"?"bg-gray-100 text-gray-800":"bg-yellow-100 text-yellow-800"),l(),v(" ",F(25,15,(s=m.reservation().paymentInfo)==null?null:s.status)," "),l(2),c(m.transactionHistory().length>0?26:-1)}}function ci(r,n){if(r&1&&(o(0,"tr",85)(1,"td",141),a(2),t(),o(3,"td",140),a(4),x(5,"currency"),t(),o(6,"td",141),a(7),x(8,"titlecase"),t(),o(9,"td",141),a(10),t(),o(11,"td",148)(12,"span",147),a(13),x(14,"titlecase"),t()()()),r&2){let e,i=n.$implicit,s=p(3);l(2),u(s.formatDateTime(i.date)),l(2),u(k(5,7,i.amount,(e=s.storeStore.selectedStore())==null?null:e.currency)),l(3),u(F(8,10,i.method)),l(3),u(i.reference),l(2),N(i.status==="completed"?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"),l(),v(" ",F(14,12,i.status)," ")}}function mi(r,n){if(r&1&&(o(0,"div",69)(1,"div",70)(2,"h3",71)(3,"mat-icon",77),a(4,"receipt"),t(),a(5," Transaction History "),t()(),o(6,"div",73)(7,"div",81)(8,"table",82)(9,"thead")(10,"tr",83)(11,"th",84),a(12,"Date"),t(),o(13,"th",84),a(14,"Amount"),t(),o(15,"th",84),a(16,"Method"),t(),o(17,"th",84),a(18,"Reference"),t(),o(19,"th",84),a(20,"Status"),t()()(),o(21,"tbody"),A(22,ci,15,14,"tr",85,xe),t()()()()()),r&2){let e=p(2);l(22),B(e.transactionHistory())}}function pi(r,n){if(r&1&&(o(0,"div",69)(1,"div",70)(2,"h3",71)(3,"mat-icon",72),a(4,"message"),t(),a(5," Special Requests "),t()(),o(6,"div",73)(7,"p",149),a(8),t()()()),r&2){let e=p(3);l(8),u(e.reservation().specialRequests)}}function ui(r,n){if(r&1&&(o(0,"div",69)(1,"div",70)(2,"h3",71)(3,"mat-icon",104),a(4,"note"),t(),a(5," Internal Notes "),t()(),o(6,"div",73)(7,"p",149),a(8),t()()()),r&2){let e=p(3);l(8),u(e.reservation().internalNotes)}}function gi(r,n){if(r&1&&(o(0,"div",101),d(1,pi,9,1,"div",69),d(2,ui,9,1,"div",69),t()),r&2){let e=p(2);l(),c(e.reservation().specialRequests?1:-1),l(),c(e.reservation().internalNotes?2:-1)}}function vi(r,n){if(r&1&&(o(0,"div",41),a(1),t()),r&2){let e=p(2).$implicit;l(),v("Adults: ",e.totalAdults)}}function xi(r,n){if(r&1&&(o(0,"div",41),a(1),t()),r&2){let e=p(2).$implicit;l(),v("Children: ",e.totalChildren)}}function _i(r,n){if(r&1&&(o(0,"div",94),a(1),t(),d(2,vi,2,1,"div",41),d(3,xi,2,1,"div",41)),r&2){let e=p().$implicit,i=p(3);l(),u(i.getGuestName(e.guest)),l(),c(e.totalAdults?2:-1),l(),c(e.totalChildren?3:-1)}}function fi(r,n){r&1&&(o(0,"div",41),a(1,"Unknown Guest"),t())}function Ci(r,n){if(r&1&&(o(0,"div",151),d(1,_i,4,3)(2,fi,2,0,"div",41),t()),r&2){let e=n.$implicit;l(),c(e.guest?1:2)}}function hi(r,n){if(r&1&&(o(0,"div",69)(1,"div",70)(2,"h3",71)(3,"mat-icon",77),a(4,"group"),t(),a(5," Additional Guests "),t()(),o(6,"div",73)(7,"div",150),A(8,Ci,3,1,"div",151,xe),t()()()),r&2){let e=p(2);l(8),B(e.reservation().additionalGuests)}}function bi(r,n){if(r&1&&(o(0,"div")(1,"label",75),a(2,"Last Updated"),t(),o(3,"div",41),a(4),t()()),r&2){let e=p(2);l(4),u(e.formatDateTime(e.reservation().updatedAt))}}function yi(r,n){if(r&1&&(o(0,"div")(1,"label",75),a(2,"Actual Check-in"),t(),o(3,"div",41),a(4),t()()),r&2){let e=p(2);l(4),u(e.formatDateTime(e.reservation().actualCheckInDate))}}function Ei(r,n){if(r&1&&(o(0,"div")(1,"label",75),a(2,"Actual Check-out"),t(),o(3,"div",41),a(4),t()()),r&2){let e=p(2);l(4),u(e.formatDateTime(e.reservation().actualCheckOutDate))}}function Si(r,n){if(r&1&&(o(0,"div")(1,"label",155),a(2,"Refund Amount"),t(),o(3,"div",156),a(4),x(5,"currency"),t()()),r&2){let e,i=p(3);l(4),u(k(5,1,i.getRefundAmount(),(e=i.storeStore.selectedStore())==null?null:e.currency))}}function Di(r,n){if(r&1&&(o(0,"div")(1,"label",155),a(2,"Cancellation Fee"),t(),o(3,"div",156),a(4),x(5,"currency"),t()()),r&2){let e,i=p(3);l(4),u(k(5,1,i.getCancellationFee(),(e=i.storeStore.selectedStore())==null?null:e.currency))}}function ki(r,n){if(r&1&&(o(0,"div",102)(1,"div",152)(2,"h3",153)(3,"mat-icon",154),a(4,"cancel"),t(),a(5," Cancellation Information "),t()(),o(6,"div",73)(7,"div",74)(8,"div")(9,"label",155),a(10,"Cancelled"),t(),o(11,"div",156),a(12),t()(),o(13,"div")(14,"label",155),a(15,"Reason"),t(),o(16,"div",156),a(17),t()(),d(18,Si,6,4,"div"),d(19,Di,6,4,"div"),t()()()),r&2){let e=p(2);l(12),u(e.formatDateTime(e.reservation().cancellation.cancelledAt)),l(5),u(e.reservation().cancellation.reason),l(),c(e.hasRefundAmount()?18:-1),l(),c(e.hasCancellationFee()?19:-1)}}function Pi(r,n){if(r&1){let e=P();o(0,"div",12)(1,"div",67)(2,"div",68)(3,"div",69)(4,"div",70)(5,"h3",71)(6,"mat-icon",72),a(7,"person"),t(),a(8," Guest Information "),t()(),o(9,"div",73)(10,"div",74)(11,"div")(12,"label",75),a(13,"Guest Name"),t(),o(14,"div",76),a(15),t()(),o(16,"div")(17,"label",75),a(18,"Email"),t(),o(19,"div",41),a(20),t()(),o(21,"div")(22,"label",75),a(23,"Phone"),t(),o(24,"div",41),a(25),t()(),o(26,"div")(27,"label",75),a(28,"Occupancy"),t(),o(29,"div",41),d(30,On,2,0)(31,In,2,0,"div"),t()()()()(),o(32,"div",69)(33,"div",70)(34,"h3",71)(35,"mat-icon",77),a(36,"calendar_today"),t(),a(37," Stay Information "),t()(),o(38,"div",73)(39,"div",74)(40,"div")(41,"label",75),a(42,"Check-in Date"),t(),o(43,"div",76),a(44),t(),d(45,Tn,2,1,"div",41),t(),o(46,"div")(47,"label",75),a(48,"Check-out Date"),t(),o(49,"div",76),a(50),t(),d(51,Fn,2,1,"div",41),t(),o(52,"div")(53,"label",75),a(54,"Number of Nights"),t(),o(55,"div",76),a(56),t()(),o(57,"div")(58,"label",75),a(59,"Booking Source"),t(),o(60,"div",41),a(61),x(62,"titlecase"),t()()()()(),d(63,Jn,13,3,"div",69),o(64,"div",69)(65,"div",70)(66,"div",78)(67,"h3",71)(68,"mat-icon",79),a(69,"hotel"),t(),a(70," Room Details "),t(),d(71,Yn,3,0,"button",80),t()(),o(72,"div",73)(73,"div",81)(74,"table",82)(75,"thead")(76,"tr",83)(77,"th",84),a(78,"Room Number"),t(),o(79,"th",84),a(80,"Room Type"),t(),o(81,"th",84),a(82,"Adults"),t(),o(83,"th",84),a(84,"Children"),t(),o(85,"th",84),a(86,"Rate per Night"),t()()(),o(87,"tbody"),A(88,Zn,12,8,"tr",85,xe),t()()()()()(),o(90,"div",86)(91,"div",69)(92,"div",87)(93,"div",88)(94,"h3",71)(95,"mat-icon"),a(96),t(),a(97," Pricing Summary "),d(98,Qn,2,0,"span",89),t(),o(99,"button",90),C("click",function(){y(e);let s=p();return E(s.openPricingUpdateDialog())}),o(100,"mat-icon"),a(101),t()()()(),o(102,"div",73)(103,"div",91)(104,"div",92)(105,"span",93),a(106,"Subtotal"),t(),o(107,"span",94),a(108),x(109,"currency"),t()(),o(110,"div",92)(111,"span",93),a(112,"Taxes"),t(),o(113,"span",94),a(114),x(115,"currency"),t()(),d(116,Xn,6,4,"div",92),d(117,ei,6,4,"div",92),d(118,ti,6,4,"div",92),d(119,ni,6,4,"div",92),d(120,ii,6,5,"div",92),S(121,"hr",95),o(122,"div",96)(123,"span",97),a(124,"Total"),t(),o(125,"span",97),a(126),x(127,"currency"),t()(),o(128,"div",92)(129,"span",93),a(130,"Paid"),t(),o(131,"span",98),a(132),x(133,"currency"),t()(),o(134,"div",92)(135,"span",93),a(136,"Balance"),t(),o(137,"span",99),a(138),x(139,"currency"),t()()()()(),d(140,di,27,17,"div",69),t()(),o(141,"div",100),d(142,mi,24,0,"div",69),d(143,gi,3,2,"div",101),d(144,hi,10,0,"div",69),o(145,"div",69)(146,"div",70)(147,"h3",71)(148,"mat-icon",79),a(149,"info"),t(),a(150," Booking Information "),t()(),o(151,"div",73)(152,"div",74)(153,"div")(154,"label",75),a(155,"Created"),t(),o(156,"div",41),a(157),t()(),d(158,bi,5,1,"div"),d(159,yi,5,1,"div"),d(160,Ei,5,1,"div"),t()()(),d(161,ki,20,4,"div",102),t()()}if(r&2){let e,i,s,m,_,b,w,O,fe,g=p();l(15),u(g.guestName()),l(5),u(g.guestEmail()),l(5),u(g.guestPhone()),l(5),c(g.hasAdditionalGuests()?30:31),l(14),u(g.formatDate(g.reservation().checkInDate)),l(),c(g.reservation().expectedCheckInTime?45:-1),l(5),u(g.formatDate(g.reservation().checkOutDate)),l(),c(g.reservation().expectedCheckOutTime?51:-1),l(5),u(g.reservation().numberOfNights),l(5),u(F(62,52,g.reservation().bookingSource)),l(2),c(g.hasExtensions()?63:-1),l(8),c(!g.isCheckedOut()&&((e=g.reservation())==null?null:e.status)!=="cancelled"?71:-1),l(17),B(g.roomDetails()),l(4),G("from-gray-50",g.isCheckedOut())("to-gray-100",g.isCheckedOut())("border-gray-200",g.isCheckedOut()),l(3),G("text-purple-600",!g.isCheckedOut())("text-gray-400",g.isCheckedOut()),l(),v(" ",g.isCheckedOut()?"lock":"account_balance_wallet"," "),l(2),c(g.isCheckedOut()?98:-1),l(),G("text-gray-400",!g.canEditPricing())("cursor-not-allowed",!g.canEditPricing()),f("matTooltip",g.canEditPricing()?"Update Pricing (Owner Authorization Required)":"Cannot edit pricing for checked-out reservations")("disabled",!g.canEditPricing()),l(2),u(g.canEditPricing()?"edit":"lock"),l(7),u(k(109,54,g.reservation().pricing.subtotal,(i=g.storeStore.selectedStore())==null?null:i.currency)),l(6),u(k(115,57,g.reservation().pricing.taxes,(s=g.storeStore.selectedStore())==null?null:s.currency)),l(2),c((m=g.reservation().pricing.fees)!=null&&m.serviceFee?116:-1),l(),c((_=g.reservation().pricing.fees)!=null&&_.cleaningFee?117:-1),l(),c((b=g.reservation().pricing.fees)!=null&&b.resortFee?118:-1),l(),c(g.reservation().pricing.discounts?119:-1),l(),c(g.getTotalExtensionCost()>0?120:-1),l(6),u(k(127,60,g.getFinalTotal(),(w=g.storeStore.selectedStore())==null?null:w.currency)),l(6),u(k(133,63,g.reservation().pricing.paid,(O=g.storeStore.selectedStore())==null?null:O.currency)),l(5),N(g.reservation().pricing.balance>0?"text-red-600":"text-green-600"),l(),v(" ",k(139,66,g.reservation().pricing.balance,(fe=g.storeStore.selectedStore())==null?null:fe.currency)," "),l(2),c(g.reservation().paymentInfo?140:-1),l(2),c(g.transactionHistory().length>0?142:-1),l(),c(g.reservation().specialRequests||g.reservation().internalNotes?143:-1),l(),c(g.hasAdditionalGuests()?144:-1),l(13),u(g.formatDateTime(g.reservation().createdAt)),l(),c(g.reservation().updatedAt!==g.reservation().createdAt?158:-1),l(),c(g.reservation().actualCheckInDate?159:-1),l(),c(g.reservation().actualCheckOutDate?160:-1),l(),c(g.hasCancellation()?161:-1)}}function Mi(r,n){if(r&1){let e=P();o(0,"button",25),C("click",function(){y(e);let s=p();return E(s.editReservation())}),o(1,"mat-icon",26),a(2,"edit"),t(),o(3,"span"),a(4,"Edit Reservation"),t()()}}function Ri(r,n){if(r&1){let e=P();o(0,"button",35),C("click",function(){y(e);let s=p();return E(s.requestExtension())}),o(1,"mat-icon",36),a(2,"schedule"),t(),o(3,"span"),a(4,"Request Stay Extension"),t()()}if(r&2){let e=p();f("disabled",e.statusUpdating())}}function wi(r,n){r&1&&(o(0,"mat-icon",20),a(1,"download"),t())}function Oi(r,n){r&1&&(o(0,"mat-icon",21),a(1,"picture_as_pdf"),t())}function Ii(r,n){if(r&1){let e=P();S(0,"mat-divider",157),o(1,"button",158),C("click",function(){y(e);let s=p();return E(s.deleteReservation())}),o(2,"mat-icon",21),a(3,"delete"),t(),o(4,"span"),a(5,"Delete Reservation"),t()()}}function Ti(r,n){r&1&&(o(0,"div",23)(1,"mat-icon",159),a(2,"lock"),t(),o(3,"span"),a(4,"Payment information is locked for checked-out reservations"),t()())}function Fi(r,n){r&1&&(o(0,"div",24),a(1," No status changes available "),t())}function Ai(r,n){if(r&1){let e=P();o(0,"button",162),C("click",function(){let s=y(e).$implicit,m=p(2);return E(m.updatePaymentStatus(s.value))}),o(1,"mat-icon",163),a(2),t(),o(3,"span"),a(4),t()()}if(r&2){let e=n.$implicit;l(),_e("color",e.color),l(),u(e.icon),l(2),u(e.label)}}function Bi(r,n){if(r&1){let e=P();A(0,Ai,5,4,"button",160,wt),o(2,"button",25),C("click",function(){y(e);let s=p();return E(s.showPaymentDialog(s.reservation()))}),o(3,"mat-icon",161),a(4,"edit"),t(),o(5,"span"),a(6,"Edit Payment Information"),t()(),o(7,"div",49),a(8,' \u{1F4A1} Use "Edit Payment Information" to update method and status details '),t()}if(r&2){let e=p();B(e.getAvailablePaymentStatusOptions())}}function Ni(r,n){if(r&1){let e=P();o(0,"button",164),C("click",function(){y(e);let s=p();return E(s.sendReservationEmail("confirmation"))}),o(1,"mat-icon",36),a(2,"check_circle"),t(),o(3,"span"),a(4,"Send Confirmation Email"),t()()}}function Vi(r,n){if(r&1){let e=P();o(0,"button",165),C("click",function(){y(e);let s=p();return E(s.sendReservationEmail("checkin"))}),o(1,"mat-icon",166),a(2,"login"),t(),o(3,"span"),a(4,"Send Check-in Notification"),t()()}}function Ui(r,n){r&1&&(o(0,"div",31)(1,"mat-icon",53),a(2,"bluetooth_connected"),t(),o(3,"span"),a(4,"Printer Connected"),t()())}function Gi(r,n){r&1&&(o(0,"div",32)(1,"mat-icon",53),a(2,"bluetooth_disabled"),t(),o(3,"span"),a(4,"Printer Not Connected"),t()())}function ji(r,n){r&1&&(o(0,"mat-icon",34),a(1,"print"),t())}function $i(r,n){r&1&&(o(0,"mat-icon",26),a(1,"print"),t())}function qi(r,n){if(r&1){let e=P();o(0,"button",167),C("click",function(){y(e);let s=p();return E(s.disconnectFromPrinter())}),o(1,"mat-icon",21),a(2,"bluetooth_disabled"),t(),o(3,"span"),a(4,"Disconnect Printer"),t()()}if(r&2){let e=p();f("disabled",e.printing()||e.statusUpdating())}}function Li(r,n){if(r&1){let e=P();o(0,"button",168),C("click",function(){y(e);let s=p();return E(s.connectToPrinter())}),o(1,"mat-icon",26),a(2,"bluetooth"),t(),o(3,"span"),a(4,"Connect to Printer"),t()()}if(r&2){let e=p();f("disabled",e.printing()||e.statusUpdating())}}var Rt=class r{router=D(Xe);route=D(Qe);location=D(Je);reservationService=D(ve);bluetoothPrinterService=D(bt);storeStore=D(Y);snackBar=D(he);dialog=D(Ct);reservation=R(null);loading=R(!1);error=R(null);statusUpdating=R(!1);printerConnected=R(!1);printing=R(!1);exportingPDF=R(!1);statusOptions=[{value:"pending",label:"Pending",icon:"schedule",color:"#f59e0b"},{value:"confirmed",label:"Confirmed",icon:"check_circle",color:"#10b981"},{value:"checked_in",label:"Checked In",icon:"login",color:"#3b82f6"},{value:"checked_out",label:"Checked Out",icon:"logout",color:"#6b7280"},{value:"cancelled",label:"Cancelled",icon:"cancel",color:"#ef4444"},{value:"no_show",label:"No Show",icon:"person_off",color:"#f97316"}];roomDetails=T(()=>{let n=this.reservation();return!n||!n.rooms?[]:n.rooms.map(e=>{let i=typeof e.room=="string"?{roomNumber:e.room,roomType:"Unknown"}:e.room;return{name:i.name||"N/A",roomNumber:i.roomNumber||"Unknown",roomType:typeof i.roomType=="object"&&i.roomType?.name||"Unknown",adults:e.guests?.adults||0,children:e.guests?.children||0,rate:i.priceOverride||0}})});transactionHistory=T(()=>{let n=this.reservation();return!n||!n.paymentInfo?.transactions?[]:n.paymentInfo.transactions});guestName=T(()=>{let n=this.reservation();if(!n||!n.guest)return"Unknown Guest";let e=n.guest;return`${e.firstName||""} ${e.lastName||""}`.trim()||"Unknown Guest"});guestEmail=T(()=>this.reservation()?.guest?.email||"No email provided");guestPhone=T(()=>this.reservation()?.guest?.phone||"No phone provided");hasAdditionalGuests=T(()=>{let n=this.reservation();return n?.additionalGuests&&n.additionalGuests.length>0});getGuestName(n){return n&&`${n.firstName||""} ${n.lastName||""}`.trim()||"Unknown Guest"}hasCancellation=T(()=>this.reservation()?.cancellation?.isCancelled);hasRefundAmount=T(()=>{let n=this.reservation();return n?.cancellation?.refundAmount&&n.cancellation.refundAmount>0});hasCancellationFee=T(()=>{let n=this.reservation();return n?.cancellation?.cancellationFee&&n.cancellation.cancellationFee>0});getRefundAmount=T(()=>this.reservation()?.cancellation?.refundAmount||0);getCancellationFee=T(()=>this.reservation()?.cancellation?.cancellationFee||0);paymentStatusOptions=[{value:"pending",label:"Pending",icon:"schedule",color:"#f59e0b"},{value:"paid",label:"Paid",icon:"check_circle",color:"#10b981"},{value:"partial",label:"Partial",icon:"donut_small",color:"#3b82f6"},{value:"refunded",label:"Refunded",icon:"undo",color:"#6b7280"}];getAvailablePaymentStatusOptions=T(()=>{let n=this.reservation();if(!n)return[];let e=n.paymentInfo?.status||"pending";return this.paymentStatusOptions.filter(i=>i.value!==e)});ngOnInit(){let n=this.route.snapshot.paramMap.get("id");n?this.loadReservation(n):this.error.set("No reservation ID provided"),this.printerConnected.set(this.bluetoothPrinterService.isConnected())}loadReservation(n){return h(this,null,function*(){this.loading.set(!0),this.error.set(null);try{if(!this.storeStore.selectedStore()?._id)throw new Error("No store selected");this.reservationService.getReservationById(n).subscribe({next:i=>{this.reservation.set(i),this.loading.set(!1)},error:i=>{console.error("Error loading reservation:",i),this.error.set("Failed to load reservation details"),this.loading.set(!1)}})}catch(e){console.error("Error loading reservation:",e),this.error.set("Failed to load reservation details"),this.loading.set(!1)}})}goBack(){this.location.back()}editReservation(){this.reservation()&&this.router.navigate(["/menu/hms/front-desk/reservations/edit",this.reservation()._id])}canEdit(){let n=this.reservation();return n?.status!=="cancelled"&&n?.status!=="checked_out"&&n?.status!=="no_show"&&n?.status!=="checked_in"&&!n?.actualCheckInDate}canDelete(){let n=this.reservation();return n?["pending","cancelled","no_show"].includes(n.status):!1}deleteReservation(){let n=this.reservation();if(!n)return;let e=this.storeStore.selectedStore();if(!e?._id){this.snackBar.open("No store selected","Close",{duration:3e3});return}let i={storeId:e._id,actionDescription:`delete reservation ${n.confirmationNumber}`,reservationId:n._id};this.dialog.open(Ie,{data:i,width:"500px",maxWidth:"90vw",disableClose:!0}).afterClosed().subscribe(m=>{m?.authorized&&m.pin&&this.performReservationDeletion(n,m.pin)})}performReservationDeletion(n,e){this.statusUpdating.set(!0),this.reservationService.deleteReservationWithPin(n._id,e).subscribe({next:i=>{this.snackBar.open(`Reservation ${n.confirmationNumber} deleted successfully`,"Close",{duration:5e3}),this.router.navigate(["/dashboard/hms/front-desk/reservations"])},error:i=>{console.error("Error deleting reservation:",i),this.snackBar.open(i.message||"Failed to delete reservation","Close",{duration:5e3,panelClass:["error-snackbar"]})},complete:()=>{this.statusUpdating.set(!1)}})}canCheckIn(){return this.reservation()?.status==="confirmed"}canCheckOut(){return this.reservation()?.status==="checked_in"}canCancel(){let n=this.reservation();return n?.status!=="cancelled"&&n?.status!=="checked_out"&&n?.status!=="no_show"}canRequestExtension(){return this.reservation()?.status==="checked_in"}isCheckedOut(){return this.reservation()?.status==="checked_out"}canEditPricing(){return!this.isCheckedOut()&&!this.loading()}canEditPaymentInfo(){return!this.isCheckedOut()&&!this.statusUpdating()}checkInReservation(){return h(this,null,function*(){if(this.reservation()){if(!this.canCheckIn()){this.snackBar.open('Guests can only be checked in when reservation status is "Confirmed"',"Close",{duration:5e3,panelClass:["error-snackbar"]});return}try{yield this.updateReservationStatus("checked_in")}catch(e){console.error("Error checking in reservation:",e),this.snackBar.open("Failed to check in reservation","Close",{duration:3e3})}}})}checkOutReservation(){return h(this,null,function*(){if(this.reservation()){if(!this.canCheckOut()){this.snackBar.open('Guests can only be checked out when reservation status is "Checked In"',"Close",{duration:5e3,panelClass:["error-snackbar"]});return}try{yield this.updateReservationStatus("checked_out")}catch(e){console.error("Error checking out reservation:",e),this.snackBar.open("Failed to check out reservation","Close",{duration:3e3})}}})}cancelReservation(){return h(this,null,function*(){if(!(!this.reservation()||!this.canCancel()))try{this.snackBar.open("Cancellation functionality coming soon","Close",{duration:3e3})}catch(e){console.error("Error cancelling reservation:",e),this.snackBar.open("Failed to cancel reservation","Close",{duration:3e3})}})}requestExtension(){return h(this,null,function*(){let n=this.reservation();if(!n||!this.canRequestExtension()){this.snackBar.open("Extensions can only be requested for checked-in guests","Close",{duration:5e3,panelClass:["error-snackbar"]});return}let e={reservation:n,currentCheckOutDate:new Date(n.checkOutDate)};this.dialog.open(Ae,{width:"600px",maxWidth:"90vw",data:e,disableClose:!0}).afterClosed().subscribe(s=>h(this,null,function*(){if(s?.success&&s.extension)try{yield this.loadReservation(n._id),this.snackBar.open("Extension request submitted successfully. Awaiting approval.","Close",{duration:5e3})}catch(m){console.error("Error reloading reservation after extension request:",m),this.snackBar.open("Extension request submitted, but failed to refresh data. Please refresh the page.","Close",{duration:5e3})}}))})}updateReservationStatus(n){return h(this,null,function*(){let e=this.reservation();if(!(!e||e.status===n)){if(n==="reopen"){this.reopenReservation();return}if(n==="checked_in"){this.showCheckInDialog(e);return}if(n==="checked_out"){this.performCheckOut();return}if(!this.isValidStatusTransition(e.status,n)){this.snackBar.open(this.getStatusTransitionError(e.status,n),"Close",{duration:5e3,panelClass:["error-snackbar"]});return}(n==="cancelled"||n==="no_show")&&!confirm(`Are you sure you want to change the status to ${n}?`)||(yield this.performStatusUpdate(n))}})}updatePaymentStatus(n){let e=this.reservation();if(e){if(this.isCheckedOut()){this.snackBar.open("Cannot update payment status for checked-out reservations","Close",{duration:3e3,panelClass:["error-snackbar"]});return}n==="paid"?this.showPaymentDialog(e):this.performPaymentStatusUpdate(n)}}showPaymentDialog(n){if(this.isCheckedOut()){this.snackBar.open("Cannot edit payment information for checked-out reservations","Close",{duration:3e3,panelClass:["error-snackbar"]});return}let e={reservation:n,isCheckoutFlow:!1};this.dialog.open(Te,{data:e,width:"600px",maxWidth:"90vw",disableClose:!0}).afterClosed().subscribe(s=>{s?.confirmed&&this.loadReservation(n._id)})}processPayment(n){return h(this,null,function*(){let e=this.reservation();if(e){this.statusUpdating.set(!0);try{yield this.reservationService.updatePaymentInfo(e._id,n).toPromise();let i=yield this.reservationService.getReservationById(e._id).toPromise();i&&this.reservation.set(i),this.snackBar.open("Payment information updated successfully","Close",{duration:5e3})}catch(i){console.error("Error updating payment info:",i);let s="Failed to update payment information";i?.error?.error?s=i.error.error:i instanceof Error&&(s=i.message),this.snackBar.open(s,"Close",{duration:5e3,panelClass:["error-snackbar"]})}finally{this.statusUpdating.set(!1)}}})}performPaymentStatusUpdate(n){return h(this,null,function*(){let e=this.reservation();if(e){this.statusUpdating.set(!0);try{let i=yield this.reservationService.updateReservation(e._id,{paymentInfo:Le(qe({},e.paymentInfo),{status:n})}).toPromise();i&&(this.reservation.set(i),this.snackBar.open(`Payment status updated to ${n}`,"Close",{duration:3e3}))}catch(i){console.error("Error updating payment status:",i);let s=i instanceof Error?i.message:"Failed to update payment status";this.snackBar.open(s,"Close",{duration:5e3,panelClass:["error-snackbar"]})}finally{this.statusUpdating.set(!1)}}})}showCheckInDialog(n){let e={reservation:n};this.dialog.open(kt,{data:e,width:"600px",maxWidth:"90vw",disableClose:!0}).afterClosed().subscribe(s=>{s?.confirmed&&this.performCheckIn(s)})}performCheckIn(n){return h(this,null,function*(){let e=this.reservation();if(e){this.statusUpdating.set(!0);try{let i=yield this.reservationService.checkInReservationWithRooms(e._id).toPromise();i&&(this.reservation.set(i),this.snackBar.open("Guest checked in successfully! Room status updated to occupied.","Close",{duration:5e3}))}catch(i){console.error("Error during check-in:",i);let s=i instanceof Error?i.message:"Failed to check in guest";this.snackBar.open(s,"Close",{duration:5e3,panelClass:["error-snackbar"]})}finally{this.statusUpdating.set(!1)}}})}performCheckOut(){return h(this,null,function*(){let n=this.reservation();if(n){if(this.requiresPaymentBeforeCheckout(n)){this.showPaymentRequiredDialog(n);return}this.statusUpdating.set(!0);try{let e=yield this.reservationService.checkOutReservationWithRooms(n._id).toPromise();e&&(this.reservation.set(e),this.snackBar.open("Guest checked out successfully! Room status updated to cleaning.","Close",{duration:5e3}))}catch(e){console.error("Error during check-out:",e);let i=e instanceof Error?e.message:"Failed to check out guest";this.snackBar.open(i,"Close",{duration:5e3,panelClass:["error-snackbar"]})}finally{this.statusUpdating.set(!1)}}})}requiresPaymentBeforeCheckout(n){let e=n.pricing.balance>0,i=n.paymentInfo?.status!=="paid";return e&&i}showPaymentRequiredDialog(n){let e={reservation:n,isCheckoutFlow:!0};this.dialog.open(Te,{data:e,width:"600px",maxWidth:"90vw",disableClose:!0}).afterClosed().subscribe(s=>{s?.confirmed&&s.paymentData&&(s.paymentData.amount!==void 0?this.processPaymentAndCheckout(s.paymentData):console.error("Expected amount-based payment data for checkout flow"))})}processPaymentAndCheckout(n){return h(this,null,function*(){let e=this.reservation();if(e){this.statusUpdating.set(!0);try{yield this.reservationService.processPayment(e._id,{amount:n.amount,method:n.method,reference:n.reference||`PAY-${Date.now()}`}).toPromise();let i=yield this.reservationService.getReservationById(e._id).toPromise();i&&(this.reservation.set(i),this.snackBar.open(`Payment of ${this.formatCurrency(n.amount)} recorded successfully`,"Close",{duration:3e3}),i.pricing.balance<=0||i.paymentInfo?.status==="paid"?setTimeout(()=>{this.proceedWithCheckout()},1500):this.snackBar.open("Payment recorded, but outstanding balance remains. Please complete payment before checkout.","Close",{duration:5e3,panelClass:["warning-snackbar"]}))}catch(i){console.error("Error processing payment for checkout:",i);let s=i instanceof Error?i.message:"Failed to process payment";this.snackBar.open(s,"Close",{duration:5e3,panelClass:["error-snackbar"]})}finally{this.statusUpdating.set(!1)}}})}proceedWithCheckout(){return h(this,null,function*(){let n=this.reservation();if(n){this.statusUpdating.set(!0);try{let e=yield this.reservationService.checkOutReservationWithRooms(n._id).toPromise();e&&(this.reservation.set(e),this.snackBar.open("Guest checked out successfully! Room status updated to cleaning.","Close",{duration:5e3}))}catch(e){console.error("Error during checkout after payment:",e);let i=e instanceof Error?e.message:"Failed to complete checkout";this.snackBar.open(i,"Close",{duration:5e3,panelClass:["error-snackbar"]})}finally{this.statusUpdating.set(!1)}}})}performStatusUpdate(n){return h(this,null,function*(){let e=this.reservation();if(e){this.statusUpdating.set(!0);try{let i=yield this.reservationService.updateReservationStatus(e._id,n).toPromise();i&&(this.reservation.set(i),this.snackBar.open(`Status updated to ${n}`,"Close",{duration:3e3}))}catch(i){console.error("Error updating reservation status:",i);let s=i instanceof Error?i.message:"Failed to update status";this.snackBar.open(s,"Close",{duration:5e3,panelClass:["error-snackbar"]})}finally{this.statusUpdating.set(!1)}}})}reopenReservation(){return h(this,null,function*(){let n=this.reservation();if(!n)return;if(n.status!=="cancelled"&&n.status!=="checked_out"){this.snackBar.open("Only cancelled reservations can be reopened","Close",{duration:5e3,panelClass:["error-snackbar"]});return}let e=this.storeStore.selectedStore()?._id;if(!e){this.snackBar.open("Store information not available","Close",{duration:5e3,panelClass:["error-snackbar"]});return}this.dialog.open(Ie,{width:"400px",disableClose:!0,data:{storeId:e,actionDescription:"reopen this cancelled reservation",reservationId:n._id}}).afterClosed().subscribe(s=>h(this,null,function*(){if(s&&s.authorized&&s.pin){this.statusUpdating.set(!0);try{let m=yield this.reservationService.reopenReservation(n._id,s.pin).toPromise();m&&(this.reservation.set(m),this.snackBar.open("Reservation reopened successfully","Close",{duration:3e3,panelClass:["success-snackbar"]}))}catch(m){console.error("Error reopening reservation:",m);let _="Failed to reopen reservation";(m instanceof Error&&m.message||m&&typeof m=="object"&&m.message)&&(_=m.message),this.snackBar.open(_,"Close",{duration:5e3,panelClass:["error-snackbar"]})}finally{this.statusUpdating.set(!1)}}}))})}getAvailableStatusOptions(){let n=this.reservation()?.status,e=this.statusOptions.filter(i=>i.value!==n&&this.isValidStatusTransition(n||"",i.value));return n==="cancelled"&&e.push({value:"reopen",label:"Reopen Reservation",color:"#10b981",icon:"refresh"}),e}isValidStatusTransition(n,e){return{pending:["confirmed","cancelled","no_show"],confirmed:["checked_in","cancelled","no_show"],checked_in:["checked_out"],checked_out:[],cancelled:[],no_show:[]}[n]?.includes(e)||!1}getStatusTransitionError(n,e){switch(e){case"checked_in":return'Guests can only be checked in when reservation status is "Confirmed"';case"checked_out":return'Guests can only be checked out when reservation status is "Checked In"';case"confirmed":return n==="checked_in"?"Cannot change back to confirmed after check-in":n==="checked_out"?"Cannot change back to confirmed after check-out":"Invalid status transition";default:return`Cannot change status from "${n}" to "${e}"`}}getStatusColor(n){return{pending:"#f59e0b",confirmed:"#10b981",checked_in:"#3b82f6",checked_out:"#6b7280",cancelled:"#ef4444",no_show:"#f97316"}[n]||"#6b7280"}getStatusIcon(n){return{pending:"schedule",confirmed:"check_circle",checked_in:"login",checked_out:"logout",cancelled:"cancel",no_show:"person_off"}[n]||"help"}formatDate(n){return n?new Date(n).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"}):"N/A"}formatDateTime(n){return n?new Date(n).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"N/A"}sendReservationEmail(n="details"){return h(this,null,function*(){let e=this.reservation();if(!e)return;let i=this.guestEmail();if(!i||i==="No email provided"){this.snackBar.open("No email address available for this guest","Close",{duration:5e3,panelClass:["error-snackbar"]});return}this.statusUpdating.set(!0);try{let s=yield this.reservationService.sendReservationEmail(e._id,{emailType:n}).toPromise();if(s?.success)this.snackBar.open(s.message||`${n.charAt(0).toUpperCase()+n.slice(1)} email sent successfully to ${i}`,"Close",{duration:5e3});else throw new Error("Email sending failed")}catch(s){console.error("Error sending reservation email:",s);let m=s instanceof Error?s.message:"Failed to send reservation email";this.snackBar.open(m,"Close",{duration:5e3,panelClass:["error-snackbar"]})}finally{this.statusUpdating.set(!1)}})}connectToPrinter(){return h(this,null,function*(){if(!this.bluetoothPrinterService.isBluetoothSupported()){this.snackBar.open("Web Bluetooth is not supported in this browser","Close",{duration:5e3,panelClass:["error-snackbar"]});return}try{this.statusUpdating.set(!0),yield this.bluetoothPrinterService.connectToPrinter(),this.printerConnected.set(!0);let n=this.bluetoothPrinterService.getConnectedDeviceInfo();this.snackBar.open(`Connected to printer: ${n?.name||"Unknown Printer"}`,"Close",{duration:3e3})}catch(n){console.error("Error connecting to printer:",n),this.printerConnected.set(!1);let e=n instanceof Error?n.message:"Failed to connect to printer";this.snackBar.open(e,"Close",{duration:5e3,panelClass:["error-snackbar"]})}finally{this.statusUpdating.set(!1)}})}disconnectFromPrinter(){return h(this,null,function*(){try{yield this.bluetoothPrinterService.disconnectPrinter(),this.printerConnected.set(!1),this.snackBar.open("Disconnected from printer","Close",{duration:3e3})}catch(n){console.error("Error disconnecting from printer:",n),this.snackBar.open("Failed to disconnect from printer","Close",{duration:3e3,panelClass:["error-snackbar"]})}})}printReservation(){return h(this,null,function*(){let n=this.reservation();if(n){if(!this.bluetoothPrinterService.isConnected())if(confirm("Printer not connected. Would you like to connect to a printer first?"))try{if(yield this.connectToPrinter(),!this.bluetoothPrinterService.isConnected())return}catch{return}else return;this.printing.set(!0);try{let e=this.storeStore.selectedStore();yield this.bluetoothPrinterService.printReservation(n,e),this.snackBar.open("Reservation printed successfully","Close",{duration:3e3})}catch(e){console.error("Error printing reservation:",e);let i=e instanceof Error?e.message:"Failed to print reservation";this.snackBar.open(i,"Close",{duration:5e3,panelClass:["error-snackbar"]}),i.includes("not connected")&&this.printerConnected.set(!1)}finally{this.printing.set(!1)}}})}testPrint(){return h(this,null,function*(){if(!this.bluetoothPrinterService.isConnected()){this.snackBar.open("Please connect to a printer first","Close",{duration:3e3,panelClass:["error-snackbar"]});return}this.printing.set(!0);try{yield this.bluetoothPrinterService.testPrint(),this.snackBar.open("Test print completed successfully","Close",{duration:3e3})}catch(n){console.error("Error during test print:",n);let e=n instanceof Error?n.message:"Test print failed";this.snackBar.open(e,"Close",{duration:5e3,panelClass:["error-snackbar"]})}finally{this.printing.set(!1)}})}exportReservationToPDF(){return h(this,null,function*(){let n=this.reservation();if(n){this.exportingPDF.set(!0);try{let e=yield this.reservationService.exportReservationToPDF(n._id).toPromise();if(e){let i=window.URL.createObjectURL(e),s=document.createElement("a");s.href=i,s.download=`reservation-${n.confirmationNumber}.pdf`,document.body.appendChild(s),s.click(),document.body.removeChild(s),window.URL.revokeObjectURL(i),this.snackBar.open("Reservation details exported to PDF successfully!","Close",{duration:3e3})}}catch(e){console.error("Error exporting reservation to PDF:",e);let i=e instanceof Error?e.message:"Failed to export reservation to PDF";this.snackBar.open(i,"Close",{duration:5e3,panelClass:["error-snackbar"]})}finally{this.exportingPDF.set(!1)}}})}openPricingUpdateDialog(){let n=this.reservation();if(!n)return;if(this.isCheckedOut()){this.snackBar.open("Cannot edit pricing for checked-out reservations","Close",{duration:3e3,panelClass:["error-snackbar"]});return}let e=this.storeStore.selectedStore();if(!e?._id){this.snackBar.open("No store selected","Close",{duration:3e3});return}let i={storeId:e._id,actionDescription:`update pricing for reservation ${n.confirmationNumber}`,reservationId:n._id};this.dialog.open(Ie,{data:i,width:"500px",maxWidth:"90vw",disableClose:!0}).afterClosed().subscribe(m=>{m?.authorized&&m.pin&&this.proceedWithPricingUpdate(n)})}proceedWithPricingUpdate(n){let e={reservation:n};this.dialog.open(Be,{data:e,width:"800px",maxWidth:"90vw",maxHeight:"90vh",disableClose:!1,autoFocus:!1,panelClass:"pricing-update-dialog"}).afterClosed().subscribe(s=>{s?.success&&s.updatedReservation&&(this.reservation.set(s.updatedReservation),this.snackBar.open("Pricing updated successfully!","Close",{duration:3e3,panelClass:["success-snackbar"]}))})}formatCurrency(n){if(!n&&n!==0)return"N/A";let e=this.storeStore.selectedStore(),i=e?.currencyCode||e?.currency||"USD";try{return new Intl.NumberFormat("en-US",{style:"currency",currency:i}).format(n)}catch{return console.warn(`Invalid currency code: ${i}, falling back to USD`),new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(n)}}hasExtensions(){let n=this.reservation();return!!(n?.extensions&&n.extensions.length>0)}getExtensions(){return this.reservation()?.extensions||[]}hasActiveExtension(){return!!this.reservation()?.currentExtension?.isActive}getTotalExtensionCost(){let n=this.reservation();return n?.currentExtension?.isActive&&n.currentExtension?.totalExtensionCost?n.currentExtension.totalExtensionCost:this.getExtensions().filter(i=>i.status==="approved").reduce((i,s)=>i+(s.additionalCost||0),0)}getTotalExtensionNights(){let n=this.reservation();return n?.currentExtension?.isActive&&n.currentExtension?.totalExtensionNights?n.currentExtension.totalExtensionNights:this.getExtensions().filter(i=>i.status==="approved").reduce((i,s)=>i+(s.additionalNights||0),0)}getFinalTotal(){return this.reservation()?.pricing?.total||0}formatExtensionDate(n){if(!n)return"N/A";try{return(typeof n=="string"?new Date(n):n).toLocaleDateString("en-US",{weekday:"short",year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}catch{return console.warn("Invalid date format:",n),"Invalid Date"}}processingExtension=R(null);processingAction=R(null);approveExtension(n){return h(this,null,function*(){let e=this.reservation();if(!e)return;let i=e.extensions?.find(b=>b._id===n);if(!i){this.snackBar.open("Extension not found","Close",{duration:3e3});return}let s={extensionId:n,reservationId:e._id,extensionCost:i.additionalCost,currency:this.storeStore.selectedStore()?.currency||"USD",additionalNights:i.additionalNights},_=yield this.dialog.open(Fe,{data:s,width:"500px",disableClose:!0}).afterClosed().toPromise();if(_){this.processingExtension.set(n),this.processingAction.set("approve");try{let b=yield this.reservationService.approveExtension(e._id,n,"Extension approved from reservation details",_).toPromise();b?.reservation&&(this.reservation.set(b.reservation),this.snackBar.open("Extension approved successfully with payment information!","Close",{duration:3e3,panelClass:["success-snackbar"]}))}catch(b){console.error("Error approving extension:",b),this.snackBar.open(b.message||"Failed to approve extension","Close",{duration:5e3,panelClass:["error-snackbar"]})}finally{this.processingExtension.set(null),this.processingAction.set(null)}}})}rejectExtension(n){return h(this,null,function*(){let e=this.reservation();if(!e)return;let i=prompt("Please provide a reason for rejection:");if(i){this.processingExtension.set(n),this.processingAction.set("reject");try{let s=yield this.reservationService.rejectExtension(e._id,n,i,"Extension rejected from reservation details").toPromise();s?.reservation&&(this.reservation.set(s.reservation),this.snackBar.open("Extension rejected successfully!","Close",{duration:3e3,panelClass:["success-snackbar"]}))}catch(s){console.error("Error rejecting extension:",s),this.snackBar.open(s.message||"Failed to reject extension","Close",{duration:5e3,panelClass:["error-snackbar"]})}finally{this.processingExtension.set(null),this.processingAction.set(null)}}})}openRoomChangeDialog(){return h(this,null,function*(){let n=this.reservation();if(!n||this.isCheckedOut()){this.snackBar.open("Cannot change rooms for checked-out reservations","Close",{duration:3e3});return}this.dialog.open(Dt,{width:"500px",maxWidth:"95vw",disableClose:!0,data:{reservationId:n._id,currentRooms:n.rooms,checkInDate:new Date(n.checkInDate).toISOString(),checkOutDate:new Date(n.checkOutDate).toISOString(),numberOfNights:n.numberOfNights,currency:this.storeStore.selectedStore()?.currency||"USD",actualCheckInDate:n.actualCheckInDate?new Date(n.actualCheckInDate).toISOString():void 0,reservationStatus:n.status}}).afterClosed().subscribe(i=>h(this,null,function*(){i&&(yield this.processRoomChange(i))}))})}processRoomChange(n){return h(this,null,function*(){let e=this.reservation();if(e)try{if(this.loading.set(!0),n.pricingAdjustment.requiresPayment){let s=this.storeStore.selectedStore()?.currency||"USD";if(!(yield this.dialog.open(Te,{width:"500px",disableClose:!0,data:{reservation:e,amount:n.pricingAdjustment.difference,title:"Room Change - Additional Payment Required",description:`Additional payment of ${s}${n.pricingAdjustment.difference.toLocaleString()} required for room upgrade`,isCheckoutFlow:!1}}).afterClosed().toPromise())){this.snackBar.open("Room change cancelled - payment not processed","Close",{duration:3e3});return}}let i=yield this.reservationService.changeRooms(e._id,n).toPromise();i.success&&(this.reservation.set(i.data),this.snackBar.open("Rooms changed successfully","Close",{duration:3e3}),yield this.loadReservation(e._id))}catch(i){console.error("Error processing room change:",i);let s=i?.error?.error||i?.error?.message||i?.message||"Failed to change rooms";this.snackBar.open(s,"Close",{duration:5e3})}finally{this.loading.set(!1)}})}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=V({type:r,selectors:[["app-reservation-details"]],decls:80,vars:23,consts:[["actionsMenu","matMenu"],["paymentMenu","matMenu"],["emailMenu","matMenu"],["printMenu","matMenu"],["statusMenu","matMenu"],[1,"bg-gradient-to-r","from-blue-50","to-indigo-50","border-b","border-blue-100"],[1,"max-w-7xl","mx-auto","px-4","sm:px-6","lg:px-8"],[1,"flex","justify-between","items-center","py-6"],[1,"flex","items-center","gap-4"],["type","button",1,"p-2","text-gray-600","hover:text-gray-900","hover:bg-white/60","rounded-lg","transition-all","duration-200",3,"click"],[1,"flex","items-center","gap-3"],[1,"flex","justify-center","items-center","py-12","bg-white"],[1,"max-w-7xl","mx-auto","px-4","sm:px-6","lg:px-8","py-8"],[1,"!shadow-xl","!border","!border-gray-200","!rounded-lg"],["mat-menu-item","",1,"!text-gray-700","hover:!bg-blue-50","hover:!text-blue-700","!transition-colors"],["mat-menu-item","",1,"!text-gray-700","hover:!bg-gray-50","!transition-colors",3,"matMenuTriggerFor"],[1,"mr-3","!text-gray-600"],[1,"ml-auto","!text-gray-400"],["mat-menu-item","",1,"!text-gray-700","hover:!bg-green-50","hover:!text-green-700","!transition-colors",3,"disabled"],["mat-menu-item","",1,"!text-gray-700","hover:!bg-red-50","hover:!text-red-700","!transition-colors",3,"click","disabled"],[1,"mr-3","!text-red-600","animate-spin"],[1,"mr-3","!text-red-600"],[1,"px-3","py-2","text-xs","font-medium","text-gray-500","border-b","border-gray-100"],[1,"px-3","py-2","text-xs","text-gray-400","italic","flex","items-center","gap-2"],[1,"px-3","py-2","text-xs","text-gray-400","italic"],["mat-menu-item","",1,"!text-gray-700","hover:!bg-blue-50","hover:!text-blue-700","!transition-colors",3,"click"],[1,"mr-3","!text-blue-600"],["mat-menu-item","",1,"!text-gray-700","hover:!bg-green-50","hover:!text-green-700","!transition-colors"],["mat-menu-item","",1,"!text-gray-700","hover:!bg-purple-50","hover:!text-purple-700","!transition-colors"],[1,"px-3","py-2","text-xs","text-gray-600","bg-gray-50","border-t","border-gray-100","mt-1"],[1,"px-3","py-2","text-xs","border-b","border-gray-100"],[1,"flex","items-center","gap-2","text-green-600"],[1,"flex","items-center","gap-2","text-gray-500"],["mat-menu-item","",1,"!text-gray-700","hover:!bg-blue-50","hover:!text-blue-700","!transition-colors",3,"click","disabled"],[1,"mr-3","!text-blue-600","animate-spin"],["mat-menu-item","",1,"!text-gray-700","hover:!bg-green-50","hover:!text-green-700","!transition-colors",3,"click","disabled"],[1,"mr-3","!text-green-600"],[1,"px-3","py-2","border-t","border-gray-100","mt-1"],["mat-menu-item","",1,"!text-gray-700","hover:!bg-red-50","hover:!text-red-700","!transition-colors","w-full",3,"disabled"],["mat-menu-item","",1,"!text-gray-700","hover:!bg-blue-50","hover:!text-blue-700","!transition-colors","w-full",3,"disabled"],[1,"text-3xl","font-bold","text-gray-900","mb-1"],[1,"text-sm","text-gray-600"],[1,"relative"],[1,"px-3","py-1","rounded-full","text-sm","font-medium","border-2","flex","items-center","gap-2","hover:opacity-80","transition-all","duration-200","disabled:opacity-50",3,"matMenuTriggerFor","disabled"],[1,"text-sm","animate-spin"],[1,"text-sm",3,"color"],[1,"text-xs","opacity-60"],["mat-menu-item",""],[1,"px-3","py-2","text-xs","text-amber-600","bg-amber-50","border-t","border-amber-100","mt-1"],[1,"px-3","py-2","text-xs","text-blue-600","bg-blue-50","border-t","border-blue-100","mt-1"],["type","button",1,"px-4","py-2","text-sm","font-medium","text-blue-700","bg-blue-50","border","border-blue-200","rounded-lg","hover:bg-blue-100","hover:border-blue-300","transition-all","duration-200","flex","items-center","gap-2"],["type","button",1,"px-4","py-2","text-sm","font-medium","text-green-700","bg-green-50","border","border-green-200","rounded-lg","hover:bg-green-100","hover:border-green-300","transition-all","duration-200","flex","items-center","gap-2","disabled:opacity-50","disabled:cursor-not-allowed",3,"disabled"],[1,"p-2","text-gray-600","hover:text-gray-900","hover:bg-white/60","rounded-lg","transition-all","duration-200",3,"matMenuTriggerFor"],[1,"text-sm"],["mat-menu-item","",3,"click"],[1,"mr-3","text-base"],["type","button",1,"px-4","py-2","text-sm","font-medium","text-blue-700","bg-blue-50","border","border-blue-200","rounded-lg","hover:bg-blue-100","hover:border-blue-300","transition-all","duration-200","flex","items-center","gap-2",3,"click"],[1,"text-lg"],["type","button",1,"px-4","py-2","text-sm","font-medium","text-green-700","bg-green-50","border","border-green-200","rounded-lg","hover:bg-green-100","hover:border-green-300","transition-all","duration-200","flex","items-center","gap-2","disabled:opacity-50","disabled:cursor-not-allowed",3,"click","disabled"],["diameter","40",1,"!text-blue-600"],[1,"ml-3","text-gray-600"],[1,"bg-red-50","border","border-red-200","rounded-lg","p-6","text-center"],[1,"w-16","h-16","bg-red-200","rounded-full","flex","items-center","justify-center","mx-auto","mb-4"],[1,"text-4xl","text-red-500"],[1,"text-lg","font-semibold","text-red-900","mb-2"],[1,"text-red-700","mb-4"],["type","button",1,"bg-red-600","hover:bg-red-700","text-white","px-4","py-2","rounded-lg","font-medium","transition-colors","duration-200",3,"click"],[1,"grid","grid-cols-1","lg:grid-cols-3","gap-8"],[1,"lg:col-span-2","space-y-6"],[1,"bg-white","rounded-lg","shadow-sm","border","border-gray-200","overflow-hidden"],[1,"bg-gradient-to-r","from-gray-50","to-gray-100","px-6","py-4","border-b","border-gray-200"],[1,"text-lg","font-semibold","text-gray-900","flex","items-center","gap-2"],[1,"text-blue-600"],[1,"p-6"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-6"],[1,"block","text-sm","font-medium","text-gray-700","mb-1"],[1,"text-lg","font-semibold","text-gray-900"],[1,"text-green-600"],[1,"flex","items-center","justify-between"],[1,"text-purple-600"],["mat-icon-button","","matTooltip","Change Rooms",1,"text-blue-600","hover:bg-blue-50","transition-colors","duration-200"],[1,"overflow-x-auto"],[1,"min-w-full"],[1,"border-b","border-gray-200"],[1,"text-left","py-3","px-4","font-semibold","text-gray-700"],[1,"border-b","border-gray-100","hover:bg-gray-50"],[1,"space-y-6"],[1,"bg-gradient-to-r","from-purple-50","to-purple-100","px-6","py-4","border-b","border-purple-200"],[1,"flex","justify-between","items-center"],[1,"text-xs","text-gray-500","font-normal"],["mat-icon-button","",1,"text-gray-600","hover:text-purple-600","hover:bg-purple-50","transition-colors","duration-200",3,"click","matTooltip","disabled"],[1,"space-y-3"],[1,"flex","justify-between"],[1,"text-gray-600"],[1,"font-medium","text-gray-900"],[1,"border-gray-200"],[1,"flex","justify-between","text-lg","font-semibold"],[1,"text-gray-900"],[1,"font-medium","text-green-600"],[1,"font-medium"],[1,"mt-8","space-y-6"],[1,"grid","grid-cols-1","lg:grid-cols-2","gap-6"],[1,"bg-red-50","border","border-red-200","rounded-lg","overflow-hidden"],[1,"bg-gradient-to-r","from-orange-50","to-amber-50","px-6","py-4","border-b","border-orange-200"],[1,"text-orange-600"],[1,"ml-2","px-2","py-1","bg-orange-100","text-orange-700","text-xs","font-medium","rounded-full"],[1,"space-y-4"],[1,"bg-gray-50","rounded-lg","p-4","border","border-gray-200"],[1,"mt-6","p-4","bg-green-50","border","border-green-200","rounded-lg"],[1,"flex","items-start","justify-between","mb-3"],[1,"w-10","h-10","bg-orange-100","rounded-full","flex","items-center","justify-center"],[1,"text-orange-600","text-sm"],[1,"px-3","py-1","rounded-full","text-xs","font-medium","border",3,"ngClass"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4","mb-4"],[1,"text-sm","text-gray-900"],[1,"text-sm","text-gray-900","font-medium"],[1,"text-sm","font-medium","text-orange-600"],[1,"mb-3"],[1,"mt-3","flex","gap-2"],[1,"mt-3","p-3","bg-red-50","border","border-red-200","rounded"],[1,"text-sm","text-gray-600","bg-white","p-3","rounded","border"],["type","button",1,"px-4","py-2","text-sm","font-medium","text-white","bg-green-600","border","border-green-600","rounded-lg","hover:bg-green-700","transition-all","duration-200","flex","items-center","gap-2","disabled:opacity-50","disabled:cursor-not-allowed",3,"click","disabled"],["type","button",1,"px-4","py-2","text-sm","font-medium","text-red-600","bg-white","border","border-red-300","rounded-lg","hover:bg-red-50","hover:border-red-400","transition-all","duration-200","flex","items-center","gap-2","disabled:opacity-50","disabled:cursor-not-allowed",3,"click","disabled"],[1,"flex","items-center","gap-2","text-sm","text-green-600"],[1,"mt-3","p-3","bg-blue-50","border","border-blue-200","rounded"],[1,"flex","items-center","gap-2","text-sm","text-blue-600","mb-2"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-3","text-sm"],[1,"ml-2","px-2","py-1","rounded-full","text-xs","font-medium",3,"ngClass"],[1,"ml-2","font-medium","text-gray-900"],[1,"mt-2","pt-2","border-t","border-blue-200"],[1,"ml-2","font-mono","text-sm","text-gray-900"],[1,"text-gray-600","text-sm"],[1,"mt-1","text-sm","text-gray-700"],[1,"flex","items-center","gap-2","text-sm","text-red-600","mb-1"],[1,"text-sm","text-red-700"],[1,"text-xs","text-red-500","mt-1"],[1,"flex","items-center","gap-2","mb-2"],[1,"font-medium","text-green-800"],[1,"text-sm","text-green-700"],["mat-icon-button","","matTooltip","Change Rooms",1,"text-blue-600","hover:bg-blue-50","transition-colors","duration-200",3,"click"],[1,"py-3","px-4","font-medium","text-gray-900"],[1,"py-3","px-4","text-gray-600"],[1,"font-medium","text-orange-600"],["matTooltip","Payment options",1,"p-2","text-gray-600","hover:text-gray-900","hover:bg-white/60","rounded-lg","transition-all","duration-200",3,"matMenuTriggerFor"],["matTooltip","Cannot edit payment info for checked-out reservations",1,"p-2","text-gray-400"],[1,"flex","items-center","gap-2"],[1,"text-sm","animate-spin","text-blue-600"],[1,"inline-flex","px-2","py-1","text-xs","font-medium","rounded-full"],[1,"py-3","px-4"],[1,"text-gray-700"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4"],[1,"bg-gray-50","border","border-gray-200","rounded-lg","p-4"],[1,"bg-red-100","px-6","py-4","border-b","border-red-200"],[1,"text-lg","font-semibold","text-red-900","flex","items-center","gap-2"],[1,"text-red-600"],[1,"block","text-sm","font-medium","text-red-700","mb-1"],[1,"text-sm","text-red-600"],[1,"!border-gray-200","my-1"],["mat-menu-item","",1,"!text-gray-700","hover:!bg-red-50","hover:!text-red-700","!transition-colors",3,"click"],[1,"!text-sm"],["mat-menu-item","",1,"!text-gray-700","hover:!bg-gray-50","!transition-colors"],[1,"mr-3","!text-base","!text-blue-600"],["mat-menu-item","",1,"!text-gray-700","hover:!bg-gray-50","!transition-colors",3,"click"],[1,"mr-3","!text-base"],["mat-menu-item","",1,"!text-gray-700","hover:!bg-green-50","hover:!text-green-700","!transition-colors",3,"click"],["mat-menu-item","",1,"!text-gray-700","hover:!bg-purple-50","hover:!text-purple-700","!transition-colors",3,"click"],[1,"mr-3","!text-purple-600"],["mat-menu-item","",1,"!text-gray-700","hover:!bg-red-50","hover:!text-red-700","!transition-colors","w-full",3,"click","disabled"],["mat-menu-item","",1,"!text-gray-700","hover:!bg-blue-50","hover:!text-blue-700","!transition-colors","w-full",3,"click","disabled"]],template:function(e,i){if(e&1){let s=P();o(0,"div",5)(1,"div",6)(2,"div",7)(3,"div",8)(4,"button",9),C("click",function(){return y(s),E(i.goBack())}),o(5,"mat-icon"),a(6,"arrow_back"),t()(),o(7,"div"),d(8,_n,4,1)(9,fn,4,0),t()(),d(10,Pn,23,18,"div",10),t()()(),d(11,Mn,4,0,"div",11),d(12,Rn,11,1,"div",12),d(13,Pi,162,69,"div",12),o(14,"mat-menu",13,0),d(16,Mi,5,0,"button",14),o(17,"button",15)(18,"mat-icon",16),a(19,"print"),t(),o(20,"span"),a(21,"Print Details"),t(),o(22,"mat-icon",17),a(23,"chevron_right"),t()(),o(24,"button",15)(25,"mat-icon",16),a(26,"email"),t(),o(27,"span"),a(28,"Send Email"),t(),o(29,"mat-icon",17),a(30,"chevron_right"),t()(),d(31,Ri,5,1,"button",18),o(32,"button",19),C("click",function(){return y(s),E(i.exportReservationToPDF())}),d(33,wi,2,0,"mat-icon",20)(34,Oi,2,0,"mat-icon",21),o(35,"span"),a(36),t()(),d(37,Ii,6,0),t(),o(38,"mat-menu",13,1)(40,"div",22),a(41," Update Payment Information "),t(),d(42,Ti,5,0,"div",23)(43,Fi,2,0,"div",24)(44,Bi,9,0),t(),o(45,"mat-menu",13,2)(47,"div",22),a(48," Email Options "),t(),o(49,"button",25),C("click",function(){return y(s),E(i.sendReservationEmail("details"))}),o(50,"mat-icon",26),a(51,"description"),t(),o(52,"span"),a(53,"Send Reservation Details"),t()(),d(54,Ni,5,0,"button",27),d(55,Vi,5,0,"button",28),o(56,"div",29),a(57),t()(),o(58,"mat-menu",13,3)(60,"div",22),a(61," Print Options "),t(),o(62,"div",30),d(63,Ui,5,0,"div",31)(64,Gi,5,0,"div",32),t(),o(65,"button",33),C("click",function(){return y(s),E(i.printReservation())}),d(66,ji,2,0,"mat-icon",34)(67,$i,2,0,"mat-icon",26),o(68,"span"),a(69),t()(),o(70,"button",35),C("click",function(){return y(s),E(i.testPrint())}),o(71,"mat-icon",36),a(72,"check_circle"),t(),o(73,"span"),a(74,"Test Print"),t()(),o(75,"div",37),d(76,qi,5,1,"button",38)(77,Li,5,1,"button",39),t(),o(78,"div",29),a(79," \u{1F5A8}\uFE0F Uses Bluetooth thermal printers with ESC/POS commands "),t()()}if(e&2){let s=U(46),m=U(59);l(8),c(i.reservation()?8:9),l(2),c(i.reservation()&&!i.loading()?10:-1),l(),c(i.loading()?11:-1),l(),c(i.error()&&!i.loading()?12:-1),l(),c(i.reservation()&&!i.loading()&&!i.error()?13:-1),l(3),c(i.canEdit()?16:-1),l(),f("matMenuTriggerFor",m),l(7),f("matMenuTriggerFor",s),l(7),c(i.canRequestExtension()?31:-1),l(),f("disabled",i.exportingPDF()||i.statusUpdating()),l(),c(i.exportingPDF()?33:34),l(3),u(i.exportingPDF()?"Exporting...":"Export to PDF"),l(),c(i.canDelete()?37:-1),l(5),c(i.isCheckedOut()?42:i.getAvailablePaymentStatusOptions().length===0?43:44),l(12),c(i.reservation()&&(i.reservation().status==="confirmed"||i.reservation().status==="checked_in"||i.reservation().status==="checked_out")?54:-1),l(),c(i.reservation()&&(i.reservation().status==="checked_in"||i.reservation().status==="checked_out")?55:-1),l(2),v(" \u{1F4E7} Email will be sent to: ",i.guestEmail()," "),l(6),c(i.printerConnected()?63:64),l(2),f("disabled",i.printing()||i.statusUpdating()),l(),c(i.printing()?66:67),l(3),u(i.printing()?"Printing...":"Print Reservation"),l(),f("disabled",i.printing()||i.statusUpdating()||!i.printerConnected()),l(6),c(i.printerConnected()?76:77)}},dependencies:[j,Ye,be,$,nt,L,q,ht,mt,pt,rt,ot,it,at,ke,De,Pe,z,W,pe,Me,ft,ut,Ce,K],styles:[".reservation-details-container[_ngcontent-%COMP%]{padding:24px;max-width:1200px;margin:0 auto}.reservation-details-container[_ngcontent-%COMP%]   .error-card[_ngcontent-%COMP%]{margin:24px auto;max-width:400px}.reservation-details-container[_ngcontent-%COMP%]   .error-card[_ngcontent-%COMP%]   .error-icon[_ngcontent-%COMP%]{font-size:48px;width:48px;height:48px;color:#f44336}.reservation-details-container[_ngcontent-%COMP%]   .header-card[_ngcontent-%COMP%]{box-shadow:0 2px 8px #0000001a;border-radius:12px}.reservation-details-container[_ngcontent-%COMP%]   .header-card[_ngcontent-%COMP%]   mat-card-header[_ngcontent-%COMP%]{padding:24px 24px 0}.reservation-details-container[_ngcontent-%COMP%]   .header-card[_ngcontent-%COMP%]   mat-card-content[_ngcontent-%COMP%]{padding:16px 24px}.reservation-details-container[_ngcontent-%COMP%]   .header-card[_ngcontent-%COMP%]   mat-card-actions[_ngcontent-%COMP%]{background-color:#f8f9fa;border-top:1px solid #e9ecef;margin:0}.reservation-details-container[_ngcontent-%COMP%]   .header-card[_ngcontent-%COMP%]   .status-chip[_ngcontent-%COMP%]{font-weight:500;border-radius:20px;padding:8px 16px;font-size:12px;text-transform:uppercase;letter-spacing:.5px}.reservation-details-container[_ngcontent-%COMP%]   mat-card[_ngcontent-%COMP%]{border-radius:12px;box-shadow:0 2px 8px #00000014;border:1px solid #e5e7eb}.reservation-details-container[_ngcontent-%COMP%]   mat-card[_ngcontent-%COMP%]   mat-card-title[_ngcontent-%COMP%]{font-size:20px;font-weight:600;color:#1f2937}.reservation-details-container[_ngcontent-%COMP%]   mat-card[_ngcontent-%COMP%]   mat-card-subtitle[_ngcontent-%COMP%]{font-size:14px;color:#6b7280;margin-top:4px}.reservation-details-container[_ngcontent-%COMP%]     .mat-mdc-tab-group .mat-mdc-tab-header{border-bottom:1px solid #e5e7eb}.reservation-details-container[_ngcontent-%COMP%]     .mat-mdc-tab-group .mat-mdc-tab.mdc-tab--active .mdc-tab__text-label{color:#3b82f6;font-weight:600}.reservation-details-container[_ngcontent-%COMP%]     .mat-mdc-tab-group .mat-mdc-tab-body-content{padding:0}.reservation-details-container[_ngcontent-%COMP%]     .mat-mdc-table{box-shadow:none;border:1px solid #e5e7eb;border-radius:8px;overflow:hidden}.reservation-details-container[_ngcontent-%COMP%]     .mat-mdc-table .mat-mdc-header-row{background-color:#f8f9fa}.reservation-details-container[_ngcontent-%COMP%]     .mat-mdc-table .mat-mdc-header-cell{font-weight:600;color:#374151;border-bottom:1px solid #e5e7eb;font-size:14px}.reservation-details-container[_ngcontent-%COMP%]     .mat-mdc-table .mat-mdc-cell{color:#1f2937;border-bottom:1px solid #f3f4f6;font-size:14px}.reservation-details-container[_ngcontent-%COMP%]     .mat-mdc-table .mat-mdc-row:hover{background-color:#f9fafb}.reservation-details-container[_ngcontent-%COMP%]     .mat-mdc-table .mat-mdc-row:last-child .mat-mdc-cell{border-bottom:none}.reservation-details-container[_ngcontent-%COMP%]     .mat-mdc-chip{font-size:11px;font-weight:500;height:24px;border-radius:12px}.reservation-details-container[_ngcontent-%COMP%]     .mat-mdc-chip.status-chip{border:none}.reservation-details-container[_ngcontent-%COMP%]     .mat-mdc-raised-button{border-radius:8px;font-weight:500;text-transform:none}.reservation-details-container[_ngcontent-%COMP%]     .mat-mdc-raised-button.mat-primary{background-color:#3b82f6;color:#fff}.reservation-details-container[_ngcontent-%COMP%]     .mat-mdc-raised-button.mat-primary:hover{background-color:#2563eb}.reservation-details-container[_ngcontent-%COMP%]     .mat-mdc-button{border-radius:8px;font-weight:500;text-transform:none}.reservation-details-container[_ngcontent-%COMP%]     .mat-mdc-menu-panel{border-radius:8px;box-shadow:0 4px 16px #0000001f}.reservation-details-container[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]{display:grid}.reservation-details-container[_ngcontent-%COMP%]   .grid-cols-1[_ngcontent-%COMP%]{grid-template-columns:repeat(1,minmax(0,1fr))}.reservation-details-container[_ngcontent-%COMP%]   .grid-cols-2[_ngcontent-%COMP%]{grid-template-columns:repeat(2,minmax(0,1fr))}.reservation-details-container[_ngcontent-%COMP%]   .grid-cols-3[_ngcontent-%COMP%]{grid-template-columns:repeat(3,minmax(0,1fr))}.reservation-details-container[_ngcontent-%COMP%]   .gap-2[_ngcontent-%COMP%]{gap:.5rem}.reservation-details-container[_ngcontent-%COMP%]   .gap-4[_ngcontent-%COMP%]{gap:1rem}.reservation-details-container[_ngcontent-%COMP%]   .gap-6[_ngcontent-%COMP%]{gap:1.5rem}.reservation-details-container[_ngcontent-%COMP%]   .space-y-1[_ngcontent-%COMP%] > *[_ngcontent-%COMP%] + *[_ngcontent-%COMP%]{margin-top:.25rem}.reservation-details-container[_ngcontent-%COMP%]   .space-y-2[_ngcontent-%COMP%] > *[_ngcontent-%COMP%] + *[_ngcontent-%COMP%]{margin-top:.5rem}.reservation-details-container[_ngcontent-%COMP%]   .space-y-6[_ngcontent-%COMP%] > *[_ngcontent-%COMP%] + *[_ngcontent-%COMP%]{margin-top:1.5rem}@media(min-width:768px){.reservation-details-container[_ngcontent-%COMP%]   .md\\\\[_ngcontent-%COMP%]:grid-cols-2{grid-template-columns:repeat(2,minmax(0,1fr))}.reservation-details-container[_ngcontent-%COMP%]   .md\\\\[_ngcontent-%COMP%]:grid-cols-3{grid-template-columns:repeat(3,minmax(0,1fr))}}.reservation-details-container[_ngcontent-%COMP%]   .flex[_ngcontent-%COMP%]{display:flex}.reservation-details-container[_ngcontent-%COMP%]   .items-center[_ngcontent-%COMP%]{align-items:center}.reservation-details-container[_ngcontent-%COMP%]   .items-start[_ngcontent-%COMP%]{align-items:flex-start}.reservation-details-container[_ngcontent-%COMP%]   .justify-center[_ngcontent-%COMP%]{justify-content:center}.reservation-details-container[_ngcontent-%COMP%]   .justify-between[_ngcontent-%COMP%]{justify-content:space-between}.reservation-details-container[_ngcontent-%COMP%]   .w-full[_ngcontent-%COMP%]{width:100%}.reservation-details-container[_ngcontent-%COMP%]   .mb-2[_ngcontent-%COMP%]{margin-bottom:.5rem}.reservation-details-container[_ngcontent-%COMP%]   .mb-4[_ngcontent-%COMP%]{margin-bottom:1rem}.reservation-details-container[_ngcontent-%COMP%]   .mb-6[_ngcontent-%COMP%]{margin-bottom:1.5rem}.reservation-details-container[_ngcontent-%COMP%]   .ml-2[_ngcontent-%COMP%]{margin-left:.5rem}.reservation-details-container[_ngcontent-%COMP%]   .p-3[_ngcontent-%COMP%]{padding:.75rem}.reservation-details-container[_ngcontent-%COMP%]   .p-4[_ngcontent-%COMP%]{padding:1rem}.reservation-details-container[_ngcontent-%COMP%]   .py-8[_ngcontent-%COMP%]{padding-top:2rem;padding-bottom:2rem}.reservation-details-container[_ngcontent-%COMP%]   .pb-4[_ngcontent-%COMP%]{padding-bottom:1rem}.reservation-details-container[_ngcontent-%COMP%]   .text-center[_ngcontent-%COMP%]{text-align:center}.reservation-details-container[_ngcontent-%COMP%]   .text-sm[_ngcontent-%COMP%]{font-size:.875rem;line-height:1.25rem}.reservation-details-container[_ngcontent-%COMP%]   .text-lg[_ngcontent-%COMP%]{font-size:1.125rem;line-height:1.75rem}.reservation-details-container[_ngcontent-%COMP%]   .text-4xl[_ngcontent-%COMP%]{font-size:2.25rem;line-height:2.5rem}.reservation-details-container[_ngcontent-%COMP%]   .font-medium[_ngcontent-%COMP%]{font-weight:500}.reservation-details-container[_ngcontent-%COMP%]   .font-semibold[_ngcontent-%COMP%]{font-weight:600}.reservation-details-container[_ngcontent-%COMP%]   .rounded-lg[_ngcontent-%COMP%]{border-radius:.5rem}.reservation-details-container[_ngcontent-%COMP%]   .border[_ngcontent-%COMP%]{border-width:1px}.reservation-details-container[_ngcontent-%COMP%]   .border-t[_ngcontent-%COMP%]{border-top-width:1px}.reservation-details-container[_ngcontent-%COMP%]   .overflow-x-auto[_ngcontent-%COMP%]{overflow-x:auto}.reservation-details-container[_ngcontent-%COMP%]   .text-gray-500[_ngcontent-%COMP%]{color:#6b7280}.reservation-details-container[_ngcontent-%COMP%]   .text-gray-900[_ngcontent-%COMP%]{color:#111827}.reservation-details-container[_ngcontent-%COMP%]   .text-blue-600[_ngcontent-%COMP%]{color:#2563eb}.reservation-details-container[_ngcontent-%COMP%]   .text-green-600[_ngcontent-%COMP%]{color:#059669}.reservation-details-container[_ngcontent-%COMP%]   .text-purple-600[_ngcontent-%COMP%]{color:#9333ea}.reservation-details-container[_ngcontent-%COMP%]   .text-orange-600[_ngcontent-%COMP%]{color:#ea580c}.reservation-details-container[_ngcontent-%COMP%]   .text-red-600[_ngcontent-%COMP%]{color:#dc2626}.reservation-details-container[_ngcontent-%COMP%]   .bg-gray-50[_ngcontent-%COMP%]{background-color:#f9fafb}.reservation-details-container[_ngcontent-%COMP%]   .bg-red-50[_ngcontent-%COMP%]{background-color:#fef2f2}.reservation-details-container[_ngcontent-%COMP%]   .border-red-200[_ngcontent-%COMP%]{border-color:#fecaca}.reservation-details-container[_ngcontent-%COMP%]   .loading-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;min-height:200px}.reservation-details-container[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]{text-align:center;padding:2rem;color:#6b7280}.reservation-details-container[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{opacity:.5}.reservation-details-container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:focus{outline:2px solid #3b82f6;outline-offset:2px}@media print{.reservation-details-container[_ngcontent-%COMP%]   .header-card[_ngcontent-%COMP%]   mat-card-actions[_ngcontent-%COMP%], .reservation-details-container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%], .reservation-details-container[_ngcontent-%COMP%]   .mat-mdc-menu-trigger[_ngcontent-%COMP%]{display:none!important}.reservation-details-container[_ngcontent-%COMP%]   mat-card[_ngcontent-%COMP%]{box-shadow:none;border:1px solid #ccc}}@media(prefers-color-scheme:dark){.reservation-details-container[_ngcontent-%COMP%]   mat-card[_ngcontent-%COMP%]{background-color:#374151;color:#f9fafb}.reservation-details-container[_ngcontent-%COMP%]   .text-gray-900[_ngcontent-%COMP%]{color:#f9fafb}.reservation-details-container[_ngcontent-%COMP%]   .text-gray-500[_ngcontent-%COMP%]{color:#9ca3af}.reservation-details-container[_ngcontent-%COMP%]   .bg-gray-50[_ngcontent-%COMP%]{background-color:#4b5563}}"]})};export{Rt as ReservationDetailsComponent};
