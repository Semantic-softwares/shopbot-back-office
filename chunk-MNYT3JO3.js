import{a as R}from"./chunk-53AK2UWQ.js";import{a as m}from"./chunk-BFT2MTJY.js";import{A as h}from"./chunk-H22US2IH.js";import{aa as a,fa as p,r as t,wa as o}from"./chunk-P5WOETP4.js";var l="role_access",v=class n{role=o(null);permissions=o(new Set);isAdmin=o(!1);http=p(h);sessionStorage=p(R);hostServer=m.apiUrl;constructor(){this.restoreFromStorage()}restoreFromStorage(){let e=this.sessionStorage.getItem(l);e&&(this.role.set(e.role),this.permissions.set(new Set(e.permissions)),this.isAdmin.set(e.isAdmin))}setAccess(e){this.role.set(e.role),this.permissions.set(new Set(e.permissions)),this.isAdmin.set(e.isAdmin),this.sessionStorage.setItem(l,{role:e.role,permissions:e.permissions,isAdmin:e.isAdmin})}clearAccess(){this.role.set(null),this.permissions.set(new Set),this.isAdmin.set(!1),this.sessionStorage.removeItem(l)}has(e){return this.permissions().has(e)}hasAny(e){return e.some(s=>this.permissions().has(s))}hasAll(e){return e.every(s=>this.permissions().has(s))}getAllRoles(){return this.http.get(`${this.hostServer}/roles`).pipe(t(e=>e.data))}getAdministrativeRoles(){return this.http.get(`${this.hostServer}/roles/administrative`).pipe(t(e=>e.data))}getRolesByStore(e){return this.http.get(`${this.hostServer}/roles/store/${e}`).pipe(t(s=>s.data))}getAllRolesForStore(e){return this.http.get(`${this.hostServer}/roles/store/${e}/all`).pipe(t(s=>s.data))}getRole(e){return this.http.get(`${this.hostServer}/roles/${e}`).pipe(t(s=>s.data))}getRolePermissions(e){return this.getRole(e).pipe(t(s=>s.permissions||[]))}createAdministrativeRole(e){return this.http.post(`${this.hostServer}/roles/administrative`,e).pipe(t(s=>s.data))}createRole(e){return this.http.post(`${this.hostServer}/roles`,e).pipe(t(s=>s.data))}updateRole(e,s){return this.http.put(`${this.hostServer}/roles/${e}`,s).pipe(t(r=>r.data))}deleteRole(e){return this.http.delete(`${this.hostServer}/roles/${e}`)}getRoleByMerchantId(e){return this.http.get(`${this.hostServer}/roles/merchant/${e}`).pipe(t(s=>s.data))}setRolePermissions(e,s){return this.http.put(`${this.hostServer}/roles/${e}/permissions`,{permissions:s}).pipe(t(r=>r.data))}addRolePermissions(e,s){return this.http.post(`${this.hostServer}/roles/${e}/permissions`,{permissions:s}).pipe(t(r=>r.data))}removeRolePermissions(e,s){return this.http.delete(`${this.hostServer}/roles/${e}/permissions`,{body:{permissions:s}}).pipe(t(r=>r.data))}cloneRole(e,s,r){return this.http.post(`${this.hostServer}/roles/${e}/clone`,{name:s,storeId:r}).pipe(t(i=>i.data))}setDefaultRole(e,s){return this.http.put(`${this.hostServer}/roles/${e}/set-default`,{storeId:s}).pipe(t(r=>r.data))}clearAllRoles(){return this.http.delete(`${this.hostServer}/roles/clear/all`)}clearStoreRoles(){return this.http.delete(`${this.hostServer}/roles/clear/store-roles`)}getPermissions(e){return this.http.get(`${this.hostServer}/permissions`,{params:e}).pipe(t(s=>s.data))}getGroupedPermissions(){return this.http.get(`${this.hostServer}/permissions/grouped`).pipe(t(e=>e.data))}getPredefinedPermissions(){return this.http.get(`${this.hostServer}/permissions/predefined`).pipe(t(e=>e.data))}getPermission(e){return this.http.get(`${this.hostServer}/permissions/${e}`).pipe(t(s=>s.data))}getPermissionCodes(){return this.http.get(`${this.hostServer}/permissions/codes`).pipe(t(e=>e.data))}seedPermissions(){return this.http.post(`${this.hostServer}/permissions/seed`,{})}createPermission(e){return this.http.post(`${this.hostServer}/permissions`,e).pipe(t(s=>s.data))}updatePermission(e,s){return this.http.put(`${this.hostServer}/permissions/${e}`,s).pipe(t(r=>r.data))}deletePermission(e){return this.http.delete(`${this.hostServer}/permissions/${e}`)}clearAllPermissions(){return this.http.delete(`${this.hostServer}/permissions/clear`)}getPermissionCategories(){return this.getGroupedPermissions().pipe(t(e=>{let s=[];return Object.keys(e).forEach(r=>{Object.keys(e[r]).forEach(i=>{s.push({_id:`${r}-${i}`,name:`${r} - ${i}`,module:r,group:i,permissions:e[r][i]})})}),s}))}static \u0275fac=function(s){return new(s||n)};static \u0275prov=a({token:n,factory:n.\u0275fac,providedIn:"root"})};export{v as a};
