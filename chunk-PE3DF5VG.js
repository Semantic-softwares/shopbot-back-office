import{b as H}from"./chunk-TLN5MM36.js";import{b as q,c as B,d as j}from"./chunk-3BP5U2AG.js";import{a as J,b as Q,h as W}from"./chunk-TXVLFBH3.js";import{a as Y}from"./chunk-OJWZ6ZD7.js";import{a as R,b as V,e as G,h as L}from"./chunk-27T6VRU4.js";import{B as N,C as k,E as T,b as z,d as P,g as S,h as E,m as I,s as A,t as F}from"./chunk-LM7FYRY4.js";import{a as K,b as U}from"./chunk-EDESGICS.js";import{X as O,Y as D,Z as w}from"./chunk-BVLPFG4Z.js";import{Bb as C,Db as m,Eb as s,Jb as g,Kb as e,Lb as i,Xb as p,Ya as r,Zb as y,ca as u,lb as v,mc as n,nc as x,oc as M,ta as _}from"./chunk-KGWH6IHP.js";import{f as b}from"./chunk-EQDQRRRY.js";function Z(o,a){o&1&&(e(0,"mat-error"),n(1,"PIN is required"),i())}function $(o,a){o&1&&(e(0,"mat-error"),n(1,"PIN must be at least 4 digits"),i())}function tt(o,a){o&1&&(e(0,"mat-error"),n(1,"PIN cannot exceed 6 digits"),i())}function et(o,a){o&1&&(e(0,"mat-error"),n(1,"Invalid PIN entered"),i())}function it(o,a){if(o&1&&(e(0,"div",12)(1,"mat-icon",20),n(2,"error"),i(),e(3,"div")(4,"h4",21),n(5,"Authorization Failed"),i(),e(6,"p",22),n(7),i()()()),o&2){let d=y();r(7),x(d.error())}}function nt(o,a){o&1&&(e(0,"mat-icon",23),n(1,"sync"),i(),n(2," Verifying... "))}function ot(o,a){o&1&&(e(0,"mat-icon",24),n(1,"security"),i(),n(2," Authorize "))}var X=class o{fb=u(k);dialogRef=u(J);data=u(Q);storeService=u(Y);verifying=_(!1);error=_(null);showPin=_(!1);pinForm;constructor(){this.pinForm=this.fb.group({pin:["",[P.required,P.minLength(4),P.maxLength(6)]]})}get actionDescription(){return this.data.actionDescription||"perform this action"}get storeId(){return this.data.storeId}togglePinVisibility(){this.showPin.set(!this.showPin())}verifyPin(){return b(this,null,function*(){if(this.pinForm.invalid){this.pinForm.markAllAsTouched();return}let a=this.pinForm.get("pin")?.value;if(a){this.verifying.set(!0),this.error.set(null);try{(yield this.storeService.validateStoreOwnerPin(this.storeId,a).toPromise())?this.dialogRef.close({authorized:!0,pin:a}):(this.error.set("Invalid PIN. Please check with the store owner for the correct PIN."),this.pinForm.get("pin")?.setErrors({invalid:!0}))}catch(d){console.error("Error validating PIN:",d),this.error.set("Unable to verify PIN. Please check your connection and try again.")}finally{this.verifying.set(!1)}}})}cancel(){this.dialogRef.close({authorized:!1})}onPinKeyPress(a){a.key==="Enter"&&this.pinForm.valid&&!this.verifying()&&this.verifyPin()}onPinInput(){this.error()&&(this.error.set(null),this.pinForm.get("pin")?.setErrors(null))}static \u0275fac=function(d){return new(d||o)};static \u0275cmp=v({type:o,selectors:[["app-pin-authorization-dialog"]],decls:38,vars:13,consts:[[1,"pin-authorization-dialog"],[1,"dialog-header"],[1,"text-xl","font-semibold","text-gray-900","mb-2","flex","items-center","gap-3"],[1,"w-10","h-10","bg-gradient-to-r","from-red-500","to-red-600","rounded-full","flex","items-center","justify-center","shadow-lg"],[1,"text-white","text-lg"],[1,"text-gray-600","text-sm"],[1,"dialog-content","mt-6"],[3,"ngSubmit","formGroup"],[1,"space-y-4"],["appearance","outline",1,"w-full"],["matInput","","formControlName","pin","placeholder","Enter 4-6 digit PIN","maxlength","6","autocomplete","off",1,"text-center","text-lg","tracking-wider","font-mono",3,"keypress","input","type"],["type","button","matSuffix","","mat-icon-button","",1,"text-gray-500","hover:text-gray-700",3,"click"],[1,"bg-red-50","border","border-red-200","rounded-lg","p-4","flex","items-start","gap-3"],[1,"bg-blue-50","border","border-blue-200","rounded-lg","p-4","flex","items-start","gap-3"],[1,"text-blue-500","mt-0.5","flex-shrink-0"],[1,"text-blue-800","font-medium","text-sm"],[1,"text-blue-700","text-sm","mt-1"],[1,"dialog-actions","mt-8","flex","items-center","justify-end","gap-3","pt-4","border-t","border-gray-200"],["type","button","mat-button","",1,"!text-gray-600","hover:!text-gray-800","hover:!bg-gray-50","!transition-colors","!px-6","!py-2",3,"click","disabled"],["type","button","mat-raised-button","","color","primary",1,"!bg-gradient-to-r","!from-blue-600","!to-blue-700","hover:!from-blue-700","hover:!to-blue-800","!text-white","!px-8","!py-2","!rounded-lg","!font-medium","!transition-all","!duration-200","!shadow-lg","hover:!shadow-xl","disabled:!opacity-50","disabled:!cursor-not-allowed",3,"click","disabled"],[1,"text-red-500","mt-0.5","flex-shrink-0"],[1,"text-red-800","font-medium","text-sm"],[1,"text-red-700","text-sm","mt-1"],[1,"!text-sm","mr-2","animate-spin"],[1,"!text-sm","mr-2"]],template:function(d,t){if(d&1&&(e(0,"div",0)(1,"div",1)(2,"h2",2)(3,"div",3)(4,"mat-icon",4),n(5,"security"),i()(),n(6," Store Owner Authorization Required "),i(),e(7,"p",5),n(8),i()(),e(9,"div",6)(10,"form",7),p("ngSubmit",function(){return t.verifyPin()}),e(11,"div",8)(12,"mat-form-field",9)(13,"mat-label"),n(14,"Store Owner PIN"),i(),e(15,"input",10),p("keypress",function(c){return t.onPinKeyPress(c)})("input",function(){return t.onPinInput()}),i(),e(16,"button",11),p("click",function(){return t.togglePinVisibility()}),e(17,"mat-icon"),n(18),i()(),m(19,Z,2,0,"mat-error"),m(20,$,2,0,"mat-error"),m(21,tt,2,0,"mat-error"),m(22,et,2,0,"mat-error"),i(),m(23,it,8,1,"div",12),e(24,"div",13)(25,"mat-icon",14),n(26,"info"),i(),e(27,"div")(28,"h4",15),n(29,"Security Notice"),i(),e(30,"p",16),n(31," Only the store owner should have access to this PIN. This authorization ensures that important actions are performed with proper approval. "),i()()()()()(),e(32,"div",17)(33,"button",18),p("click",function(){return t.cancel()}),n(34," Cancel "),i(),e(35,"button",19),p("click",function(){return t.verifyPin()}),m(36,nt,3,0)(37,ot,3,0),i()()()),d&2){let l,c,f,h;r(8),M(" Enter the store owner PIN to authorize and ",t.actionDescription,". "),r(2),g("formGroup",t.pinForm),r(5),g("type",t.showPin()?"text":"password"),r(),C("aria-label","Toggle PIN visibility"),r(2),x(t.showPin()?"visibility_off":"visibility"),r(),s((l=t.pinForm.get("pin"))!=null&&l.hasError("required")&&((l=t.pinForm.get("pin"))!=null&&l.touched)?19:-1),r(),s((c=t.pinForm.get("pin"))!=null&&c.hasError("minlength")&&((c=t.pinForm.get("pin"))!=null&&c.touched)?20:-1),r(),s((f=t.pinForm.get("pin"))!=null&&f.hasError("maxlength")&&((f=t.pinForm.get("pin"))!=null&&f.touched)?21:-1),r(),s((h=t.pinForm.get("pin"))!=null&&h.hasError("invalid")&&((h=t.pinForm.get("pin"))!=null&&h.touched)?22:-1),r(),s(t.error()?23:-1),r(10),g("disabled",t.verifying()),r(2),g("disabled",t.pinForm.invalid||t.verifying()),r(),s(t.verifying()?36:37)}},dependencies:[T,I,z,S,E,N,F,A,W,w,D,O,q,L,R,V,G,j,B,U,K,H],styles:[".pin-authorization-dialog[_ngcontent-%COMP%]{padding:24px;max-width:450px;min-width:400px}.dialog-header[_ngcontent-%COMP%]{text-align:center}.dialog-content[_ngcontent-%COMP%]   .mat-mdc-form-field[_ngcontent-%COMP%]   .mdc-text-field--outlined[_ngcontent-%COMP%]{background-color:#f9fafb;border-color:#e5e7eb}.dialog-content[_ngcontent-%COMP%]   .mat-mdc-form-field[_ngcontent-%COMP%]   .mdc-text-field--outlined[_ngcontent-%COMP%]:hover{border-color:#3b82f6}.dialog-content[_ngcontent-%COMP%]   .mat-mdc-form-field[_ngcontent-%COMP%]   .mdc-text-field--outlined.mdc-text-field--focused[_ngcontent-%COMP%]{border-color:#2563eb;box-shadow:0 0 0 3px #3b82f61a}.dialog-actions[_ngcontent-%COMP%]   .mat-mdc-raised-button[_ngcontent-%COMP%]:disabled{box-shadow:none}.dialog-actions[_ngcontent-%COMP%]   .mat-mdc-raised-button[_ngcontent-%COMP%]:disabled:hover{transform:none}.dialog-actions[_ngcontent-%COMP%]   .mat-mdc-raised-button[_ngcontent-%COMP%]:not(:disabled):hover{transform:translateY(-1px);box-shadow:0 10px 15px -3px #0000001a,0 4px 6px -2px #0000000d}@keyframes _ngcontent-%COMP%_pulse-security{0%,to{transform:scale(1)}50%{transform:scale(1.05)}}.dialog-header[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_pulse-security 2s infinite}.mat-mdc-form-field[_ngcontent-%COMP%]   input[type=password][_ngcontent-%COMP%], .mat-mdc-form-field[_ngcontent-%COMP%]   input[type=text][_ngcontent-%COMP%]{font-size:18px;letter-spacing:.2em}.mat-mdc-form-field[_ngcontent-%COMP%]   input[type=password][_ngcontent-%COMP%]::placeholder, .mat-mdc-form-field[_ngcontent-%COMP%]   input[type=text][_ngcontent-%COMP%]::placeholder{font-size:14px;letter-spacing:normal}.bg-red-50[_ngcontent-%COMP%], .bg-blue-50[_ngcontent-%COMP%]{transition:all .2s ease-in-out}.bg-red-50[_ngcontent-%COMP%]:hover, .bg-blue-50[_ngcontent-%COMP%]:hover{box-shadow:0 2px 4px #0000001a}.animate-spin[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_spin 1s linear infinite}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}@media(max-width:480px){.pin-authorization-dialog[_ngcontent-%COMP%]{padding:16px;min-width:320px;max-width:95vw}.dialog-actions[_ngcontent-%COMP%]{flex-direction:column-reverse}.dialog-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:100%;margin:4px 0}}"]})};export{X as a};
