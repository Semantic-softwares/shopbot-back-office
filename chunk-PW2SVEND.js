import{a as ce,b as pe,c as de,d as se}from"./chunk-HOKDSQC2.js";import{a as Ce}from"./chunk-GCUEAPFX.js";import{a as ve}from"./chunk-H5K5NEFK.js";import{a as _e,b as fe,c as xe,d as Se,e as be}from"./chunk-SLGEVIN5.js";import"./chunk-MS4AQ6UA.js";import{a as Y,b as Z,c as ee,d as te,e as ie,f as ne,g as ae,h as oe,i as re,j as le,k as me,m as v,n as ue}from"./chunk-QDAEUEEQ.js";import"./chunk-ZKTF2KLV.js";import"./chunk-W3I56YZS.js";import"./chunk-4FBK7QZF.js";import{k as N,m as Q}from"./chunk-5F6GZMB3.js";import"./chunk-L3V4XNTA.js";import{a as G,b as J,c as K,d as U}from"./chunk-MEJNP7NR.js";import{e as W,f as X}from"./chunk-ZHTE7B4O.js";import"./chunk-FNYKOLMP.js";import{w as H,x as j,y as A}from"./chunk-OIGPKB3Q.js";import{O as z,P as B,sa as L}from"./chunk-E4MABTKS.js";import"./chunk-CLGBGKT5.js";import{l as q,n as F,o as O}from"./chunk-5RF4TXO5.js";import{Bb as E,Cb as R,Fb as w,Gb as D,Hb as d,Ib as n,Jb as a,Kb as f,Lb as s,Mb as _,Ob as h,Sb as b,Tb as u,Xb as P,Y as g,Yb as k,Za as m,Zb as I,bc as y,ea as C,gc as o,hc as c,jb as T,ka as x,la as S,pb as p,vc as M,wc as V,xc as $}from"./chunk-EV5SF5GC.js";import"./chunk-FK6H3RFT.js";import"./chunk-EQDQRRRY.js";var Me=(e,i)=>i.value;function ge(e,i){if(e&1){let t=h();n(0,"a",26),b("click",function(){let l=x(t).$implicit,ye=u(2);return S(ye.onTabChange(l.value))}),n(1,"div",27)(2,"h3",28),o(3),a(),n(4,"p",29),o(5),a()()()}if(e&2){let t=i.$implicit,r=u(2);d("active",r.activeTab===t.value),m(3),c(t.label),m(2),c(t.count)}}function Te(e,i){e&1&&(n(0,"mat-header-cell"),o(1,"Receipt no."),a())}function Ee(e,i){if(e&1&&(n(0,"mat-cell"),o(1),a()),e&2){let t=i.$implicit;m(),c(t.receiptNo)}}function Re(e,i){e&1&&(n(0,"mat-header-cell"),o(1,"Date"),a())}function we(e,i){if(e&1&&(n(0,"mat-cell"),o(1),a()),e&2){let t=i.$implicit;m(),c(t.date)}}function De(e,i){e&1&&(n(0,"mat-header-cell"),o(1,"Ordered by"),a())}function Pe(e,i){if(e&1&&(n(0,"mat-cell"),o(1),a()),e&2){let t=i.$implicit;m(),c(t.orderedBy.name)}}function ke(e,i){e&1&&(n(0,"mat-header-cell"),o(1,"Status"),a())}function Ie(e,i){if(e&1&&(n(0,"mat-cell"),o(1),a()),e&2){let t=i.$implicit;m(),c(t.category)}}function Ve(e,i){e&1&&(n(0,"mat-header-cell"),o(1,"Payment Type"),a())}function $e(e,i){if(e&1&&(n(0,"mat-cell"),o(1),a()),e&2){let t=i.$implicit;m(),c(t.type)}}function qe(e,i){e&1&&(n(0,"mat-header-cell"),o(1,"Order Type"),a())}function Fe(e,i){if(e&1&&(n(0,"mat-cell"),o(1),M(2,"titlecase"),a()),e&2){let t=i.$implicit;m(),c(V(2,1,t.ordertype))}}function Oe(e,i){e&1&&(n(0,"mat-header-cell"),o(1,"Total"),a())}function ze(e,i){if(e&1&&(n(0,"mat-cell"),o(1),M(2,"currency"),a()),e&2){let t,r=i.$implicit,l=u(2);m(),c($(2,1,r.total,(t=l.storeStore.selectedStore())==null?null:t.currency))}}function Be(e,i){e&1&&f(0,"mat-header-row")}function He(e,i){e&1&&f(0,"mat-row")}function Ne(e,i){if(e&1){let t=h();n(0,"nav",6),w(1,ge,6,3,"a",7,Me),a(),n(3,"mat-tab-nav-panel",null,0)(5,"div",8)(6,"button",9)(7,"mat-icon",10),o(8,"file_download"),a(),o(9," Export Data "),a(),n(10,"mat-menu",null,1)(12,"button",11),b("click",function(){x(t);let l=u();return S(l.exportData("pdf"))}),n(13,"mat-icon"),o(14,"picture_as_pdf"),a(),n(15,"span"),o(16,"Export as PDF"),a()(),n(17,"button",11),b("click",function(){x(t);let l=u();return S(l.exportData("csv"))}),n(18,"mat-icon"),o(19,"description"),a(),n(20,"span"),o(21,"Export as CSV"),a()(),n(22,"button",11),b("click",function(){x(t);let l=u();return S(l.exportData("excel"))}),n(23,"mat-icon"),o(24,"table_chart"),a(),n(25,"span"),o(26,"Export as Excel"),a()()()(),n(27,"div",12)(28,"mat-table",13),s(29,14),p(30,Te,2,0,"mat-header-cell",15)(31,Ee,2,1,"mat-cell",16),_(),s(32,17),p(33,Re,2,0,"mat-header-cell",15)(34,we,2,1,"mat-cell",16),_(),s(35,18),p(36,De,2,0,"mat-header-cell",15)(37,Pe,2,1,"mat-cell",16),_(),s(38,19),p(39,ke,2,0,"mat-header-cell",15)(40,Ie,2,1,"mat-cell",16),_(),s(41,20),p(42,Ve,2,0,"mat-header-cell",15)(43,$e,2,1,"mat-cell",16),_(),s(44,21),p(45,qe,2,0,"mat-header-cell",15)(46,Fe,3,3,"mat-cell",16),_(),s(47,22),p(48,Oe,2,0,"mat-header-cell",15)(49,ze,3,4,"mat-cell",16),_(),p(50,Be,1,0,"mat-header-row",23)(51,He,1,0,"mat-row",24),a(),f(52,"mat-paginator",25),a()()}if(e&2){let t=y(4),r=y(11),l=u();d("tabPanel",t),m(),D(l.tabStats),m(5),d("matMenuTriggerFor",r),m(22),d("dataSource",l.dataSource.value().orders),m(22),d("matHeaderRowDef",l.displayedColumns),m(),d("matRowDefColumns",l.displayedColumns),m(),d("pageSize",l.pageSize)("pageSizeOptions",l.pageSizeOptions)}}function Qe(e,i){e&1&&(n(0,"div",5),f(1,"mat-spinner",30),a())}var he=class e{queryParams=C(fe);orderService=C(Se);storeStore=C(L);query=W(this.queryParams.getAllParams$);activeTab="all";tabStats;dataSource=X({params:()=>({storeId:this.storeStore.selectedStore()?._id,query:this.query()}),stream:({params:i})=>this.orderService.getSalesReceipts(i.storeId,i.query).pipe(g(t=>{let r=t.data;this.tabStats=[{label:"All Receipts",value:"all",count:r.allReceipts},{label:"Sales",value:"sales",count:r.sales},{label:"Refunds",value:"refund",count:r.refund}]}))});displayedColumns=["receiptNo","date","category","type","total","orderedBy","ordertype"];paginator;pageSize=10;pageSizeOptions=[5,10,25,50];exportService=C(be);exportData(i){if(!this.dataSource.value())return;let t=this.dataSource.value().orders,r="receipts";switch(i){case"pdf":this.exportService.exportToPdf(t,r,{from:this.query().start,to:this.query().end});break;case"csv":this.exportService.exportToCSV(t,r);break;case"excel":this.exportService.exportToExcel(t,r);break}}onTabChange(i){this.activeTab=i,this.queryParams.add({type:i})}static \u0275fac=function(t){return new(t||e)};static \u0275cmp=T({type:e,selectors:[["app-receipts"]],viewQuery:function(t,r){if(t&1&&P(v,5),t&2){let l;k(l=I())&&(r.paginator=l.first)}},decls:7,vars:1,consts:[["tabPanel",""],["exportMenu","matMenu"],[1,"p-4","bg-gray-50","min-h-screen"],[1,"flex","justify-between","items-center","mb-6","bg-white","p-4","rounded-lg","shadow-sm"],[1,"bg-white","rounded-lg","shadow-sm"],[1,"flex","items-center","justify-center","min-h-[300px]"],["mat-tab-nav-bar","",1,"grid","grid-cols-3",3,"tabPanel"],["mat-tab-link","",1,"!h-auto","!min-h-[100px]","!px-4","!py-4","border-b",3,"active"],[1,"p-6","flex","justify-between","items-center","border-b"],["mat-flat-button","","color","primary",3,"matMenuTriggerFor"],[1,"mr-2"],["mat-menu-item","",3,"click"],[1,"p-6"],[1,"w-full","!bg-white",3,"dataSource"],["matColumnDef","receiptNo"],[4,"matHeaderCellDef"],[4,"matCellDef"],["matColumnDef","date"],["matColumnDef","orderedBy"],["matColumnDef","category"],["matColumnDef","type"],["matColumnDef","ordertype"],["matColumnDef","total"],[4,"matHeaderRowDef"],[4,"matRowDef","matRowDefColumns"],["showFirstLastButtons","","aria-label","Select page",1,"!bg-white",3,"pageSize","pageSizeOptions"],["mat-tab-link","",1,"!h-auto","!min-h-[100px]","!px-4","!py-4","border-b",3,"click","active"],[1,"text-center"],[1,"text-gray-600","font-medium","mb-1"],[1,"text-2xl","font-semibold"],["diameter","40"]],template:function(t,r){t&1&&(n(0,"div",2)(1,"div",3),f(2,"date-range-selector")(3,"app-employee-selector"),a(),n(4,"div",4),E(5,Ne,53,7)(6,Qe,2,0,"div",5),a()()),t&2&&(m(5),R(r.dataSource.hasValue()?5:6))},dependencies:[O,q,F,me,Y,ee,ae,te,Z,oe,ie,ne,re,le,ue,v,U,J,G,K,B,z,A,j,_e,N,Q,se,ce,de,pe,H,Ce,xe,ve],styles:["[_nghost-%COMP%]     .mat-mdc-tab-nav-bar{border-bottom:none}.mat-mdc-tab-link[_ngcontent-%COMP%]{opacity:1!important}"]})};export{he as ReceiptsComponent};
