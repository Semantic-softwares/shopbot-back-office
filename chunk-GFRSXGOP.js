import{a as nt}from"./chunk-7FSETBMW.js";import"./chunk-HJ3KAQ7K.js";import{a as et}from"./chunk-2AUUGPQP.js";import{a as Ze,b as Ye,c as qe,h as Qe}from"./chunk-Y2RO63AQ.js";import{a as Xe}from"./chunk-JZKRHT5H.js";import"./chunk-O4OM35BU.js";import{a as Ge,b as $e,c as Ae,d as Ue,e as je,f as Le,g as He,h as We,i as ze,j as Je,k as Ke}from"./chunk-2UZI5XAB.js";import"./chunk-FK6H3RFT.js";import{b as Ve}from"./chunk-4XV2UKEU.js";import{a as q}from"./chunk-CP5EC6RD.js";import"./chunk-CCJ2KI64.js";import"./chunk-6RCOBA75.js";import{c as tt}from"./chunk-BDA5IGGY.js";import"./chunk-WFM45R76.js";import"./chunk-A24HMJCQ.js";import{a as ue,b as se}from"./chunk-CRC3Q7VD.js";import{a as ve,b as _e,c as ge,d as Ce}from"./chunk-Q4U6FYZ3.js";import{i as ne}from"./chunk-QC7H4KPM.js";import{a as Pe,b as Ne}from"./chunk-WZDQ5XTC.js";import{d as Y}from"./chunk-R6JGHN2R.js";import{d as Oe}from"./chunk-BXJEGH2V.js";import"./chunk-64WHNS37.js";import"./chunk-TIVXUJ22.js";import"./chunk-WAHSRZAW.js";import"./chunk-XLZTIYSF.js";import{b as Me,c as ke,d as Ie}from"./chunk-UMV4DCPT.js";import{a as Ee,e as Te,h as we}from"./chunk-G3VZM262.js";import"./chunk-BCE7WRWQ.js";import{a as Fe,b as Be}from"./chunk-6I3AJKA7.js";import{B as De,b as fe,g as xe,h as he,m as Re,s as be,t as ye,z as Se}from"./chunk-W7NMJLMQ.js";import"./chunk-F5SZ3AU3.js";import"./chunk-TILT22SG.js";import{a as te}from"./chunk-BFT2MTJY.js";import{a as re,b as oe,c as le,d as me,f as de,g as ce,h as pe}from"./chunk-3E3PJ7Q7.js";import"./chunk-FO4KTVQ3.js";import"./chunk-TRZH7NMW.js";import"./chunk-GXTELBJV.js";import{b as ie,c as ae}from"./chunk-JPRPNQOM.js";import{Z as Q,_ as X,ba as ee}from"./chunk-3LDCGXHW.js";import"./chunk-ZLVQTB5B.js";import{m as W,o as z,q as J,s as K,y as Z}from"./chunk-6PFJHDFS.js";import{F as M,Ib as h,Jb as R,Lc as u,Mc as P,Nc as H,Ob as p,Pb as i,Pc as x,Qb as a,Rb as b,Vb as _,Vc as y,Wb as g,Yb as O,aa as U,ac as T,bb as l,cc as c,ea as j,fa as k,ka as D,la as E,m as w,mc as B,qb as L,qc as V,r as $,rc as r,sc as C,tc as f,wa as I,wb as s,x as A}from"./chunk-J2AK4FW5.js";import{a as S}from"./chunk-GAL4ENT6.js";var N=class n{constructor(t){this.http=t}apiUrl=`${te.apiUrl}/revenue`;getRevenueData(t,e){let o=S(S({storeId:t,startDate:e.startDate,endDate:e.endDate,reportType:e.reportType},e.revenueType&&{revenueType:e.revenueType}),e.paymentMethod&&{paymentMethod:e.paymentMethod});return this.http.get(`${this.apiUrl}/data`,{params:o,headers:{storeid:t}}).pipe(M(m=>(console.error("API Error, falling back to mock data:",m),w(this.getMockRevenueData()))))}getRevenueStats(t,e){let o=S(S({storeId:t,startDate:e.startDate,endDate:e.endDate,reportType:e.reportType},e.revenueType&&{revenueType:e.revenueType}),e.paymentMethod&&{paymentMethod:e.paymentMethod});return this.http.get(`${this.apiUrl}/stats`,{params:o,headers:{storeid:t}}).pipe(M(m=>(console.error("API Error, falling back to mock data:",m),w(this.getMockRevenueStats()))))}getRevenueBreakdown(t,e){let o=S(S({storeId:t,startDate:e.startDate,endDate:e.endDate,reportType:e.reportType},e.revenueType&&{revenueType:e.revenueType}),e.paymentMethod&&{paymentMethod:e.paymentMethod});return this.http.get(`${this.apiUrl}/breakdown`,{params:o,headers:{storeid:t}}).pipe(M(m=>(console.error("API Error, falling back to mock data:",m),w(this.getMockRevenueBreakdown()))))}exportToCSV(t,e){let o=S(S({storeId:t,startDate:e.startDate,endDate:e.endDate,reportType:e.reportType,format:"csv"},e.revenueType&&{revenueType:e.revenueType}),e.paymentMethod&&{paymentMethod:e.paymentMethod});return this.http.get(`${this.apiUrl}/export`,{params:o,headers:{storeid:t},responseType:"blob"}).pipe(M(m=>{console.error("Export API Error, generating local CSV:",m);let d=this.generateCSVData(),v=new Blob([d],{type:"text/csv"});return w(v)}))}exportToPDF(t,e){let o=S(S({storeId:t,startDate:e.startDate,endDate:e.endDate,reportType:e.reportType,format:"pdf"},e.revenueType&&{revenueType:e.revenueType}),e.paymentMethod&&{paymentMethod:e.paymentMethod});return this.http.get(`${this.apiUrl}/export`,{params:o,headers:{storeid:t},responseType:"blob"}).pipe(M(m=>{console.error("Export API Error, generating local PDF:",m);let d="Mock PDF data",v=new Blob([d],{type:"application/pdf"});return w(v)}))}getMockRevenueData(){let t=new Date,e=[];for(let o=29;o>=0;o--){let m=new Date(t);m.setDate(m.getDate()-o);let d=Math.random()*5e3+2e3,v=d*(.6+Math.random()*.2),F=d*(.2+Math.random()*.1),at=d-v-F,G=Math.floor(Math.random()*50+20);e.push({date:m.toISOString().split("T")[0],totalRevenue:d,roomRevenue:v,serviceRevenue:F,otherRevenue:at,transactions:G,averageTransaction:d/G,revenueGrowth:Math.random()*20-10})}return e}getMockRevenueStats(){let t=this.getMockRevenueData(),e=t.reduce((d,v)=>d+v.totalRevenue,0),o=t.reduce((d,v)=>d+v.transactions,0),m=Math.max(...t.map(d=>d.totalRevenue));return{totalRevenue:e,totalTransactions:o,averageTransactionValue:e/o,averageDailyRevenue:e/t.length,revenueGrowth:8.5,peakRevenueAmount:m,monthlyProjection:e/t.length*30}}getMockRevenueBreakdown(){return[{category:"Room Revenue",amount:15e4*.65,percentage:65,transactions:450,averageAmount:15e4*.65/450},{category:"Service Revenue",amount:15e4*.25,percentage:25,transactions:280,averageAmount:15e4*.25/280},{category:"Food & Beverage",amount:15e4*.08,percentage:8,transactions:120,averageAmount:15e4*.08/120},{category:"Other Revenue",amount:15e4*.02,percentage:2,transactions:35,averageAmount:15e4*.02/35}]}generateCSVData(){let t=this.getMockRevenueData(),o=["Date","Total Revenue","Room Revenue","Service Revenue","Other Revenue","Transactions","Average Transaction","Growth %"].join(",")+`
`;return t.forEach(m=>{let d=[m.date,m.totalRevenue.toFixed(2),m.roomRevenue.toFixed(2),m.serviceRevenue.toFixed(2),m.otherRevenue.toFixed(2),m.transactions.toString(),m.averageTransaction.toFixed(2),m.revenueGrowth.toFixed(2)];o+=d.join(",")+`
`}),o}static \u0275fac=function(e){return new(e||n)(j(Z))};static \u0275prov=U({token:n,factory:n.\u0275fac,providedIn:"root"})};function ot(n,t){n&1&&b(0,"mat-spinner",6)}function lt(n,t){n&1&&(i(0,"mat-icon"),r(1,"refresh"),a())}function mt(n,t){n&1&&(i(0,"div",10),b(1,"mat-spinner",35),a())}function dt(n,t){if(n&1){let e=O();i(0,"mat-card",11)(1,"mat-card-content",36)(2,"div",37)(3,"mat-icon",38),r(4,"warning"),a(),i(5,"div",39)(6,"p",40),r(7),a()(),i(8,"button",41),T("click",function(){D(e);let m=c();return E(m.clearError())}),i(9,"mat-icon",42),r(10,"close"),a()()()()()}if(n&2){let e=c();l(7),C(e.error())}}function ct(n,t){if(n&1&&(i(0,"span"),r(1),a()),n&2){let e=c(3);l(),f("+",e.revenueStats().revenueGrowth,"%")}}function pt(n,t){if(n&1&&(i(0,"span"),r(1),a()),n&2){let e=c(3);l(),f("",e.revenueStats().revenueGrowth,"%")}}function ut(n,t){if(n&1&&(i(0,"p",71)(1,"mat-icon",72),r(2),a(),h(3,ct,2,1,"span")(4,pt,2,1,"span"),a()),n&2){let e=c(2);V(e.getRevenueGrowthClass(e.revenueStats().revenueGrowth)),l(2),C(e.getRevenueGrowthIcon(e.revenueStats().revenueGrowth)),l(),R(e.revenueStats().revenueGrowth>0?3:4)}}function st(n,t){if(n&1&&(i(0,"div",66),b(1,"canvas",73),a()),n&2){let e=c(2);l(),p("data",e.revenueTrendChartData())("options",e.chartOptions())}}function vt(n,t){n&1&&(i(0,"div",67)(1,"div",74)(2,"mat-icon",75),r(3,"bar_chart"),a(),i(4,"p",76),r(5,"No revenue data available"),a()()())}function _t(n,t){if(n&1&&(i(0,"div",66),b(1,"canvas",77),a()),n&2){let e=c(2);l(),p("data",e.revenueBreakdownChartData())("options",e.doughnutChartOptions())}}function gt(n,t){n&1&&(i(0,"div",67)(1,"div",74)(2,"mat-icon",75),r(3,"pie_chart"),a(),i(4,"p",76),r(5,"No breakdown data available"),a()()())}function Ct(n,t){n&1&&(i(0,"th",92),r(1,"Category"),a())}function ft(n,t){if(n&1&&(i(0,"td",93),r(1),a()),n&2){let e=t.$implicit;l(),C(e.category)}}function xt(n,t){n&1&&(i(0,"th",92),r(1,"Amount"),a())}function ht(n,t){if(n&1&&(i(0,"td",94),r(1),u(2,"currency"),a()),n&2){let e=t.$implicit,o=c(3);l(),C(x(2,1,e.amount,o.currency(),"symbol","1.2-2"))}}function Rt(n,t){n&1&&(i(0,"th",92),r(1,"Percentage"),a())}function bt(n,t){if(n&1&&(i(0,"td",94)(1,"div",95),b(2,"mat-progress-bar",96),i(3,"span"),r(4),a()()()),n&2){let e=t.$implicit;l(2),p("value",e.percentage),l(2),f("",e.percentage,"%")}}function yt(n,t){n&1&&(i(0,"th",92),r(1,"Transactions"),a())}function St(n,t){if(n&1&&(i(0,"td",94),r(1),u(2,"number"),a()),n&2){let e=t.$implicit;l(),C(P(2,1,e.transactions))}}function Dt(n,t){n&1&&(i(0,"th",92),r(1,"Avg per Transaction"),a())}function Et(n,t){if(n&1&&(i(0,"td",94),r(1),u(2,"currency"),a()),n&2){let e=t.$implicit,o=c(3);l(),C(x(2,1,e.averageAmount,o.currency(),"symbol","1.2-2"))}}function Tt(n,t){n&1&&b(0,"tr",97)}function wt(n,t){n&1&&b(0,"tr",98)}function Mt(n,t){if(n&1&&(i(0,"mat-card",13)(1,"mat-card-header")(2,"mat-icon",78),r(3,"category"),a(),i(4,"mat-card-title"),r(5,"Revenue Breakdown Details"),a()(),i(6,"mat-card-content",79)(7,"div",80)(8,"table",81),_(9,82),s(10,Ct,2,0,"th",83)(11,ft,2,1,"td",84),g(),_(12,85),s(13,xt,2,0,"th",83)(14,ht,3,6,"td",86),g(),_(15,87),s(16,Rt,2,0,"th",83)(17,bt,5,2,"td",86),g(),_(18,88),s(19,yt,2,0,"th",83)(20,St,3,3,"td",86),g(),_(21,89),s(22,Dt,2,0,"th",83)(23,Et,3,6,"td",86),g(),s(24,Tt,1,0,"tr",90)(25,wt,1,0,"tr",91),a()()()()),n&2){let e=c(2);l(8),p("dataSource",e.revenueBreakdown()),l(16),p("matHeaderRowDef",e.breakdownColumns),l(),p("matRowDefColumns",e.breakdownColumns)}}function kt(n,t){n&1&&(i(0,"th",92),r(1,"Date"),a())}function It(n,t){if(n&1&&(i(0,"td",93),r(1),a()),n&2){let e=t.$implicit,o=c(3);l(),C(o.formatDate(e.date))}}function Ft(n,t){n&1&&(i(0,"th",92),r(1,"Total Revenue"),a())}function Bt(n,t){if(n&1&&(i(0,"td",93),r(1),u(2,"currency"),a()),n&2){let e=t.$implicit,o=c(3);l(),f(" ",x(2,1,e.totalRevenue,o.currency(),"symbol","1.2-2")," ")}}function Pt(n,t){n&1&&(i(0,"th",92),r(1,"Room Revenue"),a())}function Nt(n,t){if(n&1&&(i(0,"td",94),r(1),u(2,"currency"),a()),n&2){let e=t.$implicit,o=c(3);l(),C(x(2,1,e.roomRevenue,o.currency(),"symbol","1.2-2"))}}function Ot(n,t){n&1&&(i(0,"th",92),r(1,"Service Revenue"),a())}function Vt(n,t){if(n&1&&(i(0,"td",94),r(1),u(2,"currency"),a()),n&2){let e=t.$implicit,o=c(3);l(),C(x(2,1,e.serviceRevenue,o.currency(),"symbol","1.2-2"))}}function Gt(n,t){n&1&&(i(0,"th",92),r(1,"Other Revenue"),a())}function $t(n,t){if(n&1&&(i(0,"td",94),r(1),u(2,"currency"),a()),n&2){let e=t.$implicit,o=c(3);l(),C(x(2,1,e.otherRevenue,o.currency(),"symbol","1.2-2"))}}function At(n,t){n&1&&(i(0,"th",92),r(1,"Transactions"),a())}function Ut(n,t){if(n&1&&(i(0,"td",94),r(1),u(2,"number"),a()),n&2){let e=t.$implicit;l(),C(P(2,1,e.transactions))}}function jt(n,t){n&1&&(i(0,"th",92),r(1,"Avg Transaction"),a())}function Lt(n,t){if(n&1&&(i(0,"td",94),r(1),u(2,"currency"),a()),n&2){let e=t.$implicit,o=c(3);l(),C(x(2,1,e.averageTransaction,o.currency(),"symbol","1.2-2"))}}function Ht(n,t){n&1&&(i(0,"th",92),r(1,"Growth"),a())}function Wt(n,t){if(n&1&&(i(0,"span"),r(1),a()),n&2){let e=c().$implicit;l(),f("+",e.revenueGrowth,"%")}}function zt(n,t){if(n&1&&(i(0,"span"),r(1),a()),n&2){let e=c().$implicit;l(),f("",e.revenueGrowth,"%")}}function Jt(n,t){n&1&&(i(0,"span"),r(1,"0%"),a())}function Kt(n,t){if(n&1&&(i(0,"td",94)(1,"span",107)(2,"mat-icon",72),r(3),a(),h(4,Wt,2,1,"span")(5,zt,2,1,"span")(6,Jt,2,0,"span"),a()()),n&2){let e=t.$implicit,o=c(3);l(),V(o.getRevenueGrowthClass(e.revenueGrowth)),l(2),C(o.getRevenueGrowthIcon(e.revenueGrowth)),l(),R(e.revenueGrowth>0?4:e.revenueGrowth<0?5:6)}}function Zt(n,t){n&1&&b(0,"tr",97)}function Yt(n,t){n&1&&b(0,"tr",98)}function qt(n,t){if(n&1&&(i(0,"mat-card",13)(1,"mat-card-header")(2,"mat-icon",99),r(3,"table_chart"),a(),i(4,"mat-card-title"),r(5,"Daily Revenue Data"),a(),i(6,"mat-card-subtitle"),r(7),a()(),i(8,"mat-card-content",79)(9,"div",80)(10,"table",81),_(11,100),s(12,kt,2,0,"th",83)(13,It,2,1,"td",84),g(),_(14,101),s(15,Ft,2,0,"th",83)(16,Bt,3,6,"td",84),g(),_(17,102),s(18,Pt,2,0,"th",83)(19,Nt,3,6,"td",86),g(),_(20,103),s(21,Ot,2,0,"th",83)(22,Vt,3,6,"td",86),g(),_(23,104),s(24,Gt,2,0,"th",83)(25,$t,3,6,"td",86),g(),_(26,88),s(27,At,2,0,"th",83)(28,Ut,3,3,"td",86),g(),_(29,105),s(30,jt,2,0,"th",83)(31,Lt,3,6,"td",86),g(),_(32,106),s(33,Ht,2,0,"th",83)(34,Kt,7,4,"td",86),g(),s(35,Zt,1,0,"tr",90)(36,Yt,1,0,"tr",91),a()()()()),n&2){let e=c(2);l(7),f("",e.revenueData().length," records found"),l(3),p("dataSource",e.revenueData()),l(25),p("matHeaderRowDef",e.displayedColumns),l(),p("matRowDefColumns",e.displayedColumns)}}function Qt(n,t){if(n&1&&(i(0,"div",43)(1,"mat-card",44)(2,"mat-card-content",15)(3,"div",37)(4,"div",39)(5,"p",45),r(6,"Total Revenue"),a(),i(7,"p",46),r(8),u(9,"currency"),a(),h(10,ut,5,4,"p",47),a(),i(11,"div",48)(12,"mat-icon",49),r(13,"payments"),a()()()()(),i(14,"mat-card",50)(15,"mat-card-content",15)(16,"div",37)(17,"div",39)(18,"p",51),r(19,"Total Transactions"),a(),i(20,"p",52),r(21),u(22,"number"),a(),i(23,"p",53),r(24),u(25,"currency"),a()(),i(26,"div",54)(27,"mat-icon",49),r(28,"receipt_long"),a()()()()(),i(29,"mat-card",55)(30,"mat-card-content",15)(31,"div",37)(32,"div",39)(33,"p",56),r(34,"Daily Average"),a(),i(35,"p",57),r(36),u(37,"currency"),a(),i(38,"p",58),r(39),u(40,"currency"),a()(),i(41,"div",59)(42,"mat-icon",49),r(43,"bar_chart"),a()()()()(),i(44,"mat-card",60)(45,"mat-card-content",15)(46,"div",37)(47,"div",39)(48,"p",61),r(49,"Monthly Projection"),a(),i(50,"p",62),r(51),u(52,"currency"),a(),i(53,"p",63),r(54,"Based on current trends"),a()(),i(55,"div",64)(56,"mat-icon",49),r(57,"trending_up"),a()()()()()(),i(58,"div",65)(59,"mat-card",13)(60,"mat-card-header")(61,"mat-icon",14),r(62,"show_chart"),a(),i(63,"mat-card-title"),r(64,"Revenue Trend"),a()(),i(65,"mat-card-content",15),h(66,st,2,2,"div",66)(67,vt,6,0,"div",67),a()(),i(68,"mat-card",13)(69,"mat-card-header")(70,"mat-icon",68),r(71,"pie_chart"),a(),i(72,"mat-card-title"),r(73,"Revenue Breakdown"),a()(),i(74,"mat-card-content",15),h(75,_t,2,2,"div",66)(76,gt,6,0,"div",67),a()()(),h(77,Mt,26,3,"mat-card",13),h(78,qt,37,4,"mat-card",13),i(79,"div",69)(80,"mat-icon",70),r(81,"schedule"),a(),r(82),u(83,"date"),a()),n&2){let e=c();l(8),f(" ",x(9,12,e.revenueStats().totalRevenue,e.currency(),"symbol","1.0-0")," "),l(2),R(e.revenueStats().revenueGrowth!==0?10:-1),l(11),C(P(22,17,e.revenueStats().totalTransactions)),l(3),f(" Avg: ",x(25,19,e.revenueStats().averageTransactionValue,e.currency(),"symbol","1.2-2")," "),l(12),f(" ",x(37,24,e.revenueStats().averageDailyRevenue,e.currency(),"symbol","1.0-0")," "),l(3),f(" Peak: ",x(40,29,e.revenueStats().peakRevenueAmount,e.currency(),"symbol","1.0-0")," "),l(12),f(" ",x(52,34,e.revenueStats().monthlyProjection,e.currency(),"symbol","1.0-0")," "),l(15),R(e.revenueData().length>0?66:67),l(9),R(e.revenueBreakdown().length>0?75:76),l(2),R(e.revenueBreakdown().length>0?77:-1),l(),R(e.revenueData().length>0?78:-1),l(4),f(" Last updated: ",H(83,39,e.lastUpdated(),"medium")," ")}}var it=class n{fb=k(Se);revenueService=k(N);storeStore=k(ne);exportService=k(et);isExporting=I(!1);selectedStore=y(()=>this.storeStore.selectedStore());currencySymbolToCode={"\u20A6":"NGN",$:"USD","\u20AC":"EUR","\xA3":"GBP","\xA5":"JPY","\u20B9":"INR","\u20BD":"RUB","\u20A9":"KRW","\u0E3F":"THB","\u20AB":"VND",R$:"BRL",R:"ZAR",CHF:"CHF",kr:"SEK",z\u0142:"PLN"};currency=y(()=>{let t=this.selectedStore(),e=t?.currency||t?.currencyCode||"USD";return this.currencySymbolToCode[e]||e});filterTrigger=I(0);filterForm;lastUpdated=I(new Date);filterParams=y(()=>(this.filterTrigger(),{storeId:this.selectedStore()?._id||"",filters:this.getFilters()}));revenueResource=Oe({params:this.filterParams,stream:({params:t})=>t.storeId?A({revenueData:this.revenueService.getRevenueData(t.storeId,t.filters),revenueBreakdown:this.revenueService.getRevenueBreakdown(t.storeId,t.filters),stats:this.revenueService.getRevenueStats(t.storeId,t.filters)}).pipe($(e=>(this.lastUpdated.set(new Date),e)),M(e=>(console.error("Error loading data:",e),w(null)))):w(null)});loading=y(()=>this.revenueResource.isLoading());error=I(null);revenueData=y(()=>this.revenueResource.value()?.revenueData||[]);revenueBreakdown=y(()=>this.revenueResource.value()?.revenueBreakdown||[]);revenueStats=y(()=>this.revenueResource.value()?.stats||null);revenueTrendChartData=y(()=>{let t=this.revenueData();return{labels:t.map(e=>this.formatDateShort(new Date(e.date))),datasets:[{data:t.map(e=>e.totalRevenue),label:"Total Revenue",backgroundColor:"rgba(59, 130, 246, 0.1)",borderColor:"rgba(59, 130, 246, 1)",borderWidth:2,fill:!0,tension:.4},{data:t.map(e=>e.roomRevenue),label:"Room Revenue",backgroundColor:"rgba(34, 197, 94, 0.1)",borderColor:"rgba(34, 197, 94, 1)",borderWidth:2,fill:!1,tension:.4}]}});revenueBreakdownChartData=y(()=>{let t=this.revenueBreakdown();return{labels:t.map(e=>e.category),datasets:[{data:t.map(e=>e.amount),backgroundColor:["rgba(59, 130, 246, 0.8)","rgba(34, 197, 94, 0.8)","rgba(168, 85, 247, 0.8)","rgba(245, 158, 11, 0.8)","rgba(239, 68, 68, 0.8)","rgba(20, 184, 166, 0.8)"],borderWidth:2,borderColor:"#fff"}]}});chartOptions=y(()=>({responsive:!0,maintainAspectRatio:!1,interaction:{intersect:!1,mode:"index"},plugins:{legend:{display:!0,position:"top"},tooltip:{callbacks:{label:t=>{let e=this.currency(),o=new Intl.NumberFormat("en-US",{style:"currency",currency:e});return`${t.dataset.label}: ${o.format(t.parsed.y)}`}}}},scales:{x:{display:!0,title:{display:!0,text:"Date"}},y:{display:!0,title:{display:!0,text:`Revenue (${this.currency()})`},beginAtZero:!0,ticks:{callback:t=>{let e=this.currency();return new Intl.NumberFormat("en-US",{style:"currency",currency:e}).format(Number(t))}}}}}));doughnutChartOptions=y(()=>({responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!0,position:"right"},tooltip:{callbacks:{label:t=>{let e=this.currency(),o=new Intl.NumberFormat("en-US",{style:"currency",currency:e}),m=t.dataset.data.reduce((v,F)=>v+Number(F),0),d=(Number(t.parsed)/m*100).toFixed(1);return`${t.label}: ${o.format(Number(t.parsed))} (${d}%)`}}}}}));displayedColumns=["date","totalRevenue","roomRevenue","serviceRevenue","otherRevenue","transactions","averageTransaction","revenueGrowth"];breakdownColumns=["category","amount","percentage","transactions","averageAmount"];constructor(){this.filterForm=this.fb.group({startDate:[new Date(Date.now()-720*60*60*1e3)],endDate:[new Date],reportType:["daily"],revenueType:["all"],paymentMethod:["all"]})}refreshData(){this.filterTrigger.update(t=>t+1)}onDateRangeChange(){this.filterTrigger.update(t=>t+1)}onFilterChange(){this.filterTrigger.update(t=>t+1)}clearError(){this.error.set(null)}getFilters(){let t=this.filterForm.value;return{startDate:t.startDate,endDate:t.endDate,reportType:t.reportType,revenueType:t.revenueType!=="all"?t.revenueType:void 0,paymentMethod:t.paymentMethod!=="all"?t.paymentMethod:void 0}}exportToCSV(){let t=this.selectedStore()?._id||"",e=this.getFilters();this.isExporting.set(!0),this.revenueService.exportToCSV(t,e).subscribe({next:o=>{let m=window.URL.createObjectURL(o),d=document.createElement("a");d.href=m,d.download=`revenue-report-${this.formatDateISO(new Date)}.csv`,d.click(),window.URL.revokeObjectURL(m),this.isExporting.set(!1)},error:o=>{console.error("Export error:",o),this.isExporting.set(!1)}})}exportToPDF(){let t=this.selectedStore()?._id||"",e=this.getFilters();this.isExporting.set(!0),this.revenueService.exportToPDF(t,e).subscribe({next:o=>{let m=window.URL.createObjectURL(o),d=document.createElement("a");d.href=m,d.download=`revenue-report-${this.formatDateISO(new Date)}.pdf`,d.click(),window.URL.revokeObjectURL(m),this.isExporting.set(!1)},error:o=>{console.error("Export error:",o),this.isExporting.set(!1)}})}exportData(t){if(!this.revenueData().length)return;let e=this.revenueData(),o="revenue-report",m={from:this.filterForm.value.startDate?.toISOString()||"",to:this.filterForm.value.endDate?.toISOString()||""};switch(t){case"pdf":this.exportService.exportRevenueDataToPdf(e,o,m);break;case"csv":this.exportService.exportToCSV(e,o);break;case"excel":this.exportService.exportToExcel(e,o);break}}getRevenueGrowthClass(t){return t>0?"text-green-600":t<0?"text-red-600":"text-gray-500"}getRevenueGrowthIcon(t){return t>0?"trending_up":t<0?"trending_down":"trending_flat"}formatCurrency(t){return new Intl.NumberFormat("en-US",{style:"currency",currency:this.currency()}).format(t)}formatDate(t){return new Date(t).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}formatDateShort(t){return t.toLocaleDateString("en-US",{month:"short",day:"numeric"})}formatDateISO(t){return t.toISOString().split("T")[0]}formatPercent(t){return`${t.toFixed(1)}%`}formatNumber(t){return t.toLocaleString()}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=L({type:n,selectors:[["app-revenue-report"]],decls:91,vars:12,consts:[["exportMenu","matMenu"],["startPicker",""],["endPicker",""],["title","Revenue Report","subtitle","Track and analyze your revenue performance and trends"],["actions",""],["mat-stroked-button","",3,"click","disabled"],["diameter","18"],["mat-flat-button","","color","primary",3,"matMenuTriggerFor"],["iconPositionEnd",""],["mat-menu-item","",3,"click"],[1,"flex","justify-center","items-center","py-16"],["appearance","outlined",1,"m-6","bg-yellow-50!"],[1,"p-6","space-y-6"],["appearance","outlined"],["mat-card-avatar","",1,"text-blue-600"],[1,"p-6!"],[1,"grid","grid-cols-1","md:grid-cols-2","lg:grid-cols-5","gap-4",3,"formGroup"],["appearance","outline"],["matInput","","formControlName","startDate",3,"dateChange","matDatepicker"],["matIconSuffix","",3,"for"],["matInput","","formControlName","endDate",3,"dateChange","matDatepicker"],["formControlName","reportType",3,"selectionChange"],["value","daily"],["value","weekly"],["value","monthly"],["formControlName","revenueType",3,"selectionChange"],["value","all"],["value","room"],["value","service"],["value","other"],["formControlName","paymentMethod",3,"selectionChange"],["value","cash"],["value","card"],["value","online"],["value","transfer"],["diameter","40"],[1,"p-4!"],[1,"flex","items-center"],[1,"text-yellow-500","mr-3"],[1,"flex-1"],[1,"text-sm","text-yellow-700"],["mat-icon-button","",3,"click"],[1,"text-yellow-500"],[1,"grid","grid-cols-1","sm:grid-cols-2","lg:grid-cols-4","gap-6"],["appearance","outlined",1,"bg-green-50!","border-green-200!"],[1,"text-sm","font-medium","text-green-600","uppercase","tracking-wide"],[1,"text-2xl","font-bold","text-green-900"],[1,"text-sm","mt-1","flex","items-center","gap-1",3,"class"],[1,"w-12","h-12","bg-green-500","rounded-full","flex","items-center","justify-center"],[1,"text-white"],["appearance","outlined",1,"bg-blue-50!","border-blue-200!"],[1,"text-sm","font-medium","text-blue-600","uppercase","tracking-wide"],[1,"text-2xl","font-bold","text-blue-900"],[1,"text-sm","text-blue-600","mt-1"],[1,"w-12","h-12","bg-blue-500","rounded-full","flex","items-center","justify-center"],["appearance","outlined",1,"bg-purple-50!","border-purple-200!"],[1,"text-sm","font-medium","text-purple-600","uppercase","tracking-wide"],[1,"text-2xl","font-bold","text-purple-900"],[1,"text-sm","text-purple-600","mt-1"],[1,"w-12","h-12","bg-purple-500","rounded-full","flex","items-center","justify-center"],["appearance","outlined",1,"bg-orange-50!","border-orange-200!"],[1,"text-sm","font-medium","text-orange-600","uppercase","tracking-wide"],[1,"text-2xl","font-bold","text-orange-900"],[1,"text-sm","text-orange-600","mt-1"],[1,"w-12","h-12","bg-orange-500","rounded-full","flex","items-center","justify-center"],[1,"grid","grid-cols-1","lg:grid-cols-2","gap-6"],[1,"h-80"],[1,"h-80","flex","items-center","justify-center","text-gray-500"],["mat-card-avatar","",1,"text-purple-600"],[1,"text-center","text-sm","text-gray-500"],[1,"text-base","align-text-bottom","mr-1"],[1,"text-sm","mt-1","flex","items-center","gap-1"],[1,"text-base"],["baseChart","","type","line",3,"data","options"],[1,"text-center"],[1,"text-6xl","text-gray-300"],[1,"mt-2"],["baseChart","","type","doughnut",3,"data","options"],["mat-card-avatar","",1,"text-indigo-600"],[1,"p-0!"],[1,"overflow-x-auto"],["mat-table","",1,"w-full",3,"dataSource"],["matColumnDef","category"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","","class","font-medium",4,"matCellDef"],["matColumnDef","amount"],["mat-cell","",4,"matCellDef"],["matColumnDef","percentage"],["matColumnDef","transactions"],["matColumnDef","averageAmount"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","","class","hover:bg-gray-50",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell","",1,"font-medium"],["mat-cell",""],[1,"flex","items-center","gap-2"],["mode","determinate",1,"w-16",3,"value"],["mat-header-row",""],["mat-row","",1,"hover:bg-gray-50"],["mat-card-avatar","",1,"text-teal-600"],["matColumnDef","date"],["matColumnDef","totalRevenue"],["matColumnDef","roomRevenue"],["matColumnDef","serviceRevenue"],["matColumnDef","otherRevenue"],["matColumnDef","averageTransaction"],["matColumnDef","revenueGrowth"],[1,"flex","items-center","gap-1"]],template:function(e,o){if(e&1){let m=O();i(0,"app-page-header",3),_(1,4),i(2,"button",5),T("click",function(){return D(m),E(o.refreshData())}),h(3,ot,1,0,"mat-spinner",6)(4,lt,2,0,"mat-icon"),r(5),a(),i(6,"button",7)(7,"mat-icon"),r(8,"download"),a(),r(9," Export Data "),i(10,"mat-icon",8),r(11,"arrow_drop_down"),a()(),i(12,"mat-menu",null,0)(14,"button",9),T("click",function(){return D(m),E(o.exportData("pdf"))}),i(15,"mat-icon"),r(16,"picture_as_pdf"),a(),i(17,"span"),r(18,"Export as PDF"),a()(),i(19,"button",9),T("click",function(){return D(m),E(o.exportData("csv"))}),i(20,"mat-icon"),r(21,"description"),a(),i(22,"span"),r(23,"Export as CSV"),a()(),i(24,"button",9),T("click",function(){return D(m),E(o.exportData("excel"))}),i(25,"mat-icon"),r(26,"table_chart"),a(),i(27,"span"),r(28,"Export as Excel"),a()()(),g(),a(),h(29,mt,2,0,"div",10),h(30,dt,11,1,"mat-card",11),i(31,"div",12)(32,"mat-card",13)(33,"mat-card-header")(34,"mat-icon",14),r(35,"filter_list"),a(),i(36,"mat-card-title"),r(37,"Report Filters"),a()(),i(38,"mat-card-content",15)(39,"form",16)(40,"mat-form-field",17)(41,"mat-label"),r(42,"Start Date"),a(),i(43,"input",18),T("dateChange",function(){return D(m),E(o.onDateRangeChange())}),a(),b(44,"mat-datepicker-toggle",19)(45,"mat-datepicker",null,1),a(),i(47,"mat-form-field",17)(48,"mat-label"),r(49,"End Date"),a(),i(50,"input",20),T("dateChange",function(){return D(m),E(o.onDateRangeChange())}),a(),b(51,"mat-datepicker-toggle",19)(52,"mat-datepicker",null,2),a(),i(54,"mat-form-field",17)(55,"mat-label"),r(56,"Report Type"),a(),i(57,"mat-select",21),T("selectionChange",function(){return D(m),E(o.onFilterChange())}),i(58,"mat-option",22),r(59,"Daily"),a(),i(60,"mat-option",23),r(61,"Weekly"),a(),i(62,"mat-option",24),r(63,"Monthly"),a()()(),i(64,"mat-form-field",17)(65,"mat-label"),r(66,"Revenue Type"),a(),i(67,"mat-select",25),T("selectionChange",function(){return D(m),E(o.onFilterChange())}),i(68,"mat-option",26),r(69,"All Categories"),a(),i(70,"mat-option",27),r(71,"Room Revenue"),a(),i(72,"mat-option",28),r(73,"Service Revenue"),a(),i(74,"mat-option",29),r(75,"Other Revenue"),a()()(),i(76,"mat-form-field",17)(77,"mat-label"),r(78,"Payment Method"),a(),i(79,"mat-select",30),T("selectionChange",function(){return D(m),E(o.onFilterChange())}),i(80,"mat-option",26),r(81,"All Methods"),a(),i(82,"mat-option",31),r(83,"Cash"),a(),i(84,"mat-option",32),r(85,"Card"),a(),i(86,"mat-option",33),r(87,"Online"),a(),i(88,"mat-option",34),r(89,"Bank Transfer"),a()()()()()(),h(90,Qt,84,42),a()}if(e&2){let m=B(13),d=B(46),v=B(53);l(2),p("disabled",o.loading()),l(),R(o.loading()?3:4),l(2),f(" ",o.loading()?"Loading...":"Refresh"," "),l(),p("matMenuTriggerFor",m),l(23),R(o.loading()&&!o.revenueStats()?29:-1),l(),R(o.error()?30:-1),l(9),p("formGroup",o.filterForm),l(4),p("matDatepicker",d),l(),p("for",d),l(6),p("matDatepicker",v),l(),p("for",v),l(39),R(o.revenueStats()?90:-1)}},dependencies:[K,De,Re,fe,xe,he,ye,be,tt,nt,ee,X,Q,ae,ie,Ce,_e,ve,ge,pe,re,ce,le,de,me,oe,Me,we,Ee,Te,Ie,ke,Ne,Pe,Y,Ke,Ge,Ae,He,Ue,$e,We,je,Le,ze,Je,Be,Fe,Xe,Ve,Qe,Ze,Ye,qe,q,se,ue,z,J,W],styles:[".chart-container[_ngcontent-%COMP%]{position:relative;height:100%;width:100%}.loading-spinner[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_spin 1s linear infinite}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.revenue-table-row[_ngcontent-%COMP%]{transition:background-color .2s ease}.revenue-table-row[_ngcontent-%COMP%]:hover{background-color:#f9fafbcc}.export-button[_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed}.revenue-table-container[_ngcontent-%COMP%]::-webkit-scrollbar{height:8px;width:8px}.revenue-table-container[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#f1f1f1;border-radius:4px}.revenue-table-container[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#cbd5e0;border-radius:4px}.revenue-table-container[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#a0aec0}"]})};export{it as RevenueReportComponent};
