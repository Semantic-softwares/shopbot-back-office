import{a as W}from"./chunk-CQRXSTAL.js";import{a as X}from"./chunk-TNNZGNXU.js";import{a as U,b as Ye,c as Ze}from"./chunk-7FQZXLFT.js";import{a as et}from"./chunk-42HNZPKU.js";import{a as J,b as K}from"./chunk-GZXF4TWP.js";import{d as Qe,e as je,f as Ue,h as Je,i as Ke,j as We,k as Xe}from"./chunk-Y6EIGA75.js";import{a as He}from"./chunk-5HSGNHP2.js";import{a as j,b as ze}from"./chunk-LCP7K4QH.js";import"./chunk-JZKRHT5H.js";import"./chunk-O4OM35BU.js";import{a as Q,b as Ie,c as ke,d as Re,e as Ne,f as Be,g as Ge,h as Ve,i as Ae,j as qe,k as $e}from"./chunk-2UZI5XAB.js";import"./chunk-6RCOBA75.js";import{a as _e,b as ge,c as Ce,d as he}from"./chunk-Q4U6FYZ3.js";import{i as B}from"./chunk-QC7H4KPM.js";import{a as z,b as H}from"./chunk-WZDQ5XTC.js";import{d as I}from"./chunk-R6JGHN2R.js";import{d as M}from"./chunk-BXJEGH2V.js";import"./chunk-64WHNS37.js";import"./chunk-TIVXUJ22.js";import"./chunk-WAHSRZAW.js";import"./chunk-XLZTIYSF.js";import{b as A,c as q,d as $}from"./chunk-UMV4DCPT.js";import{a as G,b as Le,d as De,h as V}from"./chunk-G3VZM262.js";import"./chunk-BCE7WRWQ.js";import{a as Oe,b as Fe}from"./chunk-6I3AJKA7.js";import{B as Pe,b as Te,d as T,g as Se,h as Me,m as ve,n as xe,s as ye,t as Ee,z as we}from"./chunk-W7NMJLMQ.js";import"./chunk-F5SZ3AU3.js";import{a as N}from"./chunk-4UBDYPTG.js";import"./chunk-TILT22SG.js";import"./chunk-BFT2MTJY.js";import{a as ue,c as fe,h as be}from"./chunk-3E3PJ7Q7.js";import"./chunk-FO4KTVQ3.js";import"./chunk-TRZH7NMW.js";import"./chunk-GXTELBJV.js";import{b as ce,c as pe}from"./chunk-JPRPNQOM.js";import{Z as de,_ as k,ba as R}from"./chunk-3LDCGXHW.js";import{g as se}from"./chunk-ZLVQTB5B.js";import"./chunk-6PFJHDFS.js";import{Fc as le,Ib as p,Jb as u,Kb as oe,Mb as w,Nb as P,Ob as c,Pb as n,Qb as a,Rb as f,Vb as C,Vc as me,Wb as h,Yb as Z,ac as b,bb as l,cc as S,fa as s,gc as L,hc as D,ic as O,ka as x,la as y,mc as re,qb as E,rc as r,sc as F,tc as g,wa as Y,wb as _}from"./chunk-J2AK4FW5.js";import"./chunk-GAL4ENT6.js";var mt=(t,e)=>e._id;function st(t,e){t&1&&(n(0,"mat-error"),r(1," Table name is required "),a())}function dt(t,e){t&1&&(n(0,"mat-error"),r(1," Table name must be at least 2 characters "),a())}function ct(t,e){if(t&1&&(n(0,"mat-option",7),r(1),a()),t&2){let i=e.$implicit;c("value",i._id),l(),g(" ",i.name," ")}}function pt(t,e){t&1&&(n(0,"mat-error"),r(1," Category is required "),a())}function ut(t,e){t&1&&(n(0,"mat-error"),r(1," Number of guests is required "),a())}function ft(t,e){t&1&&(n(0,"mat-error"),r(1," Minimum 1 guest required "),a())}function bt(t,e){t&1&&(n(0,"mat-error"),r(1," Maximum 20 guests allowed "),a())}var v=class t{fb=s(we);tableService=s(W);tableCategoryService=s(X);storeStore=s(B);snackBar=s(N);dialogRef=s(Qe);data=s(je);tableForm;isEdit=!1;isLoading=!1;categories=M({params:()=>({storeId:this.storeStore.selectedStore()?._id}),stream:({params:e})=>this.tableCategoryService.getStoreTableCategories(e.storeId)});ngOnInit(){this.isEdit=this.data?.mode==="edit",this.initForm(),this.isEdit&&this.data.table&&this.populateForm(this.data.table)}initForm(){this.tableForm=this.fb.group({name:["",[T.required,T.minLength(2)]],category:["",T.required],numberOfGuest:[1,[T.required,T.min(1),T.max(20)]],active:[!0],store:[this.storeStore.selectedStore()?._id]})}populateForm(e){this.tableForm.patchValue({name:e.name,category:typeof e.category=="object"?e.category._id:e.category,numberOfGuest:e.numberOfGuest,active:e.active,storeId:e.storeId})}onSubmit(){if(this.tableForm.valid){this.isLoading=!0;let e=this.tableForm.value;this.isEdit?this.tableService.updateTable(this.data.table._id,e).subscribe({next:()=>{this.snackBar.open("Table updated successfully","Close",{duration:3e3,horizontalPosition:"end",verticalPosition:"top"}),this.dialogRef.close(!0)},error:i=>{console.error("Error updating table:",i),this.snackBar.open("Error updating table","Close",{duration:3e3,horizontalPosition:"end",verticalPosition:"top"}),this.isLoading=!1}}):this.tableService.createTable(e).subscribe({next:()=>{this.snackBar.open("Table created successfully","Close",{duration:3e3,horizontalPosition:"end",verticalPosition:"top"}),this.dialogRef.close(!0)},error:i=>{console.error("Error creating table:",i),this.snackBar.open("Error creating table","Close",{duration:3e3,horizontalPosition:"end",verticalPosition:"top"}),this.isLoading=!1}})}}onCancel(){this.dialogRef.close(!1)}static \u0275fac=function(i){return new(i||t)};static \u0275cmp=E({type:t,selectors:[["app-create-table"]],decls:35,vars:12,consts:[[1,"dialog-container"],["mat-dialog-title","",1,"text-xl","font-semibold","text-gray-900","mb-4"],[1,"space-y-4",3,"ngSubmit","formGroup"],[1,"space-y-4"],["appearance","outline",1,"w-full"],["matInput","","formControlName","name","placeholder","Enter table name"],["formControlName","category"],[3,"value"],["matInput","","type","number","formControlName","numberOfGuest","placeholder","Maximum number of guests"],[1,"flex","items-center","gap-3"],["formControlName","active","color","primary"],[1,"text-sm","text-gray-600"],[1,"flex","justify-end","gap-3","pt-4"],["mat-button","","type","button",3,"click","disabled"],["mat-raised-button","","color","primary","type","submit",3,"disabled"]],template:function(i,o){if(i&1&&(n(0,"div",0)(1,"h2",1),r(2),a(),n(3,"form",2),b("ngSubmit",function(){return o.onSubmit()}),n(4,"mat-dialog-content",3)(5,"mat-form-field",4)(6,"mat-label"),r(7,"Table Name"),a(),f(8,"input",5),p(9,st,2,0,"mat-error"),p(10,dt,2,0,"mat-error"),a(),n(11,"mat-form-field",4)(12,"mat-label"),r(13,"Category"),a(),n(14,"mat-select",6),w(15,ct,2,2,"mat-option",7,mt),a(),p(17,pt,2,0,"mat-error"),a(),n(18,"mat-form-field",4)(19,"mat-label"),r(20,"Number of Guests"),a(),f(21,"input",8),p(22,ut,2,0,"mat-error"),p(23,ft,2,0,"mat-error"),p(24,bt,2,0,"mat-error"),a(),n(25,"div",9)(26,"mat-slide-toggle",10),r(27," Active "),a(),n(28,"span",11),r(29),a()()(),n(30,"mat-dialog-actions",12)(31,"button",13),b("click",function(){return o.onCancel()}),r(32," Cancel "),a(),n(33,"button",14),r(34),a()()()()),i&2){let m,d,ee,te,ie,ae,ne;l(2),g(" ",o.isEdit?"Edit Table":"Create New Table"," "),l(),c("formGroup",o.tableForm),l(6),u((m=o.tableForm.get("name"))!=null&&m.hasError("required")?9:-1),l(),u((d=o.tableForm.get("name"))!=null&&d.hasError("minlength")?10:-1),l(5),P(o.categories.value()),l(2),u((ee=o.tableForm.get("category"))!=null&&ee.hasError("required")?17:-1),l(5),u((te=o.tableForm.get("numberOfGuest"))!=null&&te.hasError("required")?22:-1),l(),u((ie=o.tableForm.get("numberOfGuest"))!=null&&ie.hasError("min")?23:-1),l(),u((ae=o.tableForm.get("numberOfGuest"))!=null&&ae.hasError("max")?24:-1),l(5),g(" ",(ne=o.tableForm.get("active"))!=null&&ne.value?"Table is active and available":"Table is inactive"," "),l(2),c("disabled",o.isLoading),l(2),c("disabled",o.tableForm.invalid||o.isLoading),l(),g(" ",o.isLoading?"Saving...":o.isEdit?"Update Table":"Create Table"," ")}},dependencies:[Pe,ve,Te,xe,Se,Me,Ee,ye,Xe,Je,We,Ke,A,V,G,Le,$,q,H,z,I,R,k,K,J],styles:[".dialog-container[_ngcontent-%COMP%]{min-width:400px}.dialog-container[_ngcontent-%COMP%]   .mat-mdc-form-field[_ngcontent-%COMP%]   .mat-mdc-form-field-subscript-wrapper[_ngcontent-%COMP%]{display:none}.dialog-container[_ngcontent-%COMP%]   .mat-mdc-dialog-content[_ngcontent-%COMP%]{max-height:60vh;overflow-y:auto}.dialog-container[_ngcontent-%COMP%]   .mat-mdc-slide-toggle[_ngcontent-%COMP%]{--mdc-switch-selected-track-color: #1976d2;--mdc-switch-selected-handle-color: #1976d2}"]})};var _t=()=>[5,10,25,100];function gt(t,e){if(t&1&&(n(0,"mat-option",8),r(1),a()),t&2){let i=e.$implicit;c("value",i._id),l(),g(" ",i.name," ")}}function Ct(t,e){t&1&&(n(0,"div",14),f(1,"mat-spinner",18),a())}function ht(t,e){t&1&&f(0,"app-no-record",15)}function Tt(t,e){t&1&&(n(0,"th",33),r(1,"Table Name"),a())}function St(t,e){if(t&1&&(n(0,"td",34),r(1),a()),t&2){let i=e.$implicit;l(),F(i.name)}}function Mt(t,e){t&1&&(n(0,"th",33),r(1,"Category"),a())}function vt(t,e){if(t&1&&(n(0,"td",35),r(1),a()),t&2){let i=e.$implicit;l(),F((i==null||i.category==null?null:i.category.name)||"No Category")}}function xt(t,e){t&1&&(n(0,"th",33),r(1,"Max Guests"),a())}function yt(t,e){if(t&1&&(n(0,"td",35),r(1),a()),t&2){let i=e.$implicit;l(),F(i.numberOfGuest)}}function Et(t,e){t&1&&(n(0,"th",36),r(1,"Current Order"),a())}function wt(t,e){if(t&1&&(n(0,"span",37),r(1),a()),t&2){let i=S().$implicit;l(),g(" Order #",i.order._id==null?null:i.order._id.slice(-6)," ")}}function Pt(t,e){t&1&&(n(0,"span",38),r(1," Available "),a())}function Lt(t,e){if(t&1&&(n(0,"td",35),p(1,wt,2,1,"span",37)(2,Pt,2,0,"span",38),a()),t&2){let i=e.$implicit;l(),u(i.order?1:2)}}function Dt(t,e){t&1&&(n(0,"th",36),r(1,"Status"),a())}function Ot(t,e){if(t&1){let i=Z();n(0,"td",35)(1,"mat-slide-toggle",39),b("change",function(){let m=x(i).$implicit,d=S(2);return y(d.toggleTableStatus(m))}),a()()}if(t&2){let i=e.$implicit;l(),c("checked",i.active)}}function Ft(t,e){t&1&&(n(0,"th",36),r(1,"Actions"),a())}function It(t,e){if(t&1){let i=Z();n(0,"td",35)(1,"button",40)(2,"mat-icon"),r(3,"more_vert"),a()(),n(4,"mat-menu",null,0)(6,"button",41),b("click",function(){let m=x(i).$implicit,d=S(2);return y(d.editTable(m))}),n(7,"mat-icon"),r(8,"edit"),a(),n(9,"span"),r(10,"Edit"),a()(),n(11,"button",41),b("click",function(){let m=x(i).$implicit,d=S(2);return y(d.deleteTable(m))}),n(12,"mat-icon"),r(13,"delete"),a(),n(14,"span"),r(15,"Delete"),a()()()()}if(t&2){let i=re(5);l(),c("matMenuTriggerFor",i)}}function kt(t,e){t&1&&f(0,"tr",42)}function Rt(t,e){t&1&&f(0,"tr",43)}function Nt(t,e){if(t&1&&(n(0,"div",16)(1,"table",19),C(2,20),_(3,Tt,2,0,"th",21)(4,St,2,1,"td",22),h(),C(5,23),_(6,Mt,2,0,"th",21)(7,vt,2,1,"td",24),h(),C(8,25),_(9,xt,2,0,"th",21)(10,yt,2,1,"td",24),h(),C(11,26),_(12,Et,2,0,"th",27)(13,Lt,3,1,"td",24),h(),C(14,28),_(15,Dt,2,0,"th",27)(16,Ot,2,1,"td",24),h(),C(17,29),_(18,Ft,2,0,"th",27)(19,It,16,1,"td",24),h(),_(20,kt,1,0,"tr",30)(21,Rt,1,0,"tr",31),a(),f(22,"mat-paginator",32),a()),t&2){let i=S();l(),c("dataSource",i.filteredTables()),l(19),c("matHeaderRowDef",i.displayedColumns),l(),c("matRowDefColumns",i.displayedColumns),l(),c("pageSizeOptions",le(4,_t))}}function Bt(t,e){t&1&&f(0,"app-no-record",17)}var tt=class t{tableService=s(W);tableCategoryService=s(X);storeStore=s(B);router=s(se);dialog=s(Ue);snackBar=s(N);searchTerm=Y("");selectedCategory=Y("all");displayedColumns=["name","category","numberOfGuest","order","active","actions"];dataSource=M({params:()=>({storeId:this.storeStore.selectedStore()?._id}),stream:({params:e})=>this.tableService.getStoreTables(e.storeId)});categories=M({params:()=>({storeId:this.storeStore.selectedStore()?._id}),stream:({params:e})=>this.tableCategoryService.getStoreTableCategories(e.storeId)});filteredTables=me(()=>{let e=this.searchTerm().toLowerCase(),i=this.selectedCategory();return this.dataSource.value()?.filter(o=>{let m=o.name.toLowerCase().includes(e),d=i==="all"||o?.category?._id===i;return m&&d})??[]});paginator;sort;table;onSearch(e){let i=e.target;this.searchTerm.set(i.value)}onCategoryChange(e){this.selectedCategory.set(e)}addTable(){this.dialog.open(v,{width:"500px",data:{mode:"create"}}).afterClosed().subscribe(i=>{i&&this.dataSource.reload()})}editTable(e){this.dialog.open(v,{width:"500px",data:{mode:"edit",table:e}}).afterClosed().subscribe(o=>{o&&this.dataSource.reload()})}deleteTable(e){this.dialog.open(et,{width:"400px",data:{message:`Are you sure you want to delete ${e.name}?`}}).afterClosed().subscribe(o=>{o&&this.tableService.deleteTable(e._id).subscribe({next:()=>{this.snackBar.open("Table deleted successfully","Close",{duration:3e3,horizontalPosition:"end",verticalPosition:"top"}),this.dataSource.reload()},error:m=>{console.error("Error deleting table:",m),this.snackBar.open("Error deleting table","Close",{duration:3e3,horizontalPosition:"end",verticalPosition:"top"})}})})}toggleTableStatus(e){let i={active:!e.active};this.tableService.updateTable(e._id,i).subscribe({next:()=>{this.snackBar.open("Table status updated successfully","Close",{duration:3e3,horizontalPosition:"end",verticalPosition:"top"}),this.dataSource.reload()},error:()=>{this.snackBar.open("Error updating table status","Close",{duration:3e3,horizontalPosition:"end",verticalPosition:"top"})}})}static \u0275fac=function(i){return new(i||t)};static \u0275cmp=E({type:t,selectors:[["app-list-tables"]],viewQuery:function(i,o){if(i&1&&(L(j,5),L(U,5),L(Q,5)),i&2){let m;D(m=O())&&(o.paginator=m.first),D(m=O())&&(o.sort=m.first),D(m=O())&&(o.table=m.first)}},decls:27,vars:1,consts:[["menu","matMenu"],[1,"tables-container","!bg-white","!rounded-xl","!shadow-lg","border","border-gray-100"],[1,"!bg-white"],[1,"flex","flex-col","md:flex-row","justify-between","gap-4","p-4","border-b"],[1,"flex","flex-col","sm:flex-row","gap-4","flex-grow"],["appearance","outline",1,"w-full","sm:w-48"],[3,"selectionChange"],["value","all"],[3,"value"],["appearance","outline",1,"w-full","sm:w-48","md:w-72","lg:w-96"],["matPrefix",""],["matInput","","placeholder","Search tables",3,"input"],[1,"flex","gap-3","justify-end"],["mat-raised-button","","color","primary",3,"click"],[1,"flex","items-center","justify-center","min-h-[300px]"],["icon","table_restaurant","title","No Tables","message","No tables found matching your criteria."],[1,"table-container","rounded-lg","overflow-x-auto","mt-4"],["icon","error","title","Error","message","An error occurred while fetching the data. Please try again later."],["diameter","40"],["mat-table","","matSort","",1,"!bg-white","min-w-full","rounded-lg",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","","mat-sort-header","","class","bg-gray-50",4,"matHeaderCellDef"],["mat-cell","","class","font-semibold",4,"matCellDef"],["matColumnDef","category"],["mat-cell","",4,"matCellDef"],["matColumnDef","numberOfGuest"],["matColumnDef","order"],["mat-header-cell","","class","bg-gray-50",4,"matHeaderCellDef"],["matColumnDef","active"],["matColumnDef","actions"],["mat-header-row","","class","bg-gray-50",4,"matHeaderRowDef"],["mat-row","","class","hover:bg-gray-50 transition",4,"matRowDef","matRowDefColumns"],["aria-label","Select page of tables",1,"!bg-white",3,"pageSizeOptions"],["mat-header-cell","","mat-sort-header","",1,"bg-gray-50"],["mat-cell","",1,"font-semibold"],["mat-cell",""],["mat-header-cell","",1,"bg-gray-50"],[1,"px-2","py-1","bg-orange-100","text-orange-800","rounded-full","text-xs"],[1,"px-2","py-1","bg-green-100","text-green-800","rounded-full","text-xs"],["color","primary",3,"change","checked"],["mat-icon-button","","aria-label","Table actions",3,"matMenuTriggerFor"],["mat-menu-item","",3,"click"],["mat-header-row","",1,"bg-gray-50"],["mat-row","",1,"hover:bg-gray-50","transition"]],template:function(i,o){i&1&&(n(0,"mat-card",1)(1,"mat-card-content",2)(2,"div",3)(3,"div",4)(4,"mat-form-field",5)(5,"mat-label"),r(6,"Category"),a(),n(7,"mat-select",6),b("selectionChange",function(d){return o.onCategoryChange(d.value)}),n(8,"mat-option",7),r(9,"All Categories"),a(),w(10,gt,2,2,"mat-option",8,oe),a()(),n(12,"mat-form-field",9)(13,"mat-label"),r(14,"Search"),a(),n(15,"mat-icon",10),r(16,"search"),a(),n(17,"input",11),b("input",function(d){return o.onSearch(d)}),a()()(),n(18,"div",12)(19,"button",13),b("click",function(){return o.addTable()}),n(20,"mat-icon"),r(21,"add"),a(),r(22," ADD TABLE "),a()()(),p(23,Ct,2,0,"div",14)(24,ht,1,0,"app-no-record",15)(25,Nt,23,5,"div",16)(26,Bt,1,0,"app-no-record",17),a()()),i&2&&(l(10),P(o.categories.value()),l(13),u(o.dataSource.isLoading()?23:o.dataSource.hasValue()&&o.filteredTables().length===0?24:o.dataSource.hasValue()?25:o.dataSource.error()?26:-1))},dependencies:[$e,Q,ke,Ge,Re,Ie,Ve,Ne,Be,Ae,qe,ze,j,Ze,U,Ye,A,V,G,De,$,q,H,z,I,R,k,de,be,ue,fe,he,ge,_e,Ce,pe,ce,Fe,Oe,K,J,He],styles:[".tables-container[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   .mat-mdc-table[_ngcontent-%COMP%]{border-radius:8px}.tables-container[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   .mat-mdc-table[_ngcontent-%COMP%]   .mat-mdc-header-cell[_ngcontent-%COMP%]{font-weight:600;color:#374151;background-color:#f9fafb}.tables-container[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   .mat-mdc-table[_ngcontent-%COMP%]   .mat-mdc-row[_ngcontent-%COMP%]:hover{background-color:#f9fafb}.mat-mdc-form-field[_ngcontent-%COMP%]   .mat-mdc-form-field-subscript-wrapper[_ngcontent-%COMP%]{display:none}.mat-mdc-card[_ngcontent-%COMP%]{box-shadow:0 1px 3px #0000001a,0 1px 2px #0000000f}"]})};export{tt as ListTablesComponent};
