import{a as K,b as Q}from"./chunk-U7ARI6ZS.js";import"./chunk-EIZRJIIE.js";import{a as y}from"./chunk-VPPMXXDW.js";import{a as x}from"./chunk-CGDRKYIW.js";import{b as z,c as R,d as q}from"./chunk-IS37LNAK.js";import{a as L,e as O,h as V}from"./chunk-QJ2P7YZL.js";import"./chunk-LXD47U2C.js";import{b as J}from"./chunk-ZG44B3L4.js";import{B as A,b as w,g as B,h as P,m as D,n as G,s as U,t as H,z as j}from"./chunk-SZWYIW32.js";import"./chunk-CTT4BYCX.js";import{a as b}from"./chunk-V7ZBVJLR.js";import"./chunk-NQRUH5DO.js";import{a as F,b as N,c as T,f as I,g as k,h as _}from"./chunk-MESJBQC5.js";import"./chunk-QEF3JOQ3.js";import"./chunk-LSROOOYO.js";import"./chunk-7NDZPDVA.js";import{b as M,c as C}from"./chunk-OWLRGWNJ.js";import{$ as E,Z as h}from"./chunk-OS2CYUJN.js";import"./chunk-U2P6GFP5.js";import{$a as s,Mb as p,Nb as e,Ob as t,Pb as a,_b as c,ea as m,ob as f,pc as i,rc as v,va as d}from"./chunk-IQSYHSID.js";import{a as g,b as S}from"./chunk-EQDQRRRY.js";var W=class u{fb=m(j);snackBar=m(b);storeService=m(x);storeStore=m(y);loading=d(!1);saving=d(!1);emailSettingsForm;ngOnInit(){this.initializeForm(),this.loadSettings()}initializeForm(){this.emailSettingsForm=this.fb.group({smtpHost:[""],smtpPort:[587],smtpUsername:[""],smtpPassword:[""],smtpSecure:[!0],senderName:[""],senderEmail:[""],replyToEmail:[""]})}loadSettings(){this.loading.set(!0);let n=this.storeStore.selectedStore();n?.hotelSettings?.emailSettings&&this.emailSettingsForm.patchValue(n.hotelSettings.emailSettings),this.loading.set(!1)}testEmailConnection(){this.emailSettingsForm.valid&&(this.snackBar.open("Testing email connection...","Close",{duration:2e3}),setTimeout(()=>{this.snackBar.open("Email connection test successful!","Close",{duration:3e3})},2e3))}saveEmailSettings(){if(this.emailSettingsForm.valid&&this.storeStore.selectedStore()){this.saving.set(!0);let n=this.storeStore.selectedStore(),l=this.emailSettingsForm.value,o={hotelSettings:S(g({},n.hotelSettings),{emailSettings:l})};this.storeService.updateStore(n._id,o).subscribe({next:()=>{this.storeService.getStore(n._id).subscribe({next:r=>{this.storeStore.updateStore(r),this.storeService.saveStoreLocally(r),this.saving.set(!1),this.snackBar.open("Email settings saved successfully!","Close",{duration:3e3})},error:r=>{console.error("Error fetching updated store:",r),this.saving.set(!1),this.snackBar.open("Settings saved but failed to update local data.","Close",{duration:5e3})}})},error:r=>{console.error("Error saving email settings:",r),this.saving.set(!1),this.snackBar.open("Failed to save email settings.","Close",{duration:5e3})}})}}static \u0275fac=function(l){return new(l||u)};static \u0275cmp=f({type:u,selectors:[["app-email-settings"]],decls:81,vars:3,consts:[[1,"py-6"],[3,"ngSubmit","formGroup"],[1,"grid","grid-cols-1","lg:grid-cols-2","gap-8"],["appearance","outlined"],["mat-card-avatar","",1,"text-orange-600","!flex","!items-center","!justify-center"],[1,"pt-4","space-y-6"],["appearance","outline",1,"w-full"],["matInput","","formControlName","smtpHost","placeholder","smtp.gmail.com"],["matSuffix",""],[1,"grid","grid-cols-2","gap-4"],["appearance","outline"],["matInput","","type","number","formControlName","smtpPort","placeholder","587"],[1,"flex","items-center"],["formControlName","smtpSecure","color","primary"],[1,"ml-2","text-sm","text-gray-700"],["matInput","","formControlName","smtpUsername","placeholder","your-email@domain.com"],["matInput","","type","password","formControlName","smtpPassword","placeholder","\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022"],["type","button","mat-stroked-button","","color","accent",1,"w-full",3,"click"],[1,"mr-2"],["mat-card-avatar","",1,"text-blue-600","!flex","!items-center","!justify-center"],["matInput","","formControlName","senderName","placeholder","Hotel Name"],["matInput","","type","email","formControlName","senderEmail","placeholder","noreply@hotel.com"],["matInput","","type","email","formControlName","replyToEmail","placeholder","reservations@hotel.com"],[1,"p-4","bg-yellow-50","border","border-yellow-200","rounded-lg"],[1,"font-semibold","text-yellow-900","mb-2","flex","items-center","gap-2"],[1,"text-yellow-600"],[1,"text-sm","text-yellow-800","space-y-1"],[1,"flex","justify-end","mt-8"],["type","submit","matButton","filled","color","primary",1,"px-8","py-2",3,"disabled"]],template:function(l,o){l&1&&(e(0,"div",0)(1,"form",1),c("ngSubmit",function(){return o.saveEmailSettings()}),e(2,"div",2)(3,"mat-card",3)(4,"mat-card-header")(5,"mat-icon",4),i(6,"settings"),t(),e(7,"mat-card-title"),i(8,"SMTP Configuration"),t()(),e(9,"mat-card-content",5)(10,"mat-form-field",6)(11,"mat-label"),i(12,"SMTP Host"),t(),a(13,"input",7),e(14,"mat-icon",8),i(15,"dns"),t()(),e(16,"div",9)(17,"mat-form-field",10)(18,"mat-label"),i(19,"Port"),t(),a(20,"input",11),t(),e(21,"div",12),a(22,"mat-slide-toggle",13),e(23,"span",14),i(24,"Use SSL/TLS"),t()()(),e(25,"mat-form-field",6)(26,"mat-label"),i(27,"Username"),t(),a(28,"input",15),e(29,"mat-icon",8),i(30,"person"),t()(),e(31,"mat-form-field",6)(32,"mat-label"),i(33,"Password"),t(),a(34,"input",16),e(35,"mat-icon",8),i(36,"lock"),t()(),e(37,"button",17),c("click",function(){return o.testEmailConnection()}),e(38,"mat-icon",18),i(39,"send"),t(),i(40," Test Connection "),t()()(),e(41,"mat-card",3)(42,"mat-card-header")(43,"mat-icon",19),i(44,"branding_watermark"),t(),e(45,"mat-card-title"),i(46,"Email Branding"),t()(),e(47,"mat-card-content",5)(48,"mat-form-field",6)(49,"mat-label"),i(50,"Sender Name"),t(),a(51,"input",20),e(52,"mat-icon",8),i(53,"badge"),t()(),e(54,"mat-form-field",6)(55,"mat-label"),i(56,"Sender Email"),t(),a(57,"input",21),e(58,"mat-icon",8),i(59,"email"),t()(),e(60,"mat-form-field",6)(61,"mat-label"),i(62,"Reply-To Email"),t(),a(63,"input",22),e(64,"mat-icon",8),i(65,"reply"),t()(),e(66,"div",23)(67,"h5",24)(68,"mat-icon",25),i(69,"lightbulb"),t(),i(70," Email Tips "),t(),e(71,"ul",26)(72,"li"),i(73,"\u2022 Use a dedicated email for hotel communications"),t(),e(74,"li"),i(75,"\u2022 Enable 2FA for better security"),t(),e(76,"li"),i(77,"\u2022 Test emails before going live"),t()()()()()(),e(78,"div",27)(79,"button",28),i(80),t()()()()),l&2&&(s(),p("formGroup",o.emailSettingsForm),s(78),p("disabled",o.emailSettingsForm.invalid||o.saving()),s(),v(" ",o.saving()?"Saving...":"Save Email Settings"," "))},dependencies:[A,D,w,G,B,P,H,U,_,F,k,T,I,N,E,h,C,M,z,V,L,O,q,R,Q,K,J],styles:["[_nghost-%COMP%]{display:block}"]})};export{W as EmailSettings};
