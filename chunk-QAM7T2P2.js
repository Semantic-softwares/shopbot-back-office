import{a as Be}from"./chunk-5X5SDECG.js";import{a as w,b as Fe,c as He}from"./chunk-V6Q2J3ZF.js";import{a as Ve}from"./chunk-LO5LXT4F.js";import{a as Ie}from"./chunk-YZQZHEMG.js";import{f as Re}from"./chunk-XSZYAESL.js";import"./chunk-LCNY3JPX.js";import{a as ke}from"./chunk-4QMHOUIB.js";import{a as v,b as De}from"./chunk-5NCGVO7F.js";import{a as Ee}from"./chunk-HOFFRLAS.js";import{a as Le}from"./chunk-OFQMF3WN.js";import{a as T,b as Ce,c as ge,d as Me,e as Se,f as ye,g as xe,h as Pe,i as be,j as Te,k as ve,l as we}from"./chunk-BAU4EBFS.js";import{a as ee,b as te,c as ie,d as ae}from"./chunk-4P4GBQE7.js";import{i as U}from"./chunk-ZKQYDJ5W.js";import"./chunk-LCF3SYDV.js";import"./chunk-ZLVLWRZH.js";import{d as he}from"./chunk-HJGFVW6K.js";import"./chunk-TVH27JLT.js";import"./chunk-G4CZ6LK2.js";import"./chunk-I564X6SI.js";import"./chunk-VTDH2LYT.js";import{b as de,c as pe,d as ue}from"./chunk-63HT37SK.js";import{a as me,e as se,h as ce}from"./chunk-YJCGHVXK.js";import"./chunk-UHBDKNKX.js";import{a as _e,b as fe}from"./chunk-3ZLH5HUN.js";import{A as le,b as ne,g as oe,l as re}from"./chunk-O5GCTPYR.js";import"./chunk-EGLRIU4H.js";import{a as G}from"./chunk-5TL46KBL.js";import"./chunk-53AK2UWQ.js";import"./chunk-BFT2MTJY.js";import{a as X,c as Y,h as Z}from"./chunk-JONI64R4.js";import"./chunk-H7INH462.js";import"./chunk-OOL2KACG.js";import"./chunk-KZJMNFJ3.js";import{b as J,c as K}from"./chunk-G6I3OKXX.js";import{Z as W,_ as j,ba as z}from"./chunk-4Z2XUZY2.js";import{e as q,g as O}from"./chunk-F436VINI.js";import{u as A}from"./chunk-H22US2IH.js";import{Gc as $,Ib as M,Jb as S,Ob as d,Pb as n,Qb as o,Rb as f,Vb as p,Wb as u,Yb as L,ac as y,bb as m,cc as h,fa as _,gc as x,hc as P,ic as b,ka as C,la as g,mc as H,qb as F,rc as r,sc as V,tc as E,uc as D,wb as c,xc as B,yc as Q,za as I,zc as N}from"./chunk-P5WOETP4.js";import{a as k,b as R}from"./chunk-GAL4ENT6.js";var Ne=()=>[5,10,20,50];function $e(e,i){e&1&&(n(0,"div",5),f(1,"mat-spinner",9),o())}function Ae(e,i){if(e&1&&f(0,"app-no-record",6),e&2){let t,a=h();d("message",((t=a.policies.error())==null?null:t.message)||"Unable to load hotel policies. Please try again.")}}function qe(e,i){e&1&&(n(0,"th",29),r(1,"Policy Title"),o())}function Oe(e,i){if(e&1&&(n(0,"td",30)(1,"span",31),r(2),o()()),e&2){let t=i.$implicit;m(2),V(t.attributes==null?null:t.attributes.title)}}function We(e,i){e&1&&(n(0,"th",29),r(1,"Currency"),o())}function je(e,i){if(e&1&&(n(0,"td",30),r(1),o()),e&2){let t=i.$implicit;m(),E(" ",t.attributes==null?null:t.attributes.currency," ")}}function ze(e,i){e&1&&(n(0,"th",32),r(1,"Check-in"),o())}function Ge(e,i){if(e&1&&(n(0,"td",30),r(1),o()),e&2){let t=i.$implicit;m(),D(" ",t.attributes==null?null:t.attributes.checkin_from_time," - ",t.attributes==null?null:t.attributes.checkin_to_time," ")}}function Ue(e,i){e&1&&(n(0,"th",32),r(1,"Check-out"),o())}function Je(e,i){if(e&1&&(n(0,"td",30),r(1),o()),e&2){let t=i.$implicit;m(),D(" ",t.attributes==null?null:t.attributes.checkout_from_time," - ",t.attributes==null?null:t.attributes.checkout_to_time," ")}}function Ke(e,i){e&1&&(n(0,"th",29),r(1,"Max Guests"),o())}function Xe(e,i){if(e&1&&(n(0,"td",30),r(1),o()),e&2){let t=i.$implicit;m(),E(" ",t.attributes==null?null:t.attributes.max_count_of_guests," ")}}function Ye(e,i){e&1&&(n(0,"th",32),r(1,"Actions"),o())}function Ze(e,i){if(e&1){let t=L();n(0,"td",33)(1,"button",34)(2,"mat-icon"),r(3,"more_vert"),o()(),n(4,"mat-menu",null,1)(6,"button",35),y("click",function(){let l=C(t).$implicit,s=h(2);return g(s.editPolicy(l))}),n(7,"mat-icon"),r(8,"edit"),o(),n(9,"span"),r(10,"Edit"),o()(),n(11,"button",36),y("click",function(){let l=C(t).$implicit,s=h(2);return g(s.deletePolicy(l))}),n(12,"mat-icon"),r(13,"delete"),o(),n(14,"span"),r(15,"Delete"),o()()()()}if(e&2){let t=H(5);m(),d("matMenuTriggerFor",t)}}function et(e,i){e&1&&f(0,"tr",37)}function tt(e,i){e&1&&f(0,"tr",38)}function it(e,i){if(e&1){let t=L();n(0,"mat-card",7)(1,"mat-card-content",10)(2,"div",11)(3,"mat-form-field",12)(4,"mat-label"),r(5,"Search policies"),o(),n(6,"input",13),N("ngModelChange",function(l){C(t);let s=h();return Q(s.searchText,l)||(s.searchText=l),g(l)}),y("input",function(){C(t);let l=h();return g(l.applyFilter())}),o(),n(7,"mat-icon",14),r(8,"search"),o()()(),n(9,"table",15,0),p(11,16),c(12,qe,2,0,"th",17)(13,Oe,3,1,"td",18),u(),p(14,19),c(15,We,2,0,"th",17)(16,je,2,1,"td",18),u(),p(17,20),c(18,ze,2,0,"th",21)(19,Ge,2,2,"td",18),u(),p(20,22),c(21,Ue,2,0,"th",21)(22,Je,2,2,"td",18),u(),p(23,23),c(24,Ke,2,0,"th",17)(25,Xe,2,1,"td",18),u(),p(26,24),c(27,Ye,2,0,"th",21)(28,Ze,16,1,"td",25),u(),c(29,et,1,0,"tr",26)(30,tt,1,0,"tr",27),o(),f(31,"mat-paginator",28),o()()}if(e&2){let t=h();m(6),B("ngModel",t.searchText),m(3),d("dataSource",t.dataSource),m(20),d("matHeaderRowDef",t.displayedColumns),m(),d("matRowDefColumns",t.displayedColumns),m(),d("pageSizeOptions",$(5,Ne))}}function at(e,i){e&1&&f(0,"app-no-record",8)}var Qe=class e{hotelPolicyService=_(Be);router=_(O);dialog=_(Re);snackBar=_(G);storeStore=_(U);route=_(q);paginator;sort;table;searchText="";displayedColumns=["title","currency","checkin_time","checkout_time","max_guests","actions"];dataSource=new we([]);policies=he({params:()=>({propertyId:this.storeStore.selectedStore()?.channex?.propertyId}),stream:({params:i})=>this.hotelPolicyService.getHotelPolicies(i.propertyId)});constructor(){I(()=>{let i=this.policies.value();if(i?.data){let t=i.data.map(a=>R(k({id:a.id},a.attributes),{attributes:a.attributes}));this.dataSource.data=t}})}ngAfterViewInit(){this.dataSource&&this.paginator&&this.sort&&(this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort)}applyFilter(){this.dataSource&&(this.dataSource.filter=this.searchText.trim().toLowerCase(),this.paginator&&this.paginator.firstPage())}createPolicy(){this.router.navigate(["../create"],{relativeTo:this.route})}editPolicy(i){this.router.navigate(["../edit",i.id],{relativeTo:this.route})}deletePolicy(i){this.dialog.open(Ve,{data:{title:"Delete Policy",message:`Are you sure you want to delete the policy "${i.attributes?.title}"?`}}).afterClosed().subscribe(a=>{a&&this.hotelPolicyService.deleteHotelPolicy(i.id).subscribe({next:()=>{this.snackBar.open("Policy deleted successfully","Close",{duration:3e3}),this.policies.reload()},error:l=>{let s=l.error?.message||"Failed to delete policy";this.snackBar.open(s,"Close",{duration:5e3})}})})}static \u0275fac=function(t){return new(t||e)};static \u0275cmp=F({type:e,selectors:[["app-channel-manager-list-policies"]],viewQuery:function(t,a){if(t&1&&(x(v,5),x(w,5),x(T,5)),t&2){let l;P(l=b())&&(a.paginator=l.first),P(l=b())&&(a.sort=l.first),P(l=b())&&(a.table=l.first)}},decls:10,vars:5,consts:[["table",""],["menu","matMenu"],["title","Hotel Policies","subtitle","Manage your hotel policies"],["actions",""],["matButton","filled","color","primary",1,"px-4",3,"click","disabled"],[1,"flex","justify-center","items-center","py-20"],["icon","error_outline","title","Failed to Load Policies",3,"message"],["appearance","outlined",1,"mt-6"],["icon","policy","title","No Policies Found","message","No hotel policies have been created yet. Create your first policy to get started."],["diameter","50"],[1,"p-0"],[1,"p-4","border-b","border-gray-200"],["appearance","outline",1,"w-full","md:w-80"],["matInput","","placeholder","Search by title...",3,"ngModelChange","input","ngModel"],["matSuffix",""],["mat-table","","matSort","",3,"dataSource"],["matColumnDef","title"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","currency"],["matColumnDef","checkin_time"],["mat-header-cell","",4,"matHeaderCellDef"],["matColumnDef","checkout_time"],["matColumnDef","max_guests"],["matColumnDef","actions"],["mat-cell","","class","text-right",4,"matCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["showFirstLastButtons","","aria-label","Select page",3,"pageSizeOptions"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],[1,"font-semibold","text-gray-900"],["mat-header-cell",""],["mat-cell","",1,"text-right"],["mat-icon-button","","matTooltip","More options",3,"matMenuTriggerFor"],["mat-menu-item","",3,"click"],["mat-menu-item","",1,"text-red-600",3,"click"],["mat-header-row",""],["mat-row",""]],template:function(t,a){t&1&&(n(0,"app-page-header",2),p(1,3),n(2,"button",4),y("click",function(){return a.createPolicy()}),n(3,"mat-icon"),r(4,"add"),o(),r(5," Create Policy "),o(),u(),o(),M(6,$e,2,0,"div",5),M(7,Ae,1,1,"app-no-record",6),M(8,it,32,6,"mat-card",7),M(9,at,1,0,"app-no-record",8)),t&2&&(m(2),d("disabled",a.policies.isLoading()),m(4),S(a.policies.isLoading()?6:-1),m(),S(a.policies.error()?7:-1),m(),S(!a.policies.isLoading()&&a.dataSource&&a.dataSource.data.length>0?8:-1),m(),S(!a.policies.isLoading()&&(!a.dataSource||a.dataSource.data.length===0)&&!a.policies.error()?9:-1))},dependencies:[A,ve,T,ge,xe,Me,Ce,Pe,Se,ye,be,Te,De,v,He,w,Fe,Z,X,Y,de,ce,me,se,ue,pe,z,j,W,K,J,ae,te,ee,ie,fe,_e,Ee,Le,Ie,ke,le,ne,oe,re],styles:["[_nghost-%COMP%]{display:block}"],changeDetection:0})};export{Qe as ChannelManagerListPolicies};
