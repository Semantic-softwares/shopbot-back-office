import{a as Pe,b as Se}from"./chunk-4OM7C35U.js";import{a as _e,b as be}from"./chunk-5W5E6AGV.js";import{a as ye,b as X}from"./chunk-57GZGP3R.js";import{d as le}from"./chunk-FNFXBZOZ.js";import{b as U,c as G,d as B}from"./chunk-AQ3KQLE6.js";import{a as L,b as K,d as he,e as Ce,f as ve,g as H}from"./chunk-DGYQUDOC.js";import{a as R,b as W,c as ue,d as ge,e as z,h as V}from"./chunk-QMUPRLKR.js";import{B as N,D as T,b as k,d as f,g as F,h as I,m as w,n as de,p as A,s as O,w as se,x as ce,z as pe}from"./chunk-CXVWFC6J.js";import{a as q,b as j}from"./chunk-MCIFQNRK.js";import{a as xe}from"./chunk-P7SQXTVL.js";import{W as me,X as E,Y as D}from"./chunk-BPRDVRQX.js";import{a as fe}from"./chunk-KP7TGH7C.js";import{o as ae,q as re,t as M}from"./chunk-DWCYWQVU.js";import{Bb as ne,Cc as y,Db as d,Dc as oe,Eb as s,Ec as P,Jb as h,Kb as n,Lb as e,Mb as v,Qb as J,Ub as p,Vb as C,_a as l,fa as g,hc as Z,ic as t,jc as ee,kb as S,kc as x,la as Q,lc as b,ma as Y,mc as ie,va as _}from"./chunk-5AECHVKR.js";import{f as te}from"./chunk-EQDQRRRY.js";function Ne(a,r){a&1&&(n(0,"div",25)(1,"div",31)(2,"mat-icon",32),t(3,"warning"),e(),n(4,"span",33),t(5," Please confirm all room readiness requirements before proceeding with check-in. "),e()()())}function Te(a,r){a&1&&(n(0,"mat-icon",29),t(1,"refresh"),e())}function Re(a,r){a&1&&(n(0,"mat-icon",30),t(1,"check_in"),e())}var Me=class a{dialogRef=g(L);fb=g(N);data=g(K);loading=_(!1);checkInForm=this.fb.group({isClean:[!1,f.requiredTrue],isMaintained:[!1,f.requiredTrue],amenitiesReady:[!1,f.requiredTrue],notes:[""]});get isFormValid(){return this.checkInForm.valid}get roomNumbers(){return this.data.reservation.rooms?this.data.reservation.rooms.map(r=>{let o=r.room;return typeof o=="string"?o:o.roomNumber||o._id}).join(", "):""}onCancel(){this.dialogRef.close({confirmed:!1})}onConfirm(){if(!this.isFormValid)return;let r=this.checkInForm.value,o={confirmed:!0,roomChecks:{isClean:r.isClean||!1,isMaintained:r.isMaintained||!1,amenitiesReady:r.amenitiesReady||!1},notes:r.notes||void 0};this.dialogRef.close(o)}static \u0275fac=function(o){return new(o||a)};static \u0275cmp=S({type:a,selectors:[["app-check-in-confirmation-dialog"]],decls:65,vars:10,consts:[[1,"p-6","min-w-[500px]"],[1,"flex","items-center","gap-3","mb-6"],[1,"w-12","h-12","bg-blue-100","rounded-full","flex","items-center","justify-center"],[1,"text-blue-600","text-2xl"],[1,"text-xl","font-bold","text-gray-900"],[1,"text-sm","text-gray-600"],[1,"bg-gray-50","rounded-lg","p-4","mb-6"],[1,"flex","items-center","justify-between","mb-2"],[1,"font-semibold","text-gray-900"],[1,"text-sm","text-gray-500"],[1,"text-sm","text-gray-700"],[1,"space-y-4","mb-6",3,"formGroup"],[1,"font-semibold","text-gray-900","mb-3"],[1,"space-y-3"],[1,"flex","items-center","gap-3"],["formControlName","isClean","color","primary"],[1,"text-sm"],[1,"text-green-600","text-lg"],["formControlName","isMaintained","color","primary"],[1,"text-blue-600","text-lg"],["formControlName","amenitiesReady","color","primary"],[1,"text-purple-600","text-lg"],["appearance","outline",1,"w-full"],["matInput","","formControlName","notes","rows","3","placeholder","Any special notes or observations..."],["matSuffix",""],[1,"bg-amber-50","border","border-amber-200","rounded-lg","p-3","mb-6"],[1,"flex","justify-end","gap-3"],["mat-button","",1,"px-6","py-2",3,"click"],["mat-raised-button","","color","primary",1,"px-6","py-2","!bg-blue-600","hover:!bg-blue-700",3,"click","disabled"],[1,"animate-spin","mr-2"],[1,"mr-2"],[1,"flex","items-center","gap-2"],[1,"text-amber-600"],[1,"text-sm","text-amber-800","font-medium"]],template:function(o,i){o&1&&(n(0,"div",0)(1,"div",1)(2,"div",2)(3,"mat-icon",3),t(4,"check_in"),e()(),n(5,"div")(6,"h2",4),t(7,"Confirm Check-In"),e(),n(8,"p",5),t(9),e()()(),n(10,"div",6)(11,"div",7)(12,"h3",8),t(13,"Guest Information"),e(),n(14,"span",9),t(15),e()(),n(16,"div",10)(17,"div")(18,"strong"),t(19,"Name:"),e(),t(20),e(),n(21,"div")(22,"strong"),t(23,"Adults:"),e(),t(24),n(25,"strong"),t(26,"Children:"),e(),t(27),e()()(),n(28,"form",11)(29,"div")(30,"h3",12),t(31,"Room Readiness Checklist"),e(),n(32,"div",13)(33,"div",14)(34,"mat-checkbox",15)(35,"span",16),t(36,"Room is clean and housekeeping complete"),e()(),n(37,"mat-icon",17),t(38,"cleaning_services"),e()(),n(39,"div",14)(40,"mat-checkbox",18)(41,"span",16),t(42,"All maintenance issues resolved"),e()(),n(43,"mat-icon",19),t(44,"build"),e()(),n(45,"div",14)(46,"mat-checkbox",20)(47,"span",16),t(48,"Amenities and supplies are stocked"),e()(),n(49,"mat-icon",21),t(50,"inventory_2"),e()()()(),n(51,"mat-form-field",22)(52,"mat-label"),t(53,"Check-in Notes (Optional)"),e(),v(54,"textarea",23),n(55,"mat-icon",24),t(56,"note_add"),e()()(),d(57,Ne,6,0,"div",25),n(58,"div",26)(59,"button",27),p("click",function(){return i.onCancel()}),t(60," Cancel "),e(),n(61,"button",28),p("click",function(){return i.onConfirm()}),d(62,Te,2,0,"mat-icon",29)(63,Re,2,0,"mat-icon",30),t(64," Confirm Check-In "),e()()()),o&2&&(l(9),x("Reservation ",i.data.reservation.confirmationNumber),l(6),x("Room(s): ",i.roomNumbers),l(5),b(" ",i.data.reservation.guestDetails.primaryGuest.firstName," ",i.data.reservation.guestDetails.primaryGuest.lastName),l(4),x(" ",i.data.reservation.guestDetails.totalAdults," | "),l(3),x(" ",i.data.reservation.guestDetails.totalChildren),l(),h("formGroup",i.checkInForm),l(29),s(i.isFormValid?-1:57),l(4),h("disabled",!i.isFormValid||i.loading()),l(),s(i.loading()?62:63))},dependencies:[M,H,D,E,j,q,Se,Pe,U,V,R,z,B,G,T,w,k,F,I,A,O],styles:[".check-in-dialog[_ngcontent-%COMP%]   .mat-mdc-checkbox[_ngcontent-%COMP%]   .mdc-checkbox[_ngcontent-%COMP%]{margin-right:8px}.check-in-dialog[_ngcontent-%COMP%]   .mat-mdc-form-field[_ngcontent-%COMP%]   .mat-mdc-text-field-wrapper[_ngcontent-%COMP%]{background-color:#fafafa}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.animate-spin[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_spin 1s linear infinite}"]})};function ze(a,r){if(a&1&&(n(0,"div",11)(1,"div",16)(2,"mat-icon",17),t(3,"info"),e(),n(4,"div",18)(5,"strong"),t(6,"Extensions Included:"),e(),t(7),y(8,"number"),e()()()),a&2){let o=C();l(7),ie(" ",o.getApprovedExtensionNights()," extension night(s) totaling ",o.currency,"",P(8,3,o.getApprovedExtensionCost(),"1.2-2")," are included in the total above. ")}}function Ve(a,r){a&1&&(n(0,"mat-error"),t(1,"Amount is required"),e())}function Ue(a,r){a&1&&(n(0,"mat-error"),t(1,"Amount must be greater than 0"),e())}function Ge(a,r){a&1&&(n(0,"mat-error"),t(1,"Amount cannot exceed balance due"),e())}function Be(a,r){a&1&&(n(0,"mat-error"),t(1,"Payment method is required"),e())}function qe(a,r){if(a&1){let o=J();n(0,"button",37),p("click",function(){Q(o);let m=C(2);return Y(m.setAmount(100))}),t(1),e()}if(a&2){let o=C(2);l(),x(" ",o.currency,"100 ")}}function je(a,r){if(a&1){let o=J();n(0,"button",37),p("click",function(){Q(o);let m=C(2);return Y(m.setAmount(50))}),t(1),e()}if(a&2){let o=C(2);l(),x(" ",o.currency,"50 ")}}function Le(a,r){if(a&1){let o=J();n(0,"div",19)(1,"mat-form-field",20)(2,"mat-label"),t(3,"Payment Amount"),e(),n(4,"span",21),t(5),e(),v(6,"input",22),n(7,"mat-icon",23),t(8,"attach_money"),e(),d(9,Ve,2,0,"mat-error"),d(10,Ue,2,0,"mat-error"),d(11,Ge,2,0,"mat-error"),e(),n(12,"mat-form-field",20)(13,"mat-label"),t(14,"Payment Method"),e(),n(15,"mat-select",24)(16,"mat-option",25),t(17,"Cash"),e(),n(18,"mat-option",26),t(19,"Credit Card"),e(),n(20,"mat-option",27),t(21,"Debit Card"),e(),n(22,"mat-option",28),t(23,"Bank Transfer"),e(),n(24,"mat-option",29),t(25,"Check"),e(),n(26,"mat-option",30),t(27,"Mobile Payment"),e(),n(28,"mat-option",31),t(29,"Other"),e()(),d(30,Be,2,0,"mat-error"),e()(),n(31,"mat-form-field",20)(32,"mat-label"),t(33,"Reference Number (Optional)"),e(),v(34,"input",32),n(35,"mat-icon",23),t(36,"receipt"),e()(),n(37,"mat-form-field",20)(38,"mat-label"),t(39,"Notes (Optional)"),e(),v(40,"textarea",33),n(41,"mat-icon",23),t(42,"note"),e()(),n(43,"div",34)(44,"h4",35),t(45,"Quick Amounts"),e(),n(46,"div",36)(47,"button",37),p("click",function(){Q(o);let m=C();return Y(m.setAmount(m.data.reservation.pricing.balance))}),t(48),y(49,"number"),e(),d(50,qe,2,1,"button",38),d(51,je,2,1,"button",38),e()()}if(a&2){let o,i,m,u,c=C();l(5),x("",c.currency,"\xA0"),l(),h("max",c.data.reservation.pricing.balance),l(3),s((o=c.paymentForm.get("amount"))!=null&&o.hasError("required")?9:-1),l(),s((i=c.paymentForm.get("amount"))!=null&&i.hasError("min")?10:-1),l(),s((m=c.paymentForm.get("amount"))!=null&&m.hasError("max")?11:-1),l(19),s((u=c.paymentForm.get("method"))!=null&&u.hasError("required")?30:-1),l(18),b(" Full Balance (",c.currency,"",P(49,10,c.data.reservation.pricing.balance,"1.2-2"),") "),l(2),s(c.data.reservation.pricing.balance>=100?50:-1),l(),s(c.data.reservation.pricing.balance>=50?51:-1)}}function Ke(a,r){a&1&&(n(0,"mat-error"),t(1,"Payment status is required"),e())}function He(a,r){a&1&&(n(0,"mat-error"),t(1,"Payment method is required"),e())}function $e(a,r){if(a&1&&(n(0,"div",45)(1,"div",46)(2,"mat-icon",47),t(3,"warning"),e(),n(4,"div",48)(5,"strong"),t(6,'Cannot mark as "Paid in Full":'),e(),t(7," There is still an outstanding balance of "),n(8,"strong"),t(9),y(10,"number"),e(),t(11,". "),v(12,"br"),t(13,' Please use "Partial Payment" status or record additional payments to clear the balance first. '),e()()()),a&2){let o=C(2);l(9),b("",o.currency,"",P(10,2,o.data.reservation.pricing.balance,"1.2-2"))}}function Qe(a,r){if(a&1&&(n(0,"mat-form-field",20)(1,"mat-label"),t(2,"Payment Status"),e(),n(3,"mat-select",39)(4,"mat-option",40),t(5,"Pending Payment"),e(),n(6,"mat-option",41),t(7,"Partial Payment"),e(),n(8,"mat-option",42),t(9,"Paid in Full"),e()(),n(10,"mat-icon",23),t(11,"payment"),e(),n(12,"mat-hint"),t(13,"Select the current payment status"),e(),d(14,Ke,2,0,"mat-error"),e(),n(15,"mat-form-field",20)(16,"mat-label"),t(17,"Payment Method"),e(),n(18,"mat-select",24)(19,"mat-option",25),t(20,"Cash"),e(),n(21,"mat-option",26),t(22,"Credit Card"),e(),n(23,"mat-option",27),t(24,"Debit Card"),e(),n(25,"mat-option",28),t(26,"Bank Transfer"),e(),n(27,"mat-option",29),t(28,"Check"),e(),n(29,"mat-option",30),t(30,"Mobile Payment"),e(),n(31,"mat-option",31),t(32,"Other"),e()(),n(33,"mat-icon",23),t(34,"account_balance"),e(),n(35,"mat-hint"),t(36,"How was/will the payment be made?"),e(),d(37,He,2,0,"mat-error"),e(),n(38,"mat-form-field",20)(39,"mat-label"),t(40,"Transaction Reference (Optional)"),e(),v(41,"input",43),n(42,"mat-icon",23),t(43,"receipt"),e()(),n(44,"mat-form-field",20)(45,"mat-label"),t(46,"Payment Notes (Optional)"),e(),v(47,"textarea",44),n(48,"mat-icon",23),t(49,"note"),e()(),d(50,$e,14,5,"div",45)),a&2){let o,i,m,u=C();l(14),s((o=u.paymentForm.get("status"))!=null&&o.hasError("required")?14:-1),l(23),s((i=u.paymentForm.get("method"))!=null&&i.hasError("required")?37:-1),l(13),s(((m=u.paymentForm.get("status"))==null?null:m.value)==="paid"&&u.data.reservation.pricing.balance>0?50:-1)}}function Ye(a,r){a&1&&(v(0,"mat-spinner",49),t(1," Updating... "))}function Je(a,r){a&1&&t(0," Update Payment ")}var Ae=class a{fb=g(N);dialogRef=g(L);data=g(K);storeStore=g(xe);processing=_(!1);constructor(){if(this.data.reservation.status==="checked_out"&&!this.data.isCheckoutFlow){setTimeout(()=>{this.dialogRef.close({confirmed:!1,error:"Cannot edit payment information for checked-out reservations"})});return}console.log("PaymentUpdateDialog opened with reservation:",this.data.reservation),console.log("Reservation extensions:",this.data.reservation.extensions),this.data.reservation.extensions&&this.data.reservation.extensions.forEach((r,o)=>{console.log(`Extension ${o}:`,{status:r.status,additionalCost:r.additionalCost,additionalNights:r.additionalNights})}),this.initializeForm()}initializeForm(){let r=this.getCurrentPaymentStatus(),o=this.data.reservation.paymentInfo?.method||"cash";this.data.isCheckoutFlow?(this.paymentForm.get("amount")?.setValidators([f.required,f.min(.01),f.max(this.data.reservation.pricing.balance||0)]),this.paymentForm.patchValue({amount:this.data.reservation.pricing.balance||0,method:o,reference:"",notes:""})):(this.paymentForm.get("status")?.setValidators([f.required]),this.paymentForm.patchValue({status:r,method:o,reference:"",notes:""})),this.paymentForm.updateValueAndValidity()}paymentForm=this.fb.group({amount:[0],status:[""],method:["",f.required],reference:[""],notes:[""]});get currency(){return this.storeStore.selectedStore()?.currencyCode||this.storeStore.selectedStore()?.currency||"$"}get isReservationCheckedOut(){return this.data.reservation.status==="checked_out"}getApprovedExtensionCost(){if(console.log("Extension debugging:",{hasExtensions:!!this.data.reservation.extensions,extensions:this.data.reservation.extensions,extensionCount:this.data.reservation.extensions?.length||0}),this.data.reservation.extensions){let r=this.data.reservation.extensions.filter(i=>i.status==="approved");console.log("Approved extensions:",r);let o=r.reduce((i,m)=>i+(m.additionalCost||0),0);return console.log("Total approved extension cost:",o),o}return 0}getApprovedExtensionNights(){return this.data.reservation.extensions?this.data.reservation.extensions.filter(o=>o.status==="approved").reduce((o,i)=>o+(i.additionalNights||0),0):0}hasApprovedExtensions(){return this.getApprovedExtensionCost()>0}getCurrentPaymentStatus(){let r=this.data.reservation.pricing.balance||0,o=this.data.reservation.pricing.paid||0;return r<=0?"paid":o>0?"partial":"pending"}getCurrentStatusClass(){switch(this.getCurrentPaymentStatus()){case"paid":return"text-green-600";case"partial":return"text-orange-600";case"pending":return"text-red-600";default:return"text-gray-600"}}canSave(){if(!this.paymentForm.valid)return!1;if(this.data.isCheckoutFlow)return this.paymentForm.valid;{let r=this.paymentForm.get("status")?.value,o=this.data.reservation.pricing.balance||0;if(r==="paid"&&o>0)return!1}return!0}setAmount(r){this.paymentForm.patchValue({amount:r})}onCancel(){this.dialogRef.close({confirmed:!1})}onConfirm(){if(this.canSave()){this.processing.set(!0);let r;this.data.isCheckoutFlow?r={confirmed:!0,paymentData:{amount:this.paymentForm.value.amount,method:this.paymentForm.value.method,reference:this.paymentForm.value.reference||void 0,notes:this.paymentForm.value.notes||void 0}}:r={confirmed:!0,paymentData:{status:this.paymentForm.value.status,method:this.paymentForm.value.method,reference:this.paymentForm.value.reference||void 0,notes:this.paymentForm.value.notes||void 0}},setTimeout(()=>{this.processing.set(!1),this.dialogRef.close(r)},1e3)}}static \u0275fac=function(o){return new(o||a)};static \u0275cmp=S({type:a,selectors:[["app-payment-update-dialog"]],decls:45,vars:28,consts:[[1,"payment-dialog"],[1,"dialog-header"],["mat-dialog-title","",1,"text-xl","font-semibold","text-gray-900","mb-1"],[1,"text-sm","text-gray-600","mb-4"],[1,"space-y-4"],[1,"bg-gray-50","rounded-lg","p-4","border","border-gray-200"],[1,"text-sm","font-medium","text-gray-700","mb-3"],[1,"grid","grid-cols-2","gap-4","text-sm"],[1,"text-gray-600"],[1,"font-semibold"],[1,"font-semibold","text-green-600"],[1,"bg-orange-50","border","border-orange-200","rounded-lg","p-3"],[1,"space-y-4",3,"formGroup"],["align","end",1,"gap-2","pt-4"],["mat-button","",1,"text-gray-600","hover:text-gray-800",3,"click"],["mat-raised-button","","color","primary",1,"min-w-[140px]",3,"click","disabled"],[1,"flex","items-center","gap-2"],[1,"text-orange-600","text-sm"],[1,"text-sm","text-orange-800"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4"],["appearance","outline",1,"w-full"],["matPrefix",""],["matInput","","type","number","step","0.01","min","0","formControlName","amount","placeholder","0.00",3,"max"],["matSuffix",""],["formControlName","method"],["value","cash"],["value","credit_card"],["value","debit_card"],["value","bank_transfer"],["value","check"],["value","mobile_payment"],["value","other"],["matInput","","formControlName","reference","placeholder","Transaction ID, Check number, etc."],["matInput","","formControlName","notes","rows","3","placeholder","Additional payment notes..."],[1,"space-y-2"],[1,"text-sm","font-medium","text-gray-700"],[1,"flex","flex-wrap","gap-2"],["type","button",1,"px-3","py-1","text-sm","bg-gray-100","hover:bg-gray-200","text-gray-700","rounded-md","transition-colors",3,"click"],["type","button",1,"px-3","py-1","text-sm","bg-gray-100","hover:bg-gray-200","text-gray-700","rounded-md","transition-colors"],["formControlName","status"],["value","pending"],["value","partial"],["value","paid"],["matInput","","formControlName","reference","placeholder","Transaction ID, Receipt number, etc."],["matInput","","formControlName","notes","rows","3","placeholder","Additional notes about the payment..."],[1,"bg-red-50","border","border-red-200","rounded-lg","p-3"],[1,"flex","items-start","gap-2"],[1,"text-red-600","text-sm","mt-0.5"],[1,"text-sm","text-red-800"],["diameter","20",1,"mr-2"]],template:function(o,i){o&1&&(n(0,"div",0)(1,"div",1)(2,"h2",2),t(3," Update Payment Information "),e(),n(4,"p",3),t(5),e()(),n(6,"mat-dialog-content",4)(7,"div",5)(8,"h3",6),t(9,"Current Status"),e(),n(10,"div",7)(11,"div")(12,"span",8),t(13,"Total Amount:"),e(),n(14,"div",9),t(15),y(16,"number"),e()(),n(17,"div")(18,"span",8),t(19,"Amount Paid:"),e(),n(20,"div",10),t(21),y(22,"number"),e()(),n(23,"div")(24,"span",8),t(25,"Balance Due:"),e(),n(26,"div",9),t(27),y(28,"number"),e()(),n(29,"div")(30,"span",8),t(31,"Current Status:"),e(),n(32,"div",9),t(33),y(34,"titlecase"),e()()()(),d(35,ze,9,6,"div",11),n(36,"form",12),d(37,Le,52,13)(38,Qe,51,3),e()(),n(39,"mat-dialog-actions",13)(40,"button",14),p("click",function(){return i.onCancel()}),t(41," Cancel "),e(),n(42,"button",15),p("click",function(){return i.onConfirm()}),d(43,Ye,2,0)(44,Je,1,0),e()()()),o&2&&(l(5),x(" Confirmation: ",i.data.reservation.confirmationNumber," "),l(10),b("",i.currency,"",P(16,17,i.data.reservation.pricing.total,"1.2-2")),l(6),b("",i.currency,"",P(22,20,i.data.reservation.pricing.paid,"1.2-2")),l(5),Z(i.data.reservation.pricing.balance>0?"text-red-600":"text-green-600"),l(),b(" ",i.currency,"",P(28,23,i.data.reservation.pricing.balance,"1.2-2")," "),l(5),Z(i.getCurrentStatusClass()),l(),x(" ",oe(34,26,i.getCurrentPaymentStatus())," "),l(2),s(i.hasApprovedExtensions()?35:-1),l(),h("formGroup",i.paymentForm),l(),s(i.data.isCheckoutFlow?37:38),l(5),h("disabled",!i.canSave()||i.processing()),l(),s(i.processing()?43:44))},dependencies:[M,re,ae,T,w,k,de,F,I,ce,se,A,O,H,he,ve,Ce,D,E,U,V,R,ue,W,ge,z,B,G,be,_e,le,j,q,X,ye],styles:[".payment-dialog[_ngcontent-%COMP%]{min-width:500px;max-width:600px}.dialog-header[_ngcontent-%COMP%]{padding-bottom:16px;border-bottom:1px solid #e5e7eb;margin-bottom:16px}mat-dialog-content[_ngcontent-%COMP%]{max-height:70vh;overflow-y:auto}mat-dialog-actions[_ngcontent-%COMP%]{border-top:1px solid #e5e7eb;margin-top:16px;padding-top:16px}.mat-mdc-form-field[_ngcontent-%COMP%]{margin-bottom:0}"]})};function We(a,r){a&1&&(n(0,"mat-error"),t(1,"PIN is required"),e())}function Xe(a,r){a&1&&(n(0,"mat-error"),t(1,"PIN must be at least 4 digits"),e())}function Ze(a,r){a&1&&(n(0,"mat-error"),t(1,"PIN cannot exceed 6 digits"),e())}function et(a,r){a&1&&(n(0,"mat-error"),t(1,"Invalid PIN entered"),e())}function tt(a,r){if(a&1&&(n(0,"div",12)(1,"mat-icon",20),t(2,"error"),e(),n(3,"div")(4,"h4",21),t(5,"Authorization Failed"),e(),n(6,"p",22),t(7),e()()()),a&2){let o=C();l(7),ee(o.error())}}function nt(a,r){a&1&&(n(0,"mat-icon",23),t(1,"sync"),e(),t(2," Verifying... "))}function it(a,r){a&1&&(n(0,"mat-icon",24),t(1,"security"),e(),t(2," Authorize "))}var Oe=class a{fb=g(N);dialogRef=g(L);data=g(K);storeService=g(fe);verifying=_(!1);error=_(null);showPin=_(!1);pinForm;constructor(){this.pinForm=this.fb.group({pin:["",[f.required,f.minLength(4),f.maxLength(6)]]})}get actionDescription(){return this.data.actionDescription||"perform this action"}get storeId(){return this.data.storeId}togglePinVisibility(){this.showPin.set(!this.showPin())}verifyPin(){return te(this,null,function*(){if(this.pinForm.invalid){this.pinForm.markAllAsTouched();return}let r=this.pinForm.get("pin")?.value;if(r){this.verifying.set(!0),this.error.set(null);try{(yield this.storeService.validateStoreOwnerPin(this.storeId,r).toPromise())?this.dialogRef.close({authorized:!0,pin:r}):(this.error.set("Invalid PIN. Please check with the store owner for the correct PIN."),this.pinForm.get("pin")?.setErrors({invalid:!0}))}catch(o){console.error("Error validating PIN:",o),this.error.set("Unable to verify PIN. Please check your connection and try again.")}finally{this.verifying.set(!1)}}})}cancel(){this.dialogRef.close({authorized:!1})}onPinKeyPress(r){r.key==="Enter"&&this.pinForm.valid&&!this.verifying()&&this.verifyPin()}onPinInput(){this.error()&&(this.error.set(null),this.pinForm.get("pin")?.setErrors(null))}static \u0275fac=function(o){return new(o||a)};static \u0275cmp=S({type:a,selectors:[["app-pin-authorization-dialog"]],decls:38,vars:13,consts:[[1,"pin-authorization-dialog"],[1,"dialog-header"],[1,"text-xl","font-semibold","text-gray-900","mb-2","flex","items-center","gap-3"],[1,"w-10","h-10","bg-gradient-to-r","from-red-500","to-red-600","rounded-full","flex","items-center","justify-center","shadow-lg"],[1,"text-white","text-lg"],[1,"text-gray-600","text-sm"],[1,"dialog-content","mt-6"],[3,"ngSubmit","formGroup"],[1,"space-y-4"],["appearance","outline",1,"w-full"],["matInput","","formControlName","pin","placeholder","Enter 4-6 digit PIN","maxlength","6","autocomplete","off",1,"text-center","text-lg","tracking-wider","font-mono",3,"keypress","input","type"],["type","button","matSuffix","","mat-icon-button","",1,"text-gray-500","hover:text-gray-700",3,"click"],[1,"bg-red-50","border","border-red-200","rounded-lg","p-4","flex","items-start","gap-3"],[1,"bg-blue-50","border","border-blue-200","rounded-lg","p-4","flex","items-start","gap-3"],[1,"text-blue-500","mt-0.5","flex-shrink-0"],[1,"text-blue-800","font-medium","text-sm"],[1,"text-blue-700","text-sm","mt-1"],[1,"dialog-actions","mt-8","flex","items-center","justify-end","gap-3","pt-4","border-t","border-gray-200"],["type","button","mat-button","",1,"!text-gray-600","hover:!text-gray-800","hover:!bg-gray-50","!transition-colors","!px-6","!py-2",3,"click","disabled"],["type","button","mat-raised-button","","color","primary",1,"!bg-gradient-to-r","!from-blue-600","!to-blue-700","hover:!from-blue-700","hover:!to-blue-800","!text-white","!px-8","!py-2","!rounded-lg","!font-medium","!transition-all","!duration-200","!shadow-lg","hover:!shadow-xl","disabled:!opacity-50","disabled:!cursor-not-allowed",3,"click","disabled"],[1,"text-red-500","mt-0.5","flex-shrink-0"],[1,"text-red-800","font-medium","text-sm"],[1,"text-red-700","text-sm","mt-1"],[1,"!text-sm","mr-2","animate-spin"],[1,"!text-sm","mr-2"]],template:function(o,i){if(o&1&&(n(0,"div",0)(1,"div",1)(2,"h2",2)(3,"div",3)(4,"mat-icon",4),t(5,"security"),e()(),t(6," Store Owner Authorization Required "),e(),n(7,"p",5),t(8),e()(),n(9,"div",6)(10,"form",7),p("ngSubmit",function(){return i.verifyPin()}),n(11,"div",8)(12,"mat-form-field",9)(13,"mat-label"),t(14,"Store Owner PIN"),e(),n(15,"input",10),p("keypress",function(u){return i.onPinKeyPress(u)})("input",function(){return i.onPinInput()}),e(),n(16,"button",11),p("click",function(){return i.togglePinVisibility()}),n(17,"mat-icon"),t(18),e()(),d(19,We,2,0,"mat-error"),d(20,Xe,2,0,"mat-error"),d(21,Ze,2,0,"mat-error"),d(22,et,2,0,"mat-error"),e(),d(23,tt,8,1,"div",12),n(24,"div",13)(25,"mat-icon",14),t(26,"info"),e(),n(27,"div")(28,"h4",15),t(29,"Security Notice"),e(),n(30,"p",16),t(31," Only the store owner should have access to this PIN. This authorization ensures that important actions are performed with proper approval. "),e()()()()()(),n(32,"div",17)(33,"button",18),p("click",function(){return i.cancel()}),t(34," Cancel "),e(),n(35,"button",19),p("click",function(){return i.verifyPin()}),d(36,nt,3,0)(37,it,3,0),e()()()),o&2){let m,u,c,$;l(8),x(" Enter the store owner PIN to authorize and ",i.actionDescription,". "),l(2),h("formGroup",i.pinForm),l(5),h("type",i.showPin()?"text":"password"),l(),ne("aria-label","Toggle PIN visibility"),l(2),ee(i.showPin()?"visibility_off":"visibility"),l(),s((m=i.pinForm.get("pin"))!=null&&m.hasError("required")&&((m=i.pinForm.get("pin"))!=null&&m.touched)?19:-1),l(),s((u=i.pinForm.get("pin"))!=null&&u.hasError("minlength")&&((u=i.pinForm.get("pin"))!=null&&u.touched)?20:-1),l(),s((c=i.pinForm.get("pin"))!=null&&c.hasError("maxlength")&&((c=i.pinForm.get("pin"))!=null&&c.touched)?21:-1),l(),s(($=i.pinForm.get("pin"))!=null&&$.hasError("invalid")&&(($=i.pinForm.get("pin"))!=null&&$.touched)?22:-1),l(),s(i.error()?23:-1),l(10),h("disabled",i.verifying()),l(2),h("disabled",i.pinForm.invalid||i.verifying()),l(),s(i.verifying()?36:37)}},dependencies:[M,T,w,k,F,I,pe,A,O,H,D,E,me,U,V,R,W,z,B,G,j,q,X],styles:[".pin-authorization-dialog[_ngcontent-%COMP%]{padding:24px;max-width:450px;min-width:400px}.dialog-header[_ngcontent-%COMP%]{text-align:center}.dialog-content[_ngcontent-%COMP%]   .mat-mdc-form-field[_ngcontent-%COMP%]   .mdc-text-field--outlined[_ngcontent-%COMP%]{background-color:#f9fafb;border-color:#e5e7eb}.dialog-content[_ngcontent-%COMP%]   .mat-mdc-form-field[_ngcontent-%COMP%]   .mdc-text-field--outlined[_ngcontent-%COMP%]:hover{border-color:#3b82f6}.dialog-content[_ngcontent-%COMP%]   .mat-mdc-form-field[_ngcontent-%COMP%]   .mdc-text-field--outlined.mdc-text-field--focused[_ngcontent-%COMP%]{border-color:#2563eb;box-shadow:0 0 0 3px #3b82f61a}.dialog-actions[_ngcontent-%COMP%]   .mat-mdc-raised-button[_ngcontent-%COMP%]:disabled{box-shadow:none}.dialog-actions[_ngcontent-%COMP%]   .mat-mdc-raised-button[_ngcontent-%COMP%]:disabled:hover{transform:none}.dialog-actions[_ngcontent-%COMP%]   .mat-mdc-raised-button[_ngcontent-%COMP%]:not(:disabled):hover{transform:translateY(-1px);box-shadow:0 10px 15px -3px #0000001a,0 4px 6px -2px #0000000d}@keyframes _ngcontent-%COMP%_pulse-security{0%,to{transform:scale(1)}50%{transform:scale(1.05)}}.dialog-header[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_pulse-security 2s infinite}.mat-mdc-form-field[_ngcontent-%COMP%]   input[type=password][_ngcontent-%COMP%], .mat-mdc-form-field[_ngcontent-%COMP%]   input[type=text][_ngcontent-%COMP%]{font-size:18px;letter-spacing:.2em}.mat-mdc-form-field[_ngcontent-%COMP%]   input[type=password][_ngcontent-%COMP%]::placeholder, .mat-mdc-form-field[_ngcontent-%COMP%]   input[type=text][_ngcontent-%COMP%]::placeholder{font-size:14px;letter-spacing:normal}.bg-red-50[_ngcontent-%COMP%], .bg-blue-50[_ngcontent-%COMP%]{transition:all .2s ease-in-out}.bg-red-50[_ngcontent-%COMP%]:hover, .bg-blue-50[_ngcontent-%COMP%]:hover{box-shadow:0 2px 4px #0000001a}.animate-spin[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_spin 1s linear infinite}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}@media (max-width: 480px){.pin-authorization-dialog[_ngcontent-%COMP%]{padding:16px;min-width:320px;max-width:95vw}.dialog-actions[_ngcontent-%COMP%]{flex-direction:column-reverse}.dialog-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:100%;margin:4px 0}}"]})};export{Me as a,Ae as b,Oe as c};
