import{a as $e,b as Ge}from"./chunk-CEVXR66Z.js";import{a as We,b as Oe,c as Ae,h as He}from"./chunk-VZJV7FAI.js";import{a as ze,b as je}from"./chunk-SYBKQTIU.js";import"./chunk-H3VCUIUM.js";import"./chunk-FB5OTQCF.js";import{a as Ee,b as be,c as Te,d as De,e as Le,f as Ie,g as Ve,h as Fe,i as Pe,j as Ne,k as Be}from"./chunk-OALZQOYE.js";import{a as te}from"./chunk-HY4LTOAV.js";import"./chunk-4G2PTLMY.js";import"./chunk-EIZRJIIE.js";import"./chunk-R4SEO7WU.js";import{a as pe,b as de,c as ue,d as fe}from"./chunk-U2JZUY6D.js";import{i as re}from"./chunk-U4YSNMIZ.js";import{a as we,b as Re}from"./chunk-3IQG3KHZ.js";import{d as ee}from"./chunk-YK4A772F.js";import"./chunk-HXICWX3M.js";import"./chunk-4YIJHWNC.js";import{d as V}from"./chunk-EPNSEEH4.js";import"./chunk-MMNFDWV7.js";import"./chunk-CGDRKYIW.js";import{b as ve,c as he,d as ye}from"./chunk-IS37LNAK.js";import{a as Se,e as xe,h as Me}from"./chunk-QJ2P7YZL.js";import"./chunk-LXD47U2C.js";import{A as ke,b as _e,g as ge,l as Ce}from"./chunk-SZWYIW32.js";import"./chunk-CTT4BYCX.js";import"./chunk-NQRUH5DO.js";import{a as se,c as me,h as ce}from"./chunk-MESJBQC5.js";import"./chunk-QEF3JOQ3.js";import"./chunk-LSROOOYO.js";import"./chunk-7NDZPDVA.js";import{b as ae,c as le}from"./chunk-OWLRGWNJ.js";import{$ as oe,Y as ie,Z as ne}from"./chunk-OS2CYUJN.js";import{g as X,h as Y,l as Z}from"./chunk-WFEXX4HI.js";import{l as J,m as K,p as Q,r as U}from"./chunk-U2P6GFP5.js";import{$a as l,Dc as y,Gb as T,Hb as D,Jc as b,Kb as H,Kc as $,Lb as z,Lc as G,Mb as u,Nb as t,Nc as q,Ob as i,Pb as x,Tb as g,Tc as I,Ub as C,Wb as R,_b as _,ac as k,d as W,ea as O,ib as w,ja as p,ka as d,kc as E,ob as A,oc as j,pc as o,qc as S,rc as L,ub as f,uc as M,vc as v,wc as h}from"./chunk-IQSYHSID.js";import{a as N,b as B}from"./chunk-EQDQRRRY.js";var Je=()=>["./add"],Ke=()=>[],Qe=()=>[5,10,25,50],Ue=(e,n)=>n._id;function Xe(e,n){if(e&1&&(t(0,"mat-option",17),o(1),i()),e&2){let r=n.$implicit;u("value",r._id),l(),S(r.name)}}function Ye(e,n){e&1&&(t(0,"th",35),o(1,"Invoice #"),i())}function Ze(e,n){if(e&1&&(t(0,"td",36),o(1),i()),e&2){let r=n.$implicit;l(),S(r.invoiceNumber)}}function et(e,n){e&1&&(t(0,"th",35),o(1,"Date"),i())}function tt(e,n){if(e&1&&(t(0,"td",36),o(1),b(2,"date"),i()),e&2){let r=n.$implicit;l(),L(" ",G(2,1,r.invoiceDate,"shortDate")," ")}}function it(e,n){e&1&&(t(0,"th",35),o(1,"Supplier"),i())}function nt(e,n){if(e&1&&(t(0,"td",36),o(1),i()),e&2){let r=n.$implicit;l(),S((r.supplier==null?null:r.supplier.name)||"N/A")}}function ot(e,n){e&1&&(t(0,"th",35),o(1,"Items"),i())}function rt(e,n){if(e&1&&(t(0,"td",36),o(1),i()),e&2){let r=n.$implicit;l(),S((r.items==null?null:r.items.length)||0)}}function at(e,n){e&1&&(t(0,"th",35),o(1,"Total"),i())}function lt(e,n){if(e&1&&(t(0,"td",36)(1,"span",37),o(2),b(3,"currency"),i()()),e&2){let r=n.$implicit,a=k();l(2),S(q(3,1,r.total,a.currency(),"symbol","1.2-2"))}}function st(e,n){e&1&&(t(0,"th",35),o(1,"Status"),i())}function mt(e,n){if(e&1&&(t(0,"td",36)(1,"span",38),o(2),b(3,"titlecase"),i()()),e&2){let r=n.$implicit,a=k();l(),j(a.getStatusClass(r.status)),l(),L(" ",$(3,3,r.status)," ")}}function ct(e,n){e&1&&(t(0,"th",35),o(1,"Actions"),i())}function pt(e,n){if(e&1){let r=R();t(0,"td",36)(1,"button",39)(2,"mat-icon"),o(3,"more_vert"),i()(),t(4,"mat-menu",null,2)(6,"button",40),_("click",function(){let s=p(r).$implicit,m=k();return d(m.viewDetails(s._id))}),t(7,"mat-icon"),o(8,"visibility"),i(),t(9,"span"),o(10,"View Details"),i()(),t(11,"button",40),_("click",function(){let s=p(r).$implicit,m=k();return d(m.editRestock(s._id))}),t(12,"mat-icon"),o(13,"edit"),i(),t(14,"span"),o(15,"Edit"),i()(),t(16,"button",41),_("click",function(){let s=p(r).$implicit,m=k();return d(m.deleteRestock(s._id))}),t(17,"mat-icon"),o(18,"delete"),i(),t(19,"span"),o(20,"Delete"),i()()()()}if(e&2){let r=E(5);l(),u("matMenuTriggerFor",r)}}function dt(e,n){e&1&&x(0,"tr",42)}function ut(e,n){e&1&&x(0,"tr",43)}function ft(e,n){if(e&1){let r=R();t(0,"mat-paginator",44),_("page",function(s){p(r);let m=k();return d(m.onPageChange(s))}),i()}if(e&2){let r=k();u("length",r.restocks.value().pagination.total)("pageSize",r.restocks.value().pagination.limit)("pageIndex",r.restocks.value().pagination.page-1)("pageSizeOptions",y(4,Qe))}}function _t(e,n){e&1&&(t(0,"div",34)(1,"mat-icon",45),o(2,"inventory_2"),i(),t(3,"h3",46),o(4,"No restock records found"),i(),t(5,"p",47),o(6,"Start by adding your first stock entry"),i(),t(7,"button",48),o(8," Add Stock "),i()()),e&2&&(l(7),u("routerLink",y(1,Je)))}var qe=class e{constructor(n,r,a){this.restockService=n;this.suppliersService=r;this.router=a}displayedColumns=["invoiceNumber","date","supplier","items","total","status","actions"];storeStore=O(re);selectedStore=I(()=>this.storeStore.selectedStore());currency=I(()=>this.selectedStore()?.currency||"NGN");filters={status:"",supplier:"",dateFrom:null,dateTo:null,page:1,limit:10};restocks=V({params:()=>B(N({},this.filters),{dateFrom:this.filters.dateFrom?.toISOString().split("T")[0]||"",dateTo:this.filters.dateTo?.toISOString().split("T")[0]||""}),stream:({params:n})=>this.restockService.findAll(n)});suppliers=V({params:()=>({storeId:this.storeStore.selectedStore()?._id}),stream:({params:n})=>n.storeId?this.suppliersService.getSuppliersByStore(n.storeId):new W(r=>{r.next([]),r.complete()})});ngOnInit(){this.loadRestocks()}loadRestocks(){this.restocks.reload()}onPageChange(n){this.filters.page=n.pageIndex+1,this.filters.limit=n.pageSize,this.loadRestocks()}viewDetails(n){this.router.navigate(["dashboard","inventory","restock","details",n])}editRestock(n){this.router.navigate(["dashboard","inventory","restock","edit",n])}deleteRestock(n){confirm("Are you sure you want to delete this restock record?")&&this.restockService.delete(n).subscribe(()=>{this.loadRestocks()})}getStatusClass(n){switch(n){case"completed":return"bg-green-100 text-green-800";case"draft":return"bg-yellow-100 text-yellow-800";case"cancelled":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}}static \u0275fac=function(r){return new(r||e)(w($e),w(Ge),w(X))};static \u0275cmp=A({type:e,selectors:[["app-list-restock"]],decls:77,vars:16,consts:[["fromPicker",""],["toPicker",""],["menu","matMenu"],[1,"p-6","max-w-7xl","mx-auto"],[1,"flex","justify-between","items-center","mb-6"],[1,"text-3xl","font-bold","text-gray-900"],[1,"text-gray-600","mt-1"],["mat-raised-button","","color","primary",1,"flex","items-center","space-x-2",3,"routerLink"],[1,"mb-6"],[1,"p-4"],[1,"grid","grid-cols-1","md:grid-cols-4","gap-4"],["appearance","outline"],[3,"ngModelChange","selectionChange","ngModel"],["value",""],["value","draft"],["value","completed"],["value","cancelled"],[3,"value"],["matInput","",3,"ngModelChange","dateChange","matDatepicker","ngModel"],["matIconSuffix","",3,"for"],[1,"overflow-x-auto"],["mat-table","",1,"w-full",3,"dataSource"],["matColumnDef","invoiceNumber"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","date"],["matColumnDef","supplier"],["matColumnDef","items"],["matColumnDef","total"],["matColumnDef","status"],["matColumnDef","actions"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["showFirstLastButtons","",3,"length","pageSize","pageIndex","pageSizeOptions"],[1,"text-center","py-12"],["mat-header-cell",""],["mat-cell",""],[1,"font-medium"],[1,"px-2","py-1","rounded-full","text-xs","font-medium"],["mat-icon-button","",3,"matMenuTriggerFor"],["mat-menu-item","",3,"click"],["mat-menu-item","",1,"text-red-600",3,"click"],["mat-header-row",""],["mat-row",""],["showFirstLastButtons","",3,"page","length","pageSize","pageIndex","pageSizeOptions"],[1,"text-gray-400","text-6xl","mb-4"],[1,"text-lg","font-medium","text-gray-900","mb-2"],[1,"text-gray-500","mb-4"],["mat-raised-button","","color","primary",3,"routerLink"]],template:function(r,a){if(r&1){let s=R();t(0,"div",3)(1,"div",4)(2,"div")(3,"h1",5),o(4,"Restock History"),i(),t(5,"p",6),o(6,"Track all product restocking activities"),i()(),t(7,"button",7)(8,"mat-icon"),o(9,"add"),i(),t(10,"span"),o(11,"Add Stock"),i()()(),t(12,"mat-card",8)(13,"mat-card-content",9)(14,"div",10)(15,"mat-form-field",11)(16,"mat-label"),o(17,"Status"),i(),t(18,"mat-select",12),h("ngModelChange",function(c){return p(s),v(a.filters.status,c)||(a.filters.status=c),d(c)}),_("selectionChange",function(){return p(s),d(a.loadRestocks())}),t(19,"mat-option",13),o(20,"All"),i(),t(21,"mat-option",14),o(22,"Draft"),i(),t(23,"mat-option",15),o(24,"Completed"),i(),t(25,"mat-option",16),o(26,"Cancelled"),i()()(),t(27,"mat-form-field",11)(28,"mat-label"),o(29,"Supplier"),i(),t(30,"mat-select",12),h("ngModelChange",function(c){return p(s),v(a.filters.supplier,c)||(a.filters.supplier=c),d(c)}),_("selectionChange",function(){return p(s),d(a.loadRestocks())}),t(31,"mat-option",13),o(32,"All Suppliers"),i(),H(33,Xe,2,2,"mat-option",17,Ue),i()(),t(35,"mat-form-field",11)(36,"mat-label"),o(37,"From Date"),i(),t(38,"input",18),h("ngModelChange",function(c){return p(s),v(a.filters.dateFrom,c)||(a.filters.dateFrom=c),d(c)}),_("dateChange",function(){return p(s),d(a.loadRestocks())}),i(),x(39,"mat-datepicker-toggle",19)(40,"mat-datepicker",null,0),i(),t(42,"mat-form-field",11)(43,"mat-label"),o(44,"To Date"),i(),t(45,"input",18),h("ngModelChange",function(c){return p(s),v(a.filters.dateTo,c)||(a.filters.dateTo=c),d(c)}),_("dateChange",function(){return p(s),d(a.loadRestocks())}),i(),x(46,"mat-datepicker-toggle",19)(47,"mat-datepicker",null,1),i()()()(),t(49,"mat-card")(50,"div",20)(51,"table",21),g(52,22),f(53,Ye,2,0,"th",23)(54,Ze,2,1,"td",24),C(),g(55,25),f(56,et,2,0,"th",23)(57,tt,3,4,"td",24),C(),g(58,26),f(59,it,2,0,"th",23)(60,nt,2,1,"td",24),C(),g(61,27),f(62,ot,2,0,"th",23)(63,rt,2,1,"td",24),C(),g(64,28),f(65,at,2,0,"th",23)(66,lt,4,6,"td",24),C(),g(67,29),f(68,st,2,0,"th",23)(69,mt,4,5,"td",24),C(),g(70,30),f(71,ct,2,0,"th",23)(72,pt,21,1,"td",24),C(),f(73,dt,1,0,"tr",31)(74,ut,1,0,"tr",32),i()(),T(75,ft,1,5,"mat-paginator",33),i(),T(76,_t,9,2,"div",34),i()}if(r&2){let s,m,c,F=E(41),P=E(48);l(7),u("routerLink",y(14,Je)),l(11),M("ngModel",a.filters.status),l(12),M("ngModel",a.filters.supplier),l(3),z(a.suppliers.value()),l(5),u("matDatepicker",F),M("ngModel",a.filters.dateFrom),l(),u("for",F),l(6),u("matDatepicker",P),M("ngModel",a.filters.dateTo),l(),u("for",P),l(5),u("dataSource",((s=a.restocks.value())==null?null:s.data)||y(15,Ke)),l(22),u("matHeaderRowDef",a.displayedColumns),l(),u("matRowDefColumns",a.displayedColumns),l(),D((m=a.restocks.value())!=null&&m.pagination?75:-1),l(),D((c=a.restocks.value())!=null&&c.data&&a.restocks.value().data.length===0?76:-1)}},dependencies:[U,Be,Ee,Te,Ve,De,be,Fe,Le,Ie,Pe,Ne,oe,ne,ie,le,ae,ce,se,me,fe,de,pe,ue,ve,Me,Se,xe,ye,he,Re,we,ee,He,We,Oe,Ae,te,je,ze,Z,Y,ke,_e,ge,Ce,J,Q,K],encapsulation:2})};export{qe as ListRestockComponent};
