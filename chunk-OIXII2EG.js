import{c as Ce,d as xe,e as Se,f as be}from"./chunk-S5EO7Y4W.js";import{a as he}from"./chunk-DYW4DHWR.js";import{a as ye,b as Me,c as Ee}from"./chunk-MHF2HXCI.js";import{h as ge}from"./chunk-EC5CTV5L.js";import"./chunk-MS4AQ6UA.js";import{a as h,b as ve}from"./chunk-O45P3V5P.js";import{a as ae,b as re,c as le,d as me,e as ce,f as pe,g as se,h as de,i as _e,j as ue,k as fe}from"./chunk-57X727ZR.js";import"./chunk-Q5UDPT6U.js";import"./chunk-3RK6DDJD.js";import{a as Te}from"./chunk-CNWF3C72.js";import{a as Re}from"./chunk-2Y57DTIK.js";import"./chunk-VIUFJ2AI.js";import"./chunk-Q4AGDAAP.js";import{b as K,d as U}from"./chunk-2QJHH5H3.js";import{a as Z,b as ee,c as te,d as ie}from"./chunk-AI6BMZ3D.js";import"./chunk-TGNPMYMP.js";import"./chunk-ISZZXQLC.js";import{c as ne,d as oe}from"./chunk-KYJY5VKP.js";import"./chunk-WYGWPNHQ.js";import{z as J}from"./chunk-XY46NWPA.js";import{a as W,b as X}from"./chunk-VJDAHTGR.js";import{l as Q,m as j,n as G}from"./chunk-FJR6RDUA.js";import{c as Y}from"./chunk-4N6XGVIM.js";import"./chunk-DX7AZUD7.js";import"./chunk-C3MGKPDK.js";import{a as H,c as A}from"./chunk-QQ5WRBM6.js";import{g as q,m as B,q as z,r as N}from"./chunk-5PWABXJE.js";import{$b as V,Db as T,Eb as w,Hb as D,Ib as L,Jb as p,Kb as n,Lb as o,Mb as b,Nb as d,Ob as _,Qb as v,Ub as S,Vb as s,Z as R,Zb as P,_a as m,_b as k,dc as y,fa as f,ic as a,jc as u,kb as E,kc as I,la as C,ma as x,qb as c,wc as F,xc as M,yc as $,zc as O}from"./chunk-FR2FBSQW.js";import"./chunk-FK6H3RFT.js";import"./chunk-EQDQRRRY.js";var De=(e,i,t,r)=>({"bg-green-100 text-green-800":e,"bg-yellow-100 text-yellow-800":i,"bg-red-100 text-red-800":t,"bg-gray-100 text-gray-800":r}),Le=(e,i)=>i.value;function Pe(e,i){if(e&1){let t=v();n(0,"a",29),S("click",function(){let l=C(t).$implicit,g=s(2);return x(g.onTabChange(l.value))}),n(1,"div",30)(2,"h3",31),a(3),o(),n(4,"p",32),a(5),o()()()}if(e&2){let t=i.$implicit,r=s(2);p("active",r.activeTab===t.value),m(3),u(t.label),m(2),u(t.count)}}function ke(e,i){e&1&&(n(0,"th",33),a(1,"Receipt no."),o())}function Ve(e,i){if(e&1&&(n(0,"td",34),a(1),o()),e&2){let t=i.$implicit;m(),u(t.receiptNo)}}function Ie(e,i){e&1&&(n(0,"th",33),a(1,"Date"),o())}function Fe(e,i){if(e&1&&(n(0,"td",34),a(1),o()),e&2){let t=i.$implicit;m(),u(t.date)}}function $e(e,i){e&1&&(n(0,"th",33),a(1,"Ordered by"),o())}function Oe(e,i){if(e&1&&(n(0,"td",34),a(1),o()),e&2){let t=i.$implicit;m(),u((t==null||t.orderedBy==null?null:t.orderedBy.name)??"Admin")}}function qe(e,i){e&1&&(n(0,"th",33),a(1,"Status"),o())}function Be(e,i){if(e&1&&(n(0,"td",34)(1,"span",35),a(2),o()()),e&2){let t=i.$implicit;m(),p("ngClass",F(2,De,t.category==="Complete",t.category==="Processing",t.category==="Cancel",t.category!=="Complete"&&t.category!=="Processing"&&t.category!=="Cancel")),m(),I(" ",t.category," ")}}function ze(e,i){e&1&&(n(0,"th",33),a(1,"Payment Type"),o())}function Ne(e,i){if(e&1&&(n(0,"td",34),a(1),o()),e&2){let t=i.$implicit;m(),u(t.type)}}function He(e,i){e&1&&(n(0,"th",33),a(1,"Order Type"),o())}function Ae(e,i){if(e&1&&(n(0,"td",34),a(1),M(2,"titlecase"),o()),e&2){let t=i.$implicit;m(),u($(2,1,t.ordertype))}}function Qe(e,i){e&1&&(n(0,"th",33),a(1,"Total"),o())}function je(e,i){if(e&1&&(n(0,"td",34),a(1),M(2,"currency"),o()),e&2){let t,r=i.$implicit,l=s(2);m(),u(O(2,1,r.total,(t=l.storeStore.selectedStore())==null?null:t.currency))}}function Ge(e,i){e&1&&(n(0,"th",33),a(1,"Actions"),o())}function Je(e,i){if(e&1){let t=v();n(0,"td",34)(1,"button",36)(2,"mat-icon"),a(3,"more_vert"),o()(),n(4,"mat-menu",null,2)(6,"button",12),S("click",function(){let l=C(t).$implicit,g=s(2);return x(g.viewRecipesDetails(l._id))}),n(7,"mat-icon"),a(8,"visibility"),o(),n(9,"span"),a(10,"View Receipt Details"),o()(),n(11,"button",12),S("click",function(){let l=C(t).$implicit,g=s(2);return x(g.deleteReceipt(l))}),n(12,"mat-icon"),a(13,"delete"),o(),n(14,"span"),a(15,"Delete"),o()()()()}if(e&2){let t=y(5);m(),p("matMenuTriggerFor",t)}}function Ke(e,i){e&1&&b(0,"tr",37)}function Ue(e,i){e&1&&b(0,"tr",38)}function We(e,i){if(e&1){let t=v();n(0,"nav",7),D(1,Pe,6,3,"a",8,Le),o(),n(3,"mat-tab-nav-panel",null,0)(5,"div",9)(6,"button",10)(7,"mat-icon",11),a(8,"file_download"),o(),a(9," Export Data "),o(),n(10,"mat-menu",null,1)(12,"button",12),S("click",function(){C(t);let l=s();return x(l.exportData("pdf"))}),n(13,"mat-icon"),a(14,"picture_as_pdf"),o(),n(15,"span"),a(16,"Export as PDF"),o()(),n(17,"button",12),S("click",function(){C(t);let l=s();return x(l.exportData("csv"))}),n(18,"mat-icon"),a(19,"description"),o(),n(20,"span"),a(21,"Export as CSV"),o()(),n(22,"button",12),S("click",function(){C(t);let l=s();return x(l.exportData("excel"))}),n(23,"mat-icon"),a(24,"table_chart"),o(),n(25,"span"),a(26,"Export as Excel"),o()()()(),n(27,"div",13)(28,"div",14)(29,"table",15),d(30,16),c(31,ke,2,0,"th",17)(32,Ve,2,1,"td",18),_(),d(33,19),c(34,Ie,2,0,"th",17)(35,Fe,2,1,"td",18),_(),d(36,20),c(37,$e,2,0,"th",17)(38,Oe,2,1,"td",18),_(),d(39,21),c(40,qe,2,0,"th",17)(41,Be,3,7,"td",18),_(),d(42,22),c(43,ze,2,0,"th",17)(44,Ne,2,1,"td",18),_(),d(45,23),c(46,He,2,0,"th",17)(47,Ae,3,3,"td",18),_(),d(48,24),c(49,Qe,2,0,"th",17)(50,je,3,4,"td",18),_(),d(51,25),c(52,Ge,2,0,"th",17)(53,Je,16,1,"td",18),_(),c(54,Ke,1,0,"tr",26)(55,Ue,1,0,"tr",27),o(),b(56,"mat-paginator",28),o()()()}if(e&2){let t=y(4),r=y(11),l=s();p("tabPanel",t),m(),L(l.tabStats),m(5),p("matMenuTriggerFor",r),m(23),p("dataSource",l.dataSource.value().orders),m(25),p("matHeaderRowDef",l.displayedColumns),m(),p("matRowDefColumns",l.displayedColumns),m(),p("pageSize",l.pageSize)("pageSizeOptions",l.pageSizeOptions)}}function Xe(e,i){e&1&&(n(0,"div",6),b(1,"mat-spinner",39),o())}var we=class e{queryParams=f(ye);orderService=f(Re);router=f(A);route=f(H);storeStore=f(Y);query=ne(this.queryParams.getAllParams$);activeTab="all";tabStats;dataSource=oe({params:()=>({storeId:this.storeStore.selectedStore()?._id,query:this.query()}),stream:({params:i})=>this.orderService.getSalesReceipts(i.storeId,i.query).pipe(R(t=>{let r=t.data;this.tabStats=[{label:"All Receipts",value:"all",count:r.allReceipts},{label:"Sales",value:"sales",count:r.sales},{label:"Refunds",value:"refund",count:r.refund}]}))});displayedColumns=["receiptNo","date","category","type","total","orderedBy","ordertype","actions"];paginator;pageSize=10;pageSizeOptions=[5,10,25,50];exportService=f(Ee);exportData(i){if(!this.dataSource.value())return;let t=this.dataSource.value().orders,r="receipts";switch(i){case"pdf":this.exportService.exportToPdf(t,r,{from:this.query().start,to:this.query().end});break;case"csv":this.exportService.exportToCSV(t,r);break;case"excel":this.exportService.exportToExcel(t,r);break}}onTabChange(i){this.activeTab=i,this.queryParams.add({type:i})}viewRecipesDetails(i){this.router.navigate(["../",i,"details"],{relativeTo:this.route})}deleteReceipt(i){confirm("Are you sure you want to delete this receipt?")&&this.orderService.deleteOrder(i).subscribe({next:()=>{this.dataSource.reload()},error:t=>{console.error("Error deleting receipt:",t)}})}static \u0275fac=function(t){return new(t||e)};static \u0275cmp=E({type:e,selectors:[["app-list-receipts"]],viewQuery:function(t,r){if(t&1&&P(h,5),t&2){let l;k(l=V())&&(r.paginator=l.first)}},decls:7,vars:1,consts:[["tabPanel",""],["exportMenu","matMenu"],["menu","matMenu"],[1,"p-4","bg-gray-50","min-h-screen"],[1,"flex","justify-between","items-center","mb-6","bg-white","p-4","rounded-lg","shadow-sm"],[1,"bg-white","rounded-lg","shadow-sm"],[1,"flex","items-center","justify-center","min-h-[300px]"],["mat-tab-nav-bar","",1,"grid","grid-cols-3",3,"tabPanel"],["mat-tab-link","",1,"!h-auto","!min-h-[100px]","!px-4","!py-4","border-b",3,"active"],[1,"p-6","flex","justify-between","items-center","border-b"],["mat-flat-button","","color","primary",3,"matMenuTriggerFor"],[1,"mr-2"],["mat-menu-item","",3,"click"],[1,"p-6"],[1,"table-container"],["mat-table","","matSort","",1,"!bg-white","w-full",3,"dataSource"],["matColumnDef","receiptNo"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","date"],["matColumnDef","orderedBy"],["matColumnDef","category"],["matColumnDef","type"],["matColumnDef","ordertype"],["matColumnDef","total"],["matColumnDef","actions"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["showFirstLastButtons","","aria-label","Select page",1,"!bg-white",3,"pageSize","pageSizeOptions"],["mat-tab-link","",1,"!h-auto","!min-h-[100px]","!px-4","!py-4","border-b",3,"click","active"],[1,"text-center"],[1,"text-gray-600","font-medium","mb-1"],[1,"text-2xl","font-semibold"],["mat-header-cell",""],["mat-cell",""],[1,"inline-block","px-2","py-1","rounded-full","text-xs","font-semibold",3,"ngClass"],["mat-icon-button","",3,"matMenuTriggerFor"],["mat-header-row",""],["mat-row",""],["diameter","40"]],template:function(t,r){t&1&&(n(0,"div",3)(1,"div",4),b(2,"date-range-selector")(3,"app-employee-selector"),o(),n(4,"div",5),T(5,We,57,7)(6,Xe,2,0,"div",6),o()()),t&2&&(m(5),w(r.dataSource.hasValue()?5:6))},dependencies:[N,q,B,z,fe,ae,le,se,me,re,de,ce,pe,_e,ue,ve,h,ie,ee,Z,te,G,j,Q,X,W,ge,K,U,be,Ce,Se,xe,J,he,Me,Te],styles:["[_nghost-%COMP%]     .mat-mdc-tab-nav-bar{border-bottom:none}.mat-mdc-tab-link[_ngcontent-%COMP%]{opacity:1!important}"]})};export{we as ListReceiptsComponent};
