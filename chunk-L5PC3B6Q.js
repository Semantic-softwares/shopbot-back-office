import{a as Z}from"./chunk-4C6TXTXM.js";import{a as Q,b as W,h as X}from"./chunk-DCD2EY64.js";import{a as z}from"./chunk-CGDRKYIW.js";import{b as U,c as Y,d as H}from"./chunk-IS37LNAK.js";import{a as j,b as q,e as B,h as K}from"./chunk-QJ2P7YZL.js";import{b as J}from"./chunk-ZG44B3L4.js";import{B as L,b as E,d as _,g as F,h as N,m as k,s as T,t as G,y as R,z as V}from"./chunk-SZWYIW32.js";import{b as I,c as A}from"./chunk-OWLRGWNJ.js";import{$ as S,Y as w,Z as D}from"./chunk-OS2CYUJN.js";import{$a as a,Eb as M,Gb as p,Hb as c,Mb as g,Nb as e,Ob as i,_b as u,ac as O,ea as d,ob as C,pc as n,qc as b,rb as y,rc as v,va as P}from"./chunk-IQSYHSID.js";import{f as x}from"./chunk-EQDQRRRY.js";function it(o,r){o&1&&(e(0,"mat-error"),n(1,"PIN is required"),i())}function nt(o,r){o&1&&(e(0,"mat-error"),n(1,"PIN must be at least 4 digits"),i())}function ot(o,r){o&1&&(e(0,"mat-error"),n(1,"PIN cannot exceed 6 digits"),i())}function rt(o,r){o&1&&(e(0,"mat-error"),n(1,"Invalid PIN entered"),i())}function at(o,r){if(o&1&&(e(0,"div",12)(1,"mat-icon",20),n(2,"error"),i(),e(3,"div")(4,"h4",21),n(5,"Authorization Failed"),i(),e(6,"p",22),n(7),i()()()),o&2){let l=O();a(7),b(l.error())}}var $=class o{fb=d(V);dialogRef=d(Q);data=d(W);storeService=d(z);verifying=P(!1);error=P(null);showPin=P(!1);pinForm;constructor(){this.pinForm=this.fb.group({pin:["",[_.required,_.minLength(4),_.maxLength(6)]]})}get actionDescription(){return this.data.actionDescription||"perform this action"}get storeId(){return this.data.storeId}togglePinVisibility(){this.showPin.set(!this.showPin())}verifyPin(){return x(this,null,function*(){if(this.pinForm.invalid){this.pinForm.markAllAsTouched();return}let r=this.pinForm.get("pin")?.value;if(r){this.verifying.set(!0),this.error.set(null);try{(yield this.storeService.validateStoreOwnerPin(this.storeId,r).toPromise())?this.dialogRef.close({authorized:!0,pin:r}):(this.error.set("Invalid PIN. Please check with the store owner for the correct PIN."),this.pinForm.get("pin")?.setErrors({invalid:!0}))}catch(l){console.error("Error validating PIN:",l),this.error.set("Unable to verify PIN. Please check your connection and try again.")}finally{this.verifying.set(!1)}}})}cancel(){this.dialogRef.close({authorized:!1})}onPinKeyPress(r){r.key==="Enter"&&this.pinForm.valid&&!this.verifying()&&this.verifyPin()}onPinInput(){this.error()&&(this.error.set(null),this.pinForm.get("pin")?.setErrors(null))}static \u0275fac=function(l){return new(l||o)};static \u0275cmp=C({type:o,selectors:[["app-pin-authorization-dialog"]],decls:37,vars:13,consts:[[1,"pin-authorization-dialog"],[1,"dialog-header"],[1,"text-xl","font-semibold","text-gray-900","mb-2","flex","items-center","gap-3"],[1,"w-10","h-10","bg-gradient-to-r","from-red-500","to-red-600","rounded-full","flex","items-center","justify-center","shadow-lg"],[1,"text-white","text-lg"],[1,"text-gray-600","text-sm"],[1,"dialog-content","mt-6"],[3,"ngSubmit","formGroup"],[1,"space-y-4"],["appearance","outline",1,"w-full"],["matInput","","formControlName","pin","placeholder","Enter 4-6 digit PIN","maxlength","6","autocomplete","off",1,"text-center","text-lg","tracking-wider","font-mono",3,"keypress","input","type"],["type","button","matSuffix","","mat-icon-button","",1,"text-gray-500","hover:text-gray-700",3,"click"],[1,"bg-red-50","border","border-red-200","rounded-lg","p-4","flex","items-start","gap-3"],[1,"bg-blue-50","border","border-blue-200","rounded-lg","p-4","flex","items-start","gap-3"],[1,"text-blue-500","mt-0.5","flex-shrink-0"],[1,"text-blue-800","font-medium","text-sm"],[1,"text-blue-700","text-sm","mt-1"],[1,"dialog-actions","mt-8","flex","items-center","justify-end","gap-3","pt-4","border-t","border-gray-200"],["type","button","mat-button","",1,"!text-gray-600","hover:!text-gray-800","hover:!bg-gray-50","!transition-colors","!px-6","!py-2",3,"click","disabled"],["type","button","mat-raised-button","","color","primary",1,"!bg-gradient-to-r","!from-blue-600","!to-blue-700","hover:!from-blue-700","hover:!to-blue-800","!text-white","!px-8","!py-2","!rounded-lg","!font-medium","!transition-all","!duration-200","!shadow-lg","hover:!shadow-xl","disabled:!opacity-50","disabled:!cursor-not-allowed",3,"click","disabled"],[1,"text-red-500","mt-0.5","flex-shrink-0"],[1,"text-red-800","font-medium","text-sm"],[1,"text-red-700","text-sm","mt-1"]],template:function(l,t){if(l&1&&(e(0,"div",0)(1,"div",1)(2,"h2",2)(3,"div",3)(4,"mat-icon",4),n(5,"security"),i()(),n(6," Store Owner Authorization Required "),i(),e(7,"p",5),n(8),i()(),e(9,"div",6)(10,"form",7),u("ngSubmit",function(){return t.verifyPin()}),e(11,"div",8)(12,"mat-form-field",9)(13,"mat-label"),n(14,"Store Owner PIN"),i(),e(15,"input",10),u("keypress",function(s){return t.onPinKeyPress(s)})("input",function(){return t.onPinInput()}),i(),e(16,"button",11),u("click",function(){return t.togglePinVisibility()}),e(17,"mat-icon"),n(18),i()(),p(19,it,2,0,"mat-error"),p(20,nt,2,0,"mat-error"),p(21,ot,2,0,"mat-error"),p(22,rt,2,0,"mat-error"),i(),p(23,at,8,1,"div",12),e(24,"div",13)(25,"mat-icon",14),n(26,"info"),i(),e(27,"div")(28,"h4",15),n(29,"Security Notice"),i(),e(30,"p",16),n(31," Only the store owner should have access to this PIN. This authorization ensures that important actions are performed with proper approval. "),i()()()()()(),e(32,"div",17)(33,"button",18),u("click",function(){return t.cancel()}),n(34," Cancel "),i(),e(35,"button",19),u("click",function(){return t.verifyPin()}),n(36),i()()()),l&2){let m,s,f,h;a(8),v(" Enter the store owner PIN to authorize and ",t.actionDescription,". "),a(2),g("formGroup",t.pinForm),a(5),g("type",t.showPin()?"text":"password"),a(),M("aria-label","Toggle PIN visibility"),a(2),b(t.showPin()?"visibility_off":"visibility"),a(),c((m=t.pinForm.get("pin"))!=null&&m.hasError("required")&&((m=t.pinForm.get("pin"))!=null&&m.touched)?19:-1),a(),c((s=t.pinForm.get("pin"))!=null&&s.hasError("minlength")&&((s=t.pinForm.get("pin"))!=null&&s.touched)?20:-1),a(),c((f=t.pinForm.get("pin"))!=null&&f.hasError("maxlength")&&((f=t.pinForm.get("pin"))!=null&&f.touched)?21:-1),a(),c((h=t.pinForm.get("pin"))!=null&&h.hasError("invalid")&&((h=t.pinForm.get("pin"))!=null&&h.touched)?22:-1),a(),c(t.error()?23:-1),a(10),g("disabled",t.verifying()),a(2),g("disabled",t.pinForm.invalid||t.verifying()),a(),v(" ",t.verifying()?"Verifying...":"Authorize Action"," ")}},dependencies:[L,k,E,F,N,R,G,T,X,S,D,w,U,K,j,q,B,H,Y,A,I,J],styles:[".pin-authorization-dialog[_ngcontent-%COMP%]{padding:24px;max-width:450px;min-width:400px}.dialog-header[_ngcontent-%COMP%]{text-align:center}.dialog-content[_ngcontent-%COMP%]   .mat-mdc-form-field[_ngcontent-%COMP%]   .mdc-text-field--outlined[_ngcontent-%COMP%]{background-color:#f9fafb;border-color:#e5e7eb}.dialog-content[_ngcontent-%COMP%]   .mat-mdc-form-field[_ngcontent-%COMP%]   .mdc-text-field--outlined[_ngcontent-%COMP%]:hover{border-color:#3b82f6}.dialog-content[_ngcontent-%COMP%]   .mat-mdc-form-field[_ngcontent-%COMP%]   .mdc-text-field--outlined.mdc-text-field--focused[_ngcontent-%COMP%]{border-color:#2563eb;box-shadow:0 0 0 3px #3b82f61a}.dialog-actions[_ngcontent-%COMP%]   .mat-mdc-raised-button[_ngcontent-%COMP%]:disabled{box-shadow:none}.dialog-actions[_ngcontent-%COMP%]   .mat-mdc-raised-button[_ngcontent-%COMP%]:disabled:hover{transform:none}.dialog-actions[_ngcontent-%COMP%]   .mat-mdc-raised-button[_ngcontent-%COMP%]:not(:disabled):hover{transform:translateY(-1px);box-shadow:0 10px 15px -3px #0000001a,0 4px 6px -2px #0000000d}@keyframes _ngcontent-%COMP%_pulse-security{0%,to{transform:scale(1)}50%{transform:scale(1.05)}}.dialog-header[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_pulse-security 2s infinite}.mat-mdc-form-field[_ngcontent-%COMP%]   input[type=password][_ngcontent-%COMP%], .mat-mdc-form-field[_ngcontent-%COMP%]   input[type=text][_ngcontent-%COMP%]{font-size:18px;letter-spacing:.2em}.mat-mdc-form-field[_ngcontent-%COMP%]   input[type=password][_ngcontent-%COMP%]::placeholder, .mat-mdc-form-field[_ngcontent-%COMP%]   input[type=text][_ngcontent-%COMP%]::placeholder{font-size:14px;letter-spacing:normal}.bg-red-50[_ngcontent-%COMP%], .bg-blue-50[_ngcontent-%COMP%]{transition:all .2s ease-in-out}.bg-red-50[_ngcontent-%COMP%]:hover, .bg-blue-50[_ngcontent-%COMP%]:hover{box-shadow:0 2px 4px #0000001a}.animate-spin[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_spin 1s linear infinite}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}@media(max-width:480px){.pin-authorization-dialog[_ngcontent-%COMP%]{padding:16px;min-width:320px;max-width:95vw}.dialog-actions[_ngcontent-%COMP%]{flex-direction:column-reverse}.dialog-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:100%;margin:4px 0}}"]})};var tt=class o{guestService=d(Z);transform(r){return this.guestService.getGuestName(r)}static \u0275fac=function(l){return new(l||o)};static \u0275pipe=y({name:"getGuestName",type:o,pure:!0})};export{$ as a,tt as b};
