import{a as he}from"./chunk-AQOUGCTM.js";import{a as ce,b as fe}from"./chunk-LJBXM47V.js";import"./chunk-HFTRPIKU.js";import{a as pe,b as de}from"./chunk-KVX2H4A7.js";import{b as ne,c as oe,d as ae}from"./chunk-GYNGZAKB.js";import{a as D,b as B}from"./chunk-GI4SSOPO.js";import{c as ue}from"./chunk-2WBLSBPP.js";import{a as se}from"./chunk-GIZLGNET.js";import"./chunk-NXTZK4C5.js";import{a as W,b as J,c as K,d as Q,e as X,f as Y,g as Z}from"./chunk-J3TXHOEY.js";import{a as ee,b as te,e as ie,h as re}from"./chunk-YLKT6R4Z.js";import{C as R,E as H,b as V,d as S,g as G,h as q,m as U,n as z,q as L,s as O,t as $,y as j}from"./chunk-2UT4NYMV.js";import"./chunk-S2P5547C.js";import{a as le,b as me}from"./chunk-J5JAEWDO.js";import{a as w}from"./chunk-RE5VYPI4.js";import"./chunk-AGG277FR.js";import"./chunk-7KULNFHZ.js";import"./chunk-5M2ITBTB.js";import{Y as T,Z as A}from"./chunk-D3B3XJ53.js";import"./chunk-RDMIWI4X.js";import"./chunk-AGZJ637K.js";import{a as k,c as P}from"./chunk-LTDPQFG4.js";import"./chunk-VYX7HJYX.js";import"./chunk-FORATDN3.js";import{Eb as d,Fb as u,Kb as b,Lb as t,Mb as e,Nb as l,Ub as N,Yb as E,Za as m,_b as f,ca as p,ha as I,ia as y,mb as F,nc as i,oc as x,pc as h,ta as C}from"./chunk-53XJD7JZ.js";import{a as _,b as M}from"./chunk-EQDQRRRY.js";function Ce(a,n){if(a&1&&(t(0,"div",1)(1,"div",32)(2,"mat-icon",33),i(3,"error"),e(),t(4,"p",34),i(5),e()()()),a&2){let r=f();m(5),x(r.error())}}function be(a,n){a&1&&(t(0,"mat-error"),i(1," Supplier name is required "),e())}function Ee(a,n){a&1&&(t(0,"mat-error"),i(1," Supplier name must be at least 2 characters "),e())}function xe(a,n){a&1&&(t(0,"mat-error"),i(1," Email is required "),e())}function ve(a,n){a&1&&(t(0,"mat-error"),i(1," Please enter a valid email address "),e())}function ge(a,n){if(a&1&&(t(0,"button",30),l(1,"mat-spinner",35),i(2),e()),a&2){let r=f();m(2),h(" ",r.isEditMode()?"Updating...":"Creating..."," ")}}function _e(a,n){if(a&1){let r=N();t(0,"button",36),E("click",function(){I(r);let s=f();return y(s.onSubmit())}),t(1,"mat-icon"),i(2),e(),i(3),e()}if(a&2){let r=f();b("disabled",r.supplierForm.invalid),m(2),x(r.isEditMode()?"save":"add"),m(),h(" ",r.isEditMode()?"Update Supplier":"Create Supplier"," ")}}var Se=class a{fb=p(R);suppliersService=p(he);router=p(P);route=p(k);snackBar=p(D);storeStore=p(se);authService=p(w);currentUser=ue(this.authService.currentUser,{initialValue:null});supplierForm;loading=C(!1);error=C(null);isEditMode=C(!1);supplierId=null;constructor(){this.initializeForm()}ngOnInit(){this.supplierId=this.route.snapshot.paramMap.get("id"),this.supplierId&&(this.isEditMode.set(!0),this.loadSupplier())}initializeForm(){this.supplierForm=this.fb.group({name:["",[S.required,S.minLength(2)]],contactPerson:[""],email:["",[S.required,S.email]],phone:[""],website:[""],description:[""],taxId:[""],paymentTerms:[""],creditLimit:[null],active:[!0],notes:[""],address:this.fb.group({street:[""],city:[""],state:[""],country:[""],postalCode:[""]})})}loadSupplier(){if(!this.supplierId)return;let n=this.storeStore.selectedStore()?._id;n&&(this.loading.set(!0),this.suppliersService.getSupplier(this.supplierId,n).subscribe({next:r=>{this.supplierForm.patchValue(r),this.loading.set(!1)},error:r=>{this.error.set("Failed to load supplier details"),this.loading.set(!1),console.error("Error loading supplier:",r)}}))}onSubmit(){if(this.supplierForm.invalid){this.markAllFieldsAsTouched();return}let n=this.storeStore.selectedStore()?._id,r=this.currentUser();if(!n||!r){this.error.set("Store or user information not available");return}this.loading.set(!0),this.error.set(null);let o=this.supplierForm.value;if(this.isEditMode()&&this.supplierId){let s=o;this.suppliersService.updateSupplier(this.supplierId,s,n).subscribe({next:()=>{this.snackBar.open("Supplier updated successfully","Close",{duration:3e3,horizontalPosition:"end",verticalPosition:"top"}),this.router.navigate(["/menu/erp/inventory/suppliers"])},error:c=>{this.error.set("Failed to update supplier"),this.loading.set(!1),this.snackBar.open("Failed to update supplier","Close",{duration:3e3,horizontalPosition:"end",verticalPosition:"top"}),console.error("Error updating supplier:",c)}})}else{let s=M(_({},o),{store:n,createdBy:r._id});this.suppliersService.createSupplier(s).subscribe({next:()=>{this.snackBar.open("Supplier created successfully","Close",{duration:3e3,horizontalPosition:"end",verticalPosition:"top"}),this.router.navigate(["/menu/erp/inventory/suppliers"])},error:c=>{this.error.set("Failed to create supplier"),this.loading.set(!1),this.snackBar.open("Failed to create supplier","Close",{duration:3e3,horizontalPosition:"end",verticalPosition:"top"}),console.error("Error creating supplier:",c)}})}}onCancel(){this.router.navigate(["/menu/erp/inventory/suppliers"])}markAllFieldsAsTouched(){Object.keys(this.supplierForm.controls).forEach(n=>{let r=this.supplierForm.get(n);if(r?.markAsTouched(),r&&r.value&&typeof r.value=="object"){let o=r;Object.keys(o.controls).forEach(s=>{o.get(s)?.markAsTouched()})}})}isFieldInvalid(n){let r=this.supplierForm.get(n);return r?r.invalid&&r.touched:!1}isNestedFieldInvalid(n,r){let o=this.supplierForm.get(`${n}.${r}`);return o?o.invalid&&o.touched:!1}getFieldError(n){let r=this.supplierForm.get(n);if(r?.errors&&r.touched){if(r.errors.required)return`${n} is required`;if(r.errors.email)return"Please enter a valid email address";if(r.errors.minlength)return`${n} must be at least ${r.errors.minlength.requiredLength} characters`}return""}static \u0275fac=function(r){return new(r||a)};static \u0275cmp=F({type:a,selectors:[["app-create-suppliers"]],decls:114,vars:10,consts:[[1,"max-w-4xl","mx-auto"],[1,"bg-red-50","border","border-red-200","rounded-lg","p-4","mb-6"],[1,"space-y-6",3,"ngSubmit","formGroup"],[1,"mb-8"],[1,"text-lg","font-semibold","text-gray-900","mb-4"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4"],["appearance","outline",1,"md:col-span-2"],["matInput","","formControlName","name","placeholder","Enter supplier name"],["matSuffix",""],["appearance","outline"],["matInput","","formControlName","contactPerson","placeholder","Enter contact person name"],["matInput","","type","email","formControlName","email","placeholder","Enter email address"],["matInput","","type","tel","formControlName","phone","placeholder","Enter phone number"],["matInput","","type","url","formControlName","website","placeholder","https://example.com"],["matInput","","formControlName","description","rows","3","placeholder","Enter supplier description"],["formGroupName","address",1,"mb-8"],["matInput","","formControlName","street","placeholder","Enter street address"],["matInput","","formControlName","city","placeholder","Enter city"],["matInput","","formControlName","state","placeholder","Enter state or province"],["matInput","","formControlName","country","placeholder","Enter country"],["matInput","","formControlName","postalCode","placeholder","Enter postal code"],["matInput","","formControlName","taxId","placeholder","Enter tax identification number"],["matInput","","formControlName","paymentTerms","placeholder","e.g., Net 30 days"],["matInput","","type","number","formControlName","creditLimit","placeholder","Enter credit limit amount","min","0","step","0.01"],[1,"flex","items-center","mt-4"],["formControlName","active"],["appearance","outline",1,"w-full"],["matInput","","formControlName","notes","rows","4","placeholder","Enter any additional notes about this supplier"],["align","end"],["mat-button","","type","button",3,"click","disabled"],["mat-raised-button","","color","primary","disabled",""],["mat-raised-button","","color","primary",3,"disabled"],[1,"flex"],[1,"text-red-400","mr-2"],[1,"text-sm","text-red-800"],["diameter","20"],["mat-raised-button","","color","primary",3,"click","disabled"]],template:function(r,o){if(r&1&&(t(0,"mat-card",0)(1,"mat-card-header")(2,"mat-card-title"),i(3),e(),t(4,"mat-card-subtitle"),i(5),e()(),t(6,"mat-card-content"),d(7,Ce,6,1,"div",1),t(8,"form",2),E("ngSubmit",function(){return o.onSubmit()}),t(9,"div",3)(10,"h3",4),i(11,"Basic Information"),e(),t(12,"div",5)(13,"mat-form-field",6)(14,"mat-label"),i(15,"Supplier Name *"),e(),l(16,"input",7),t(17,"mat-icon",8),i(18,"business"),e(),d(19,be,2,0,"mat-error"),d(20,Ee,2,0,"mat-error"),e(),t(21,"mat-form-field",9)(22,"mat-label"),i(23,"Contact Person"),e(),l(24,"input",10),t(25,"mat-icon",8),i(26,"person"),e()(),t(27,"mat-form-field",9)(28,"mat-label"),i(29,"Email Address *"),e(),l(30,"input",11),t(31,"mat-icon",8),i(32,"email"),e(),d(33,xe,2,0,"mat-error"),d(34,ve,2,0,"mat-error"),e(),t(35,"mat-form-field",9)(36,"mat-label"),i(37,"Phone Number"),e(),l(38,"input",12),t(39,"mat-icon",8),i(40,"phone"),e()(),t(41,"mat-form-field",9)(42,"mat-label"),i(43,"Website"),e(),l(44,"input",13),t(45,"mat-icon",8),i(46,"language"),e()(),t(47,"mat-form-field",6)(48,"mat-label"),i(49,"Description"),e(),l(50,"textarea",14),e()()(),t(51,"div",15)(52,"h3",4),i(53,"Address Information"),e(),t(54,"div",5)(55,"mat-form-field",6)(56,"mat-label"),i(57,"Street Address"),e(),l(58,"input",16),t(59,"mat-icon",8),i(60,"location_on"),e()(),t(61,"mat-form-field",9)(62,"mat-label"),i(63,"City"),e(),l(64,"input",17),e(),t(65,"mat-form-field",9)(66,"mat-label"),i(67,"State/Province"),e(),l(68,"input",18),e(),t(69,"mat-form-field",9)(70,"mat-label"),i(71,"Country"),e(),l(72,"input",19),e(),t(73,"mat-form-field",9)(74,"mat-label"),i(75,"Postal Code"),e(),l(76,"input",20),e()()(),t(77,"div",3)(78,"h3",4),i(79,"Business Information"),e(),t(80,"div",5)(81,"mat-form-field",9)(82,"mat-label"),i(83,"Tax ID"),e(),l(84,"input",21),t(85,"mat-icon",8),i(86,"receipt"),e()(),t(87,"mat-form-field",9)(88,"mat-label"),i(89,"Payment Terms"),e(),l(90,"input",22),t(91,"mat-icon",8),i(92,"payment"),e()(),t(93,"mat-form-field",9)(94,"mat-label"),i(95,"Credit Limit"),e(),l(96,"input",23),t(97,"mat-icon",8),i(98,"attach_money"),e()(),t(99,"div",24)(100,"mat-checkbox",25),i(101,"Active Supplier"),e()()()(),t(102,"div",3)(103,"h3",4),i(104,"Additional Notes"),e(),t(105,"mat-form-field",26)(106,"mat-label"),i(107,"Notes"),e(),l(108,"textarea",27),e()()()(),t(109,"mat-card-actions",28)(110,"button",29),E("click",function(){return o.onCancel()}),i(111," Cancel "),e(),d(112,ge,3,1,"button",30)(113,_e,4,3,"button",31),e()()),r&2){let s,c,v,g;m(3),h(" ",o.isEditMode()?"Edit Supplier":"Add New Supplier"," "),m(2),h(" ",o.isEditMode()?"Update supplier information":"Create a new supplier for your store"," "),m(2),u(o.error()?7:-1),m(),b("formGroup",o.supplierForm),m(11),u((s=o.supplierForm.get("name"))!=null&&s.hasError("required")?19:-1),m(),u((c=o.supplierForm.get("name"))!=null&&c.hasError("minlength")?20:-1),m(13),u((v=o.supplierForm.get("email"))!=null&&v.hasError("required")?33:-1),m(),u((g=o.supplierForm.get("email"))!=null&&g.hasError("email")?34:-1),m(76),b("disabled",o.loading()),m(2),u(o.loading()?112:113)}},dependencies:[H,U,V,z,G,q,j,$,O,L,Z,W,X,K,Y,Q,J,ne,re,ee,te,ie,ae,oe,A,T,me,le,fe,ce,de,pe,B],styles:["[_nghost-%COMP%]{display:block}"]})};export{Se as CreateSuppliersComponent};
