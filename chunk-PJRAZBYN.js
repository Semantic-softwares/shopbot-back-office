import{a as me,b as pe,c as he,e as ue,f as ge,g as ve,l as fe}from"./chunk-SB5BMAVW.js";import{a as de,b as ce}from"./chunk-TPXN6FKM.js";import{a as A}from"./chunk-23Y5PA5G.js";import{c as ye}from"./chunk-RDML4QTY.js";import"./chunk-WFM45R76.js";import{i as ae}from"./chunk-WFQLSX5X.js";import"./chunk-5IMEEOTN.js";import"./chunk-UATHS3SB.js";import"./chunk-GZ7S2I6F.js";import"./chunk-L5R7UQHM.js";import"./chunk-ADPCW6JI.js";import"./chunk-UPMF7ZC6.js";import{a as re}from"./chunk-BFT2MTJY.js";import{a as se,h as le}from"./chunk-GI3DA2RF.js";import"./chunk-47XHPHB4.js";import{b as ne,c as oe}from"./chunk-5P5QATX2.js";import{$ as ie,Y as ee,Z as te,i as Y}from"./chunk-LG6YQHRU.js";import{g as X}from"./chunk-DWM5GR6S.js";import{m as Z,p as q,r as J,x as K}from"./chunk-6BQAOBQP.js";import{$ as L,$a as o,E as S,Gb as _,Hb as w,Jb as F,Jc as M,Kb as N,Lb as W,Lc as T,Mb as C,Nb as i,Ob as r,Pb as h,V as p,Wb as Q,_b as $,aa as G,ac as D,ea as g,f as H,g as y,ja as P,ka as B,m as b,mc as v,ob as k,pb as U,pc as a,qc as c,r as E,rc as f,va as m,ya as V}from"./chunk-H33Y42PP.js";import"./chunk-GAL4ENT6.js";var Se=(()=>{class s{static \u0275fac=function(e){return new(e||s)};static \u0275mod=U({type:s});static \u0275inj=G({imports:[A,Y,A]})}return s})();var R=class s{http=g(K);baseUrl=re.apiUrl+"/analytics";dashboardStatsSubject=new y(null);dashboardStats$=this.dashboardStatsSubject.asObservable();recentActivitiesSubject=new y([]);recentActivities$=this.recentActivitiesSubject.asObservable();loadingSubject=new y(!1);loading$=this.loadingSubject.asObservable();errorSubject=new y(null);error$=this.errorSubject.asObservable();getDashboardStats(t){return this.loadingSubject.next(!0),this.errorSubject.next(null),this.http.get(`${this.baseUrl}/dashboard/${t}`).pipe(E(n=>(this.dashboardStatsSubject.next(n),this.loadingSubject.next(!1),n)),S(n=>{console.error("Error fetching dashboard stats:",n),this.errorSubject.next("Failed to load dashboard statistics"),this.loadingSubject.next(!1);let e={totalRooms:50,availableRooms:12,occupancyRate:76,checkedInGuests:38,todayCheckins:8,todayCheckouts:5,todayRevenue:4250,monthlyRevenue:125e3,lastUpdated:new Date};return this.dashboardStatsSubject.next(e),b(e)}))}getOccupancyTrend(t,n=7){return this.http.get(`${this.baseUrl}/occupancy-trend/${t}?days=${n}`).pipe(S(e=>{console.error("Error fetching occupancy trend:",e);let l=Array.from({length:n},(x,u)=>{let d=new Date;return d.setDate(d.getDate()-(n-1-u)),{date:d.toISOString().split("T")[0],occupancyRate:Math.floor(Math.random()*40)+60,occupiedRooms:Math.floor(Math.random()*20)+30,totalRooms:50}});return b(l)}))}getRevenueTrend(t,n=7){return this.http.get(`${this.baseUrl}/revenue-trend/${t}?days=${n}`).pipe(S(e=>{console.error("Error fetching revenue trend:",e);let l=Array.from({length:n},(x,u)=>{let d=new Date;return d.setDate(d.getDate()-(n-1-u)),{date:d.toISOString().split("T")[0],revenue:Math.floor(Math.random()*3e3)+2e3,reservationCount:Math.floor(Math.random()*10)+5}});return b(l)}))}getRecentActivities(t,n=10){return this.http.get(`${this.baseUrl}/recent-activities/${t}?limit=${n}`).pipe(E(e=>(this.recentActivitiesSubject.next(e),e)),S(e=>{console.error("Error fetching recent activities:",e);let l=[{id:"1",title:"John Doe checked in to room 205",icon:"check_in",type:"Check-in",time:"15m ago",timestamp:new Date(Date.now()-900*1e3)},{id:"2",title:"New reservation by Sarah Wilson",icon:"book_online",type:"Reservation",time:"32m ago",timestamp:new Date(Date.now()-1920*1e3)},{id:"3",title:"Mike Johnson checked out from room 102",icon:"check_out",type:"Check-out",time:"1h ago",timestamp:new Date(Date.now()-3600*1e3)},{id:"4",title:"Room 301 maintenance completed",icon:"build",type:"Maintenance",time:"2h ago",timestamp:new Date(Date.now()-7200*1e3)},{id:"5",title:"Payment received from Lisa Chen",icon:"payment",type:"Payment",time:"3h ago",timestamp:new Date(Date.now()-10800*1e3)}];return this.recentActivitiesSubject.next(l),b(l)}))}refreshData(t){this.getDashboardStats(t).subscribe(),this.getRecentActivities(t).subscribe()}clearError(){this.errorSubject.next(null)}static \u0275fac=function(n){return new(n||s)};static \u0275prov=L({token:s,factory:s.\u0275fac,providedIn:"root"})};function _e(s,t){if(s&1){let n=Q();i(0,"div",7)(1,"div",10)(2,"div",36)(3,"mat-icon",40),a(4,"error"),r(),i(5,"span",41),a(6),r()(),i(7,"button",42),$("click",function(){P(n);let l=D();return B(l.clearError())}),i(8,"mat-icon"),a(9,"close"),r()()()()}if(s&2){let n=D();o(6),c(n.error())}}function we(s,t){s&1&&h(0,"mat-divider")}function Ce(s,t){if(s&1&&(i(0,"mat-list-item",43)(1,"div",44)(2,"mat-icon"),a(3),r()(),i(4,"span",45),a(5),r(),i(6,"span",46),a(7),r(),i(8,"span",47),a(9),r()(),_(10,we,1,0,"mat-divider")),s&2){let n=t.$implicit,e=t.$index,l=D();o(3),c(n.icon),o(2),c(n.title),o(2),c(n.time),o(2),c(n.type),o(),w(e<l.recentActivities().length-1?10:-1)}}function De(s,t){s&1&&(i(0,"div",34)(1,"mat-icon",48),a(2,"history"),r(),i(3,"p"),a(4,"Recent activity will appear here"),r()())}var xe=class s{router=g(X);analyticsService=g(R);destroy$=new H;storeStore=g(ae);get currency(){return this.storeStore.selectedStore()?.currency||this.storeStore.selectedStore()?.currencyCode||"$"}get defaultValue(){return"0"}dashboardStats=m(null);recentActivities=m([]);loading=m(!1);error=m(null);lastUpdated=m(new Date);storeChangeEffect=V(()=>{let t=this.storeStore.selectedStore();t?._id&&(console.log("Store changed in overview component:",t.name,t._id),this.refreshData(),this.loadChartData())});occupancyChartData=m({labels:[],datasets:[{data:[],label:"Occupancy Rate (%)",backgroundColor:"rgba(59, 130, 246, 0.1)",borderColor:"rgba(59, 130, 246, 1)",borderWidth:2,fill:!0,tension:.4}]});occupancyChartOptions={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1}},scales:{y:{beginAtZero:!0,max:100,ticks:{callback:function(t){return t+"%"}}}}};revenueChartData=m({labels:[],datasets:[{data:[],label:"Daily Revenue",backgroundColor:"rgba(34, 197, 94, 0.8)",borderColor:"rgba(34, 197, 94, 1)",borderWidth:1}]});revenueChartOptions={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1}},scales:{y:{beginAtZero:!0,ticks:{callback:t=>this.currency+t}}}};ngOnInit(){this.analyticsService.dashboardStats$.pipe(p(this.destroy$)).subscribe(t=>{this.dashboardStats.set(t),t&&this.lastUpdated.set(t.lastUpdated)}),this.analyticsService.recentActivities$.pipe(p(this.destroy$)).subscribe(t=>{this.recentActivities.set(t)}),this.analyticsService.loading$.pipe(p(this.destroy$)).subscribe(t=>{this.loading.set(t)}),this.analyticsService.error$.pipe(p(this.destroy$)).subscribe(t=>{this.error.set(t)})}loadChartData(){let t=this.storeStore.selectedStore();if(!t?._id){console.log("No store selected, skipping chart data load");return}this.analyticsService.getOccupancyTrend(t._id,7).pipe(p(this.destroy$)).subscribe(n=>{this.occupancyChartData.set({labels:n.map(e=>new Date(e.date).toLocaleDateString("en-US",{weekday:"short"})),datasets:[{data:n.map(e=>e.occupancyRate),label:"Occupancy Rate (%)",backgroundColor:"rgba(59, 130, 246, 0.1)",borderColor:"rgba(59, 130, 246, 1)",borderWidth:2,fill:!0,tension:.4}]})}),this.analyticsService.getRevenueTrend(t._id,7).pipe(p(this.destroy$)).subscribe(n=>{this.revenueChartData.set({labels:n.map(e=>new Date(e.date).toLocaleDateString("en-US",{weekday:"short"})),datasets:[{data:n.map(e=>e.revenue),label:`Daily Revenue (${this.currency})`,backgroundColor:"rgba(34, 197, 94, 0.8)",borderColor:"rgba(34, 197, 94, 1)",borderWidth:1}]})})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}refreshData(){let t=this.storeStore.selectedStore();if(!t?._id){console.log("No store selected, skipping data refresh");return}this.analyticsService.refreshData(t._id),this.loadChartData()}clearError(){this.analyticsService.clearError()}navigateTo(t){this.router.navigate([t],{relativeTo:this.router.routerState.root})}static \u0275fac=function(n){return new(n||s)};static \u0275cmp=k({type:s,selectors:[["app-overview"]],decls:111,vars:35,consts:[[1,"min-h-screen","p-4","md:p-6","lg:p-8"],[1,"max-w-7xl","mx-auto","space-y-6"],[1,"text-center","space-y-2"],[1,"flex","items-center","justify-center","space-x-4"],[1,"text-3xl","md:text-4xl","font-bold","text-gray-800"],["matIconButton","","color","primary",3,"click","disabled"],[1,"text-gray-600","text-lg"],[1,"bg-red-50","border","border-red-200","rounded-lg","p-4","max-w-2xl","mx-auto"],[1,"grid","grid-cols-1","md:grid-cols-2","lg:grid-cols-4","gap-6"],["appearance","outlined",1,"hover:shadow-lg","transition-all","duration-300","p-6"],[1,"flex","items-center","justify-between"],[1,"text-sm","font-medium","text-gray-500","uppercase","tracking-wide"],[1,"text-3xl","font-bold","text-gray-900","mt-2"],[1,"text-sm","text-emerald-600","mt-1"],[1,"font-medium"],[1,"p-3","border","border-outline-variant","rounded-lg"],[1,"text-sm","text-amber-600","mt-1"],[1,"text-sm","text-purple-600","mt-1"],["appearance","outlined",1,"hover:shadow-lg","transition-all","duration-300","p-6","overflow-hidden"],[1,"flex","items-center","justify-between","gap-2"],[1,"min-w-0","flex-1"],[1,"text-xl","md:text-2xl","lg:text-3xl","font-bold","text-gray-900","mt-2","truncate"],[1,"text-sm","text-green-600","mt-1","truncate"],[1,"p-3","border","border-outline-variant","rounded-lg","flex-shrink-0"],[1,"grid","grid-cols-1","lg:grid-cols-2","gap-6"],[1,"flex","items-center","justify-between","mb-6"],[1,"text-lg","font-semibold","text-gray-800"],[1,"flex","items-center","space-x-2","text-sm","text-gray-500"],[1,"w-3","h-3","bg-blue-500","rounded-full"],[1,"h-64","relative"],["baseChart","","type","line",1,"!h-full","!w-full",3,"data","options"],[1,"w-3","h-3","bg-green-500","rounded-full"],["baseChart","","type","bar",1,"!h-full","!w-full",3,"data","options"],["matButton",""],[1,"text-center","py-8","text-gray-500"],["appearance","outlined",1,"hover:shadow-lg","transition-all","duration-300","p-4"],[1,"flex","items-center","space-x-2"],[1,"w-2","h-2","bg-green-500","rounded-full"],[1,"text-sm","text-gray-600"],[1,"text-xs","text-gray-400"],[1,"text-red-600"],[1,"text-red-800"],["mat-icon-button","",1,"!text-red-600",3,"click"],[1,"!h-auto","!py-3"],["matListItemIcon",""],["matListItemTitle","",1,"text-gray-900"],["matListItemLine","",1,"text-gray-500"],["matListItemMeta","",1,"text-xs","text-gray-400"],[1,"!text-3xl","mb-2"]],template:function(n,e){if(n&1&&(i(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h1",4),a(5,"Hotel Management Dashboard"),r(),i(6,"button",5),$("click",function(){return e.refreshData()}),i(7,"mat-icon"),a(8,"refresh"),r()()(),i(9,"p",6),a(10,"Welcome back! Here's what's happening at your hotel today."),r(),_(11,_e,10,1,"div",7),r(),i(12,"div",8)(13,"mat-card",9)(14,"div",10)(15,"div")(16,"p",11),a(17,"Total Rooms"),r(),i(18,"p",12),a(19),r(),i(20,"p",13)(21,"span",14),a(22),r(),a(23," Available "),r()(),i(24,"div",15)(25,"mat-icon"),a(26,"hotel"),r()()()(),i(27,"mat-card",9)(28,"div",10)(29,"div")(30,"p",11),a(31,"Occupancy Rate"),r(),i(32,"p",12),a(33),r(),i(34,"p",16)(35,"span",14),a(36),r(),a(37," Guests "),r()(),i(38,"div",15)(39,"mat-icon"),a(40,"people"),r()()()(),i(41,"mat-card",9)(42,"div",10)(43,"div")(44,"p",11),a(45,"Today's Check-ins"),r(),i(46,"p",12),a(47),r(),i(48,"p",17)(49,"span",14),a(50),r(),a(51," Check-outs "),r()(),i(52,"div",15)(53,"mat-icon"),a(54,"event_available"),r()()()(),i(55,"mat-card",18)(56,"div",19)(57,"div",20)(58,"p",11),a(59,"Today's Revenue"),r(),i(60,"p",21),a(61),M(62,"currency"),r(),i(63,"p",22)(64,"span",14),a(65),M(66,"currency"),r(),a(67," This Month "),r()(),i(68,"div",23)(69,"mat-icon"),a(70,"trending_up"),r()()()()(),i(71,"div",24)(72,"mat-card",9)(73,"div",25)(74,"h3",26),a(75,"Weekly Occupancy"),r(),i(76,"div",27),h(77,"div",28),i(78,"span"),a(79,"Occupancy Rate"),r()()(),i(80,"div",29),h(81,"canvas",30),r()(),i(82,"mat-card",9)(83,"div",25)(84,"h3",26),a(85,"Revenue Trend"),r(),i(86,"div",27),h(87,"div",31),i(88,"span"),a(89,"Daily Revenue"),r()()(),i(90,"div",29),h(91,"canvas",32),r()()(),i(92,"mat-card",9)(93,"div",25)(94,"h3",26),a(95,"Recent Activity"),r(),i(96,"button",33),a(97,"View All"),r()(),i(98,"mat-list"),N(99,Ce,11,5,null,null,F),_(101,De,5,0,"div",34),r()(),i(102,"mat-card",35)(103,"div",10)(104,"div",36),h(105,"div",37),i(106,"span",38),a(107,"System Status: Online"),r()(),i(108,"div",39),a(109),M(110,"date"),r()()()()()),n&2){let l,x,u,d,I,z,O,j;o(6),C("disabled",e.loading()),o(),v("animate-spin",e.loading()),o(4),w(e.error()?11:-1),o(7),v("animate-pulse",e.loading()),o(),f(" ",((l=e.dashboardStats())==null?null:l.totalRooms)||e.defaultValue," "),o(3),c(((x=e.dashboardStats())==null?null:x.availableRooms)||e.defaultValue),o(10),v("animate-pulse",e.loading()),o(),f(" ",((u=e.dashboardStats())==null?null:u.occupancyRate)||e.defaultValue,"% "),o(3),c(((d=e.dashboardStats())==null?null:d.checkedInGuests)||e.defaultValue),o(10),v("animate-pulse",e.loading()),o(),f(" ",((I=e.dashboardStats())==null?null:I.todayCheckins)||e.defaultValue," "),o(3),c(((z=e.dashboardStats())==null?null:z.todayCheckouts)||e.defaultValue),o(10),v("animate-pulse",e.loading()),o(),f(" ",T(62,26,(O=e.dashboardStats())==null?null:O.todayRevenue,e.currency)||e.defaultValue," "),o(4),c(T(66,29,(j=e.dashboardStats())==null?null:j.monthlyRevenue,e.currency)||e.defaultValue),o(16),C("data",e.occupancyChartData())("options",e.occupancyChartOptions),o(10),C("data",e.revenueChartData())("options",e.revenueChartOptions),o(8),W(e.recentActivities()),o(2),w(!e.recentActivities()||e.recentActivities().length===0?101:-1),o(8),f(" Last updated: ",T(110,32,e.lastUpdated(),"short")," ")}},dependencies:[J,le,se,oe,ne,ie,te,ee,Se,fe,ge,ve,ue,de,pe,me,he,ce,ye,q,Z],encapsulation:2})};export{xe as OverviewComponent};
