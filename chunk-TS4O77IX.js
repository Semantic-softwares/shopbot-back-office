import{a as Z}from"./chunk-M2YK6UF7.js";import{a as U}from"./chunk-AGZJ637K.js";import{A as H,B as K}from"./chunk-DWCYWQVU.js";import{E as A,Lc as w,M as F,Mc as x,Nc as L,W,Z as I,aa as M,b as k,c as R,fa as p,g as _,ka as O,l as E,p as T,pa as D,ra as b,ua as j,va as z}from"./chunk-5AECHVKR.js";import{a as o,b as h}from"./chunk-EQDQRRRY.js";var $=class e{hostServer=U.apiUrl;_httpClient=p(K);sessionStorageService=p(Z);createStore(t){return this._httpClient.post(`${this.hostServer}/stores/web`,t)}getStoreCategories(){return this._httpClient.get(`${this.hostServer}/categories`)}deliveryZones(){return this._httpClient.get(`${this.hostServer}/delivery-zones`)}getMerchantStore(t){return this._httpClient.get(`${this.hostServer}/stores/merchant/${t}`)}getMerchantStores(t){return this._httpClient.get(`${this.hostServer}/stores/${t}/vendors`)}updateStore(t,n){return this._httpClient.put(`${this.hostServer}/stores/${t}`,n)}get getStoreLocally(){return this.sessionStorageService.getStore()}get getStoresLocally(){return this.sessionStorageService.getStores()}saveStoresLocally(t){this.sessionStorageService.setStores(t)}saveStoreLocally(t){this.sessionStorageService.setStore(t)}deleteStoreLocally(){this.sessionStorageService.removeStore()}getStore(t){return this._httpClient.get(`${this.hostServer}/stores/${t}`)}addStore(t){return this._httpClient.post(`${this.hostServer}/stores`,t)}getStoreOrders(t){return this._httpClient.get(`${this.hostServer}/orders/store/${t}/orders`)}deleteStoreOrders(t){return this._httpClient.delete(`${this.hostServer}/orders/${t}`)}updateOrderStatus(t,n,r){return this._httpClient.put(`${this.hostServer}/orders/${t}/status/${n}`,r)}uploadLogo(t,n){return this._httpClient.post(`${this.hostServer}/stores/upload/${n}/logo`,t)}uploadBanner(t,n){return this._httpClient.post(`${this.hostServer}/stores/upload/${n}/banner`,t)}getOrderStat(t){let n=new H({fromObject:t});return this._httpClient.get(`${this.hostServer}/dashboard/total-store-sales?${n.toString()}`)}getIncompleteData(t){return this._httpClient.get(`${this.hostServer}/stores/in-complete-data/${t}`)}getDeliveryZonesFromServer(){return this._httpClient.get(`${this.hostServer}/delivery-zones`)}validateStoreOwnerPin(t,n){return this._httpClient.post(`${this.hostServer}/stores/${t}/validate-pin`,{pin:n})}static \u0275fac=function(n){return new(n||e)};static \u0275prov=M({token:e,factory:e.\u0275fac,providedIn:"root"})};function B(e){let t=w(()=>e());return et(t)?new Proxy(e,{get(n,r){return r in t?(j(n[r])||Object.defineProperty(n,r,{value:x(()=>n()[r]),configurable:!0}),B(n[r])):n[r]}}):e}var tt=[WeakSet,WeakMap,Promise,Date,Error,RegExp,ArrayBuffer,DataView,Function];function et(e){if(e===null||typeof e!="object"||nt(e))return!1;let t=Object.getPrototypeOf(e);if(t===Object.prototype)return!0;for(;t&&t!==Object.prototype;){if(tt.includes(t.constructor))return!1;t=Object.getPrototypeOf(t)}return t===Object.prototype}function nt(e){return typeof e?.[Symbol.iterator]=="function"}var rt=new WeakMap,c=Symbol("STATE_SOURCE");function l(e,...t){e[c].update(n=>t.reduce((r,a)=>o(o({},r),typeof a=="function"?a(r):a),n)),st(e)}function ot(e){return e[c]()}function it(e){return rt.get(e[c])||[]}function st(e){let t=it(e);for(let n of t){let r=w(()=>ot(e));n(r)}}function q(...e){let t=[...e],n=typeof t[0]=="function"?{}:t.shift(),r=t;return(()=>{class s{constructor(){let d=r.reduce((g,X)=>X(g),at()),{stateSignals:S,props:y,methods:m,hooks:i}=d,f=o(o(o({},S),y),m);this[c]=d[c];for(let g of Reflect.ownKeys(f))this[g]=f[g];let{onInit:v,onDestroy:C}=i;v&&v(),C&&p(b).onDestroy(C)}static \u0275fac=function(S){return new(S||s)};static \u0275prov=M({token:s,factory:s.\u0275fac,providedIn:n.providedIn||null})}return s})()}function at(){return{[c]:z({}),stateSignals:{},props:{},methods:{},hooks:{}}}function ct(e){return t=>{let n=e(o(o(o({[c]:t[c]},t.stateSignals),t.props),t.methods));return Reflect.ownKeys(n),h(o({},t),{props:o(o({},t.props),n)})}}function V(e){return ct(e)}function Y(e){return t=>{let n=o(o(o({[c]:t[c]},t.stateSignals),t.props),t.methods),r=typeof e=="function"?e(n):e,a=s=>{let u=r[s],d=t.hooks[s];return u?()=>{d&&d(),u(n)}:d};return h(o({},t),{hooks:{onInit:a("onInit"),onDestroy:a("onDestroy")}})}}function G(e){return t=>{let n=e(o(o(o({[c]:t[c]},t.stateSignals),t.props),t.methods));return Reflect.ownKeys(n),h(o({},t),{methods:o(o({},t.methods),n)})}}function J(e){return t=>{let n=typeof e=="function"?e():e,r=Reflect.ownKeys(n);t[c].update(s=>o(o({},s),n));let a=r.reduce((s,u)=>{let d=x(()=>t[c]()[u]);return h(o({},s),{[u]:B(d)})},{});return h(o({},t),{stateSignals:o(o({},t.stateSignals),a)})}}function Q(e,t,n){let r=typeof e=="function"?{next:e,error:t,complete:n}:e;return a=>a.pipe(I({next:r.next,complete:r.complete}),A(s=>(r.error(s),E)),r.finalize?F(r.finalize):s=>s)}function P(e,t){t?.injector||O(P);let n=t?.injector??p(D),r=new _,a=e(r).subscribe();n.get(b).onDestroy(()=>a.unsubscribe());let s=(u,d)=>{if(lt(u))return r.next(u),{destroy:k};let S=ut(),y=d?.injector??S??n;if(j(u)){let i=L(()=>{let f=u();w(()=>r.next(f))},{injector:y});return a.add({unsubscribe:()=>i.destroy()}),i}let m=u.subscribe(i=>r.next(i));return a.add(m),y!==n&&y.get(b).onDestroy(()=>m.unsubscribe()),{destroy:()=>m.unsubscribe()}};return s.destroy=a.unsubscribe.bind(a),s}function lt(e){return!j(e)&&!T(e)}function ut(){try{return p(D)}catch{return}}var dt={stores:[],isLoading:!1,selectedStore:null,error:null,logoPath:null,bannerPath:null},Ft=q({providedIn:"root"},J(dt),V(({stores:e})=>({storesCount:x(()=>e().length)})),G((e,t=p($))=>{function n(i){l(e,{isLoading:i})}function r(i){t.saveStoreLocally(i),l(e,{selectedStore:i})}function a(i){t.saveStoresLocally(i),l(e,{stores:i})}function s(){l(e,{stores:[]})}function u(){let i=t.getStoreLocally;i&&l(e,{selectedStore:i})}function d(i,f){let v=e.selectedStore();if(v){let C=v.staffs.map(g=>g._id===i?o(o({},g),f):g);l(e,{selectedStore:h(o({},v),{staffs:C})})}}function S(i){let f=e.selectedStore();f&&l(e,{selectedStore:h(o(o({},f),i),{_id:f._id})})}function y(i){l(e,{logoPath:i})}let m=P(R(I(()=>l(e,{isLoading:!0,error:null})),W(i=>t.updateStore(e.selectedStore()._id,i).pipe(Q({next(f){l(e,{isLoading:!1,error:null,logoPath:null,bannerPath:null}),S(i)},error(f){l(e,{isLoading:!1,error:f})}})))));return{setSelectedStores:a,clearStores:s,updateStore$:m,updateStore:S,updateStoreStaffs:d,setSelectedStore:r,initializeFromStorage:u,updateLogoPath:y,setLoadingState:n}}),Y({onInit(e,t=p($)){let n=t.getStoresLocally,r=t.getStoreLocally;n&&n.length>0&&l(e,{stores:n}),r&&l(e,{selectedStore:r})}}));export{$ as a,Ft as b};
